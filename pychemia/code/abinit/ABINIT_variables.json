{
  "accesswff": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0. However, if mpi_io is available, <b>accesswff</b> will be set to 1 for the datasets for which <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1, while an explicit mention of <b>accesswff</b> in the input file will override this intermediate default.",
    "definition": "ACCESS to WaveFunction Files ",
    "section": "vardev",
    "text": "<p>\nGoverns the method of access to the\ninternal wavefunction files. Relevant only for the wavefunctions\nfiles for which the corresponding \"mkmem\"-type variable is zero, that\nis, for the wavefunctions that are not kept in core memory.\n<ul>\n<li>0 =&gt; Use standard Fortran IO routines</li>\n<li>1 =&gt; Use MPI/IO routines</li>\n<li>2 =&gt; Directly use NetCDF routines (this option is not available)</li>\n<li>3 =&gt; Use ETSF_IO routines, creating NetCDF files according to the ETSF specification.</li>\n</ul>\n<br>\nIn case <b>accesswff</b>=1, note the following. MPI/IO routines might be much more efficient than usual Fortran IO\nroutines in the case of a large number of processors, with a pool of\ndisks attached globally to the processors, but not one disk attached\nto each processor. For a execution of workstations, where each processor\nhas his own temporaries, the use of <b>accesswff</b>=0 might be perfectly\nallright. This option is useful only if one is using the band-FFT parallelism.\nMPI/IO routines are available in the MPI-2 library, but usually not in the MPI-1 library. So, perhaps you cannot\nuse <b>accesswff</b>=1.\n<br>\nIn case <b>accesswff</b>=3, note that not only the wavefunctions will be written using the ETSF_IO routines,\nbut also, the same input variable governs the writing of the density and potential, that can also be\nwritten using ETSF_IO routines. In order to use <b>accesswff</b>=3, you need to have the plug-in library ETSF_IO\nworking (see the documentation of the build system).\nReferences :\n<ul>\n<li>\n\"Specification of an extensible and portable file format for electronic structure and crystallographic data\",\nX. Gonze, C.-O. Almbladh, A. Cucca, D. Caliste, C. Freysoldt, M. Marques, V. Olevano, Y. Pouillon, M.J. Verstraete,\nComput. Mat. Science 43, 1056 (2008)\n</li>\n<li>\n\"Sharing electronic structure and crystallographic data with ETSF_IO\",\nD. Caliste, Y. Pouillon, M.J. Verstraete, V. Olevano, X. Gonze,\nComput. Physics Communications 179, 748 (2008)\n</li>\n<li>\nsee also <a href=\"http://www.etsf.eu/fileformats\">http://www.etsf.eu/fileformats</a>.\n</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "acell": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a>,<a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "3*1 (in Bohr).",
    "definition": "CELL lattice vector scaling",
    "section": "varbas",
    "text": "<p>\nGives the length scales by which\ndimensionless primitive translations (in <a href=\"varbas.html#rprim\">rprim</a>) are\nto be multiplied.  By default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since <b>acell</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\nSee further description of <b>acell</b> related to the\n<a href=\"varbas.html#rprim\">rprim</a> input variable,\nthe <a href=\"varbas.html#scalecart\">scalecart</a> input variable,\nand the associated internal <a href=\"varbas.html#rprimd\">rprimd</a> input variable.\n<p>\nNote that <b>acell</b> is NOT the length of the conventional orthogonal basis vectors, but the scaling factors of the primitive vectors.\nUse <a href=\"varbas.html#scalecart\">scalecart</a> to scale the cartesian coordinates. ",
    "vartype": "real array acell(3), represented internally as acell(3,<a href=\"varrlx.html#nimage\">nimage</a>)"
  },
  "algalch": {
    "category": " ",
    "default": "1 for all indices",
    "definition": "ALGorithm for generating ALCHemical pseudopotentials",
    "section": "vargs",
    "text": "<p> Used for the generation of alchemical pseudopotentials, that is,\nwhen <a href=\"vargs.html#ntypalch\">ntypalch</a> is non-zero.\n<p>Give the algorithm to be used to\ngenerate the <a href=\"vargs.html#ntypalch\">ntypalch</a> alchemical potentials\nfrom the different <a href=\"vargs.html#npspalch\">npspalch</a> pseudopotentials\ndedicated to this use.\n<p> Presently, <b>algalch</b> can only have the value 1, that is :\n<ul>\n<li>the local potentials are mixed, thanks to the <a href=\"vargs.html#mixalch\">mixalch</a>\nmixing coefficients</li>\n<li>the form factors of the non-local projectors are all preserved, and all considered\nto generate the alchemical potential</li>\n<li>the scalar coefficients of the non-local projectors are multiplied by the proportion\nof the corresponding type of atom that is present in <a href=\"vargs.html#mixalch\">mixalch</a></li>\n<li>the characteristic radius for the core charge is a\nlinear combination of the characteristic radii of the core charges,\nbuild with the <a href=\"vargs.html#mixalch\">mixalch</a> mixing\ncoefficients</li>\n<li>the core charge function f(r/rc) is a linear combination\nof the core charge functions, build with the <a href=\"vargs.html#mixalch\">mixalch</a>\nmixing coefficients</li>\n</ul>\nLater, other algorithms for the mixing might be included.\n<p>Note that alchemical mixing cannot be used with PAW.\n",
    "vartype": "integer array algalch(<a href=\"vargs.html#ntypalch\">ntypalch</a>)  "
  },
  "amu": {
    "category": "EVOLVING ",
    "default": "provided by a database of atomic masses.",
    "definition": "Atomic Mass Units ",
    "section": "varrlx",
    "text": "<p>\nGives the masses in atomic mass units for each kind\nof atom in cell. These masses are used in performing\nmolecular dynamical atomic motion if\n<a href=\"varrlx.html#ionmov\">ionmov</a>=1, 6, 7 or 8.\nNote that one may set all masses to 1 for certain cases\nin which merely structural relaxation is desired and not\nactual molecular dynamics.\n<p>sing 1986 recommended values, 1 atomic mass unit =\n1.6605402e-27 kg.\nIn this unit the mass of Carbon 12 is exactly 12.\n<p>A database of atomic masses is provided, giving\ndefault values.\nNote that the default database uses mixed isotope masses (for Carbon\nthe natural occurence of Carbon 13 is taken into account).\nThe values are those recommended by the commission on Atomic Weights\nand\nIsotopic Abundances, Inorganic Chemistry Division, IUPAC, in\n<i>Pure Appl. Chem.</i> <b>60</b>, 841 (1988).\nFor Tc, Pm, Po to Ac, Pa and beyond U,\nnone of the isotopes has a half-life greater than 3.0d10 years, and\nthe values provided in the database do not come from that source.\n<p>\nFor alchemical pseudoatoms, the masses of the constituents\natoms are mixed, according to the alchemical miwing\ncoefficients <a href=\"vargs.html#mixalch\">mixalch</a>\n<p> In most cases, the use of <b>amu</b>\nwill be as a static (non-evolving) variable. However, the possibility to have\ndifferent values of <b>amu</b> for different images has been coded. A population of\ncells with different atomic characteristics can thus be considered,\nand can be made to evolve, e.g. with a genetic algorithm (not coded in v7.0.0 though).\n",
    "vartype": "real array amu(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "angdeg": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default (use <a href=\"varbas.html#rprim\">rprim</a> as Default).",
    "definition": "ANGles in DEGrees  ",
    "section": "varbas",
    "text": "<p>\nGives the angles between directions of\nprimitive vectors of the unit cell (in degrees),\nas an alternative to the input array <a href=\"varbas.html#rprim\">rprim</a> .\nWill be used to set up <a href=\"varbas.html#rprim\">rprim</a>,\nthat, together with the array <a href=\"varbas.html#acell\">acell</a>, will be used to define the\nprimitive vectors.\n<ul>\n<li><b>angdeg</b>(1) is the angle between the 2nd and 3rd vectors,</li>\n<li><b>angdeg</b>(2) is the angle between the 1st and 3rd vectors,</li>\n<li><b>angdeg</b>(3) is the angle between the 1st and 2nd vectors,</li>\n</ul>\nIf the three angles are equal within 1.0d-12 (except if they are exactly 90 degrees),\nthe three primitive\nvectors are chosen so that the trigonal symmetry that exchange\nthem is along the z cartesian axis :\n<pre>\nR1=( a  ,           0,c)\nR2=(-a/2, sqrt(3)/2*a,c)\nR3=(-a/2,-sqrt(3)/2*a,c)\n</pre>\nwhere a<sup>2</sup>+c<sup>2</sup>=1.0d0\n<br>\nIf the angles are not all equal (or if they are all 90 degrees), one will have the following\ngeneric form :\n<ul>\n<li>R1=(1,0,0)</li>\n<li>R2=(a,b,0)</li>\n<li>R3=(c,d,e)</li>\n</ul>\nwhere each of the vectors is normalized,\nand form the desired angles with the others.",
    "vartype": "real array angdeg(3) "
  },
  "atvshift": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "a set of 0.0d0.",
    "definition": "ATomic potential (V) energy SHIFTs ",
    "section": "varff",
    "text": "<p>\nDefines for each atom and each spin channel (at present, can only be used\nwith <a href=\"varbas.html#nsppol\">nsppol</a>=1 or 2, like the +U scheme),\na possible potential shift, for the d\n(with <a href=\"varpaw.html#lpawu\">lpawu</a>=2,\n<a href=\"varff.html#natvshift\">natvshift</a>=5),\nor f states\n(with <a href=\"varpaw.html#lpawu\">lpawu</a>=3,\n<a href=\"varff.html#natvshift\">natvshift</a>=7).\nIn the case of d states, and 2 spin channels, a set of 10 numbers for\neach atom must be defined.\nThe first set of 5 numbers corresponds to real spherical harmonics\nm=-2 to m=+2 for the spin-up channel,\nthe second set of 5 numbers corresponds to real spherical harmonics\nm=-2 to m=+2 for the spin-down channel.\nIn the case of f states, the same ordering applies, for sets of 7 numbers,\ncorresponding to m=-3 to m=+3.\n<br>\n<a href=\"varpaw.html#usepawu\">usepawu</a> should be non-zero,\n<a href=\"varpaw.html#lpawu\">lpawu</a> should be 2 or 3.\n",
    "vartype": "real array atvshift (<a href=\"varff.html#natvshift\">natvshift</a>, <a href=\"varbas.html#nsppol\">nsppol</a>, <a href=\"varbas.html#natom\">natom</a>) "
  },
  "autoparal": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, PARALLEL ",
    "default": "0.",
    "definition": "AUTOmatisation of the PARALlelism",
    "section": "varpar",
    "text": "<p>\nThis input variable is used only when running ABINIT in parallel and for Ground-State calculations.<br>\nIt controls the automatic determination of parameters related to parallel work distribution (if not imposed in input file).\nGiven a total number of processors, ABINIT can find a suitable distribution that fill (when possible)\nall the differents levels of parallelization. ABINIT can also determine optimal parameters for\nthe use of parallel Linear Algebra routines (using Scalapack or Cuda, at present, v7.2).<br>\nThe different values for <b>autoparal</b> are:\n<ul>\n<li>\n<b>0:</b> The number of processors per parallelization level is determined by mean of\na simple (but relatively efficient) heuristic. A scaling factor is attributed to each level\nand an simple speedup factor is computed. The selected parameters are those giving the best speedup factor.<br>\nPossibly concerned parameters: <a href=\"varpar.html#npimage\">npimage</a>, <a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npspinor\">npspinor</a>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#bandpp\">bandpp</a>.\n</li>\n<li>\n<b>1:</b> The number of processors per parallelization level is first determined by mean of\na simple (but relatively efficient) heuristic (see 0 above). Then the code perfoms a series\nof small benchmarks using the scheme applied for the LOBPCG algorithm\n(see: <a href=\"vardev.html#wfoptalg\">wfoptalg</a>=4 or 14). The parallel distribution is then\nchanged according to the benchmarks.<br>\nPossibly concerned parameters: <a href=\"varpar.html#npimage\">npimage</a>, <a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npspinor\">npspinor</a>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#bandpp\">bandpp</a>.\n</li>\n<li>\n<b>2:</b>\nSame as <b>autoparal</b>=0, plus automatic determination of Linear Algebra routines parameters.<br>\nIn addition, the code perfoms a series of small benchmarks using the Linear Algebra routines\n(ScaLapack or Cuda-GPU). The parameters used to optimize Linear Algebra work distribution\nare then changed according to the benchmarks.<br>\nPossibly concerned parameters (in addition to those modified for <b>autoparal</b>=0):\n<a href=\"varpar.html#use_slk\">use_slk</a>, <a href=\"varpar.html#np_slk\">np_slk</a>,\n<a href=\"varpar.html#gpu_linalg_limit\">gpu_linalg_limit</a>\n</li>\n<li>\n<b>3:</b> combination of <b>autoparal</b>=1 and <b>autoparal</b>=2.\n</li>\n</ul>\nNote that <b>autoparal</b>=0 can be used on every set of processors; <b>autoparal</b>>0 should be used on a sufficiently large number of MPI process.<br>\nAlso note that <b>autoparal</b> can be used simultaneously with\n<a href=\"varpar.html#paral_kgb\">paral_kgb</a><0; in this case, ABINIT performs\nan optimization of process distribution for each total number of processors from 2\nto -<a href=\"varpar.html#paral_kgb\">paral_kgb</a>. A weight is associated to\neach distribution and the higher this weight is the better the distribution is. After having\nprinted out the weights, the code stops.\n",
    "vartype": "integer "
  },
  "awtr": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "1 (was 0 prior to 5.8)",
    "definition": "evaluate the Adler-Wiser expression of $\\chi^{(0)}_{KS}$ assuming Time-Reversal ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\nThis input variable defines whether the irreducible polarizability $\\chi^{(0)}_{KS}$ is evaluated\ntaking advantage of time-reversal symmetry or not.\n\n<ul>\n<li>  0 =&gt; Use the \"standard\" Adler-Wiser expression without assuming time-reversal symmetry.\nIn this case, the irreducible polarizability is calculated summing over all possible electronic\ntransitions (both resonant and antiresonant).\n<li>  1 =&gt; Take advantage of time-reversal symmetry to halve the number of transitions to be\nexplicitly considered. This method leads to a decrease in the CPU time by a factor two with respect\nto the <b>awtr</b>=0 case.\n</ul>\n\n<p>\nNote that the parallel algorithm <a href=\"varpar.html#gwpara\">gwpara</a>=2 is not compatible with\nthe choiche <b>awtr</b>=0.\n\n",
    "vartype": "integer parameter  "
  },
  "bandpp": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1.",
    "definition": "BAND Per Processor ",
    "section": "varpar",
    "text": "<p>\nControl the size of the block in the LOBPCG algorithm.\nThis keyword works only with <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1 and has to be either 1 or a multiple of 2.\n<br><br>-- With <a href=\"varpar.html#npband\">npband</a>=1:\n<ul>\n<li>1 =&gt; band-per-band algorithm</li>\n<li>n =&gt; The minimization is performed using <a href=\"varbas.html#nband\">nband</a>/n blocks of n bands.</li>\n</ul>\nNote: <a href=\"varbas.html#nband\">nband</a>/n has to be an integer.\n<br><br>-- With <a href=\"varpar.html#npband\">npband</a>/=1:\n<ul>\n<li>1 =&gt; The minimization is performed using <a href=\"varbas.html#nband\">nband</a>/<a href=\"varpar.html#npband\">npband</a> blocks of <a href=\"varpar.html#npband\">npband</a> bands.</li>\n<li>n =&gt; The minimization is performed using <a href=\"varbas.html#nband\">nband</a>/(<a href=\"varpar.html#npband\">npband</a>*n) blocks of <a href=\"varpar.html#npband\">npband</a>*n bands.</li>\n</ul>\nNote: <a href=\"varbas.html#nband\">nband</a>/(<a href=\"varpar.html#npband\">npband</a>*n) has to be an integer.\n<br><br>By minimizing a larger number of bands together in LOBPCG, we increase the convergency of the residual.\nThe better minimization procedure (as concerns the convergency, but not as concerns the speed) is generally\nperformed by using <b>bandpp</b>*<a href=\"varpar.html#npband\">npband</a>=<a href=\"varbas.html#nband\">nband</a>.\nPut <b>bandpp</b>=2 when <a href=\"vardev.html#istwfk\">istwfk</a>=2 (the time spent in FFTs is divided by two).\n",
    "vartype": "integer parameter "
  },
  "bdberry": {
    "category": " ",
    "default": "4*0.",
    "definition": "BanD limits for BERRY phase ",
    "section": "varff",
    "text": "<p> Used for non-zero values of <a href=\"varff.html#berryopt\">berryopt</a>.\n<p>Give the lower band and the upper band of the set of bands\nfor which the Berry phase must be computed.\nIrrelevant if <a href=\"varff.html#nberry\">nberry</a> is not positive.\nWhen <a href=\"varbas.html#nsppol\">nsppol</a> is 1 (no spin-polarisation),\nonly the two first numbers, giving the lower and highest\nbands, are significant. Their occupation number is assumed to be 2.\nWhen <a href=\"varbas.html#nsppol\">nsppol</a> is 2 (spin-polarized calculation),\nthe two first numbers give the lowest and highest\nbands for spin up, and the third and fourth numbers\ngive the lowest and highest bands for spin down.\nTheir occupation number is assumed to be 1 .\n<p> Presently, <b>bdberry</b> MUST be initialized by the user\nin case of Berry phase calculation: the above-mentioned\ndefault will cause an early exit.\n",
    "vartype": "integer array bdberry(4)  "
  },
  "bdeigrf": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "-1.",
    "definition": "BanD for second-order EIGenvalues from Response-Function ",
    "section": "varrf",
    "text": "<p>\nOnly relevant if <a href=\"varrf.html#ieig2rf\">ieig2rf</a> = 1 or 2, that is, if the user is performing second-order eigenvalue calculations using response-functions.\n<br><br>\nThe variable <b>bdeigrf</b> is the maximum number of bands for which the second-order eigenvalues must be calculated: the full number of bands is still used during the computation of these corrections.\n<br><br>\nIf <b>bdeigrf</b> is set to -1, the code will automatically set <b>bdeigrf</b> equal to nband.\n",
    "vartype": "integer parameters "
  },
  "bdgw": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "all 0's ",
    "definition": "BanDs for GW calculation ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nFor each k-point with number ikptgw in the range (1:<a href=\"vargw.html#nkptgw\">nkptgw</a>) and each\nspin index isppol, <b>bdgw(1,ikptgw,isppol)</b> is the number of the lowest band for which the GW computation must be done,\nand <b>bdgw(2,ikptgw,isppol)</b> is the number of the highest band for which the GW computation must be done.\n<p>\nWhen <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a> &#62&#61 20,\nthe quasiparticle wavefunctions are computed and represented as linear combination of some Kohn-Sham wavefunctions.\nIn this case <b>bdgw</b> designates the KS wavefunctions used as basis set.\nFor each k-point, indeed, the quasiparticle wavefunctions are expanded considering only the KS states between\n<b>bdgw(1,ikptgw,isppol)</b> and <b>bdgw(2,ikptgw,isppol)</b>.\n<p>\nNote that the initial values given in the input file might be changed inside the code so that all\nthe degenerate states at a given k-point and spin are included.\nThis might happen when <a href=\"vargw.html#symsigma\">symsigma</a>=1 is used or in the case of\nself-consistent GW calculations.\n<p>\nWhen <a href=\"vargw.html#symsigma\">symsigma</a>=1, indeed, the diagonal matrix elements of the\nself-energy are obtained by averaging the unsymmetrized results in the degenerate subspace.\n<p>\nFor self-consistent calculations, on the other hand, the basis set used to expand the GW\nwavefunctions should include all the degenerate states belonging to the same irreducible\nrepresentation. Only in this case, indeed, the initial symmetries and energy degenerations are preserved.\n",
    "vartype": "integer array bdgw(2,<a href=\"vargw.html#nkptgw\">nkptgw</a>, <a href=\"varbas.html#nsppol\">nsppol</a>,) "
  },
  "berryopt": {
    "category": " ",
    "default": "0",
    "definition": "BERRY phase OPTions ",
    "section": "varff",
    "text": "<p>\nSpecifies the use of Berry phase for the computation\nof either the polarization, the derivatives with respect to the\nwavevector, or finite electric field calculations.\n<ul>\n<li>0 => no computation of expressions relying on a Berry phase (default)</li>\n<li>1 => the computation of Berry phases is activated (berryphase routine)</li>\n<li>2 => the computation of derivatives with respect to the wavevector,\nthanks to the Berry phase finite-difference formula, is activated (uderiv routine)</li>\n<li>3 => same as option 1 and 2 together </li>\n<li>4 => finite electric field calculation (unreduced E-field)</li>\n<li>6 => finite electric displacement field calculation (unreduced D-field)</li>\n<li>14 => finite reduced electric field calculation </li>\n<li>16 => finite electric displacement field calculation</li>\n<li>17 => mixed electric boundary condition: finite reduced electric field in some directions, finite reduced electric displacement field along other directions. See variable jfielddir for more details.</li>\n<li>-1 => alternative computation of Berry phases (berryphase_new routine)</li>\n<li>-2 => alternative computation of derivatives with respect to the wavevector,\nthanks to the Berry phase finite-difference formula (berryphase_new routine)</li>\n<li>-3 => same as option -1 and -2 together </li>\n</ul>\n<p>\nThe other related input variables are :\n<ul>\n<li>in case of <b>berryopt</b>=1,2, or 3 : <a href=\"varff.html#bdberry\">bdberry</a>\nand <a href=\"varff.html#kberry\">kberry</a>; also, <a href=\"varff.html#nberry\">nberry</a>\nmust be larger than 0;</li>\n<li>in case of <b>berryopt</b>=-1,-2, or -3 : the variable\n<a href=\"varrf.html#rfdir\">rfdir</a> must be used to specify the primitive\nvector along which the projection of the polarization or the ddk will be computed.\nFor example if <b>berryopt</b>=1 and <a href=\"varrf.html#rfdir\">rfdir</a>=1 0 0,\nthe projection of the polarization along the reciprocal lattice vector\nG_1 is computed. In case <a href=\"varrf.html#rfdir\">rfdir</a>=1 1 1,\nABINIT computes the projection of P along G_1, G_2 and G_3 and transforms the results\nto cartesian coordinates;</li>\n<li>in case of <b>berryopt</b> is negative, <a href=\"varff.html#berrystep\">berrystep</a>\nallow a computation of multiple-step Berry phase in order to accelerate the convergence.<li>\n<li><a href=\"varff.html#efield\">efield</a>,\n<a href=\"varrf.html#rfdir\">rfdir</a> in case of <b>berryopt</b>=4 ;</li>\n</ul>\n<p>\nThe cases <b>berryopt</b>=-1,-2,-3, 4, 6, 7, 14, 16, and 17 have to be used with\n<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1, and\n<a href=\"varbas.html#occopt\">occopt</a>=1.\n<p>\nThe cases <b>berryopt</b>=-1 and 4, 6, 7, 14, 16, 17 are compatible with PAW, howevever, if in these cases one uses\n<a href=\"varbas.html#kptopt\">kptopt</a>/=3, one must also use only symmorphic symmetries (either because the space group is\nsymmorphic or the variable <a href=\"vargw.html#symmorphi\">symmorphi</a> is set to zero).\n<p>\nFor a phonon calculation under a finite electric field, respect the following procedure.\n<ul>\n<li>1. Run a scf ground-state calculation at zero electric field\nto get wavefunctions to initialize the ground-state calculation in finite electric fields.</li>\n<li>2. Run a scf ground-state calculation in finite electric field. The\nelectric field is controlled by the input variable <a href=\"varff.html#efield\">efield</a>.\n<b>berryopt</b> should be 4.\nThe input variable <a href=\"varbas.html#kptopt\">kptopt</a> should be set to be 2.</li>\n<li>3. Based on the wave functions obtained in step (2), perform phonon\ncalculation by setting <b>berryopt</b>=4, <a href=\"varbas.html#kptopt\">kptopt</a>=3 and\nThe same value of <a href=\"varff.html#efield\">efield</a> than in step 2.\n<a href=\"varbas.html#nsym\">nsym</a> should be set to 1 currently but this restriction may be\nremoved later . The other\nparameters are the same as phonon calculation at zero electric field.</li>\n<li>Note : the choice of k-point sampling N x N x N should be the same in the three runs\nand N should be an even number.\n</ul>\n<p>\nIn case of finite electric (displacement) field calculations (<b>berryopt</b>=4,6,7,14,16,17), see also the input variables\n<a href=\"varff.html#berrysav\">berrysav</a>, <a href=\"varff.html#dfield\">dfield</a>,\n<a href=\"varff.html#red_dfield\">red_dfield</a>, <a href=\"varff.html#red_efield\">red_efield</a>,\n<a href=\"varff.html#ddamp\">ddamp</a>\n\n",
    "vartype": "integer berryopt "
  },
  "berrysav": {
    "category": " ",
    "default": "0",
    "definition": "BERRY SAVe ",
    "section": "varff",
    "text": "<p>\n<ul>\n<li>0 => for finite electric field calculation (<a href=\"varff.html#berryopt\">berryopt</a>=4/14), the polarization branch will be chosen on each iteration from (-pi, pi);\nfor finite electric displacement field calculation(<a href=\"varff.html#berryopt\">berryopt</a>=6/7/16/17), the polarization will be chosen to minimize the internal energy.\n</li>\n<li>1 => the polarization will be kept in the same branch on each iteration. At the end of the run, a file \"POLSAVE\" will be saved containing the reduced polarization in atomic units. Note: Make sure that \"POLSAVE\" is empty or it does not exist before the calculation, or else that it specifies the desired polarization branch.\n</li>\n</ul>\n\n",
    "vartype": "integer berrysav "
  },
  "berrystep": {
    "category": " ",
    "default": "1",
    "definition": "BERRY phase : multiple STEP ",
    "section": "varff",
    "text": "<p>\nIf <a href=\"varff.html#berryopt\">berryopt</a> is negative,\nthis variable is used to compute multiple-steps berry phase. The single-step berry phase\nis the standard calculation using strings of k-points based on overlap of Bloch function separated by dk, while the two-step\nberry phase use strings use overlaps based on dk and 2*dk, the three-step use overlaps based on dk, 2*dk and 3*dk...\n<p>\nThe default value of this variable is 1, meaning that only the single-step berry phase calculation is done.\nIf a larger value is set, ABINIT will compute all the multiple-step berry phase from the single-step to the\n<b>berrystep</b>-step, and use the large-step values of berry phase to correct the single-step berry phase.\nAs of now (2011), experience is still to be gained with this procedure, but it is promising.\n",
    "vartype": "integer berrystep "
  },
  "bfield": {
    "category": "",
    "default": "3*0.0 .",
    "definition": "finite B FIELD calculation ",
    "section": "varff",
    "text": "<p>\nPerform finite magnetic field calculation. THIS CODE IS UNDER DEVELOPMENT AND IS NOT READY FOR USE.\n",
    "vartype": "real array efield(3)  "
  },
  "bmass": {
    "category": "",
    "default": "10.",
    "definition": "Barostat mass",
    "section": "varrlx",
    "text": "<p>\nbmass is the mass of the barostat when <a\nhref=\"varrlx.html#ionmov\">ionmov</a>=13 (constant pressure)\n",
    "vartype": "real parameter "
  },
  "boxcenter": {
    "category": "",
    "default": "0.5 0.5 0.5 .",
    "definition": "BOX CENTER ",
    "section": "vargs",
    "text": "<p>\nDefines the center of the box, in reduced coordinates.\nAt present, this information is only used in the case of\nTime-Dependent DFT computation of the oscillator strength.\nOne must take boxcenter such as to be roughly the center of\nthe execution or molecule. The default is sensible when\nthe vacuum surrounding the execution or molecule has xred 0 or 1.\nOn the contrary, when the execution or molecule is close to\nthe origin, it is better to take <b>boxcenter</b>=(0 0 0).\n",
    "vartype": "real array <b>boxcenter</b>(3) "
  },
  "boxcutmin": {
    "category": "",
    "default": "2.0 .",
    "definition": "BOX CUT-off MINimum ",
    "section": "vargs",
    "text": "<p>\nThe box cut-off ratio is the ratio between the wavefunction plane wave sphere\nradius, and the radius of the sphere that can be inserted in the\nFFT box, in reciprocal space. In order for the density to be exact\n(in the case of plane wave, not PAW), this ratio should be at least two.\nIf one uses a smaller ratio, one will gain speed, at the expense of accuracy.\nIn case of pure ground state calculation (e.g. for the determination\nof geometries), this is sensible. However,\nthe wavefunctions that are obtained CANNOT be used for starting response function\ncalculation.\n",
    "vartype": "real "
  },
  "brvltt": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a> ",
    "default": "0.",
    "definition": "BRaVais LaTTice type ",
    "section": "vargeo",
    "text": "<p>\nSet the type of Bravais lattice,\nneeded only if <a href=\"vargeo.html#spgroup\">spgroup</a>/=0 .\nIn this case, the cell defined by <a href=\"varbas.html#acell\">acell</a>\nand <a href=\"varbas.html#rprim\">rprim</a> or <a href=\"varbas.html#angdeg\">angdeg</a>\nshould be the CONVENTIONAL cell.\n<p>If brvltt=0, the code will assign\nbrvltt from the space group information\n<a href=\"vargeo.html#spgroup\">spgroup</a>,\nand produce the symmetry operations for the conventional unit cell.\nIf the conventional cell is not primitive, the user should\nset <a href=\"vargs.html#chkprim\">chkprim</a>=0.\n<p>\nIf brvltt=-1, the code will assign brvltt from\nthe space group information, then reduce the unit cell\nto a primitive unit cell. The echo of <a href=\"varbas.html#acell\">acell</a>\nand <a href=\"varbas.html#rprim\">rprim</a> might thus differ from those\nderived directly from the input variables.\nAlso, the input variable\n<a href=\"varbas.html#xred\">xred</a> will refer to the\nCONVENTIONAL unit cell, but its echo will refer to the\npreprocessed PRIMITIVE unit cell.\nThere is of course no problem with\n<a href=\"varbas.html#xangst\">xangst</a> and\n<a href=\"varbas.html#xcart\">xcart</a>, as they are independent\nof the unit cell.\n<p>The echo of <b>brvltt</b> in the output file will be one\nof the following Bravais lattices:\n<br>\n<ul>\n<li>1 = Primitive with no associated translations</li>\n<li>2 = Inner centered with (a/2 + b/2 + c/2)\nassociated translation </li>\n<li>3 = Face centered with (a/2 + b/2; b/2 + c/2; c/2 + a/2)\nassociated translations</li>\n<li>4 = C - centered with (a/2 + b/2) associated translation</li>\n<li>5 = A - centered with (b/2 + c/2) associated translation</li>\n<li>6 = B - centered with (c/2 + a/2) associated translation</li>\n<li>7 = Rhombohedral lattice.</li>\n</ul>\nThe user might also input directly these values, although\nthey might not be consistent\nwith <a href=\"vargeo.html#spgroup\">spgroup</a>.\n<p>\nThe space groups 146, 148, 155, 160, 161, 166, 167, when used\nwith <a href=\"vargeo.html#spgaxor\">spgaxor</a>=1 (hexagonal axes) will have <b>brvltt</b>=7\nand two associated translations: (2/3, 1/3, 1/3) and\n(1/3, 2/3, 2/3).\n<br>For more details see the space group\n<a href=\"../users/spacegrouphelpfile.html\">help file</a>.\n",
    "vartype": "integer parameter "
  },
  "bs_algorithm": {
    "category": "BS  ",
    "default": "1 ",
    "definition": "Bethe-Salpeter ALGORITHM ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\nThe bs_algorithm input variable defines the algorithm employed to calculate the macroscopic dielectric function.\nPossible values are 1, 2 or 3:\n\n<ul>\n<li> 1 =&gt;\nThe macroscopic dielectric is obtained by performing a direct diagonalization of the exciton Hamiltonian.\nAdvantages: It gives direct access to the excitonic eigenvalues as well as to the oscillator strengths.\nDrawbacks: It is a very CPU- and memory-consuming approach as the size of the Hamiltonian scales as (nk*nc*nv)**2.\nwhere nk is the number of k-point in the FULL Brillouin zone, and nc and nv are the number of\nconduction and valence states, respectively.\nPros: It can be used both for resonant-only and resonant+coupling calculations.\n<li> 2 =&gt;\nHaydock iterative method. The macroscopic dielectric function\nis obtained by iterative applications of the Hamiltonian on a set of vectors in the electron-hole space.\nAdvantages: It is less memory demanding and usually faster\nthan the direct diagonalization provided that <a href=\"vargw.html#zcut\">zcut</a> is larger than the typical\nenergy spacing of the eigenvalues. Drawbacks: It's an iterative method therefore\nthe convergence with respect to bs_haydock_niter should be checked.\nIt is not possible to have direct information on the exciton spectrum, oscillator strengths and excitonic wave functions.\nFor the time being <b>bs_algorithm</b>=2 cannot be used for calculations in which the coupling term is included.\n<li> 3 =&gt;\nConjugate-gradient method\n[STILL UNDER DEVELOPMENT]\nOnly available for resonant calculations.\n</ul>\n",
    "vartype": "integer "
  },
  "bs_calctype": {
    "category": "BS  ",
    "default": "1 ",
    "definition": "Bethe-Salpeter CALCulation TYPE ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\nPossible values are 1,2,3\n<ul>\n<li> 1 =&gt; use the KS eigenvalues and wave functions stored in the KSS file\nto construct the transition space\n\n<li> 2 =&gt; The transition space is constructed with Kohn-Sham orbitals\nbut the energies are read from the external GW file\n\n<li> 3 =&gt; QP amplitudes and energies will be read from the QPS file and used to construct H_ex.\nNot coded yet\nBesides <\\psi|r|\\psj>^QP should be calculated taking into account the non-locality of the\nthe self-energy in the commutator [H,r].\n</ul>\n",
    "vartype": "integer "
  },
  "bs_coulomb_term": {
    "category": "BS  ",
    "default": "11 ",
    "definition": "Bethe-Salpeter COULOMB TERM ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\nThis variable governs the choice among the different options that are available for the treatment\nof Coulomb term of the BS Hamiltonian.\n<b>bs_coulomb_term</b> is the concatenation of two digits, labelled (A) and (B).\n<p>\nThe first digit (A) can assume the values 0,1,2:\n\n<ul>\n<li> 0 =&gt; The Coulomb term is not computed. This choice is equivalent to computing the RPA\nspectrum but using the representation in transition space instead of the\nmore efficient approach based on the sum over states.\n<li> 1 =&gt; The Coulomb term is computed using the screened interaction read from an external SCR file\n(standard excitonic calculation).\n<li> 2 =&gt; The Coulomb term is computed using a model screening function\n(useful for convergence studies or for reproducing published results).\n</ul>\n<p>\nThe second digit (B) can assume the values: 0,1\n<ul>\n<li> 0 =&gt;\nUse a diagonal approximation for W_GG' (mainly used for accelerating convergence studies).\n<li> 1 =&gt;\nThe Coulomb term is correctly evaluated using the truly non-local W(r,r').\n</ul>\n\n",
    "vartype": "integer "
  },
  "bs_coupling": {
    "category": "BS ",
    "default": "1 ",
    "definition": "Bethe-Salpeter COUPLING ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\n\nThe <b>bs_coupling</b> input variable defines the treatment of the coupling block of the\nBS Hamiltonian. Possible values are 0,1.\n\n<ul>\n<li> 0 =&gt;\nThe coupling block is neglected. The code runs faster and the Hamiltonian matrix requires\nless memory (factor 4). It is a good approximation for the absorption spectrum\nwhich only requires the knowledge of Im(\\epsilon). The reliability of this\napproximation should be tested in the case of EELF calculations.\n<li> 1 =&gt;\nThe coupling term is included.\n</ul>\n",
    "vartype": "integer "
  },
  "bs_eh_cutoff": {
    "category": "BS  ",
    "default": "(-inf,+inf,+inf) ",
    "definition": "Bethe-Salpeter Electron-Hole CUTOFF ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\nIt is used to define a cutoff in the e-h basis set. Only those transitions whose\nenergy is between bs_eh_window(1) and bs_eh_window(2) will be considered during\nthe construction of the e-h Hamiltonian. bs_eh_window(3) (named stripecut in EXC)\nare used to define an additional cutoff in the exciton Hamiltonian. Let it and itp\nindicate two e-h basis set elements with itp >= it.Only the matrix elements\ncorresponding to the pairs (it,itp) such that Etrans_{itp}-Etrans_{it} are considered.\n",
    "vartype": "integer(3) "
  },
  "bs_exchange_term": {
    "category": "BS  ",
    "default": "1 ",
    "definition": "Bethe-Salpeter EXCHANGE TERM ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\n\n<ul>\n<li> 0 =&gt;\nThe exchange term is not calculated. This is equivalent to neglecting local field effects\nin the macroscopic dielectric function.\n<li> 1 =&gt;\nThe exchange term is calculated and added to the excitonic Hamiltonian.\n</ul>\n",
    "vartype": "integer "
  },
  "bs_freq_mesh": {
    "category": "BS, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>  ",
    "default": "(0.0,0.0,0.01) eV ",
    "definition": "Bethe-Salpeter FREQuency MESH ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\nbs_freq_mesh(1) defines the first frequency for the calculation of the macroscopic dielectric function.\nbs_freq_mesh(2) gives the last frequency for the calculation of the macroscopic dielectric function.\nIf zero, bs_omegae is automatically calculated inside the code such that the frequency mesh covers the entire set of e-h transitions.\nbs_freq_mesh(3) gives the step of the linear mesh used for evaluating the macroscopic dielectric function.\n",
    "vartype": "real(3) "
  },
  "bs_hayd_term": {
    "category": "BS  ",
    "default": "1 ",
    "definition": "Bethe-Salpeter HAYdock TERMinator ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99 and <a href=\"vargw.html#bs_algorithm\">bs_algorithm</a>=2\nthat is, Bethe-Salpeter calculations with the Haydock iterative method.\n<p>\nDefines how to terminate the continued fraction expression for the dielectic function.\nThe terminator reduces the number of iterations needed to converge by smoothing the oscillation\nin the high energy part of the spectrum\n\n<ul>\n<li> 0 =&gt;\nNo terminator. The contribution given by the terms missing in the Lanczos chain are set to zero.\n<li> 1 =&gt; Use the terminator function. The particular expression depends on the type of calculation:\nIn the resonant-only case, the a_i and b_i coefficients for i &gt; niter,\nare replaced by their values at i=niter.\nEhen the coupling block is included, the terminator function described in D. Rocca, R. Gebauer, Y. Saad, S. Baroni, J. Chem. Phys.\n128, 154105 (2008) is used.\n</ul>\n\n",
    "vartype": "integer "
  },
  "bs_haydock_niter": {
    "category": "BS ",
    "default": "100 ",
    "definition": "Bethe-Salpeter HAYDOCK Number of Iterations ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99 and <a href=\"vargw.html#bs_algorithm\">bs_algorithm</a>=2\nthat is, Bethe-Salpeter calculations with the Haydock iterative method.\n<p>\n<b>bs_haydock_niter</b> defines the maximum number of iterations used to calculate the macroscopic dielectric function.\nThe iterative algorithm stops when the difference between two consecutive evaluations of the optical\nspectra is less than <a href=\"vargw.html#bs_haydock_tol\">bs_haydock_tol</a>.\n",
    "vartype": "integer "
  },
  "bs_haydock_tol": {
    "category": "BS  ",
    "default": "(0.02,0) ",
    "definition": "Bethe-Salpeter HAYDOCK TOLerance ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99 and <a href=\"vargw.html#bs_algorithm\">bs_algorithm</a>=2\nthat is, Bethe-Salpeter calculations with the Haydock iterative method.\n<p>\nDefines the convergence criterion for the Haydock iterative method.\nThe iterative algorithm stops when the difference between two consecutive evaluations of the\nmacroscopic dielectric function is less than <b>bs_haydock_tol(1)</b>.\nThe sign of <b>bs_haydock_tol(1)</b> defines how to estimate the convergence error.\nA negative value signals that the converge should be reached for each frequency (strict criterion),\nwhile a positive value indicates that the converge error is estimated\nby averaging over the entire frequency range (mild criterion).\n<p>\nbs_haydock_tol(2) defines the quantity that will be checked for convergence:\n<ul>\n<li>0 &rarr; both the real and the imaginary part must converge\n<li>1 &rarr; only the real part\n<li>2 &rarr; only the imaginary part\n</ul>\n",
    "vartype": "real(2) "
  },
  "bs_loband": {
    "category": "BS  ",
    "default": "0",
    "definition": "Bethe-Salpeter Lowest Occupied BAND",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99, that is, Bethe-Salpeter calculations.\n<p>\nThis variable defines the index of the lowest occupied band used for the construction of the electron-hole basis set\nAn additional cutoff energy can be applied by means of the bs_eh_window input variable.\n",
    "vartype": "integer"
  },
  "bs_nstates": {
    "category": "BS ",
    "default": "0 ",
    "definition": "Bethe-Salpeter Number of States ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=99 and <a\nhref=\"vargw.html#bs_algorithm\">bs_algorithm</a>=2,3\nthat is, Bethe-Salpeter calculations with the Haydock iterative approach or the Conjugate gradient method\n<p>\n<b>bs_nstates</b> defines the maximum number of excitonic states calculated in\nthe direct diagonalization of the excitonic matrix or in the conjugate-gradient method.\nThe number of states should be sufficiently large\nfor a correct description of the optical properties in the frequency range of interest.\n",
    "vartype": "integer "
  },
  "builtintest": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0",
    "definition": "BUIT-IN TEST number ",
    "section": "vardev",
    "text": "<p>\nWhen <b>builtintest</b> is non-zero, the input file is a special one, that runs very quickly,\nand that is accompanied by\na specific analysis by ABINIT, at the end of the run, against a hard-coded value of total energy\n(and possibly stresses, forces ...). The echo of the analysis is done in the STATUS file.\nIn particular, such built-in tests can be used to check quickly\nwhether ABINIT fallbacks have been connected or not (bigdft, etsf_io, libxc, wannier90).\nAt present, <b>builtintest</b>=1 ... 7 are allowed. See more information in tests/built-in/README .\n",
    "vartype": "integer "
  },
  "bxctmindg": {
    "category": "",
    "default": "2.0",
    "definition": "BoX CuT-off MINimum for the Double Grid (PAW) ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>The box cut-off ratio is the ratio between the wavefunction plane wave\nsphere radius, and the radius of the sphere that can be inserted in the FFT box,\nin reciprocal space.\n<br>If the density was generated only from wavefunctions,\nthis ratio should at least two in order for the density to be exact. If one\nuses a smaller ratio, one will gain speed, at the expense of accuracy. In case\nof pure ground state calculation (e.g. for the determination of geometries),\nthis is sensible. However, the wavefunctions that are obtained CANNOT be used\nfor starting response function calculation.\n<br>However, some augmentation charge is always added in PAW, and even with the box cut-off\nratio larger than two, the density is never exact. Sometimes, this ratio must be\nmuch larger than two for the computation to be converged at the\nrequired level of accuracy.\n",
    "vartype": "real parameter "
  },
  "cd_customnimfrqs": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "Contour Deformation Custom Imaginary Frequencies",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_customnimfrqs</b> lets the user define the gridpoints along the imaginary axis by hand. Set this\nto the number of frequencies you want. The frequencies are specified with <a href=\"vargw.html#cd_imfrqs\">cd_imfrqs</a>.\n",
    "vartype": "integer "
  },
  "cd_frqim_method": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "1",
    "definition": "Contour Deformation Imaginary Frequency integration Method",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma (self-energy)\ncalculations, and <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22 (contour deformation\nfull-frequency treatment).\n<p>\n<b>cd_frqim_method</b> defines the choice of integration method along the imaginary frequency axis\nfor Contour Deformation calculations. The default method is very robust, fast and optimal for the\nvast majority of cases. However, for very accurate (&ldquo;paranoid level&rdquo;) convergence studies,\nABINIT offers the possibility of a variety of methods and grids. Note that as one starts to change\nthe defaults, one needs to carefully consider the grid used. Therefore we recommend that in\naddition to reading the infomation below, the user reads the description of the\ninput variables <a href=\"vargw.html#freqim_alpha\">freqim_alpha</a>,\n<a href=\"vargw.html#nfreqim\">nfreqim</a>, <a href=\"vargw.html#ppmfrq\">ppmfrq</a>,\n<a href=\"vargw.html#gw_frqim_inzgrid\">gw_frqim_inzgrid</a>.\n<p>\nThe integration to be performed for each matrix element of the self energy along the imaginary axis is of the form:\n</p>\n<p align=\"center\">\n<img style=\"width: 461px; height: 49px;\" src=\"./vargw_img/self_energy_cd.png\">\n</p>\n<p>\nWhere <span style=\"font-family:Times,Serif\"><i>&omega;</i></span> is the frequency point along the real axis,\n<span style=\"font-family:Times,Serif\"><i>&epsilon;<sub>s</sub></i></span> is an eigenvalue,\nand <span style=\"font-family:Times,Serif\"><i>i&omega;'</i></span> is the variable along the\nimaginary axis. Thus the function to be integrated\nis a Lorentzian weight function centred on the origin (whose FWHM is decided by\n|<span style=\"font-family:Times,Serif\"><i>&omega; - &epsilon;<sub>s</sub></i></span>|),\ntimes a function. The function is related to the inverse dielectric matrix. It might have a peaked structure near the origin and is very smooth otherwise. the function decays\nasymptotically as <span style=\"font-family:Times,Serif\">1 / <i>i&omega;'</i></span>, so the whole\nintegral converges as this to the third power.\n<ul>\n<li><b>cd_frqim_method = 1 - Histogram:</b> This is the <b>default</b> method where the function\n<span style=\"font-family:Times,Serif\"><i>f(i&omega;')</i></span> is approximated by a histogram,\nand the Lorentzian is integrated analytically in each sub-interval. See the section on grids\nbelow for a description of the default grid. This method combined with the default grid is the\nfastest and optimised for the use of few points along the imaginary axis.\n\n<li><b>cd_frqim_method = 2 - Trapezoid:</b> The next step up from the histogram approximation in the previous\nmethod. The integration region is transformed\n<span style=\"font-family:Times,Serif\"><i>[0,&#8734;[ &rarr; [0,1]</i></span> with a proper\nweight depending on the width of the Lorentian. In this space\n<span style=\"font-family:Times,Serif\"><i>f(i&omega;')</i></span>\nis approximated by a linear function between grid points (trapezoids), and the integrand is\nintegrated analytically in each sub-interval. This method tends to slightly overestimate contributions\nwhile the default method tends to slightly underestimate them, so the results from methods\n1 and 2 should bracket the converged values. The asymptotic behaviour is explicitly taken\ninto account by a fit using the last two grid points.\n\n<li><b>cd_frqim_method = 3, 4, 5 - Natural Spline:</b> The function is transfomed <span style=\"font-family:Times,Serif\"><i>[0,&#8734;[ &rarr; [0,1]</i></span>. In this space <span style=\"font-family:Times,Serif\"><i>f(i&omega;')</i></span> is approximated by a natural spline function whose starting and ending sections are linear. This transform is chosen so that the function should approach a linear function asymptotically as the integration interval approaches 1, so that the asymptotic behaviour is automatically taken into account. For each Lorenzian width\n(determined by |<span style=\"font-family:Times,Serif\"><i>&omega; - &epsilon;<sub>s</sub></i></span>|)\nthe integrand is appropriately scaled in the interval\n<span style=\"font-family:Times,Serif\"><i>[0,1]</i></span>, and a nested Gauss-Kronrod (GK)\nnumerical integration rule is performed. The integrand is evaluated at the GK nodes by means\nof a spline-fit. The order of the GK rule is controlled by the index of the method:\n<ul>\n<li><b>3 =&gt; Gauss  7 point, Kronrod 15 point rule </b>\n<li><b>4 =&gt; Gauss 11 point, Kronrod 23 point rule </b>\n<li><b>5 =&gt; Gauss 15 point, Kronrod 31 point rule </b>\n</ul>\nThere is rarely any difference to machine precision between these rules, and the code will\nissue a warning if a higher-order rule is recommended.\n\n</ul>\n\n<p>\n<b>Grids for the integral along the imaginary axis:</b>\n<p>\nAll the methods above should execute no matter what grid is used along the imaginary axis, so this\nis very much under the user's control. The only requirement is that the grid be strictly increasing.\nThe point at zero frequency is assumed to lie on the real axis, so the calculation of that point\nis controlled by <a href=\"vargw.html#nfreqre\">nfreqre</a> and corresponding variables. We highly\nrecommend extracting various elements of the dielectric matrix from the _SCR file using\nthe <B>Mrgscr</B> utility and plotting them for visual inspection.\n<p>\n<ul>\n<li><b>Default</b> - The default grid is an exponentially increasing grid given by the formula:\n<p align=\"center\">\n<img style=\"width: 309px; height: 46px;\" src=\"./vargw_img/cd_default_grid.png\">\n</p>Here <span style=\"font-family:Times,Serif\"><i>&omega;<sub>p</sub></i></span> is the\nplasma frequency (by default determined by the average density of the system, but this\ncan be overridden by setting <a href=\"vargw.html#ppmfrq\">ppmfrq</a>).\n<span style=\"font-family:Times,Serif\"><i>N</i></span> is the total number of gridpoints\n(set by <a href=\"vargw.html#nfreqim\">nfreqim</a>).\n<span style=\"font-family:Times,Serif\"><i>&alpha;</i></span> is a parameter which determines\nhow far out the final grid point will lie. The final point will be at\n<span style=\"font-family:Times,Serif\"><i>&alpha;&middot;&omega;<sub>p<sub></i></span>\n(the default is <span style=\"font-family:Times,Serif\"><i>&alpha; = 5</i></span>,\nand was hard-coded in older versions of ABINIT).\nThis grid is designed so that approximately half the grid points are always distributed\nto values lower than the plasma frequency, in order to resolve any peaked structure. If one\nseeks to increase the outermost reach by increasing <a href=\"vargw.html#ppmfrq\">ppmfrq</a>\none must simultaneously take care to increase <a href=\"vargw.html#nfreqim\">nfreqim</a>\nin order to have the appropriate resolution for the low-frequency region.\nIn more recent versions of ABINIT one can also simply adjust the parameter\n<span style=\"font-family:Times,Serif\"><i>&alpha;</i></span> by using\n<a href=\"vargw.html#freqim_alpha\">freqim_alpha</a>. This grid is optimised for\nspeed and accurate results with few gridpoints for <b>cd_frqim_method = 1</b>.\n<li><b>Inverse z transform</b> - This grid is activated by the use of the variable\n<a href=\"vargw.html#gw_frqim_inzgrid\">gw_frqim_inzgrid</a>. This is the standard\n<span style=\"font-family:Times,Serif\"><i>[0,&#8734;[ &rarr; [0,1]</i></span> transform\nusing the formula:\n<p align=\"center\">\n<img style=\"width: 122px; height: 38px;\" src=\"./vargw_img/cd_inzgrid.png\">\n</p>Here <span style=\"font-family:Times,Serif\"><i>&omega;<sub>p</sub></i></span> is the\nplasma frequency (default can be overridden by setting <a href=\"vargw.html#ppmfrq\">ppmfrq</a>).\nThe gridpoints are then picked by an equidistant grid (number of points set by\n<a href=\"vargw.html#nfreqim\">nfreqim</a>) in the interval\n<span style=\"font-family:Times,Serif\"><i>z &sub; [0,1]</i></span>. This grid can easily\nbe uniquely converged by just increasing <a href=\"vargw.html#nfreqim\">nfreqim</a>. Again\nthe points are distributed so that approximately half of them lie below the plasma frequency.\n<li><b>User defined</b> - The user can also define their own grid using the variables\n<a href=\"vargw.html#nfreqim\">cd_customnimfrqs</a> and\n<a href=\"vargw.html#nfreqim\">cd_imfrqs</a>. <i>With great power comes great responsibility!</i>\n</ul>\n<p>\nThe <B>Mrgscr</B> utility is handy in optimising the numerical effort expended in convergence studies.\nBy estimating the densest grid one can afford to calculate in the SCR file, and succesively removing\nfrequencies from a single file (using the utility), one only needs to perform the screening\ncalculation <b>once</b> on the dense mesh for a given convergence study. One can also use the utility to\nmerge independent screening calculations over q-points and frequency sections.\n",
    "vartype": "integer "
  },
  "cd_full_grid": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "Contour Deformation Full Grid in complex plane",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_full_grid</b> enables the calculation of the screening [both chi0 and epsilon^(-1)] on a grid in the first\nquadrant of the complex plane. The grid is determined by the (tensor) product of the grid in real frequency and\nthe grid in imaginary frequency. In the SUS and SCR files the grid points are stored as follows:\n<pre>\n<b>Index:</b>  1   . . .   nfreqre   nfrqre+1 . . . nfreqre+nfreqim   nfreqre+nfreqim+1 . . . nfreqre*nfreqim\n<b>Entry:</b> | purely real freq.  |     purely imaginary freq.     |      gridpoints in complex plane        |\n</pre>\nThe grid in the complex plane is stored looping over the real dimension as the inner loop and the imaginary as\nthe outer loop. The contents of the generated SUS and SCR files can be extracted for visualisation and further\nanalysis with the <B>Mrgscr</B> utility.\n",
    "vartype": "integer "
  },
  "cd_halfway_freq": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "100.0 eV",
    "definition": "Contour Deformation tangent grid Halfway Frequency ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_halfway_freq</b> determines the frequency where half of the number of points defined in\n<a href=\"vargw.html#nfreqre\">nfreqre</a> are used up. The tangent transformed grid is approximately\nlinear up to this point. To be used in conjunction with <a href=\"vargw.html#gw_frqre_tangrid\">gw_frqre_tangrid</a>.\n",
    "vartype": "real parameter"
  },
  "cd_imfrqs": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "none",
    "definition": "Contour Deformation Imaginary Frequencies ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_imfrqs</b> Specifies the grid points for the imginary axis. Only activated if\n<a href=\"vargw.html#cd_customnimfrqs\">cd_customnimfrqs</a> is not equal to 0. The number of frequencies\nis set by the value of <a href=\"vargw.html#cd_customnimfrqs\">cd_customnimfrqs</a>. Example:\n<pre>\ncd_customnimfrqs   5\nnfreqim            5\ncd_imfrqs          0.1  0.2  0.5  1.0  5.0\n</pre>\nIf <a href=\"vargw.html#nfreqim\">nfreqim</a> is not equal to\n<a href=\"vargw.html#cd_customnimfrqs\">cd_customnimfrqs</a> a warning will be issued.\n</p>\n<p>\n<b>Use at own risk!</b> The use of a custom grid makes it your responsibility that the SUS and\nSCR files are valid in self-energy (i.e. <a href=\"vargs.html#optdriver\">optdriver</a>=4)\ncalculations, so caution is advised. Note that frequencies have to be strictly increasing, and the\npoint at zero frequency is <b>not</b> considered to be part of the imaginary grid, but rather\nthe grid along the real axis. The calculation of that point should be controlled by\n<a href=\"vargw.html#nfreqre\">nfreqre</a> and related variables.\n</p><p>\n",
    "vartype": "real array cd_imfrqs(cd_customnimfrqs)"
  },
  "cd_max_freq": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "1000.0 eV",
    "definition": "Contour Deformation grid Maximum Frequency ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_max_freq</b> determines the frequency where all the points defined in\n<a href=\"vargw.html#nfreqre\">nfreqre</a> are used up. To be used in conjunction with\n<a href=\"vargw.html#gw_frqre_tangrid\">gw_frqre_tangrid</a>.\n",
    "vartype": "real parameter"
  },
  "cd_subset_freq": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "full set",
    "definition": "Contour Deformation grid calculate Subset of Frequencies ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>cd_subset_freq</b> Specifies that only a subset of the frequencies defined by\n<a href=\"vargw.html#nfreqre\">nfreqre</a> are to be calculated. The first index is the start and\nthe second the end, with index number 1 always being the origin. For example a calculation with\n<b><a href=\"vargw.html#nfreqre\">nfreqre</a>=100</b> could be separated into two datasets with:\n<pre>\nsubset_freq1   1   50\nsubset_freq2   51  100\n</pre>\nAny resulting susceptibiltiy (_SUS) and screening (_SCR) files can then be merged with the <b>mrgscr</b> utility.\n</p><p>\n<br>\nNote that this does <b>NOT</b>\nhave to be used in conjunction with <a href=\"vargw.html#gw_frqre_tangrid\">gw_frqre_tangrid</a>.\n",
    "vartype": "integer array cd_subset_freq(2)"
  },
  "charge": {
    "category": " ",
    "default": "0.",
    "definition": "CHARGE ",
    "section": "vargs",
    "text": "<p>\nUsed to establish charge balance between\nthe number of electrons filling the bands and the\nnominal <b>charge</b> associated with the atomic cores.\n<br>The code adds up the number of valence electrons\nprovided by the pseudopotentials of each type\n(call this \"zval\"), then add <b>charge</b>, to get the\nnumber of electrons per unit cell,\n<a href=\"varint.html#nelect\">nelect</a>.\n<br>\nThen, if <a href=\"varbas.html#iscf\">iscf</a> is positive,\nthe code adds up the band occupancies (given in\narray <a href=\"vargs.html#occ\">occ</a>) for all bands at each k point,\nthen multiplies\nby the k point weight <a href=\"varbas.html#wtk\">wtk</a> at each k point.\nCall this sum \"nelect_occ\" (for the number of electrons\nfrom occupation numbers).  It is then\nrequired that:\n<br>nelect_occ = nelect\n<br>\nTo treat a neutral\nsystem, which is desired in nearly all cases, one must\nuse <b>charge</b>=0.  To treat a system missing one electron\nper unit cell, set <b>charge</b>=+1.\n",
    "vartype": "real number  "
  },
  "chkexit": {
    "category": "",
    "default": "0 (before v5.3, it was 2 for sequential version of ABINIT, 1 for parallel version of ABINIT.)",
    "definition": "CHecK whether the user want to EXIT ",
    "section": "vargs",
    "text": "<p>\nIf <b>chkexit</b> is 1 or 2, ABINIT\nwill check whether the user wants to interrupt the run (using the keyword\n\"exit\" on the top of the input file or creating a file\nnamed \"abinit.exit\": see the\n<a href=\"../users/abinit_help.html#chkexit\">end of section 3.2</a> of abinit_help).\n<p>\nIf <b>chkexit</b>=0, the check is not performed at all\n<p>\nIf <b>chkexit</b>=1, the check is not performed frequently (after each SCF step)\n<p>\nIf <b>chkexit</b>=2, the check is performed frequently\n(after a few bands, at each k point)\n<p>In all cases, the check is performed at most every 2 seconds of CPU time.\n",
    "vartype": "integer parameter "
  },
  "chkgwcomp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>",
    "default": "0",
    "definition": "Check GW Completeness",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>chkgwcomp</b> performs a check on the completeness relation that is assumend to be fulfilled by the oscillator strenghts\nin the limit of very large number of bands.\nIf <b>chkgwcomp==1</b>, a _DELI file is generated, containing the incompleteness matrix in reciprocal space for each q-point.\nThis matrix is the difference between the identity and the projection over all bands (the oscillator strengths),\nsummed over all occupied states. It is relevant in case one performs a GW + PAW calculation, especially if one is\nwilling to use the extrapolar approximation (<b><a href=\"vargw.html#gwencomp\">gwencomp</a>=1</b>).\nNote that this closure relation is not fulfilled in PAW, due to the incompleteness of the basis.\n",
    "vartype": "integer  "
  },
  "chkprim": {
    "category": "<a href=\"../users/abinit_help.html#symmetry_finder\">SYMMETRY FINDER</a> ",
    "default": "1.",
    "definition": "CHecK whether the cell is PRIMitive ",
    "section": "vargs",
    "text": "<p>\nIf the symmetry finder is used\n(see <a href=\"varbas.html#nsym\">nsym</a>), a non-zero\nvalue of <b>chkprim</b> will make the code stop if a non-primitive\ncell is used. If <b>chkprim</b>=0, a warning is issued, but the run\ndoes not stop.\n<p>If you are generating the atomic and cell geo using\n<a href=\"vargeo.html#spgroup\">spgroup</a>, you might\ngenerate a PRIMITIVE cell using\n<a href=\"vargeo.html#brvltt\">brvltt</a>=-1 .\n",
    "vartype": "integer parameter "
  },
  "chksymbreak": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "1.",
    "definition": "CHecK SYMmetry BREAKing  ",
    "section": "vargs",
    "text": "<p>\nThis variable governs the behaviour of the code when there are potential\nsource of symmetry breaking, related e.g. to the k point grid or the presence of\nnon-symmorphic translations which might not be coherent with the exchange-correlation grid.\n<p>\nWhen <b>chksymbreak</b>=1, the code stops if :\n<ul>\n<li>(1) The k point grid is non-symmetric, in case <a href=\"varbas.html#nsym\">kptopt</a>=1, 2, or 4 ;</li>\n<li>(2) The non-symmorphic translation part of the symmetry operations has components that are not zero,\nor simple fractions, with 2, 3, 4, 6, 8 or 12 as denominators.</li>\n</ul>\n<br>When <b>chksymbreak</b> is zero, there is no such check.\n<br>When <b>chksymbreak</b> is minus 1, the code stops if the condition (1) is met, but in case the condition (2) is met, there will be a trial\nto shift the atomic coordinates such as to obtain symmetry operations with the adequate non-symmorphic part.\n\n<p>Explanation :\n<br>In the ground-state calculation, such breaking of the symmetry is usually harmless. However, if the user is doing a\ncalculation of phonons using DFPT (<a href=\"varrf.html#rfphon\">rfphon</a>=1), the convergence with respect to the number of k points will\nbe much worse with a non-symmetric grid than with a symmetric one. Also, if the user is doing a GW calculation, the\npresence of non-symmorphic translations that are not coherent with the FFT grid might cause\nproblems.\nIn the GW part, indeed, one needs to reconstruct the wavefunctions in the full Brillouin zone for\ncalculating both the polarizability and the self-energy.\nThe wavefunctions in the full Brillouin zone are obtained from the irreducible wedge by applying the symmetry\noperations of the space group of the crystal.\nIn the present implementation, the symmetrization of the wavefunctions is done in real space on the FFT mesh\nthat, therefore, has to be coherent both with the rotational part as well as with the fractional translation\nof each symmetry operation.\nIf the condition (2) is met, the GW code won't be able to find a symmetry-preserving FFT mesh.\n<br>So, it was decided to warn the user about these possible problems already at the level of the ground state calculations,\nalthough such warning might be irrelevant.\n<br>If you encounter a problem outlined above, you have two choices : change your atomic positions (translate them) such that the origin\nappears as the most symmetric point ; or ignore the problem, and set <b>chksymbreak</b>=0 .\n",
    "vartype": "integer parameter "
  },
  "cineb_start": {
    "category": "",
    "default": "<b>cineb_start</b>=7",
    "definition": "Climbing-Image Nudged Elastic Band: STARTing iteration",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=5 (Nudged Elastic Band) and\n<a href=\"varrlx.html#neb_algo\">neb_algo</a>=2 (CI-NEB).<br>\nGives the index of the first CI-NEB iteration..<br>\nThe CI-NEB method constitutes a small modification to the NEB method allowing a rigorous\nconvergence to the saddle point. As the image with the highest energy has to be identified,\nthe calculation begins with several iterations of the standard NEB algorithm.\nThe effective CI-NEB begins at the <b>cineb_start</b> iteration.<br>\n<i>See: J. Chem. Phys. 113, 9901 (2000).</i>\n",
    "vartype": "integer parameter"
  },
  "cmlfile": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "no file.",
    "definition": "Chemical Markup Language FILE ",
    "section": "varfil",
    "text": "<p>\nUsed to import some of the data from one or more Chemical Markup Language 2 (CML2) file(s)\n(one per dataset). Unlike most of the other input variables, it refers\nto a character string, e.g. :\n<br>\n<pre>\ncmlfile ../t67.in_CML.xml\n</pre>\nThe file is preprocessed, and the relevant information is translated in order\nto be used as an alternative to the usual input variables. Note that the input variables\ndirectly defined in the usual input file have precedence over the CML data :\nthe latter are used only when there is no occurence of the corresponding\nkeyword in the input file...\n<br> The ABINIT CML parser is still quite primitive. The mechanism\nfollowed to parse the CML file is described afterwards.\n<br> The ABINIT CML parser will localize in the CML file the first occurence\nof a 'molecule' markup section. It will ignore all other occurences of\n'molecule'. Inside this 'molecule' section, it will localize the first occurences\nof the 'crystal', 'symmetry' and 'atomArray' sections. All other occurences,\nand all other sections, are ignored.\n<br> The following ABINIT input variables will be extracted from these\nsections of the CML file (if the data is available) :\n<ul>\n<li> <a href=\"varbas.html#acell\">acell</a> from the first 'scalar title=\"a\"','scalar title=\"b\"',\nand 'scalar=\"c\"' sections (all three must be present if one is present)\nin the 'crystal' section, expecting the\ndata in Angstrom;</li>\n<li> <a href=\"varbas.html#angdeg\">angdeg</a> from the first 'scalar title=\"alpha\"','scalar title=\"beta\"',\nand 'scalar title=\"gamma\"' sections (all three must be present if one is present)\nin the 'crystal' section, expecting the\ndata in degrees; </li>\n<li> <a href=\"varbas.html#nsym\">nsym</a>,\n<a href=\"varbas.html#symrel\">symrel</a> and <a href=\"varbas.html#tnons\">tnons</a> from\nthe content of 'matrix' sections in the 'symmetry' section;</li>\n<li> <a href=\"varbas.html#natom\">natom</a> from the number of items in the first\n'atom' sections in the 'atomArray' section;</li>\n<li> <a href=\"varbas.html#ntypat\">ntypat</a> from the number of types of atoms over all input CML files;</li>\n<li> <a href=\"varbas.html#typat\">typat</a> from the attribute 'elementType' in the\n'atom' sections in the 'atomArray' section, with identification\nof the pseudopotentials that have the correct nuclear charge, according to the atomic symbol\n(the first pseudopotential with the correct nuclear charge, from the pseudopotential list, will be used);</li>\n<li> Coordinates of the atoms :\n<ul>\n<li> <a href=\"varbas.html#xred\">xred</a> from the attributes 'xFract', 'yFract', and 'zFract'\n(all three must be present if one is present) in the 'atom' sections\nin the 'atomArray' section.</li>\n<ul><B>OR</B></ul>\n<li> <a href=\"varbas.html#xcart\">xcart</a> from the attributes 'x3', 'y3', and 'z3'\n(all three must be present if one is present) in the 'atom' sections\nin the 'atomArray' section.</li>\n<li> <a href=\"varbas.html#znucl\">znucl</a> for all of the CML files read in.</li>\n</ul>\n</ul>\n<br> These limited parsing capabilities are enough for ABINIT to read the CML files it has created\nthanks to the use of the <a href=\"varfil.html#prtcml\">prtcml</a> input variable. Mixing CML files\nwith normal input or <a href=\"vargeo.html#xyzfile\">xyzfile</a> will not work.\n",
    "vartype": "character string "
  },
  "cpu": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ; for cpum and cpuh : <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>",
    "default": "0.0d0.",
    "definition": "CPU time limit in: Seconds, Minutes, Hours   ",
    "section": "vargs",
    "text": "<p>\nOne of these three real parameters can be\ndefined in the input file, to set up a CPU time limit.\nWhen the job reaches that limit, it will try to end smoothly.\nHowever, note that this might still take some time.\nIf the user want a firm CPU time limit, the present\nparameter must be reduced sufficiently. Intuition\nabout the actual margin to be taken into account\nshould come with experience ...\n<br>Note that only one of these three parameters can be defined\nin a single input file.\nA zero value has no action of the job.\n<br>Internally, only <b>cpus</b> is used in the dtset array: adequate\nconversion factors are used to generate it from <b>cpum</b> or\n<b>cpuh</b>.",
    "vartype": "real parameters  "
  },
  "ddamp": {
    "category": " ",
    "default": "0.1 .",
    "definition": "electric Displacement field DAMPing parameter ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=6,\nthe electric field is updated after each SCF iteration according to\nE_{n+1}= <b>ddamp</b>*(D - 4*pi*P_{n}) + (1-<b>ddamp</b>)*E_{n}\nwhere P_{n} and E_{n} are the polarization and electric field after nth SCF iteration.\n<b>ddamp</b> is a damping parameter used to control the convergence speed.\n<br>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=16, the electric field is updated after each SCF iteration according to\ne_{n+1}= <b>ddamp</b>*(d - p_{n}) + (1-<b>ddamp</b>)*e_{n}\n<br>\nIf you have difficulty getting convergence, try to reduce this value or reduce maxestep.\nThis parameter is used in finite electric displacement field calculations (berryopt=6,16,17).\n",
    "vartype": "real parameter  "
  },
  "delayperm": {
    "category": "",
    "default": "0.",
    "definition": "DELAY between trials to PERMUTE atoms ",
    "section": "varrlx",
    "text": "<p>\nDelay (number of time steps) between trials to permute\ntwo atoms, in\nview of accelerated search of minima. Still in development. See the\nroutine moldyn.F90. See also <a href=\"varrlx.html#signperm\">signperm</a>.\nWhen <b>delayperm</b> is zero, there is not permutation trials.\n",
    "vartype": "integer "
  },
  "densty": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.0d0.",
    "definition": "initial DENSity for each TYpe of atom ",
    "section": "vardev",
    "text": "<p>\nGives a rough description\nof the initial GS density, for each type of atom.\nThis value is only used to create\nthe first exchange and correlation potential,\nand is not used anymore afterwards.\nFor the time being, it corresponds to an average\nradius (a.u.) of the density, and is used to generate\na gaussian density. If set to 0.0d0, an optimized value is used.\n<br>No meaning for RF calculations.",
    "vartype": "real array densty(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "dfield": {
    "category": " ",
    "default": "3*0.0 .",
    "definition": "Displacement FIELD ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=6,\n<b>dfield</b> specifies the (unreduced) finite electric displacement field vector, in atomic units, that is to be imposed as a constraint during the calculation.\n",
    "vartype": "real array dfield(3)  "
  },
  "diecut": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "2.2d0 Ha.",
    "definition": "DIElectric matrix Energy CUToff ",
    "section": "vargs",
    "text": "<p>\nKinetic energy cutoff that controls the number\nof planewaves used to represent the dielectric matrix:\n<br>(1/2)[(2 Pi)*(Gmax)]<sup>2</sup>=<a href=\"varbas.html#ecut\">ecut</a> for Gmax.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>diecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n<br>All planewaves inside this \"basis sphere\" centered\nat G=0 are included in the basis.\nThis is useful only when <a href=\"vargs.html#iprcel\">iprcel</a>>=21, which means that\na preconditioning scheme based on the dielectric matrix\nis used.\n<br>NOTE : a negative <b>diecut</b> will define the same dielectric\nbasis sphere as the corresponding positive value,\nbut the FFT grid will be identical to the one used\nfor the wavefunctions.\nThe much smaller FFT grid, used when <b>diecut</b> is positive,\ngives exactly the same results.\n<br>No meaning for RF calculations yet.",
    "vartype": "real parameter "
  },
  "diegap": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.1 Ha.",
    "definition": "DIElectric matrix GAP ",
    "section": "vargs",
    "text": "<p>\nGives a rough estimation of the dielectric gap\nbetween the highest energy level computed in the run,\nand the set of bands not represented.\nUsed to extrapolate dielectric matrix when <a href=\"vargs.html#iprcel\">iprcel</a> >= 21.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>diegap</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n<br>No meaning for RF calculations yet.",
    "vartype": "real parameter "
  },
  "dielam": {
    "category": "",
    "default": "0.5 .",
    "definition": "DIElectric matrix LAMbda ",
    "section": "vargs",
    "text": "<p>\nGives the amount of occupied states with mean energy given by the\nhighest level computed in the run, included\nin the extrapolation of the dielectric matrix.\nUsed when <a href=\"vargs.html#iprcel\">iprcel</a> >= 21.\n<br>No meaning for RF calculations yet.",
    "vartype": "real parameter between 0 and 1 "
  },
  "dielng": {
    "category": " ",
    "default": "1.0774841d0 (Bohr), for historical reasons.",
    "definition": "model DIElectric screening LeNGth ",
    "section": "vargs",
    "text": "<p>\nUsed for screening length (in Bohr) of the model\ndielectric function, diagonal in reciprocal space.\nBy default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstrom), although Angstrom can be specified,\nif preferred, since <b>dielng</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\n<br>\nThis model dielectric function is as follows :\n<pre>\n(     1        + <b>dielng</b><sup>2</sup> * K<sup>2</sup> )\ndiel(K)= --------------------------------------------\n( 1/<a href=\"vargs.html#diemac\">diemac</a> + <b>dielng</b><sup>2</sup> * K<sup>2</sup> ) * <a href=\"vargs.html#diemix\">diemix</a>\n</pre>\nThe inverse of this model dielectric function will be\napplied to the residual, to give the preconditioned\nchange of potential. Right at K=0, diel(K) is imposed to be 1.\n<p>If the preconditioning were perfect,\nthe change of potential would lead to an exceedingly fast solution\nof the self-consistency problem (two or three steps).\nThe present model dielectric function is excellent for\nrather homogeneous unit cells.\n<br>When K->0 , it tends to the macroscopic dielectric\nconstant, eventually divided by the mixing factor <a href=\"vargs.html#diemix\">diemix</a>\n(or <a href=\"vargs.html#diemix\">diemixmag</a> for magnetization).\n<br>For metals, simply put <a href=\"vargs.html#diemac\">diemac</a> to a very large value (10^6 is OK)\n<br>The screening length <b>dielng</b> governs the length scale\nto go from the macroscopic regime to the microscopic\nregime, where it is known that the dielectric function\nshould tend to 1. It is on the order of 1 Bohr for\nmetals with medium density of states at the Fermi level,\nlike Molybdenum, and for Silicon. For metals with a\nlarger DOS at the Fermi level (like Iron),\nthe screening will be more effective, so that <b>dielng</b>\nhas to be decreased by a factor of 2-4.\n<br>This works for GS and RF calculations.\n\nTO BE IMPROVED : it is not clear what the variable K is and how to deal it, David Waroquiers, 090831.\n",
    "vartype": "real parameter "
  },
  "diemac": {
    "category": " ",
    "default": "10<sup>6</sup> (metallic damping). ",
    "definition": "model DIElectric MACroscopic constant ",
    "section": "vargs",
    "text": "<p>\nA rough knowledge of the macroscopic dielectric constant <b>diemac</b>\nof the system is a useful help to speed-up the SCF procedure:\na model dielectric function,\nsee the keyword <a href=\"vargs.html#dielng\">dielng</a>, is used for that\npurpose.  It is especially\nuseful for speeding up the treatment of rather homogeneous unit cells.\n<p>Some hint :\n<br>The value of <b>diemac</b> should usually be bigger than 1.0d0,\non physical grounds.\n<br>For metals, simply put <b>diemac</b> to a very large value (the default 10<sup>6</sup> is OK)\n<br>For silicon, use 12.0 . A similar value is likely to work well for\nother semiconductors\n<br>For wider gap insulators, use 2.0 ... 4.0\n<br>For molecules in an otherwise empty big box, try 1.5 ... 3.0\n<br>Systems that combine a highly polarisable part and some vacuum are rather\nbadly treated by the model dielectric function. One has to use the\n\"extrapolar\" technique, activated by the  input variable\n<a href=\"vargs.html#iprcel\">iprcel</a>.\n<br>In sufficiently homogeneous systems, you might have to experiment\na bit to find the best <b>diemac</b>. If you let <b>diemac</b>\nto its default value, you might even never obtain the self-consistent convergence !\n<br>For response function calculations, use the same\nvalues as for GS. The improvement in speed can be considerable\nfor small (but non-zero) values of the wavevector.\n",
    "vartype": "real parameter "
  },
  "diemix": {
    "category": " ",
    "default": "1.0 (norm-conserving psps or <a href=\"vargs.html#iprcel\">iprcel</a>/=0) or 0.7 (PAW and <a href=\"vargs.html#iprcel\">iprcel</a>=0).",
    "definition": "model DIElectric MIXing factor ",
    "section": "vargs",
    "text": "<p>\nGives overall factor of the preconditioned\nresidual density/potential to be transferred in the SCF cycle.\n<br>It should be between 0.0 and 1.0 .\n<br>If the model dielectric function were perfect, <b>diemix</b>\nshould be 1.0 . By contrast, if the model dielectric function\ndoes nothing (when <a href=\"vargs.html#diemac\">diemac</a>=1.0d0 or <a href=\"vargs.html#dielng\">dielng</a>\nis larger than the\nsize of the cell), <b>diemix</b> can be used\nto damp the amplifying factor inherent to the SCF loop.\n<br>For molecules, a value on the order 0.5 or 0.33 is rather usual.\n<br>When mod(<a href=\"varbas.html#iscf\">iscf</a>,10)=3, 4 ,5 or 7, <b>diemix</b>\nis only important at the\nfew first iterations when anharmonic effects are important,\nsince these schemes compute their own mixing factor\nfor self-consistency.<br>\nAlso note that a different value of diemix can be used for the magnetization\n(see <a href=\"vargs.html#diemixmag\">diemixmag</a>).\n",
    "vartype": "real parameter "
  },
  "diemixmag": {
    "category": " ",
    "default": "diemixmag= <a href=\"vargs.html#diemixmag\">diemix</a> when <a href=\"vargs.html#iprcel\">iprcel</a>=0 or 70<<a href=\"vargs.html#iprcel\">iprcel</a><80 or <a href=\"varbas.html#iscf\">iscf</a><10 (SCF mixing on potential), else diemixmag= - <a href=\"vargs.html#diemixmag\">diemix</a>",
    "definition": "model DIElectric MIXing factor for the MAGgnetization",
    "section": "vargs",
    "text": "<p>\nGives overall factor of the preconditioned\nresidual magnetization/magnetic field to be transferred in the SCF cycle (see <a href=\"vargs.html#diemixmag\">diemix</a> for further information).<br>\nFor the time being, apply only when the SCF mixing is done on the density\n(<a href=\"varbas.html#iscf\">iscf</a>>=10).<br><br>\nA negative value of diemixmag means that magnetization is only preconditionned by ABS(diemixmag),\nwithout the use of any preconditionner.<br><br>\nWhen SCF cycle has some difficulties to converge, changing the value of <b>diemixmag</b>\ncan have a positive effect.<br>In particular <b>diemixmag</b>=-4 is a good choice\n(i.e. diemixmag=4, no other preconditionner on magnetization).\n",
    "vartype": "real parameter "
  },
  "diismemory": {
    "category": "",
    "default": "8.",
    "definition": "Direct Inversion in the Iterative Subspace MEMORY ",
    "section": "varrlx",
    "text": "<p>\nGives the maximum number of \"time\" steps for which the\nforces and stresses are stored, and taken into account in the\nDIIS algorithm (<a href=\"varrlx.html#ionmov\">ionmov</a>=20)\nto find zero-force and stress configurations.\n",
    "vartype": "integer "
  },
  "dilatmx": {
    "category": "",
    "default": "1.0 .",
    "definition": "DILATation : MaXimal value ",
    "section": "varrlx",
    "text": "<p>\nGives the maximal permitted scaling of\nthe lattice parameters when the cell shape and\ndimension is varied (see variable <a href=\"varrlx.html#optcell\">optcell</a>).\nIt is used to define the sphere of plane waves\nand FFT box coherent with the possible modifications\nof the cell (<a href=\"varrlx.html#ionmov\">ionmov</a>==2 and <a\nhref=\"varrlx.html#optcell\">optcell</a>/=0).\nFor these definitions, it is equivalent\nto changing <a href=\"varbas.html#ecut\">ecut</a> by multiplying it by <b>dilatmx</b><sup>2</sup>\n(the result is an \"effective ecut\", called internally \"ecut_eff\",\nother uses of <a href=\"varbas.html#ecut\">ecut</a> being not modified\nwhen <b>dilatmx</b>&gt;1.0 .\n<br>\nUsing <b>dilatmx</b>&lt;1.0 is equivalent to changing <a\nhref=\"varbas.html#ecut\">ecut</a>\nin all its uses. This is allowed, although its meaning\nis no longer related to a maximal expected scaling.\n<br>\nSetting <b>dilatmx</b> to a large value leads to waste\nof CPU time and memory. Supposing you think that the\noptimized <a href=\"varbas.html#acell\">acell</a> values might be 10%\nlarger than your\ninput values, use simply <b>dilatmx</b> 1.1 . This will already\nlead to an increase of the number of planewaves by a factor\n(1.1)<sup>3</sup>=1.331 , and a corresponding increase in CPU time\nand memory.\n<br>\nIt is possible to use <b>dilatmx</b> when <a\nhref=\"varrlx.html#optcell\">optcell</a>=0, but\na value larger than 1.0 will be a waste.\n",
    "vartype": "real parameter "
  },
  "dmatpawu": {
    "category": "",
    "default": "-10. (not defined)",
    "definition": "initial Density MATrix for PAW+U ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1,\n<a href=\"varpaw.html#usepawu\">usepawu</a>=1,\n<a href=\"varpaw.html#usedmatpu\">usedmatpu</a>/=0 for Ground-State calculations.<br>\nGives the value of an initial density matrix used in LDA+U and kept\nfixed during the first abs(<a href=\"varpaw.html#usedmatpu\">usedmatpu</a>) SCF iterations.\n<br>Only components corresponding to <a href=\"varpaw.html#lpawu\">lpawu</a> angular momentum are requested.\n<br>Restriction: In order to use dmatpawu, <a href=\"varpaw.html#lpawu\">lpawu</a> must be identical for all atom types (or -1).\n<br>The occupation matrix is in the basis of real spherical harmonics Slm (note that this differs from the choice made when\n<a href=\"varfil.html#prtdosm\">prtdosm=1</a>, that is in the basis of complex spherical harmonics).\nTheir are ordered by increasing m, and are defined e.g. in\nthe article\n\"Evaluation of the rotation matrices in the basis of real spherical harmonics\",\nby Miguel A. Blancoa, M. Floreza, M. Bermejo,\nJournal of Molecular Structure (Theochem) 419, 19 (1997), that can be downloaded from\n<a href=\"http://azufre.quimica.uniovi.es/articles/Theochem419-19-ov-BF97-rotation-matrices.pdf\">\n<!-- <a href=\"http://www.unioviedo.es/qcg/art/Theochem419-19-ov-BF97-rotation-matrices.pdf\"> -->\nthe author Web site</a>.\nFor the case l=2 (d states), the five columns corresponds respectively to (the normalisation factor has been dropped)\n<br>\n<ul>\n<li>m=-2, xy\n<li>m=-1, yz\n<li>m=0, 3z^2-r^2\n<li>m=1, xz\n<li>m=2, x^2-y^2\n</ul>\n<br>\n<b>dmatpawu</b> must always be given as a \"spin-up\" occupation matrix (and eventually a \"spin-down\" matrix).\nBe aware that its physical meaning depends on the magnetic properties imposed to the system\n(with <a href=\"varbas.html#nsppol\">nsppol</a>,\n<a href=\"vargs.html#nspinor\">nspinor</a>,\n<a href=\"vargs.html#nspden\">nspden</a>):<br>\n<ul>\n<li><b>Non-magnetic system</b>\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=1):<br>\nOne (2lpawu+1)x(2lpawu+1) <b>dmatpawu</b> matrix is given for each atom on which +U is applied.<br>\nIt contains the \"spin-up\" occupations.</li>\n<li><b>Ferromagnetic spin-polarized (collinear) system</b>\n(<a href=\"varbas.html#nsppol\">nsppol</a>=2,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2):<br>\nTwo (2lpawu+1)x(2lpawu+1) <b>dmatpawu</b> matrices are given for each atom on which +U is applied.<br>\nThey contain the \"spin-up\" and \"spin-down\" occupations.</li>\n<li><b>Anti-ferromagnetic spin-polarized (collinear) system</b>\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2):<br>\nOne (2lpawu+1)x(2lpawu+1) <b>dmatpawu</b> matrix is given for each atom on which +U is applied.<br>\nIt contains the \"spin-up\" occupations.</li>\n<li><b>Non-collinear magnetic system</b>\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=2,\n<a href=\"vargs.html#nspden\">nspden</a>=4):<br>\nTwo (2lpawu+1)x(2lpawu+1) <b>dmatpawu</b> matrices are given for each atom on which +U is applied.<br>\nThey contains the \"spin-up\" and \"spin-down\" occupations\n(defined as n_up=(n+|m|)/2 and n_dn=(n-|m|)/2), where m is the integrated magnetization vector).<br>\nThe direction of the magnetization (which is also the direction of n_up and n_dn) is given by\n<a href=\"vargs.html#spinat\">spinat</a>.<br>\n<i>Warning: unlike collinear case, atoms having the same magnetization magnitude with different directions\nmust be given the same occupation matrix;<br>\nthe magnetization will be oriented by the value of <a href=\"vargs.html#spinat\">spinat</a>\n(this is the case for antiferro-magnetism).</i></li>\n<li><b>Non-collinear magnetic system with zero magnetization</b>\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=2,\n<a href=\"vargs.html#nspden\">nspden</a>=1):<br>\nTwo (2lpawu+1)x(2lpawu+1) <b>dmatpawu</b> matrices are given for each atom on which +U is applied.<br>\nThey contain the \"spin-up\" and \"spin-down\" occupations;<br>\nBut, as \"spin-up\" and \"spin-down\" are constrained identical, the \"spin-down\" one is ignored by the code.</li>\n</ul>\n",
    "vartype": "real array dmatpawu(2*max(<a href=\"varpaw.html#lpawu\">lpawu</a>)+1,2*max(<a href=\"varpaw.html#lpawu\">lpawu</a>)+1, max(<a href=\"varbas.html#nsppol\">nsppol</a>,<a href=\"vargs.html#nspinor\">nspinor</a>), %<a href=\"varint.html#natpawu\">natpawu</a>) <br>where %<a href=\"varint.html#natpawu\">natpawu</a> is the number of atoms on which LDA/GGA+U is applied. "
  },
  "dmatpuopt": {
    "category": "",
    "default": "2",
    "definition": "Density MATrix for PAW+U OPTion",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and\n<a href=\"varpaw.html#usepawu\">usepawu</a>=1<br>\nThis option governs the way occupations of localized atomic levels are computed:<br>\n<ul>\n<li> <b>dmatpuopt</b>=1: atomic occupations are projections on atomic orbitals (Eq. (6) of PRB 77, 155104 (2008)). <br>\n</li>\n<li> <b>dmatpuopt</b>=2: atomic occupations are integrated values in PAW spheres\nof angular-momentum-decomposed charge densities (Eq. (7) of PRB 77, 155104 (2008)). <br>\n</li>\n<li> <b>dmatpuopt</b>=3: only for tests<br>\n</li>\n</li>\n<li> <b>dmatpuopt</b>=4: Extrapolations of occupancies outside the PAW-sphere. This Definition gives normalized operator for occupation.<br>\n</li>\n</ul>\nIn the general case <b>dmatpuopt</b>=2 is suitable. The use of <b>dmatpuopt</b>=1\nis restricted to PAW datasets in which the first\natomic wavefunction of the correlated subspace is a normalized atomic eigenfunction.\n",
    "vartype": "integer parameter"
  },
  "dmatudiag": {
    "category": "",
    "default": "0",
    "definition": "Density MATrix for paw+U, DIAGonalization ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and\n<a href=\"varpaw.html#usepawu\">usepawu</a>=1 and for Ground-State calculations.<br>\nThis option can be used to diagonalize the occupation matrix Nocc_{m,m'}.<br>\nRelevant values are:<br>\n<ul>\n<li>0: desactivated.</li>\n<li>1: occupation matrix is diagonalized and printed in log file at each SCF cycle\n(eigenvectors are also given in the log file).</li>\n<li>2: for testing purpose.</li>\n</ul>\nNot yet available for <a href=\"vargs.html#nspden\">nspden</a>=4.\n",
    "vartype": "integer parameter"
  },
  "dmft_dc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1 ",
    "definition": "Dynamical Mean Fied Theory: Double Counting",
    "section": "vardev",
    "text": "<p>\n<br> Value of double counting used for DMFT. Only value 1 is activated for the moment and is the FLL double counting.\n",
    "vartype": "integer  "
  },
  "dmft_iter": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 ",
    "definition": "Dynamical Mean Fied Theory: number of ITERation ",
    "section": "vardev",
    "text": "<p>\n<br> Number of iterations for the DMFT inner loop.\n",
    "vartype": "integer  "
  },
  "dmft_mxsf": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0.3 ",
    "definition": "Dynamical Mean Fied Theory: MiXing parameter for the SelF energy ",
    "section": "vardev",
    "text": "<p>\n<br> Mixing parameter for the simple mixing of the self-energy.\n",
    "vartype": "real  "
  },
  "dmft_nwli": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0  ",
    "definition": "Dynamical Mean Fied Theory: Number of frequency omega (W) in the LInear mesh ",
    "section": "vardev",
    "text": "<p>\n<br> Number of Matsubara frequencies (linear  mesh)\n",
    "vartype": "integer  "
  },
  "dmft_nwlo": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0  ",
    "definition": "Dynamical Mean Fied Theory: Number of frequency omega (W) in the log mesh ",
    "section": "vardev",
    "text": "<p>\n<br> Number of frequencies in the log mesh.\n",
    "vartype": "integer  "
  },
  "dmft_read_occnd": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0  ",
    "definition": "Dynamical Mean Fied Theory: Read Occupations (Non Diagonal) ",
    "section": "vardev",
    "text": "<p>\n<br> Flag to read/write Occupations as computed in DMFT. This flag is useful\nto restart a DFT+DMFT calculation with self-consistency over electronic density.\nThe occupations are written each time a DMFT loop is finished. So if the calculations stops\nbecause the time limit is reached, this option offers the possibility to restart the self-consistent loop\nover density at the point where it stopped.\n<ul>\n<li> 0=&gt;  Occupations are written but never read.\n<li> 1=&gt;  Occupations are read from I_DMFTOCCND, where I is the root for input files.\n<li> 2=&gt;  Occupations are read from O_DMFTOCCND, where O is the root for output files.\n</ul>\n\n",
    "vartype": "integer  "
  },
  "dmft_rslf": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0  ",
    "definition": "Dynamical Mean Fied Theory: Read SeLF energy ",
    "section": "vardev",
    "text": "<p>\n<br> Flag to read/write Self-Energy. If put to one, self-energy is written and read at each LDA iteration.\n",
    "vartype": "integer  "
  },
  "dmft_solv": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0  ",
    "definition": "Dynamical Mean Fied Theory: choice of SOLVer ",
    "section": "vardev",
    "text": "<p>\n<br> Choice of solver for the Impurity model.\n<ul>\n<li> 1=&gt; LDA+U self-energy is used (for testing purpose)\n<li> 2=&gt; Hubbard one solver.\n</ul>\n<br> WARNING: Quantum Monte Carlo (QMC) solvers are not yet interfaced with the code. The present version of LDA+DMFT implemented here\nshould NOT be used for correlated metals. Even of correlated (Mott) insulators, QMC is expected to be much more\nprecise: Hubbard one is a approximation !\n",
    "vartype": "real  "
  },
  "dmft_tollc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0.00001  ",
    "definition": "Dynamical Mean Fied Theory: Tolerance on Local Charge for convergency of the DMFT loop ",
    "section": "vardev",
    "text": "<p>\n<br> Tolerance for the variation of Local Charge during iterations of the DMFT Loop.\n<br> The default value is good for fast calculations. However, to obtain good convergency of the DFT Loop,\nthe DMFT Loop needs a better convergence criterion.\n",
    "vartype": "real  "
  },
  "dmftbandf": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 ",
    "definition": "(to be described) ",
    "section": "vardev",
    "text": "<p>\n<br> dmftbandi and dmftbandf are the first and last bands taken into account in the Projected Local\nOrbitals scheme of LDA+DMFT. They thus define the energy window used to define Wannier Functions.\n(see  Amadon, B., Lechermann, F., Georges, A., Jollet, F., Wehling, T. O., and Lichtenstein, A. I. Phys. Rev. B 77(20), (2008).)\n\n",
    "vartype": "(to be described)  "
  },
  "dmftbandi": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 ",
    "definition": "(to be described) ",
    "section": "vardev",
    "text": "<p>\n<br> dmftbandi and dmftbandf are the first and last bands taken into account in the Projected Local\nOrbitals scheme of LDA+DMFT. They thus define the energy window used to define Wannier Functions.\n(see  Amadon, B., Lechermann, F., Georges, A., Jollet, F., Wehling, T. O., and Lichtenstein, A. I. Phys. Rev. B 77(20), (2008).)\n\n",
    "vartype": "(to be described)  "
  },
  "dmftcheck": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 ",
    "definition": "Dynamical Mean Fied Theory: CHECKs ",
    "section": "vardev",
    "text": "<p>\n<br> (Introduced by B. Amadon, v6.1.0)\n",
    "vartype": "integer  "
  },
  "dosdeltae": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0 .",
    "definition": "DOS Delta in Energy ",
    "section": "vargs",
    "text": "<p>\nDefines the linear grid resolution (energy increment) to be used for the\ncomputation of the Density-Of-States, when <a href=\"varfil.html#prtdos\">prtdos</a>\nis non-zero.\n<br>If <b>dosdeltae</b> is set to zero (the default value), the actual\nincrement is 0.001 Ha if <a href=\"varfil.html#prtdos\">prtdos</a>=1, and\nthe much smaller value 0.00005 Ha if <a href=\"varfil.html#prtdos\">prtdos</a>=2.\nThis different default value arises because the <a href=\"varfil.html#prtdos\">prtdos</a>=1 case,\nbased on a smearing technique, gives a quite smooth DOS, while the DOS from the\ntetrahedron method, <a href=\"varfil.html#prtdos\">prtdos</a>=2, is rapidly varying.\n",
    "vartype": "real parameter "
  },
  "dtion": {
    "category": "",
    "default": "100.",
    "definition": "Delta Time for IONs ",
    "section": "varrlx",
    "text": "<p>\nUsed for controlling ion time steps.\nIf <a href=\"varrlx.html#ionmov\">ionmov</a> is set to 1, 6 or 7, then\nmolecular dynamics is&nbsp;\nused to update atomic positions in response to\nforces. The parameter <b>dtion</b> is a time step in\natomic units of time. (One atomic time unit is\n2.418884e-17 seconds, which is the value of\nPlanck's constant in hartree*sec.)\nIn this case the atomic masses, in amu (given in array \"<a\nhref=\"varrlx.html#amu\">amu</a>\"),\nare used in Newton's equation and the viscosity (for <a\nhref=\"varrlx.html#ionmov\">ionmov</a>=1)\nand number of time steps are provided to the code using input\nvariables \"<a href=\"varrlx.html#vis\">vis</a>\" and \"<a\nhref=\"varrlx.html#ntime\">ntime</a>\".\nThe code actually converts\nfrom masses in amu to masses in atomic units (in units\nof electron masses) but the user enters masses in <a\nhref=\"varrlx.html#amu\">amu</a>.\n(The conversion from amu to atomic units (electron\nmasses) is 1822.88851 electron masses/amu.)\n<br>\nA typical good value for <b>dtion</b> is about 100.\nThe user must try several values\nfor <b>dtion</b> in order to establish the stable and efficient\nchoice for the accompanying amu, atom types and positions,\nand <a href=\"varrlx.html#vis\">vis</a> (viscosity).\n<br>\nFor quenched dynamics (<a href=\"varrlx.html#ionmov\">ionmov</a>=7), a\nlarger time step might\nbe taken, for example 200.\n<br>\nNo meaning for RF calculations.\n",
    "vartype": "real parameter "
  },
  "dynimage": {
    "category": "",
    "default": "<b>dynimage(:)</b>=1; if <a href=\"varrlx.html#imgmov\">imgmov</a>=2 or 5 (String Method, NEB), <b>dynimage(1)</b>=0 and <b>dynimage(<a href=\"varrlx.html#nimage\">nimage</a>)</b>=0.",
    "definition": "DYNamics of the IMAGE ",
    "section": "varrlx",
    "text": "<p>\nThis input variable is relevant when sets of images are activated (see\n<a href=\"varrlx.html#imgmov\">imgmov</a>). Not all images might be required to evolve from one time step to the other.\nIndeed, in the String Method or the Nudged Elastic Band, one might impose that the extremal configurations of the string are fixed.\nIn case the <b>dynimage</b>(iimage)=0, the image with index \"iimage\" will be consider as fixed.\nThus, there is no need to compute forces and stresses for this image at each time step. The purpose of\nnevertheless defining extremal images is to make the input/output easier.<br><br>\nIn order to save CPU time, the computation of properties of static images (<b>dynimage</b>(iimage)=0)\ncan be avoided: see <a href=\"varrlx.html#istatimg\">istatimg</a> keyword.\n",
    "vartype": "integer dynimage(nimage)"
  },
  "ecut": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "",
    "definition": "Energy CUToff ",
    "section": "varbas",
    "text": "<p>\nUsed for kinetic energy cutoff\nwhich controls number\nof planewaves at given k point by:\n<br>(1/2)[(2 Pi)*(k+Gmax)]<sup>2</sup>=<b>ecut</b> for Gmax.\n<br>All planewaves inside this \"basis sphere\" centered\nat k are included in the basis (except if <a href=\"varrlx.html#dilatmx\">dilatmx</a>\nis defined).\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n<br>This is the single parameter which can have an enormous\neffect on the quality of a calculation; basically the larger\n<b>ecut</b> is, the better converged the calculation is.  For fixed\ngeo, the total energy MUST always decrease as <b>ecut</b> is\nraised because of the variational nature of the problem.\n<p>\n<i>Usually one runs at least several calculations at various <b>ecut</b>\nto investigate the convergence needed for reliable results.</i>\n<p>\nFor k-points whose coordinates are build from 0 or 1/2,\nthe implementation of time-reversal symmetry that links\ncoefficients of the wavefunctions in reciprocal space\nhas been realized. See the input variable <a href=\"vardev.html#istwfk\">istwfk</a>.\nIf activated (which corresponds to the Default mode),\nthis input variable <a href=\"vardev.html#istwfk\">istwfk</a> will allow to\ndivide the number of plane wave (npw) treated explicitly\nby a factor of two. Still, the final result should be identical with\nthe 'full' set of plane waves.\n<p>See the input variable <a href=\"varrlx.html#ecutsm\">ecutsm</a>, for the\nsmoothing of the kinetic energy, needed to optimize unit cell parameters.\n",
    "vartype": "real parameter "
  },
  "ecuteps": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0 ",
    "definition": "Energy CUT-off for EPSilon (the dielectric matrix) ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>ecuteps</b> determines the cut-off energy of the planewave set used to represent the\nindependent-particle susceptibility $\\chi^{(0)}_{KS}$, the dielectric matrix $\\epsilon$, and its inverse.\n<br>\nIt is not worth to take <b>ecuteps</b> bigger than four times <a href=\"vargw.html#ecutwfn\">ecutwfn</a>,\nthis latter limit corresponding to the highest Fourier components of a wavefunction convoluted with itself.\nUsually, even twice the value of <a href=\"vargw.html#ecutwfn\">ecutwfn</a> might overkill. A value of <b>ecuteps</b>\nbetween 5 and 10 Hartree often leads to converged results (at the level of 0.01 eV for the energy gap).\nIn any case, a convergence study is worth.\n<p>\nThis set of planewaves can also be determined by the other input variables\n<a href=\"vargw.html#npweps\">npweps</a> and <a href=\"vargw.html#nsheps\">nsheps</a>,\nbut these are much less convenient to use for general systems, than the selection\ncriterion based on a cut-off energy.\n",
    "vartype": "real parameter"
  },
  "ecutsigx": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0.0 .",
    "definition": "Energy CUT-off for SIGma eXchange ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>ecutsigx</b> determines the cut-off energy of the planewave set used to generate the\nexchange part of the self-energy operator. For norm-conserving calculations, it is pointless\nto have <b>ecutsigx</b> bigger than 4*<a href=\"varbas.html#ecut\">ecut</a>,\nwhile for PAW calculations, the maximal useful value is\n<a href=\"varpaw.html#pawecutdg\">pawecutdg</a>. Thus, if you do not care about CPU time, please use these\nvalues. If you want to spare some CPU time, you might try to use a value between <a href=\"varbas.html#ecut\">ecut</a> and these\nupper limits.\n<p>\nThis set of planewaves can also be determined by the other input variables\n<a href=\"vargw.html#npwsigx\">npwsigx</a> and <a href=\"vargw.html#nshsigx\">nshsigx</a>,\nbut these are much less convenient to use for general systems, than the\nselection criterion based on the cut-off energy (<b>ecutsigx</b> has to be 0.0 for using these).\n",
    "vartype": "real parameter"
  },
  "ecutsm": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.d0",
    "definition": "Energy CUToff SMearing ",
    "section": "varrlx",
    "text": "<p>This input variable is important when performing\nrelaxation of unit cell\nsize and shape (non-zero <a href=\"varrlx.html#optcell\">optcell</a>).\nUsing a non-zero\n<b>ecutsm</b>, the total energy curves as a function of\n<a href=\"varbas.html#ecut\">ecut</a>, or <a href=\"varbas.html#acell\">acell</a>,\ncan be smoothed,\nkeeping consistency with\nthe stress (and automatically including the Pulay stress). The\nrecommended\nvalue is 0.5 Ha. Actually, when <a href=\"varrlx.html#optcell\">optcell</a>/=0,\nABINIT requires\n<b>ecutsm</b> to be larger than zero. If you want to optimize cell\nshape and size without\nsmoothing the total energy curve (a dangerous thing to do), use a very\nsmall <b>ecutsm</b>,\non the order of one microHartree.\n\n<p>\nTechnical information :\n<br>\nSee Bernasconi et al, J. Phys. Chem. Solids 56, 501 (1995)\nfor a related method.\n<br>\n<b>ecutsm</b> allows to define an effective kinetic energy for plane\nwaves, close to, but\nlower than the\nmaximal kinetic energy <a href=\"varbas.html#ecut\">ecut</a>. For\nkinetic\nenergies less than <a href=\"varbas.html#ecut\">ecut</a>-<b>ecutsm</b>,\nnothing is modified,\nwhile between <a href=\"varbas.html#ecut\">ecut</a>-<b>ecutsm</b> and <a\nhref=\"varbas.html#ecut\">ecut</a>,\nthe kinetic energy is multiplied by:\n<br>\n1.0 / ( x<sup>2</sup> (3+x-6x<sup>2</sup>+3x<sup>3</sup>))\n<br>\nwhere x = (<a href=\"varbas.html#ecut\">ecut</a> - kinetic_energy)/<b>ecutsm</b>\n<br>\nNote that x<sup>2</sup> ( 3+x-6x<sup>2</sup>+3x<sup>3</sup>) is 0 at\nx=0, with vanishing derivative,\nand that at x=1 , it is 1, with also vanishing derivative.\n<br>\nIf <b>ecutsm</b> is zero, the unmodified kinetic energy is used.\n<br>\n<b>ecutsm</b> can be specified in Ha (the default), Ry, eV or Kelvin,\nsince\n<b>ecutsm</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>'\ncharacteristics.\n(1 Ha=27.2113845 eV).\n<br>\nA few test for Silicon (diamond structure, 2 k-points) have\nshown 0.5 Ha to be largely enough for <a href=\"varbas.html#ecut\">ecut</a>\nbetween 2Ha and 6Ha,\nto get smooth curves. It is likely that this value is OK\nas soon as <a href=\"varbas.html#ecut\">ecut</a> is larger than 4Ha.\nNote that prior to v4.4 (in v4.3 and older versions), the smoothing\nfunction was\n<br>\n1.0 / ( x<sup>2</sup> ( 3-2*x) )\n<br>\nHowever, the second derivative was not continuous at the cut-off\nenergy. This\nleads to problems for elastic constant calculations using response\nfunctions.\n",
    "vartype": "real parameter (in Hartree) "
  },
  "ecutwfn": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0.0, although, if a screening or self-energy calculation is done (<a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4), <b>ecutwfn</b> is automatically set to <a href=\"varbas.html#ecut\">ecut</a> ",
    "definition": "Energy CUT-off for WaveFunctions",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening and sigma calculations.\n<p>\n<b>ecutwfn</b> determines the cut-off energy of the planewave set used to represent the wavefunctions\nin the formula that generates the independent-particle susceptibility $\\chi^{(0)}_{KS}$\n(for <a href=\"vargs.html#optdriver\">optdriver</a>=3), or the\nself-energy (for <a href=\"vargs.html#optdriver\">optdriver</a>=4).\n<br>\nUsually, <b>ecutwfn</b> is smaller than <a href=\"varbas.html#ecut\">ecut</a>,\nso that the wavefunctions are filtered, and some components are ignored.\nAs a side effect, the wavefunctions are no more normalized, and also, no more orthogonal.\nAlso, the set of plane waves can be much smaller for <a href=\"vargs.html#optdriver\">optdriver</a>=3,\nthan for <a href=\"vargs.html#optdriver\">optdriver</a>=4, although a convergence\nstudy is needed to choose correctly both values.\n<p>\nThis set of planewaves can also be determined by the other input variables\n<a href=\"vargw.html#npwwfn\">npwwfn</a> and <a href=\"vargw.html#nshwfn\">nshwfn</a>,\nbut these are much less convenient to use for general systems, than the\nselection criterion based on the cut-off energy (<b>ecutwfn</b> has to be set to 0.0 for using these).\n",
    "vartype": "real parameter"
  },
  "effmass": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "one.",
    "definition": "EFFective MASS ",
    "section": "vardev",
    "text": "<p>\n<br>This parameter allows to change the electron mass, with respect to its\nexperimental value.\n",
    "vartype": "real number  "
  },
  "efield": {
    "category": " ",
    "default": "3*0.0 .",
    "definition": "Electric FIELD ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=4,\na finite electric field calculation is performed. The value\nof this electric field, and its direction is determined by <b>efield</b>.\nIt must be given in atomic units (1 a.u. of electric field= 514220624373.482 V/m, see note below),\nin cartesian coordinates.\n<p>\nReferences for the calculation under electric field (based on multi k point Berry phase) :\n<ul>\n<li> Nunes and Vanderbilt, PRL 73, 712 (1994) : real-space version of the finite-field Hamiltonian </li>\n<li> Nunes and Gonze, PRB 63, 155107 (2001) : reciprocal-space version of the finite-field Hamiltonian\n(the one presently implemented), and extensive theoretical analysis </li>\n<li> Souza, Iniguez and Vanderbilt, PRL 89, 117602 (2003) : implementation of the finite-field Hamiltonian\n(reciprocal-space version)</li>\n<li> Zwanziger, Galbraith, Kipouros, Torrent, Giantomassi and Gonze, Comp. Mater. Sci. 58, 113 (2012) : extension\nto PAW formalism </li>\n</ul>\nSee also Umari, Gonze, Pasquarello, PRL 90, 027401 (2003).\n<p>\nThe atomic unit of electric field strength is :\ne_Cb/(4 pi eps0 a0**2), where e_Cb is the electronic charge in Coulomb (1.60217653e-19),\neps0 is the electric constant (8.854187817d-12 F/m), and a0 is the Bohr radius\nin meter (0.5291772108e-10).\n",
    "vartype": "real array efield(3)  "
  },
  "elph2_imagden": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>,'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>'",
    "default": "0.0 Ha.",
    "definition": "ELectron-PHonon interaction at 2nd order : IMAGina y shoft of the DENominator ",
    "section": "varrf",
    "text": "<p>\nOnly relevant if <a href=\"varrf.html#ieig2rf\">ieig2rf</a> is non-zero, that is, if the user is performing performing second-order eigenvalue calculations using response-functions. <br><br>The variable <b>elph2_imagden</b> determines the imaginary shift of the denominator of the sum-over-states\nin the perturbation denominator, (e_{nk}-e_{n'k'}+i <b>elph2_imagden</b>).\nOne should use a width comparable with the Debye frequency or the maximum phonon frequency.<br>Can be\nspecified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n",
    "vartype": "real parameter "
  },
  "enunit": {
    "category": " ",
    "default": "0 (eigenvalues in hartree and phonon frequencies in hartree and cm-1).",
    "definition": "ENergy UNITs ",
    "section": "vargs",
    "text": "<p>\nGoverns the units to be used for\noutput of eigenvalues (and eventual phonon frequencies)\n<ul>\n<li>0=>print eigenvalues in hartree;</li>\n<li>1=>print eigenvalues in eV; </li>\n<li>2=>print eigenvalues in both hartree and eV.  </li>\n</ul>\nIf phonon frequencies are to be computed :\n<ul>\n<li>0=> phonon frequencies in Hartree and cm-1; </li>\n<li>1=> phonon frequencies in eV and THz; </li>\n<li>2=> phonon frequencies in hartree, eV, cm-1, Thz and Kelvin.</li>\n</ul>",
    "vartype": "integer parameter  "
  },
  "eshift": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>  ",
    "default": "zero.",
    "definition": "Energy SHIFT ",
    "section": "vardev",
    "text": "<p>\nUsed only if <a href=\"vardev.html#wfoptalg\">wfoptalg</a>=3 .\n<b>eshift</b> gives the shift of the energy used in the\nshifted Hamiltonian squared.\nThe algorithm will determine eigenvalues and eigenvectors centered\non <b>eshift</b>.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n",
    "vartype": "real number  "
  },
  "esmear": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>,'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>'   ",
    "default": "0.04 Ha.",
    "definition": "Eigenvalue SMEARing ",
    "section": "varrf",
    "text": "<p>\nOnly relevant if <a href=\"varrf.html#smdelta\">smdelta</a> = 1-5, that is, if the user is performing simulations of the electronic lifetimes induced by the electron-phonon coupling.\n<br><br>\nThe variable <b>esmear</b> determines the width of the functions approximating the delta function, \\delta(e_{nk}-e_{n'k'}),\npresent in the expression of the lifetimes. One should use a width comparable with the Debye frequency or the maximum phonon frequency.<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n",
    "vartype": "real parameter "
  },
  "etsfgroups": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "ETSF I/O additional GROUPS of variables",
    "section": "vardev",
    "text": "<p>NOTE : NOT USED AT PRESENT (v5.3.0)\n<p>This variable is a bit-wise combination of what will be written\ninto&nbsp;/&nbsp;read from a special WFK/DEN/POT file. The contents of the file\nfollow the <a href=\"http://www.etsf.eu/fileformats\">Nanoquanta/ETSF file format specifications</a>.</p>\n<p>Please check the \"etsf_io\" module of the ETSF I/O library for possible\nvalues.</p>\n",
    "vartype": "integer parameter "
  },
  "etsfmain": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "ETSF I/O MAIN variable",
    "section": "vardev",
    "text": "<p>NOTE : NOT USED AT PRESENT (v5.3.0)\n<p>This variable tells what will be written into&nbsp;/&nbsp;read from a\nspecial WFK/DEN/POT file. The contents of the file follow the\n<a href=\"http://www.etsf.eu/fileformats\">Nanoquanta/ETSF file format specifications</a>.</p>\n<p>Please check the \"etsf_io\" module of the ETSF I/O library for possible\nvalues.</p>\n",
    "vartype": "integer parameter "
  },
  "exchmix": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.25 ",
    "definition": "EXCHange MIXing",
    "section": "vardev",
    "text": "<p>\n<b>exchmix</b> allows to tune the ratio of exact exchange when\n<a href=\"varpaw.html#useexexch\">useexexch</a> is used. The default value of 0.25 corresponds to PBE0.\n",
    "vartype": "real number "
  },
  "exchn2n3d": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0. ",
    "definition": "EXCHange N2 and N3 Dimensions",
    "section": "vardev",
    "text": "<p>\nIf <b>exchn2n3d</b> is 1, the internal representation of the FFT arrays\nin reciprocal space will be array(n1,n3,n2), where the second and\nthird dimensions have been switched. This is to allow to be coherent with the\n<a href=\"vardev.html#exchn2n3d\">exchn2n3d</a>=4xx FFT treatment.\n",
    "vartype": "integer parameter "
  },
  "f4of2_sla": {
    "category": "",
    "default": "0.625 for d electron and 0.6681 for f electron",
    "definition": "F4 Over F2 ratio of Slater integrals ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and\n<a href=\"varpaw.html#usepawu\">usepawu</a>=1  or\n<a href=\"vardev.html#usedmft\">usedmft</a>=1  .<br>\nThis gives the ratio of Slater Integrals F4 and F2.\nIt is used in DFT+U or DFT+DMFT for the calculation of the orbital\ndependent screened coulomb interaction.\n",
    "vartype": "real parameter"
  },
  "f6of2_sla": {
    "category": "",
    "default": "0.4943",
    "definition": "F6 Over F2 ratio of Slater integrals ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and\n(<a href=\"varpaw.html#usepawu\">usepawu</a>=1  or\n<a href=\"vardev.html#usedmft\">usedmft</a>=1) and\n<a href=\"varpaw.html#lpawu\">lpawu</a>=3) .<br>\nThis gives the ratio of Slater Integrals F6 and F2.\nIt is used with <a href=\"varpaw.html#f4of2_sla\">f4of2_sla</a>=3) .<br>\nin DFT+U or DFT+DMFT for the calculation of the orbital\ndependent screened coulomb interaction.\n",
    "vartype": "real parameter"
  },
  "fband": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0.125 in case <a href=\"varbas.html#occopt\">occopt</a>==1 (insulating case), 0.500 for other values of <a href=\"varbas.html#occopt\">occopt</a> (metallic case) and 0. in wavelet case. Not used in case <a href=\"varbas.html#occopt\">occopt</a>==0 or 2.",
    "definition": "Factor for the number of BANDs ",
    "section": "vargs",
    "text": "<p>\nGoverns the number of bands to be used in the code in the case\nthe parameter <a href=\"varbas.html#nband\">nband</a> is not defined in the input file\n(which means that <a href=\"varbas.html#occopt\">occopt</a> is not equal to 0 or 2).\n<p>In case <b>fband</b> is 0.0d0, the code computes from\nthe pseudopotential files and the geo data\ncontained in the input file, the number of electrons\npresent in the system. Then, it computes the minimum\nnumber of bands that can accomodate them, and use\nthat value for <a href=\"varbas.html#nband\">nband</a>.\n<br>In case <b>fband</b> differs from\nzero, other bands will be added, just\nlarger than <b>fband</b> times the number of atoms.\nThis parameter is not echoed in the top of the main\noutput file, but only the parameter <a href=\"varbas.html#nband\">nband</a> that it allowed\nto compute. It is also not present in the dtset array (no internal).\n<br>The default values are chosen such as to give naturally some\nconduction bands. This improves the robustness of the code,\nsince this allows to identify lack of convergence coming from\n(near-)degeneracies at the Fermi level. In the metallic\ncase, the number of bands generated might be too small\nif the smearing factor is large. The occupation numbers\nof the higher bands should be small enough such as to\nneglect higher bands. It is difficult to automate\nthis, so a fixed default value has been chosen.",
    "vartype": "real parameter, positive or zero  "
  },
  "fermie_nest": {
    "category": " ",
    "default": "0",
    "definition": "FERMI Energy for printing the NESTing function ",
    "section": "vardev",
    "text": "<p>\nThis input variable is only effective when <a href=\"vardev.html#prtnest\">prtnest</a>=1. The energy is relative to the calculated fermi energy.\n",
    "vartype": "real parameter  "
  },
  "fft_opt_lob": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1. If <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1, default is 2.",
    "definition": "Fast Fourier Transform parallelisation - OPTion for LOB algorithm ",
    "section": "vardev",
    "text": "<p>\nOption for LOB algorithm, used in the band/FFT/k-point parallelisation,\nsee <a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npkpt\">npkpt</a>, and <a href=\"varpar.html#paral_kgb\">paral_kgb</a>.\n<ul>\n<li> =1 : old implementation </li>\n<li> =2 : new implementation : the\ncalls to getghc are made in parallel on a set of bands\n<a href=\"vardev.html#nbdblock\">nbdblock</a> :\nthe aim is to reduce the number of collective communications. This is\nnot yet implemented in lobpcgwf. </li>\n</ul>\n",
    "vartype": "integer "
  },
  "fftalg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "112, except for VPP Fujitsu, for which the Default is 111, and for NEC, for which the default is 200. Moreover, if the FFTW3 library has been enabled, the default becomes 312, EXCEPT if <a href=\"vardev.html#usedmft\">usedmft</a> is non-zero for at least one dataset. <br> Finally, If <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1, <b>fftalg</b> is automatically set to 401, with the hightest precedence.",
    "definition": "Fast Fourier Transform ALGorithm ",
    "section": "vardev",
    "text": "<p>\nThis keyword is <b>irrelevant</b> when Fast Fourier Transforms are done using <b>Graphics Processing Units</b> (GPU),\ni.e. when <a href=\"varpar.html#use_gpu_cuda\">use_gpu_cuda</a>=1 (in that case, it is ignored).\n<br><br>Allows to choose the algorithm\nfor Fast Fourier Transforms. These have to be used\nwhen applied to wavefunctions (routine fourwf.f),\nas well as when\napplied to densities and potentials (routine fourdp.f).\nPresently, it is the concatenation of three digits,\nlabelled (A), (B) and (C).\n<br>\n<br>The first digit (A) is to be chosen among 1, 2, 3 and 4 :\n<ul>\n<li> 1=&gt; use FFT routines written by S. Goedecker.</li>\n<li> 2=&gt; use machine-dependent FFT algorithm, taken from the vendor\nlibrary, if it exists and if it has been implemented.\nThe bare <b>fftalg</b>=200 has little chance to be\nfaster than <b>fftalg</b>=112,\nbut it might be tried. Implementing library\nsubroutines with <b>fftalg</b>/=200 has not yet been done.\nCurrently implemented library subroutines (<b>fftalg</b>=200)\nare:\n<ul>\n<li>      on HP, z3dfft from Veclib; </li>\n<li>      on DEC Alpha, zfft_3d from DXML;</li>\n<li>      on NEC, ZFC3FB from ASL lib;</li>\n<li>      on SGI, zfft3d from complib.sgimath</li>\n</ul>\n</li>\n\n<li>\n3=&gt; use serial or multi-threaded FFTW fortran routines (<a href=\"http://www.fftw.org\">http://www.fftw.org</a>).\nCurrently implemented with <b>fftalg</b>=300.</li>\n<li> 4=&gt; use FFT routines written by S. Goedecker, 2002 version, that will\nbe suited for MPI and OpenMP parallelism.</li>\n</ul>\nThe second digit (B) is related to fourdp.f :\n<ul>\n<li> 0=&gt; only use Complex-to-complex FFT</li>\n<li> 1=&gt; real-to-complex is also allowed (only coded for A==1)</li>\n</ul>\nThe third digit (C) is related to fourwf.f :\n<ul>\n<li> 0=&gt; no use of zero padding </li>\n<li> 1=&gt; use of zero padding (only coded for A==1 and A==4)</li>\n<li> 2=&gt; use of zero padding, and also combines actual\nFFT operations (using 2 routines from S. Goedecker)\nwith important pre- and post-processing\noperations, in order to maximize cache data reuse.\nThis is very efficient for cache architectures.\n(coded for A==1 and A==4, but A==4 is not yet sufficiently tested)</li>\n</ul>\nInternal representation as <a href=\"vargs.html#ngfft\">ngfft</a>(7).",
    "vartype": "integer parameter "
  },
  "fftcache": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "16. Not yet machine-dependent.",
    "definition": "Fast Fourier Transform CACHE size ",
    "section": "vardev",
    "text": "<p>\nGives the cache size of the current\nmachine, in Kbytes.\n<br>Internal representation as <a href=\"vargs.html#ngfft\">ngfft</a>(8).",
    "vartype": "integer parameter "
  },
  "fftgw": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "21.",
    "definition": "FFT for GW calculation",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\nThe basic ingredients needed to perform both a screening and a sigma calculation are the so-called\noscillator matrix elements defined as\n\n<br><br> $<\n<B>k-q</B>, b1 | e^{-i (<B>q+G</B>).<B>r</B>} | <B>k</B> b2 >$ &nbsp;&nbsp;&nbsp;1)\n<br><br>\n\nIn reciprocal space, Eq.1 is given by a convolution in which the number of reciprocal\nlattice vectors employed to describe the wavefunctions is given\nby <a href=\"vargw.html#ecutwfn\">ecutwfn</a>\nTn the case of screening calculations, the number of <B>G</B> vectors in Eq.1 is defined\nby <a href=\"vargw.html#ecuteps\">ecuteps</a>,\nwhile <a href=\"vargw.html#ecutsigx\">ecutsigx</a> defined the number of <B>G</B> used in sigma calculations.\nTo improve the efficiency of the code, the oscillator matrix elements are evaluated\nin real space through FFT techniques, and the <b>fftgw</b> input variable is used to select the FFT\nmesh to be used.\n<p>\n<b>fftgw</b> is the concatenation of two digits, labelled (A) and (B) whose value is internally used\nto define the value of  <a href=\"vargs.html#ngfft\">ngfft</a>(1:3) (see the setmesh.F90 routine).\n<p>\nThe first digit (A) defines the augmentation of the FFT grid. Possible values are 1, 2 and 3.\n\n<ul>\n<li> 0 =&gt; Use the FFT grid specified by the user through <a href=\"vargs.html#ngfft\">ngfft</a>(1:3) </li>\n<li> 1 =&gt; Use a coarse FFT grid which encloses a sphere in reciprocal space whose radius depends\non the largest value between\n<a href=\"vargw.html#ecutwfn\">ecutwfn</a> and <a href=\"vargw.html#ecuteps\">ecuteps</a> </li>\n<li> 2 =&gt;  Use a slightly augmented FFT which is sufficient for the correct treatment of the\nconvolution\n<li> 3 =&gt; Doubled FFT grid (same mesh as that used for GS calculations).</li>\n</ul>\n\n<p>\nThe second digit (B) can be chosen between 0 and 1. It defines whether a FFT grid compatible with all\nthe symmetries of the space group must be enforced or not:\n\n<ul>\n<li> 0 =&gt; Use the smallest FFT mesh which is compatible with the FFT library (faster, save memory\nbut is less accurate)</li>\n<li> 1 =&gt; Enforce a FFT grid which is compatible with all the symmetry operations of the space\ngroup. This method leads to an increase both of CPU time and memory, but the matrix elements\nare more accurate since the symmetry properties of the system are preserved.</li>\n</ul>\n\nThe behaviour of ABINIT before v5.5 corresponds to the default value 11.\n",
    "vartype": "integer parameter  "
  },
  "freqim_alpha": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "5.0",
    "definition": "FREQuencies along the IMaginary axis ALPHA parameter",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, self-energy calculations.\n<p>\n<b>freqim_alpha</b> is used only for numerical integration of the GW self-energy\n(<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).\n<br>\n<b>freqim_alpha</b> determines the location of the maximum frequency point along the imaginary axis\nif the default grid is used in Contour Deformation (numerical integration) calculations. It is set\nas <span style=\"font-family:Times,Serif\"><i>&alpha;&middot;&omega;<sub>p<sub></i></span>, where\n<span style=\"font-family:Times,Serif\"><i>&omega;<sub>p<sub></i></span> is the plasma frequency\ndetermined by the average density of the system (this can be set by hand by using the variable <a href=\"vargw.html#ppmfrq\">ppmfrq</a>). See the section on grids in the descriptive text for <a href=\"vargw.html#cd_frqim_method\">cd_frqim_method</a> for a detailed description of the formula.\n\n",
    "vartype": "real parameter  "
  },
  "freqremax": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0.0",
    "definition": "FREQuencies along the Real axis MAXimum",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>freqremax</b> is used only for numerical integration of the GW self-energy\n(<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).\n<br>\n<b>freqremax</b> sets the maximum real frequency used to calculate the dielectric matrix in order\nto perform the numerical integration of the GW self-energy.\n<b>freqremax</b>, <a href=\"vargw.html#freqremin\">freqremin</a> and <a href=\"vargw.html#nfreqre\">nfreqre</a>\ndefine the spacing of the frequency mesh along the real axis.\n",
    "vartype": "real parameter  "
  },
  "freqremin": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0.0",
    "definition": "FREQuencies along the Real axis MINimum",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>freqremin</b> is used only for numerical integration of the GW self-energy\n(<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).\n<br>\n<b>freqremin</b> sets the minimum real frequency used to calculate the dielectric matrix in order\nto perform the numerical integration of the GW self-energy.\n<b>freqremin</b> can be used to split a wide frequency interval into smaller subintervals that\ncan be calculated independently.\nThe different subintervals can then be merged together with the <B>Mrgscr</B> utility thus obtaining\na single screening file that can used for self-energy calculations.\n\nNote that <a href=\"vargw.html#freqremax\">freqremax</a>, <a href=\"vargw.html#freqremin\">freqremin</a>\nand <a href=\"vargw.html#nfreqre\">nfreqre</a> define the spacing of the frequency mesh along the real axis.\n\n",
    "vartype": "real parameter  "
  },
  "freqspmax": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0.0",
    "definition": "FREQuencies for the SPectral function MAXimum",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>freqspmax</b> sets the maximum real frequency used to calculate the spectral function\nfrom the GW Green's function. <a href=\"vargw.html#freqspmin\">freqspmin</a>, <b>freqspmax</b> and\n<a href=\"vargw.html#nfreqsp\">nfreqsp</a> define the spacing of an equidistant frequency mesh along\nthe real axis. Alternatively, the variables <a href=\"vargw.html#gw_customnfreqsp\">gw_customnfreqsp</a> and\n<a href=\"vargw.html#gw_freqsp\">gw_freqsp</a> can be used to make a user-defined grid.\n\n",
    "vartype": "real parameter  "
  },
  "freqspmin": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "-<a href=\"vargw.html#freqspmax\">freqspmax</a>",
    "definition": "FREQuencies for the SPectral function MINimum",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>freqspmin</b> sets the minimum real frequency used to calculate the spectral function\nfrom the GW Green's function. <b>freqspmin</b> is set to -<a href=\"vargw.html#freqspmax\">freqspmax</a>\nif left undefined. <b>freqspmin</b>, <a href=\"vargw.html#freqspmax\">freqspmax</a>, and\n<a href=\"vargw.html#nfreqsp\">nfreqsp</a> define the spacing of an equidistant frequency mesh along\nthe real axis. Alternatively, the variables <a href=\"vargw.html#gw_customnfreqsp\">gw_customnfreqsp</a> and\n<a href=\"vargw.html#gw_freqsp\">gw_freqsp</a> can be used to make a user-defined grid.\n",
    "vartype": "real parameter  "
  },
  "freqsusin": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.0",
    "definition": "FREQuencies for the SUSceptibility matrix : the INcrement ",
    "section": "vardev",
    "text": "<p>\nDefine, with\n<a href=\"vardev.html#freqsuslo\">freqsuslo</a>, the series of imaginary frequencies at which\nthe susceptibility matrix should be computed.\n<br>This is still under development.\n",
    "vartype": "real parameter, positive or zero "
  },
  "freqsuslo": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.0",
    "definition": "FREQuencies for the SUSceptibility matrix : the LOwest frequency ",
    "section": "vardev",
    "text": "<p>\nDefine, with\n<a href=\"vardev.html#freqsusin\">freqsusin</a>,\nthe series of imaginary frequencies at which\nthe susceptibility matrix should be computed.\n<br>This is still under development.\n",
    "vartype": "real parameter, positive or zero "
  },
  "friction": {
    "category": "",
    "default": "0.001 ",
    "definition": "internal FRICTION coefficient ",
    "section": "varrlx",
    "text": "<p>\nGives the internal friction coefficient (atomic units)\nfor Langevin dynamics (when <a href=\"varrlx.html#ionmov\">ionmov</a>=9):\nfixed temperature simulations with random forces.\n<p>The equation of motion is :<br>\nM<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>\n- <b>friction</b> M<sub>I</sub> dR<sub>I</sub>/dt - F_random<sub>I</sub>\n<br>\nwhere F_random<sub>I</sub> is a Gaussian random force with average\nzero,\nand variance 2 <b>friction</b> M<sub>I</sub> kT.\n<br>\nThe atomic unit of friction is\nhartrees*electronic mass*(atomic time units)/Bohr<sup>2</sup>. See J.\nChelikowsky, J. Phys. D : Appl Phys. 33(2000)R33.\n",
    "vartype": "real parameter "
  },
  "frzfermi": {
    "category": "        ",
    "default": "0.",
    "definition": "FReeZe FERMI energy",
    "section": "varrf",
    "text": "<p>\nCan be used to suppress artificially the first-order change of\nFermi energy, in case of Response Function calculation\nfor metals at Q=0. This change is needed, but was not computed prior to v4.4 .\nIts calculation has been implemented by DHamann. The input variable <b>frzfermi</b>,\nif set to 1, allows to recover the previous, incorrect behaviour.\n",
    "vartype": "integer parameter"
  },
  "fxcartfactor": {
    "category": "",
    "default": "(Bohr^2)/Hartree ",
    "definition": "Forces to (X) CARTesian coordinates FACTOR ",
    "section": "varrlx",
    "text": "<p>\nThe forces multiplied\nby <b>fxcartfactor</b> will be treated like difference in cartesian coordinates in the\nprocess of optimization. This is a simple preconditioner.\n<br> TO BE UPDATED See (<a href=\"varrlx.html#ionmov\">ionmov</a>=2,\nnon-zero\n<a href=\"varrlx.html#optcell\">optcell</a>).\nFor example, the stopping criterion defined by\n<a href=\"varrlx.html#tolmxf\">tolmxf</a> relates to these scaled\nstresses.\n",
    "vartype": "real parameter "
  },
  "ga_algor": {
    "category": "",
    "default": "1 ",
    "definition": "Genetic Algorithm selection",
    "section": "varrlx",
    "text": "<p>\nChoosing method to make the structure selection. Only the enthalpy is used now but we\nplan to include, energy, electronic band gap and alchemical potentials. Right now only value of 1 (enthalpy)\nworks.\n",
    "vartype": "integer"
  },
  "ga_fitness": {
    "category": "",
    "default": "1 ",
    "definition": "Genetic Algorithm FITNESS function selection",
    "section": "varrlx",
    "text": "<p>\nDifferent methodologies to perform the roulette-wheel selection of parents. Even though, the\nobjective function is the crystalline enthalpy (H_i), the weight of the population elements to be chosen from\nin a roulette-wheel selection can be given through different functions. We consider the following cases.\n<br>\n1. F = H_i / Sum H_i\n<br>\n2. F = exp(-(H_i-H_min)) / Sum exp(-(H_i-H_min))\n<br>\n3. F = (1/n_i) / Sum (1/n_i). Where n_i is the position in the ordered list of enthalpies\n",
    "vartype": "integer"
  },
  "ga_n_rules": {
    "category": "",
    "default": "1 ",
    "definition": "Genetic Algorithm Number of RULES",
    "section": "varrlx",
    "text": "<p>\nDifferent genetic rules have been implemented and the user has the change to choose between any of them.\nRight now we have 4 rules. See <a href=\"varbas.html#rprim\">ga_rules</a>\n",
    "vartype": "integer"
  },
  "ga_opt_percent": {
    "category": "",
    "default": "0.2 ",
    "definition": "Genetic Algorithm OPTIMAL PERCENT",
    "section": "varrlx",
    "text": "<p>\nPercentage of the population that according to the fitness function passes\nto the following iteration.\n",
    "vartype": "double"
  },
  "ga_rules": {
    "category": "",
    "default": "1 ",
    "definition": "Genetic Algorithm RULES",
    "section": "varrlx",
    "text": "<p>\nDifferent genetic rules have been implemented and the user has the change to choose between any of them.\nThe chosen number of rules have been defined in <a href=\"varbas.html#rprim\">ga_n_rules</a>\n<br>\n<br>\nImplemented rules are\n<br>\n1) crossover. Two parents are randomly chosen and two springs are mixed from the two by (a) chosing randomly (through\nFitness function) two parents and then randomly rotating and shifting the coordinates withing that particular cell.\n(b) Slice every one of the unit cell of the parents along a random direction and creating the spring offs from the\npieces of the two parents.\n<br>\n2) Vector flip mutation. From the coordinates from a given parent, a piece of it is inverted.\n<br>\n3) random strain.  A random anisotropic deformation is given to the unit cell.\n<br>\n4) Coordinates mutation of 1/4 of the whole coordinates.\n<br>\n",
    "vartype": "integer vector"
  },
  "genafm": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>  ",
    "default": "3*0.",
    "definition": "GENerator of the translation for Anti-FerroMagnetic space group",
    "section": "vargeo",
    "text": "<p>\nThis input variable might be used to define a Shubnikov type IV magnetic space group (anti-ferromagnetic\nspace group). The user is advised to consult\n\"The mathematical theory of symmetry in solids,\nRepresentation theory for point groups and space groups, 1972,\nC.J. Bradley and A.P. Cracknell, Clarendon Press, Oxford.\"\n<br>A Shubnikov type IV magnetic space group might be defined by its Fedorov space group\n(set of spatial symmetries, that do not change the magnetisation), and\none translation associated with a change of magnetisation.\n<b>genafm</b> is precisely this translation, in reduced coordinates (like <a href=\"varbas.html#xred\">xred</a>)\n<br>Thus, one way to specify a Shubnikov IV magnetic space group, is to define both\n<a href=\"vargeo.html#spgroup\">spgroup</a> and <b>genafm</b>. Alternatively, one might\ndefine <a href=\"vargeo.html#spgroup\">spgroup</a> and <a href=\"vargeo.html#spgroupma\">spgroupma</a>,\nor define by hand the set of symmetries, using <a href=\"varbas.html#symrel\">symrel</a>,\n<a href=\"varbas.html#tnons\">tnons</a> and <a href=\"vargs.html#symafm\">symafm</a>\n",
    "vartype": "real genafm(3) "
  },
  "get1den": {
    "category": " ",
    "default": "0.",
    "definition": "GET the first-order density from _DEN file ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#optdriver\">optdriver</a>=5.\nIndicate the files from which first-order densities must be obtained,\nin multi-dataset mode (in single dataset mode, use\n<a href=\"varfil.html#irdden\">ird1den</a>).\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "get1wf": {
    "category": " ",
    "default": "0.",
    "definition": "GET the first-order wavefunctions from _1WF file ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(in the multi-dataset mode), to indicate\nstarting wavefunctions, as an alternative to <a href=\"varfil.html#irdwfk\">irdwfk</a>,\n<a href=\"varfil.html#irdwfk\">irdwfq</a>,\n<a href=\"varfil.html#irdwfk\">ird1wf</a>,\nor <a href=\"varfil.html#irdwfk\">irdddk</a>. One should first read the\nexplanations given for these latter variables.\n<br>\nThe <b>getwfk</b>, <b>getwfq</b>, <b>get1wf</b> and <b>getddk</b> variables are typically\nused to chain the calculations in the multi-dataset mode,\nsince they describe from which dataset the OUTPUT\nwavefunctions are to be taken, as INPUT wavefunctions\nof the present dataset.\n<br><br>We now focus on the <b>getwfk</b> input variable (the only\none used in ground-state calculations), but\nthe rules for <b>getwfq</b> and <b>get1wf</b> are similar, with _WFK\nreplaced by _WFQ or _1WF.\n<br>If <b>getwfk</b>==0, no use of previously computed output\nwavefunction file appended with _DSx_WFK is done.\n<br>If <b>getwfk</b> is positive, its value gives the index of the dataset\nfor which the output wavefunction file appended with _WFK\nmust be used.\n<br>If <b>getwfk</b> is -1, the output wf file with _WFK\nof the previous dataset must be taken,\nwhich is a frequently occuring case.\n<br>If <b>getwfk</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed wavefunction file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the wavefunctions are not initialised from\na disk file, so that it is as if <b>getwfk</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getwfk</b> -1 is rather\nstraightforward : except for the first wavefunctions, that\nare not initialized by reading a disk file, the output\nwavefunction of one dataset is input of the next one.\n<br>In the case of a ddk calculation in a multidataset\nrun, in order to compute\ncorrectly the localisation tensor, it is mandatory to\ndeclare give getddk the value of the current dataset\n(i.e. getddk3 3 ) - this is a bit strange and\nshould be changed in the future.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getbscoup": {
    "category": " ",
    "default": "0.",
    "definition": "GET the Bethe-Salpeter COUPling block from ... ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and, in the case of a Bethe-Salpeter\ncalculation to indicate that the starting coupling block of the excitonic Hamiltonian will be taken from the output of a previous dataset.\nIt is used to chain the calculations, since it describes from which dataset the OUTPUT coupling\nblock is to be taken, as INPUT of the present dataset.\n<br>If <b>getbscoup</b>==0, no such use of previously computed coupling block file is done.\n<br>If <b>getbscoup</b> is positive, its value gives the index of the dataset to be used as input.\n<br>If <b>getbscoup</b> is -1, the output of the previous dataset must be taken, which is a frequently occuring case.\n<br>If <b>getbscoup</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existant data set (prior to the first), the coupling block is not initialised from\na disk file, so that it is as if <b>getbscoup</b>=0 for that initialisation.\n",
    "vartype": "integer "
  },
  "getbseig": {
    "category": " ",
    "default": "0.",
    "definition": "GET the Bethe-Salpeter EIGenstates from ... ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and, in the case of a Bethe-Salpeter\ncalculation to indicate that the starting excitonic eigenstates are to be taken from the output of a previous dataset.\nIt is used to chain the calculations, since it describes from which dataset the OUTPUT eigenstates\nare to be taken, as INPUT eigenstates of the present dataset.\n<br>If <b>getbseig</b>==0, no such use of previously computed output eigenstates file is done.\n<br>If <b>getbseig</b> is positive, its value gives the index of the dataset\nfrom which the output states is to be used as input.\n<br>If <b>getbseig</b> is -1, the output eigenstates of the previous dataset\nmust be taken, which is a frequently occuring case.\n<br>If <b>getbseig</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existant data set (prior to the first), the eigenstates are not initialised from\na disk file, so that it is as if <b>getbseig</b>=0 for that initialisation.\n",
    "vartype": "integer "
  },
  "getbsreso": {
    "category": " ",
    "default": "0.",
    "definition": "GET the Bethe-Salpeter RESOnant block from ... ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and, in the case of a Bethe-Salpeter\ncalculation to indicate that the starting resonant block of the excitonic Hamiltonian will be taken from the output of a previous dataset.\nIt is used to chain the calculations, since it describes from which dataset the OUTPUT resonant\nblock is to be taken, as INPUT of the present dataset.\n<br>If <b>getbsreso</b>==0, no such use of previously computed resonant block file is done.\n<br>If <b>getbsreso</b> is positive, its value gives the index of the dataset to be used as input.\n<br>If <b>getbsreso</b> is -1, the output of the previous dataset must be taken, which is a frequently occuring case.\n<br>If <b>getbsreso</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existant data set (prior to the first), the resonant block is not initialised from\na disk file, so that it is as if <b>getbsreso</b>=0 for that initialisation.\n",
    "vartype": "integer "
  },
  "getcell": {
    "category": "",
    "default": "0.",
    "definition": "GET CELL parameters from ... ",
    "section": "varrlx",
    "text": "<p>\nThis variable is typically used to chain the\ncalculations,\nin the multi-dataset mode (<a href=\"varbas.html#ndtset\">ndtset</a>&gt;0),\nsince it describes from which dataset <a href=\"varbas.html#acell\">acell</a>\nand\n<a href=\"varbas.html#rprim\">rprim</a> are to be taken, as input of the\npresent\ndataset. The cell parameters are EVOLVING variables,\nfor which such a chain of calculations is useful.\n<br>\nIf ==0, no use of previously computed values must occur.\n<br>\nIf it is positive, its value gives the index of the dataset\nfrom which the data are to be used as input data.\nIt must be the index of a dataset already computed in the\nSAME run.\n<br>\nIf equal to -1, the output data of the previous dataset\nmust be taken, which is a frequently occuring case.\nHowever, if the first dataset is treated, -1 is equivalent\nto 0, since no dataset has yet been computed in the same run.\n<br>\nIf another negative number, it indicates the number\nof datasets to go backward to find the needed data\n(once again, going back beyond the first dataset is equivalent\nto using a null get variable).\n",
    "vartype": "integer parameter, an instance of a 'get' variable. "
  },
  "getddk": {
    "category": " ",
    "default": "0.",
    "definition": "GET the ddk wavefunctions from _1WF file ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(in the multi-dataset mode), to indicate\nstarting wavefunctions, as an alternative to <a href=\"varfil.html#irdwfk\">irdwfk</a>,\n<a href=\"varfil.html#irdwfk\">irdwfq</a>,\n<a href=\"varfil.html#irdwfk\">ird1wf</a>,\nor <a href=\"varfil.html#irdwfk\">irdddk</a>. One should first read the\nexplanations given for these latter variables.\n<br>\nThe <b>getwfk</b>, <b>getwfq</b>, <b>get1wf</b> and <b>getddk</b> variables are typically\nused to chain the calculations in the multi-dataset mode,\nsince they describe from which dataset the OUTPUT\nwavefunctions are to be taken, as INPUT wavefunctions\nof the present dataset.\n<br><br>We now focus on the <b>getwfk</b> input variable (the only\none used in ground-state calculations), but\nthe rules for <b>getwfq</b> and <b>get1wf</b> are similar, with _WFK\nreplaced by _WFQ or _1WF.\n<br>If <b>getwfk</b>==0, no use of previously computed output\nwavefunction file appended with _DSx_WFK is done.\n<br>If <b>getwfk</b> is positive, its value gives the index of the dataset\nfor which the output wavefunction file appended with _WFK\nmust be used.\n<br>If <b>getwfk</b> is -1, the output wf file with _WFK\nof the previous dataset must be taken,\nwhich is a frequently occuring case.\n<br>If <b>getwfk</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed wavefunction file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the wavefunctions are not initialised from\na disk file, so that it is as if <b>getwfk</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getwfk</b> -1 is rather\nstraightforward : except for the first wavefunctions, that\nare not initialized by reading a disk file, the output\nwavefunction of one dataset is input of the next one.\n<br>In the case of a ddk calculation in a multidataset\nrun, in order to compute\ncorrectly the localisation tensor, it is mandatory to\ndeclare give getddk the value of the current dataset\n(i.e. getddk3 3 ) - this is a bit strange and\nshould be changed in the future.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getden": {
    "category": " ",
    "default": "0.",
    "definition": "GET the DENsity from ... ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and, in the case of a ground-state\ncalculation, if <a href=\"varbas.html#iscf\">iscf</a>&lt;0 (non-SCF calculation),\nto indicate that the starting density is to be taken\nfrom the output of a previous dataset.\nIt is used to chain the calculations,\nsince it describes from which dataset the OUTPUT density\nare to be taken, as INPUT density of the present dataset.\n<br>If <b>getden</b>==0, no such use of previously computed output\ndensity file is done.\n<br>If <b>getden</b> is positive, its value gives the index of the dataset\nfrom which the output density is to be used as input.\n<br>If <b>getden</b> is -1, the output density of the previous dataset\nmust be taken, which is a frequently occuring case.\n<br>If <b>getden</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existant data set (prior\nto the first), the density is not initialised from\na disk file, so that it is as if <b>getden</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getden</b> -1 is rather\nstraightforward : except for the first density, that\nis not initialized by reading a disk file, the output\ndensity of one dataset is input of the next one.\n<br>Be careful : the output density file of a run with\nnon-zero <a href=\"varrlx.html#ionmov\">ionmov</a> does not have the proper name (it has a \"TIM\"\nindication) for use as an input of an <a href=\"varbas.html#iscf\">iscf</a>&lt;0 calculation.\n<br>One should use the output density of a <a href=\"varrlx.html#ionmov\">ionmov</a>==0 run.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getgam_eig2nkq": {
    "category": "",
    "default": "0.  ",
    "definition": "GET the GAMma phonon data EIG2NKQ from dataset ",
    "section": "vardev",
    "text": "<p>\nOnly relevant if <a href=\"varrf.html#ieig2rf\">ieig2rf</a> is non-zero, that is, if the user is performing performing second-order eigenvalue calcul\nations using response-functions. Also, relevant only for non-zero wavevectors <a href=\"vargs.html#qpt\">qpt</a>\n<br><br>From the electron-phonon matrix elements at some wavevector only, it is not possible to determine the Debye-Wallercontribution : one has to know also the q=Gamma electron-phonon matrix elements.\n<br>\nThe variable <b>getgam_eig2nkq</b> allows to transmit the information about the second-order derivatives of the\neigenvalues for q=Gamma from the dataset where the calculation at Gamma was done, to the datasets\nfor other wavevectors.\n",
    "vartype": "integer parameter "
  },
  "gethaydock": {
    "category": " ",
    "default": "0.",
    "definition": "GET the Haydock restart file from ... ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and, in the case of a Bethe-Salpeter\ncalculation to indicate that the Haydock iterative technique will be restarted from the output of a previous dataset.\n<br>If <b>gethaydock</b>==0, no such use of previously computed coupling block file is done.\n<br>If <b>gethaydock</b> is positive, its value gives the index of the dataset to be used as input.\n<br>If <b>gethaydock</b> is -1, the output of the previous dataset must be taken, which is a frequently occuring case.\n<br>If <b>gethaydock</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existant data set (prior to the first), the coupling block is not initialised from\na disk file, so that it is as if <b>gethaydock</b>=0 for that initialisation.\n",
    "vartype": "integer "
  },
  "getkss": {
    "category": "GW  ",
    "default": "0.",
    "definition": "GET Kohn-Sham Structure from ... ",
    "section": "varfil",
    "text": "<p>\nUsed when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4\n(a GW calculation),\nto indicate that the KSS wavefunction file is to be taken\nfrom the output of a previous dataset.\nIt is used to chain the calculations,\nsince it describes from which dataset the OUTPUT wavefunctions\nare to be taken, as INPUT of the present dataset.\n<br>If <b>getkss</b>==0, no such use of previously computed output\nKSS file is done.\n<br>If <b>getkss</b> is positive, its value gives the index of the dataset\nfrom which the output KSS file is to be used as input.\n<br>If <b>getkss</b> is -1, the output KSS file of the previous dataset\nmust be taken, which is a frequently occuring case.\n<br>If <b>getkss</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the KSS file is not initialised from\na disk file, so that it is as if <b>getkss</b>=0 for that\ninitialisation.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getocc": {
    "category": " ",
    "default": "0.",
    "definition": "GET OCC parameters from ... ",
    "section": "varfil",
    "text": "<p>\nThis variable is typically used to chain the calculations,\nin the multi-dataset mode (<a href=\"varbas.html#ndtset\">ndtset</a>>0),\nsince it describes from which dataset the array <a href=\"vargs.html#occ\">occ</a>\nis to be taken, as input of the present\ndataset. The occupation numbers are EVOLVING variables,\nfor which such a chain of calculations is useful.\n<br>If ==0, no use of previously computed values must occur.\n<br>If it is positive, its value gives the index of the dataset\nfrom which the data are to be used as input data.\nIt must be the index of a dataset already computed in the\nSAME run.\n<br>If equal to -1, the output data of the previous dataset\nmust be taken, which is a frequently occuring case.\nHowever, if the first dataset is treated, -1 is equivalent\nto 0, since no dataset has yet been computed in the same run.\n<br>If another negative number, it indicates the number\nof datasets to go backward to find the needed data\n(once again, going back beyond the first dataset is equivalent\nto using a null get variable).\n<br>NOTE that a non-zero <b>getocc</b> MUST be used with <a href=\"varbas.html#occopt\">occopt</a>==2,\nso that the number of bands has to be initialized for\neach k point. Of course, these numbers of bands must be\nidentical with the numbers of bands of the dataset from which\n<a href=\"vargs.html#occ\">occ</a> will be copied. The same is true for the number of k points.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter, an instance of a 'get' variable "
  },
  "getqps": {
    "category": "GW ",
    "default": "0.",
    "definition": "GET QuasiParticle Structure ",
    "section": "varfil",
    "text": "<p>\nUsed when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and <a href=\"vargs.html#optdriver\">optdriver</a>=3, or 4\n(screening or sigma step of a GW calculation),\nto indicate that the eigenvalues and possibly the wavefunctions have to be\ntaken from a previous quasiparticle calculation (instead of the usual LDA starting\npoint). This is to achieve quasiparticle self-consistency.\nSee also <a href=\"varfil.html#irdqps\">irdqps</a>\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getscr": {
    "category": "GW ",
    "default": "0.",
    "definition": "GET SCReening (the inverse dielectric matrix) from ... ",
    "section": "varfil",
    "text": "<p>\nUsed when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and <a href=\"vargs.html#optdriver\">optdriver</a>=4\n(sigma step of a GW calculation),\nto indicate that the dielectric matrix (_SCR file) is to be taken\nfrom the output of a previous dataset.\nIt is used to chain the calculations,\nsince it describes from which dataset the OUTPUT dielectric matrix\nis to be taken, as INPUT of the present dataset.\n<br>If <b>getscr</b>==0, no such use of previously computed output\n_SCR file is done.\n<br>If <b>getscr</b> is positive, its value gives the index of the dataset\nfrom which the output _SCR file is to be used as input.\n<br>If <b>getscr</b> is -1, the output _SCR file of the previous dataset\nmust be taken, which is a frequently occuring case.\n<br>If <b>getscr</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the _SCR file is not initialised from\na disk file, so that it is as if <b>getscr</b>=0 for that\ninitialisation.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getsuscep": {
    "category": "GW ",
    "default": "0.",
    "definition": "GET SUSCEPtibility (the irreducible polarizability) from ... ",
    "section": "varfil",
    "text": "<p>\nUsed when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(multi-dataset mode) and <a href=\"vargs.html#optdriver\">optdriver</a>=4\n(sigma step of a GW calculation),\nto indicate that the irreducible polarizability (_SUSC file) is to be taken\nfrom the output of a previous dataset.\nIt is used to chain the calculations, since it describes from which dataset the OUTPUT susceptibility\nis to be taken, as INPUT of the present dataset.\nPerforming a GW calculations starting from the _SUSC file instead of the _SCR file presents\nthe advantage that starting from the irreducible polarizability, one can calculate the screened interaction\nusing different expressions without having to perform a screening calculation from scratch.\nFor example, it is possible to apply a cutoff to the Coulomb interaction in order\nto facilitate the convergence of the GW correction with respect to the size of the supercell\n(see <a href=\"vargw.html#vcutgeo\">vcutgeo</a> and <a href=\"vargw.html#icutcoul\">icutcoul</a>)\n\n<br>If <b>getsuscep</b>==0, no such use of previously computed output _SUSC file is done.\n<br>If <b>getsuscep</b> is positive, its value gives the index of the dataset\nfrom which the output _SUSC file is to be used as input.\n<br>If <b>getsuscep</b> is -1, the output _SUSC file of the previous dataset\nmust be taken, which is a frequently occuring case.\n<br>If <b>getsuscep</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the _SUSC file is not initialised from\na disk file, so that it is as if <b>getsuscep</b>=0 for that\ninitialisation.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getvel": {
    "category": "",
    "default": "0.",
    "definition": "GET VEL from ... ",
    "section": "varrlx",
    "text": "<p>\nThese variables are typically used to chain the\ncalculations,\nin the multi-dataset mode (<a href=\"varbas.html#ndtset\">ndtset</a>&gt;0)\nsince they describe from which dataset the corresponding\noutput variables are to be taken, as input of the present\ndataset. The atomic positions and velocities are EVOLVING variables,\nfor which such a chain of calculation is useful.\n<br>\nNote that the use of <b>getxcart</b> and <b>getxred</b> differs when\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#rprim\">rprim</a>\nare different from one dataset\nto the other.\n<br>\nIf ==0, no use of previously computed values must occur.\n<br>\nIf it is positive, its value gives the index of the dataset\nfrom which the data are to be used as input data.\nIt must be the index of a dataset already computed in the\nSAME run.\n<br>\nIf equal to -1, the output data of the previous dataset\nmust be taken, which is a frequently occuring case.\nHowever, if the first dataset is treated, -1 is equivalent\nto 0, since no dataset has yet been computed in the same run.\n<br>\nIf another negative number, it indicates the number\nof datasets to go backward to find the needed data\n(once again, going back beyond the first dataset is equivalent\nto using a null get variable).\n<br>\nNote : <b>getxred</b> and <b>getxcart</b> cannot be simultaneously\nnon-zero for the same dataset. On the other hand the use of\n<b>getvel</b> with <b>getxred</b> is allowed, despite the different\ncoordinate system.\n",
    "vartype": "integer parameters, instances of 'get' variables "
  },
  "getwfk": {
    "category": " ",
    "default": "0.",
    "definition": "GET the wavefunctions from _WFK file ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(in the multi-dataset mode), to indicate\nstarting wavefunctions, as an alternative to <a href=\"varfil.html#irdwfk\">irdwfk</a>,\n<a href=\"varfil.html#irdwfk\">irdwfq</a>,\n<a href=\"varfil.html#irdwfk\">ird1wf</a>,\nor <a href=\"varfil.html#irdwfk\">irdddk</a>. One should first read the\nexplanations given for these latter variables.\n<br>\nThe <b>getwfk</b>, <b>getwfq</b>, <b>get1wf</b> and <b>getddk</b> variables are typically\nused to chain the calculations in the multi-dataset mode,\nsince they describe from which dataset the OUTPUT\nwavefunctions are to be taken, as INPUT wavefunctions\nof the present dataset.\n<br><br>We now focus on the <b>getwfk</b> input variable (the only\none used in ground-state calculations), but\nthe rules for <b>getwfq</b> and <b>get1wf</b> are similar, with _WFK\nreplaced by _WFQ or _1WF.\n<br>If <b>getwfk</b>==0, no use of previously computed output\nwavefunction file appended with _DSx_WFK is done.\n<br>If <b>getwfk</b> is positive, its value gives the index of the dataset\nfor which the output wavefunction file appended with _WFK\nmust be used.\n<br>If <b>getwfk</b> is -1, the output wf file with _WFK\nof the previous dataset must be taken,\nwhich is a frequently occuring case.\n<br>If <b>getwfk</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed wavefunction file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the wavefunctions are not initialised from\na disk file, so that it is as if <b>getwfk</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getwfk</b> -1 is rather\nstraightforward : except for the first wavefunctions, that\nare not initialized by reading a disk file, the output\nwavefunction of one dataset is input of the next one.\n<br>In the case of a ddk calculation in a multidataset\nrun, in order to compute\ncorrectly the localisation tensor, it is mandatory to\ndeclare give getddk the value of the current dataset\n(i.e. getddk3 3 ) - this is a bit strange and\nshould be changed in the future.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getwfkfine": {
    "category": " ",
    "default": "0.",
    "definition": "GET the fine grid wavefunctions from _WFK file ",
    "section": "vardev",
    "text": "Eventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(in the multi-dataset mode), to indicate\nstarting wavefunctions, as an alternative to\n<a href=\"vardev.html#irdwfkfine\">irdwfkfine</a>. One should first read the\nexplanations given for these latter variables.\n<br>\nThe <b>getwfkfine</b> variables is typically used to chain the calculations\nin the multi-dataset mode, since they describe from which dataset the OUTPUT\nwavefunctions are to be taken, as INPUT wavefunctions\nof the present dataset.\n<br>If <b>getwfkfine</b>==0, no use of previously computed output\nwavefunction file appended with _DSx_WFK is done.\n<br>If <b>getwfkfine</b> is positive, its value gives the index of the dataset\nfor which the output wavefunction file appended with _WFK\nmust be used.\n<br>If <b>getwfkfine</b> is -1, the output wf file with _WFK\nof the previous dataset must be taken,\nwhich is a frequently occuring case.\n<br>If <b>getwfkfine</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed wavefunction file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the wavefunctions are not initialised from\na disk file, so that it is as if <b>getwfkfine</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getwfkfine</b> -1 is rather\nstraightforward : except for the first wavefunctions, that\nare not initialized by reading a disk file, the output\nwavefunction of one dataset is input of the next one.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>getwfkfine</b> or <a href=\"vardev.html#irdwfkfine\">irdwfkfine</a> MUST be non-zero</li>\n<li>if <b>getwfkfine</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>Reading the fine grid wavefunction will trigger the k-points interpolation technique of the temperature dependent\ncalculations. </li>\n</ul>\n\nBethe-Salpeter calculation :\n<ul>\n<li>one and only one of <b>getwfkfine</b> or <a href=\"vardev.html#irdwfkfine\">irdwfkfine</a> MUST be non-zero</li>\n<li>if <b>getwfkfine</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>This variable or <a href=\"vardev.html#irdwfkfine\">irdwfkfine</a> is mandatory when bs_interp_mode = 1 </li>\n</ul>\n\n<b>This variable is experimental. In development.</b>\n",
    "vartype": "integer parameter "
  },
  "getwfq": {
    "category": " ",
    "default": "0.",
    "definition": "GET the wavefunctions from _WFQ file ",
    "section": "varfil",
    "text": "<p>\nEventually used when <a href=\"varbas.html#ndtset\">ndtset</a>>0\n(in the multi-dataset mode), to indicate\nstarting wavefunctions, as an alternative to <a href=\"varfil.html#irdwfk\">irdwfk</a>,\n<a href=\"varfil.html#irdwfk\">irdwfq</a>,\n<a href=\"varfil.html#irdwfk\">ird1wf</a>,\nor <a href=\"varfil.html#irdwfk\">irdddk</a>. One should first read the\nexplanations given for these latter variables.\n<br>\nThe <b>getwfk</b>, <b>getwfq</b>, <b>get1wf</b> and <b>getddk</b> variables are typically\nused to chain the calculations in the multi-dataset mode,\nsince they describe from which dataset the OUTPUT\nwavefunctions are to be taken, as INPUT wavefunctions\nof the present dataset.\n<br><br>We now focus on the <b>getwfk</b> input variable (the only\none used in ground-state calculations), but\nthe rules for <b>getwfq</b> and <b>get1wf</b> are similar, with _WFK\nreplaced by _WFQ or _1WF.\n<br>If <b>getwfk</b>==0, no use of previously computed output\nwavefunction file appended with _DSx_WFK is done.\n<br>If <b>getwfk</b> is positive, its value gives the index of the dataset\nfor which the output wavefunction file appended with _WFK\nmust be used.\n<br>If <b>getwfk</b> is -1, the output wf file with _WFK\nof the previous dataset must be taken,\nwhich is a frequently occuring case.\n<br>If <b>getwfk</b> is a negative number, it indicates the number\nof datasets to go backward to find the needed wavefunction file.\nIn this case, if one refers to a non existent data set (prior\nto the first), the wavefunctions are not initialised from\na disk file, so that it is as if <b>getwfk</b>=0 for that\ninitialisation.\nThanks to this rule, the use of <b>getwfk</b> -1 is rather\nstraightforward : except for the first wavefunctions, that\nare not initialized by reading a disk file, the output\nwavefunction of one dataset is input of the next one.\n<br>In the case of a ddk calculation in a multidataset\nrun, in order to compute\ncorrectly the localisation tensor, it is mandatory to\ndeclare give getddk the value of the current dataset\n(i.e. getddk3 3 ) - this is a bit strange and\nshould be changed in the future.\n<br>NOTE : a negative value of a \"get\" variable indicates the number of datasets to go backwards;\nit is not the number to be subtracted from the current dataset to find the proper dataset.\nAs an example : <pre>ndtset 3   jdtset 1 2 4  getXXX -1</pre> refers to dataset 2 when dataset 4 is initialized.\n",
    "vartype": "integer parameter "
  },
  "getxcart": {
    "category": "",
    "default": "0.",
    "definition": "GET XCART from ... ",
    "section": "varrlx",
    "text": "<p>\nThese variables are typically used to chain the\ncalculations,\nin the multi-dataset mode (<a href=\"varbas.html#ndtset\">ndtset</a>&gt;0)\nsince they describe from which dataset the corresponding\noutput variables are to be taken, as input of the present\ndataset. The atomic positions and velocities are EVOLVING variables,\nfor which such a chain of calculation is useful.\n<br>\nNote that the use of <b>getxcart</b> and <b>getxred</b> differs when\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#rprim\">rprim</a>\nare different from one dataset\nto the other.\n<br>\nIf ==0, no use of previously computed values must occur.\n<br>\nIf it is positive, its value gives the index of the dataset\nfrom which the data are to be used as input data.\nIt must be the index of a dataset already computed in the\nSAME run.\n<br>\nIf equal to -1, the output data of the previous dataset\nmust be taken, which is a frequently occuring case.\nHowever, if the first dataset is treated, -1 is equivalent\nto 0, since no dataset has yet been computed in the same run.\n<br>\nIf another negative number, it indicates the number\nof datasets to go backward to find the needed data\n(once again, going back beyond the first dataset is equivalent\nto using a null get variable).\n<br>\nNote : <b>getxred</b> and <b>getxcart</b> cannot be simultaneously\nnon-zero for the same dataset. On the other hand the use of\n<b>getvel</b> with <b>getxred</b> is allowed, despite the different\ncoordinate system.\n",
    "vartype": "integer parameters, instances of 'get' variables "
  },
  "getxred": {
    "category": "",
    "default": "0.",
    "definition": "GET XRED from ... ",
    "section": "varrlx",
    "text": "<p>\nThese variables are typically used to chain the\ncalculations,\nin the multi-dataset mode (<a href=\"varbas.html#ndtset\">ndtset</a>&gt;0)\nsince they describe from which dataset the corresponding\noutput variables are to be taken, as input of the present\ndataset. The atomic positions and velocities are EVOLVING variables,\nfor which such a chain of calculation is useful.\n<br>\nNote that the use of <b>getxcart</b> and <b>getxred</b> differs when\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#rprim\">rprim</a>\nare different from one dataset\nto the other.\n<br>\nIf ==0, no use of previously computed values must occur.\n<br>\nIf it is positive, its value gives the index of the dataset\nfrom which the data are to be used as input data.\nIt must be the index of a dataset already computed in the\nSAME run.\n<br>\nIf equal to -1, the output data of the previous dataset\nmust be taken, which is a frequently occuring case.\nHowever, if the first dataset is treated, -1 is equivalent\nto 0, since no dataset has yet been computed in the same run.\n<br>\nIf another negative number, it indicates the number\nof datasets to go backward to find the needed data\n(once again, going back beyond the first dataset is equivalent\nto using a null get variable).\n<br>\nNote : <b>getxred</b> and <b>getxcart</b> cannot be simultaneously\nnon-zero for the same dataset. On the other hand the use of\n<b>getvel</b> with <b>getxred</b> is allowed, despite the different\ncoordinate system.\n",
    "vartype": "integer parameters, instances of 'get' variables "
  },
  "goprecon": {
    "category": "",
    "default": "0 ",
    "definition": "Geometry Optimization PREconditioner equations",
    "section": "varrlx",
    "text": "<p>\nSet the kind of preconditioner to be used for Geometry Optimization\n<br>\n(Note : Under development now (2011.05.20))\n<ul>\n<li><b>goprecon</b>=0 : No preconditioner</li>\n<li><b>goprecon</b>=[1-9] : Linear preconditioner</li>\n<li><b>goprecon</b>=[11-19] : Non-linear preconditioner</li>\n</ul>\n<br>\n",
    "vartype": "integer parameter"
  },
  "goprecprm": {
    "category": "",
    "default": "0 ",
    "definition": "Geometry Optimization PREconditioner PaRaMeters equations",
    "section": "varrlx",
    "text": "<p>\nSet the paramenters use by the preconditioner to be\nused for Geometry Optimization\n<br>\n(Note : Under development now (2011.06.06))\n",
    "vartype": "real array of 3 elements"
  },
  "gpu_linalg_limit": {
    "category": "",
    "default": "2000000.  ",
    "definition": "GPU (Cuda): LINear ALGebra LIMIT ",
    "section": "varpar",
    "text": "<p>\nOnly relevant if <a href=\"varpar.html#use_gpu_cuda\">use_gpu_cuda</a>=1, that is, if ABINIT is used with CUDA functionality.<br><br>\nUse of linear algebra and matrix algebra on GPU is only efficient if the size of the involved matrices is large enough.\nThe <b>gpu_linalg_limit</b> parameter defines the threshold above which linear (and matrix) algebra operations\nare done on the Graphics Processing Unit.<br>\nThe considered matrix size is equal to:<br>\n<li>SIZE=(<a href=\"varint.html#mpw\">mpw</a>*<a href=\"vargs.html#nspinor\">nspinor</a>/\n<a href=\"varpar.html#npspinor\">npspinor</a>)*\n(<a href=\"varpar.html#npband\">npband</a>*<a href=\"varpar.html#bandpp\">bandpp</a>)**2\n</li><br>\nWhen SIZE>=<b>gpu_linalg_limit</b>, <a href=\"vardev.html#wfoptalg\">wfoptalg</a> parameter is\nautomatically set to 14 which corresponds to the use of LOBPCG algorithm for the calculation of the eigenstates.\n",
    "vartype": "integer parameter "
  },
  "gw_customnfreqsp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "GW CUSTOM SPectral FREQuencies",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>gw_customnfreqsp</b> lets the user define the gridpoints along the real frequency axis by hand\nfor the calculation of the self-energy along the real axis. Set this to the number of frequencies\nyou want. The frequencies are specified with <a href=\"vargw.html#gw_freqsp\">gw_freqsp</a>.\n",
    "vartype": "integer "
  },
  "gw_eet": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "-1 ",
    "definition": "GW Effective Energy Technique ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>gw_eet</b> governs the use of the effective energy technique (EET).\nWith the EET GW calculations can be performed without summing over the empty states, both in the calculation of the screening and the self-energy.\nThis is achieved by using a single effective energy that takes into account the contributions of all the empty states.\nSee J.A. Berger, L. Reining, and, F. Sottile, Phys. Rev. B (82), 041103(R) (2010) for a more detailed description of the method.\n<ul>\n<li> <b>gw_eet</b> = -1, no effective energy technique is used\n<li> <b>gw_eet</b> = 0, 1, or 2 an effective energy is used. These numbers correspond to the order of the approxiation for the effective energy as given in Eqs. (10), (11), and (12), respectively, in J.A. Berger, L. Reining, and, F. Sottile, Phys. Rev. B (82), 041103(R) (2010). The higher the order, the more accurate (in principle) is the result. However, also the calculation time of the effective energy will increase.\n</ul>\n",
    "vartype": "integer "
  },
  "gw_eet_inclvkb": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW Effective Energy Technique INCLude VKB ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations\nand if <a href=\"vargw.html#gw_eet\">gw_eet</a>=1 or 2\n<p>\n<b>gw_eet_inclvkb</b> governs the use of the commutator of the non-local part of the pseudo-potential in determining the effective energy of the EET.\n<ul>\n<li> <b>gw_eet_inclvkb</b> = 0 the commutator is not included\n<li> <b>gw_eet_inclvkb</b> = 1 the commutator is included\n</ul>\n",
    "vartype": "integer "
  },
  "gw_eet_nband": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "-1 ",
    "definition": "GW Effective Energy Technique Number of BANDs ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations\nand if <a href=\"vargw.html#gw_eet\">gw_eet</a>=0, 1, or 2\n<p>\n<b>gw_eet_nband</b> governs the number of bands to be used in the effective energy technique (EET). It will only be taken into account if it is higher than the number of occupied bands. If this is not the case, summations will only include occupied states.\n",
    "vartype": "integer "
  },
  "gw_eet_scale": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "1 ",
    "definition": "GW Effective Energy Technique SCALE ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations\nand if <a href=\"vargw.html#gw_eet\">gw_eet</a>=0, 1, or 2\n<p><b>gw_eet_scale</b> sets the prefactor with which the effective energy can be scaled to\nobtain a faster convergence with respect to the number of empty states.\n",
    "vartype": "real parameter "
  },
  "gw_freqsp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "none",
    "definition": "GW SPectral FREQuencies ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is sigma calculations.\n<p>\n<b>gw_freqsp</b> specifies the grid points for the real frequency axis when the real and imaginary\n(spectral funtion) parts of sigma are calculated explicitly for post-processing or plotting.\nOnly activated if\n<a href=\"vargw.html#gw_customnfreqsp\">gw_customnfreqsp</a> is not equal to 0. The number of frequencies\nis set by the value of <a href=\"vargw.html#gw_customnfreqsp\">gw_customnfreqsp</a>. Example:\n<pre>\ngw_customnfreqsp   5\nnfreqsp            5\ngw_freqsp         -0.5  -0.1  0.0  1.0  10.0 eV\n</pre>\nIf <a href=\"vargw.html#nfreqsp\">nfreqsp</a> is not equal to\n<a href=\"vargw.html#gw_customnfreqsp\">gw_customnfreqsp</a> a warning will be issued.\n</p>\n",
    "vartype": "real array gw_freqsp(gw_customnfreqsp)"
  },
  "gw_frqim_inzgrid": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "Contour Deformation Imaginary Frequencies Inverse Z Grid",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>gw_frqim_inzgrid</b> creates gridpoints along the <b>imaginary</b> frequency axis by using an\nequidistant grid in the variable\n<span style=\"font-family:Times,Serif\"><i>z &sub; [0,1]</i></span>\nwhere the transform is:\n<p align=\"center\">\n<img style=\"width: 122px; height: 38px;\" src=\"./vargw_img/cd_inzgrid.png\">\n</p>\n<p>Here <span style=\"font-family:Times,Serif\"><i>&omega;<sub>p</sub></i></span> is the\nplasma frequency (default can be overridden by setting <a href=\"vargw.html#ppmfrq\">ppmfrq</a>).\nThe equidistant grid in z is determined uniquely by <a href=\"vargw.html#nfreqim\">nfreqim</a>) and\nthe points are distributed so that half of them lie below the plasma frequency.\n",
    "vartype": "integer "
  },
  "gw_frqre_inzgrid": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "Contour Deformation Real Frequencies Inverse Z Grid",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>gw_frqre_inzgrid</b> creates gridpoints along the <b>real</b> frequency axis by using an\nequidistant grid in the variable\n<span style=\"font-family:Times,Serif\"><i>z &sub; [0,1]</i></span>\nwhere the transform is:\n<p align=\"center\">\n<img style=\"width: 122px; height: 38px;\" src=\"./vargw_img/cd_inzgrid_re.png\">\n</p>\n<p>Here <span style=\"font-family:Times,Serif\"><i>&omega;<sub>p</sub></i></span> is the\nplasma frequency (default can be overridden by setting <a href=\"vargw.html#ppmfrq\">ppmfrq</a>).\nThe equidistant grid in z is determined uniquely by <a href=\"vargw.html#nfreqim\">nfreqre</a>) and\nthe points are distributed so that half of them lie below the plasma frequency. This is useful in\nconjuction with <a href=\"vargw.html#gw_frqim_inzgrid\">gw_frqim_inzgrid</a> if one needs to use a grid\nwhich maps <span style=\"font-family:Times,Serif\"><i>[0,&#8734;[ &rarr; [0,1]</i></span>. Note that\ntypically <i>many</i> more points are needed along the real axis in order to properly resolve\npeak structures. In contrast, both the screening and self-energy are very smooth along the\nimaginary axis. Also, please note that this is <b>not</b> an efficient grid for <b>standard</b>\nContour Deformation calculations, where typically only a smaller range of frequencies near the\norigin is required. The maximum value needed along the real frequency axis is output in the\nlogfile during Contour Deformation sigma calculations.\n",
    "vartype": "integer "
  },
  "gw_frqre_tangrid": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0 (off)",
    "definition": "Contour Deformation Use Tangent Grid ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nand <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=2, 12 or 22.\n<p>\n<b>gw_frqre_tangrid</b> defines a nonuniform grid to be used in frequency, with stepsize increasing\nproportional to tan(x). This makes the grid approximately linear to start with, with a rapid increase\ntowards the end. Also, this is the grid which gives equal importance to each point used in the integration\nof a function which decays as 1/x^2. To be used in conjuction with <a href=\"vargw.html#nfreqre\">nfreqre</a>,\n<a href=\"vargw.html#cd_max_freq\">cd max_freq</a> and <a href=\"vargw.html#cd_halfway_freq\">cd halfway_freq</a>\nwhich determine the parameters of the transformed grid.\n",
    "vartype": "integer "
  },
  "gw_nqlwl": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "1 ",
    "definition": "GW, Number of Q-points for the Long Wave-Length Limit ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,4,99 that is, screening, sigma or BS\ncalculations, althought the actual meaning of the variable depends on the particular run-level (see\ndiscussion below).\n<p>\n<b>gw_nqlwl</b> defines the number of directions in reciprocal space used to describe the non-analytical behaviour\nof the heads (G = G'=0) and the wings (G=0 or G'=0) of the dielectric matrix in the optical limit\n(i.e. for q tending to zero).\nThe number of directions is specified by the additional variable <a href=\"vargw.html#gw_qlwl\">gw_qlwl</a>.\n<p>\nWhen <a href=\"vargs.html#optdriver\">optdriver</a>=3, <b>gw_nqlwl</b> and <b>gw_qlwl</b> define\nthe set of \"small\" q that will be calculated and stored in the final SCR file. Therefore, the two\nvariables can be used to analyze how the optical spectra depend on the direction\nof the incident phonon (useful especially in anisotropic systems).\n<p>\nWhen <a href=\"vargs.html#optdriver\">optdriver</a>=4, <b>gw_nqlwl</b> and <b>gw_qlwl</b> can be used\nto specify the heads and the wings to be used to perform the quadrature of the correlated\npart of the self-energy in the small region around the origin.\n(NB: not yet available, at present the quadrature is performed using a single direction in q-space)\n<p>\nWhen <a href=\"vargs.html#optdriver\">optdriver</a>=99, <b>gw_nqlwl</b> and <b>gw_qlwl</b> define\nthe set of directions in q-space along which the macroscopic dielectric function is evaluated.\nBy default the BS code calculates the macroscopic dielectric function using six different\ndirections in q-space (the three basis vectors of the reciprocal lattice and the three Cartesian axis).\n",
    "vartype": "integer "
  },
  "gw_nstep": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "30 ",
    "definition": "GW Number of self-consistent STEPS ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=8, that is, self-consistent GW calculations.\n<p>\nGives the maximum number of self-consistent GW cycles (or \"iterations\").\nin which G and/or W will be updated until the quasi-particle energied are converged\nwithin <a href=\"vargw.html#gw_toldfeig\">gw_toldfeig</a>.\n<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a> and <a href=\"vargw.html#gw_sctype\">gw_sctype</a> are\nused to define the type of self-consistency.\n",
    "vartype": "integer "
  },
  "gw_qlwl": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0.00001 0.00002 0.00003",
    "definition": "GW, Q-points for the Long Wave-Length Limit ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,4 that is, screening or sigma calculations.\n<p>\nWhen <a href=\"vargs.html#optdriver\">optdriver</a>=3,\n<b>gw_qlwl</b> defines the set of q-points around Gamma that are considered during the evaluation\nof the non-analytical behaviour of the dielectrix matrix. Optical spectra (with and without\nnon-local field effects) are evaluated for each direction specified by <b>gw_qlwl</b>.\n<p>\n",
    "vartype": "real array gw_qlwl(3,<a href=\"vargw.html#gw_nqlwl\">gw_nqlwl</a>) "
  },
  "gw_sctype": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 so that no choice is done",
    "definition": "GW, Self-Consistency TYPE ",
    "section": "vargw",
    "text": "<p>\nThis variable is used to partially define the kind of self-consistency for GW calculations.\nThe other piece of information is given by <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>\nthat defines the particular approximation for the self-energy operator as well as whether the\nwavefunctions have to replaced by quasi-particle amplitudes.\n<p>\nIf <b>gw_sctype</b> is specified in the input file, the code will perform an iterative update\nof the quantities entering the GW equations until the quasi-particle energies are converged\nwithin <a href=\"vargw.html#gw_toldfeig\">gw_toldfeig</a>. The maximum number of iterations is\nspecified by <a href=\"vargw.html#gw_nstep\">gw_nstep</a>.\nPossible values are:\n<ul>\n<li>  1 =&gt; standard one-shot method (one screening calculation followed by a single sigma run)\n<li>  2 =&gt; self-consistency only on W (iterative update of W followed by a sigma run in which G\nis approximated with the Kohn-Sham independent-particle Green's function G0)\n<li>  3 =&gt; self-consistency only of G (a single screening calculation to obtain the Kohn-Sham\npolarizability followed by an iterative update of the Green's functions in the self-energy)\n<li>  4 =&gt; fully self-consistent algorithm (iterative update of both G and W)\n</ul>\n\nIt is possible to initialize the self-consistent procedure by reading a previously calculated\nSCR or SUSC file via the variables <a href=\"varfil.html#getscr\">getscr</a> or\n<a href=\"varfil.html#getsuscep\">getsuscep</a>, respectively.\n<a href=\"varfil.html#getqps\">getqps</a> can be used to read a previous QPS file thus initializing\nthe Green's functions to be used in the first self-consistent iteration.\n\n",
    "vartype": "integer "
  },
  "gw_sigxcore": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW, treatment of the ... ",
    "section": "vargw",
    "text": "<p>\nOnly available for PAW and relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4 that is, sigma calculations.\n<p>\nTheoretical introduction: GW calculations perfomed on top of electronic calculations relying\nwhen the frozen-core approximation is used to separate inner-core electrons from valence electrons,\nonly the contribution to the self-energy arising from valence electrons is explicitly accounted for.\nIn the standard approach based on pseudopotentials the contribution to the self-energy due to core electrons is approximated\nby means of the KS exchange-correlation potential generated by the core density.\nIn the case of GW calculations employing the PAW method, the core contribution to the self-energy\ncan be more accurately estimated in terms of the Fock operator generated by the core wavefunctions.\nIn the simplest approach, the only ingredients required for this more refined treatment are the wave\nfunctions of the core electrons in the reference atomic configuration that are calculated during the\ngeneration of the PAW setup. This is a good approximation provided that the core wave functions\nare strictly localized inside the PAW spheres.\n<p>\n<b>gw_sigxcore</b> defines the approximation used to evaluate the core contribution to sigma.\n<ul>\n<li> <b>gw_sigxcore</b> = 0, standard approach, the core contribution is approximated with vxc.\n<li> <b>gw_sigxcore</b> = 1, the core term is approximated with the Fock operator inside the PAW spheres.\n</ul>\n<p>\n",
    "vartype": "integer "
  },
  "gw_toldfeig": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.1 eV ",
    "definition": "GW TOLerance on the DiFference of the EIGenvalues ",
    "section": "vargw",
    "text": "<p>\nSets a tolerance for absolute differences of QP energies that will cause one self-consistent GW cycle to stop.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>toldfe</b> has the '<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics (1 Ha=27.2113845 eV)\n<br>Effective only when self-consistent GW calculations are done  (<a href=\"vargs.html#optdriver\">optdriver</a>=8).\n<p>\n",
    "vartype": "REAL "
  },
  "gwcalctyp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW CALCulation TYPe",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>gwcalctyp</b> governs the choice between the different capabilities of the GW code.\n\n<ul>\n<li>  0 &#60&#61 <b>gwcalctyp</b> &#60&#61  9 : standard \"1 shot\" quasiparticle method\n<li> 10 &#60&#61 <b>gwcalctyp</b> &#60&#61 19 : self-consistent quasiparticle method on energies only\n<li> 20 &#60&#61 <b>gwcalctyp</b> &#60&#61 29 : self-consistent quasiparticle method on energies and wavefunctions\n</ul>\n\n<p>\n<ul>\n<li> <b>gwcalctyp</b> &#61 0, 10, or 20 : standard Plasmon-Pole model GW calculation\n<li> <b>gwcalctyp</b> &#61 2, 12, or 22 : GW calculation using numerical integration\n(contour deformation method, see e.g. S. Lebegue <i> et al.</i> PRB <b>67</b>, 155208 (2003).)\n<li> <b>gwcalctyp</b> &#61 5, 15, or 25 : Hartree-Fock calculation\n<li> <b>gwcalctyp</b> &#61 6, 16, or 26 : Screened Exchange calculation\n<li> <b>gwcalctyp</b> &#61 7, 17, or 27 : COHSEX calculation\n<li> <b>gwcalctyp</b> &#61 8, 18, or 28 : model GW calculation\nfollowing S. Faleev <i>et al.</i> PRL <b>93</b>, 126406 (2004) using a Plasmon-Pole model\n<li> <b>gwcalctyp</b> &#61 9, 19, or 29 : model GW calculation\nfollowing S. Faleev <i>et al.</i> PRL <b>93</b>, 126406 (2004) using numerical integration\n(contour deformation method)\n</ul>\n\n<p>\nAlso\n<ul>\n<li> <b>gwcalctyp</b> &#61 105,125 : HSE06 calculations (1-shot and self-consistent)\n<li> <b>gwcalctyp</b> &#61 205,225 : PBE0 calculations  (1-shot and self-consistent)\n<li> <b>gwcalctyp</b> &#61 305,325 : B3LYP calculations (1-shot and self-consistent)\n\n</ul>\n\n",
    "vartype": "integer parameter"
  },
  "gwcomp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW COMPletness ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>gwcomp</b> governs the use of an extrapolar approximation. If <b>gwcomp</b>==1, one improves the completeness\nin a truncated sum over states. In practice, this permits one to reduce quite much the number of\nbands required in the calculation of the screening or of the self-energy.\nThe energy parameter\nneeded in the extrapolar approximation is set by <a href=\"vargw.html#gwencomp\">gwencomp</a>.\nSee F. Bruneval, X. Gonze, Phys. Rev. B 78, 085125 (2008) for a description of the methodology.\n",
    "vartype": "integer "
  },
  "gwencomp": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "2. ",
    "definition": "GW Energy for COMPletness ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations,\nwhen <a href=\"vargw.html#gwcomp\">gwcomp</a> is equal to 1.\n<p>\n<b>gwencomp</b> sets the energy parameter used in the extrapolar approximation used to improve\ncompleteness and make the convergence against the number of bands much faster.\n<p>\nSee F. Bruneval, X. Gonze, Phys. Rev. B 78, 085125 (2008) for a description of the methodology.\n",
    "vartype": "energy "
  },
  "gwgamma": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW Gamma ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nIf <b>gwgamma</b> is 1, the vertex correction will be included leading to what is known as \"GWGamma\" approximation.\nsee R. Del Sole, L. Reining, and R. W. Godby, Phys. Rev. B  49, 8024 (1994).\nNote that, in order to include the vertex correction in W, one has to start the sigma calculation\nfrom the susceptibility file_SUSC instead of the _SCR file (see <a href=\"varfil.html#getsuscep\">getsuscep</a>&nbsp;&nbsp;\nand <a href=\"varfil.html#irdsuscep\">irdsuscep</a>&nbsp;&nbsp;)\nNot available for PAW calculations.\n<p>\n",
    "vartype": "integer "
  },
  "gwmem": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "11 ",
    "definition": "GW MEMory ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,4, that is, sigma calculations.\n<p>\n<b>gwmem</b> governs the memory strategy during a screening and/or a sigma run.\n<ul>\n<li> <b>gwmem</b> = 1x , the screening matrix are read for all q-vectors and stored in the memory.\n<li> <b>gwmem</b> = 0x , the screening matrix are read just a q-vector after another.\n<br>\n<li> <b>gwmem</b> = x1 , the real-space wavefunctions are stored in the memory.\n<li> <b>gwmem</b> = x0 , the real-space wavefunctions are not stored, but rather recalculated on-fly each abinit needs them using FFTs.\n</ul>\nThe default is <b>gwmem</b> = 11, which is the fastest, but also the most memory consuming.\nWhen experiencing memory shortage, one should try <b>gwmem</b> = 0.\nThe first digit is only meaningful when performing sigma calculations.\n<p>\n",
    "vartype": "integer "
  },
  "gwpara": {
    "category": "GW, PARALLEL",
    "default": "1 <B>TODO: default should be 2</b>.",
    "definition": "GW PARAllelization level ",
    "section": "varpar",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>gwpara</b> is used to choose between the two different parallelization levels\navailable in the GW code. The available options are:\n\n<ul>\n<li> =1 =&gt; parallelisation on k points </li>\n<li> =2 =&gt; parallelisation on bands    </li>\n</ul>\n\n<p>\nAdditional notes:\n<br>\nIn the present status of the code, only the parallelization over bands (<b>gwpara</b>=2)\nallows to reduce the memory allocated by each processor.\n<br>\nUsing <b>gwpara</b>=1, indeed, requires the same amount of memory as a sequential run,\nirrespectively of the number of CPU's used.\n<p>\nA reduction of the requireed memory can be achieved by opting for an out-of-core solution\n(<a href=\"varfil.html#mkmem\">mkmem</a>=0, only coded for <a href=\"vargs.html#optdriver\">optdriver</a>=3)\nat the price of a drastic worsening of the performance.\n",
    "vartype": "integer "
  },
  "gwrpacorr": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "GW RPA CORRelation energy ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 and if <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=x1, i.e. a screening calculation for imaginary frequencies.\n<p>\n<b>gwrpacorr</b> governs the calculation of the RPA correlation energy.\n<ul>\n<li> <b>gwrpacorr</b> = 0, no RPA correlation energy is calculated\n<li> <b>gwrpacorr</b> = 1, the RPA correlation energy is calculated using an exact integration over the coupling constant: it requires one diagonalization of the polarizability matrix\n<li> <b>gwrpacorr</b> = <i>n</i> &gt 1, the RPA correlation energy is calculated using <i> n </i> values for the coupling constant: it requires <i>n</i> inversions of the polarizability matrix\n</ul>\n<p>\n",
    "vartype": "integer "
  },
  "iatcon": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 ",
    "definition": "Indices of AToms in CONstraint equations",
    "section": "varrlx",
    "text": "<p>\nGives the indices of the atoms appearing in each of the\n<a href=\"varrlx.html#nconeq\">nconeq</a>\nindependent equations constraining the motion of\natoms during structural optimization or molecular dynamics (see <a\nhref=\"varrlx.html#nconeq\">nconeq</a>, <a href=\"varrlx.html#natcon\">natcon</a>,\nand <a href=\"varrlx.html#wtatcon\">wtatcon</a>).\n<br>\n(Note : combined with wtatcon to give internal representation of the\nlatter - this should be described)\n",
    "vartype": "integer array iatcon(<a href=\"varrlx.html#natcon\">natcon</a>,<a href=\"varrlx.html#nconeq\">nconeq</a>)"
  },
  "iatfix": {
    "category": "<b>iatfixx</b>,<b>iatfixy</b> and <b>iatfixz</b> are <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default (ignored unless <a href=\"varrlx.html#natfix\">natfix</a>,<a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> &gt; 0).",
    "definition": "Indices of AToms that are FIXed ",
    "section": "varrlx",
    "text": "<p>\nGive the index (in the range 1 to <a\nhref=\"varbas.html#natom\">natom</a>)\nof each atom which is to\nbe held fixed for structural optimization or molecular dynamics.\nThe variable <b>iatfix</b> lists those fixed in the three directions,\nwhile the other variables allow to fix some atoms along\nx, y or z directions, or a combination of these.\n<p>WARNING : The implementation is inconsistent !! For <a\nhref=\"varrlx.html#ionmov\">ionmov</a>==1, the fixing of directions\nwas done in cartesian coordinates, while for the other values\nof <a href=\"varrlx.html#ionmov\">ionmov</a>, it was done in reduced\ncoordinates. Sorry for this.\n<p> There is no harm in fixing one atom in the three\ndirections\nusing <b>iatfix</b>, then fixing it again in other directions\nby mentioning it in <b>iatfixx</b>, <b>iatfixy</b> or <b>iatfixz</b>.\n<br>\nThe internal representation of these input data is done\nby the mean of one variable <b>iatfix</b>(3,<a href=\"varbas.html#natom\">natom</a>),\ndefined\nfor each direction and each atom, being 0 if the atom is\nnot fixed along the direction, and 1 if the atom is fixed\nalong the direction.\nWhen some atoms are fixed along 1 or 2 directions, the\nuse of symmetries is restricted to symmetry operations\nwhose (3x3) matrices <a href=\"varbas.html#symrel\">symrel</a> are\ndiagonal.\n<br>\nIf the geo builder is used, <b>iatfix</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).\n",
    "vartype": "integer arrays of length <a href=\"varrlx.html#natfix\">natfix</a>, <a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> "
  },
  "iatfixx": {
    "category": "<b>iatfixx</b>,<b>iatfixy</b> and <b>iatfixz</b> are <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default (ignored unless <a href=\"varrlx.html#natfix\">natfix</a>,<a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> &gt; 0).",
    "definition": "Indices of AToms that are FIXed along the X direction ",
    "section": "varrlx",
    "text": "<p>\nGive the index (in the range 1 to <a\nhref=\"varbas.html#natom\">natom</a>)\nof each atom which is to\nbe held fixed for structural optimization or molecular dynamics.\nThe variable <b>iatfix</b> lists those fixed in the three directions,\nwhile the other variables allow to fix some atoms along\nx, y or z directions, or a combination of these.\n<p>WARNING : The implementation is inconsistent !! For <a\nhref=\"varrlx.html#ionmov\">ionmov</a>==1, the fixing of directions\nwas done in cartesian coordinates, while for the other values\nof <a href=\"varrlx.html#ionmov\">ionmov</a>, it was done in reduced\ncoordinates. Sorry for this.\n<p> There is no harm in fixing one atom in the three\ndirections\nusing <b>iatfix</b>, then fixing it again in other directions\nby mentioning it in <b>iatfixx</b>, <b>iatfixy</b> or <b>iatfixz</b>.\n<br>\nThe internal representation of these input data is done\nby the mean of one variable <b>iatfix</b>(3,<a href=\"varbas.html#natom\">natom</a>),\ndefined\nfor each direction and each atom, being 0 if the atom is\nnot fixed along the direction, and 1 if the atom is fixed\nalong the direction.\nWhen some atoms are fixed along 1 or 2 directions, the\nuse of symmetries is restricted to symmetry operations\nwhose (3x3) matrices <a href=\"varbas.html#symrel\">symrel</a> are\ndiagonal.\n<br>\nIf the geo builder is used, <b>iatfix</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).\n",
    "vartype": "integer arrays of length <a href=\"varrlx.html#natfix\">natfix</a>, <a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> "
  },
  "iatfixy": {
    "category": "<b>iatfixx</b>,<b>iatfixy</b> and <b>iatfixz</b> are <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default (ignored unless <a href=\"varrlx.html#natfix\">natfix</a>,<a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> &gt; 0).",
    "definition": "Indices of AToms that are FIXed along the Y direction ",
    "section": "varrlx",
    "text": "<p>\nGive the index (in the range 1 to <a\nhref=\"varbas.html#natom\">natom</a>)\nof each atom which is to\nbe held fixed for structural optimization or molecular dynamics.\nThe variable <b>iatfix</b> lists those fixed in the three directions,\nwhile the other variables allow to fix some atoms along\nx, y or z directions, or a combination of these.\n<p>WARNING : The implementation is inconsistent !! For <a\nhref=\"varrlx.html#ionmov\">ionmov</a>==1, the fixing of directions\nwas done in cartesian coordinates, while for the other values\nof <a href=\"varrlx.html#ionmov\">ionmov</a>, it was done in reduced\ncoordinates. Sorry for this.\n<p> There is no harm in fixing one atom in the three\ndirections\nusing <b>iatfix</b>, then fixing it again in other directions\nby mentioning it in <b>iatfixx</b>, <b>iatfixy</b> or <b>iatfixz</b>.\n<br>\nThe internal representation of these input data is done\nby the mean of one variable <b>iatfix</b>(3,<a href=\"varbas.html#natom\">natom</a>),\ndefined\nfor each direction and each atom, being 0 if the atom is\nnot fixed along the direction, and 1 if the atom is fixed\nalong the direction.\nWhen some atoms are fixed along 1 or 2 directions, the\nuse of symmetries is restricted to symmetry operations\nwhose (3x3) matrices <a href=\"varbas.html#symrel\">symrel</a> are\ndiagonal.\n<br>\nIf the geo builder is used, <b>iatfix</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).\n",
    "vartype": "integer arrays of length <a href=\"varrlx.html#natfix\">natfix</a>, <a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> "
  },
  "iatfixz": {
    "category": "<b>iatfixx</b>,<b>iatfixy</b> and <b>iatfixz</b> are <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default (ignored unless <a href=\"varrlx.html#natfix\">natfix</a>,<a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> &gt; 0).",
    "definition": "Indices of AToms that are FIXed along the Z direction ",
    "section": "varrlx",
    "text": "<p>\nGive the index (in the range 1 to <a\nhref=\"varbas.html#natom\">natom</a>)\nof each atom which is to\nbe held fixed for structural optimization or molecular dynamics.\nThe variable <b>iatfix</b> lists those fixed in the three directions,\nwhile the other variables allow to fix some atoms along\nx, y or z directions, or a combination of these.\n<p>WARNING : The implementation is inconsistent !! For <a\nhref=\"varrlx.html#ionmov\">ionmov</a>==1, the fixing of directions\nwas done in cartesian coordinates, while for the other values\nof <a href=\"varrlx.html#ionmov\">ionmov</a>, it was done in reduced\ncoordinates. Sorry for this.\n<p> There is no harm in fixing one atom in the three\ndirections\nusing <b>iatfix</b>, then fixing it again in other directions\nby mentioning it in <b>iatfixx</b>, <b>iatfixy</b> or <b>iatfixz</b>.\n<br>\nThe internal representation of these input data is done\nby the mean of one variable <b>iatfix</b>(3,<a href=\"varbas.html#natom\">natom</a>),\ndefined\nfor each direction and each atom, being 0 if the atom is\nnot fixed along the direction, and 1 if the atom is fixed\nalong the direction.\nWhen some atoms are fixed along 1 or 2 directions, the\nuse of symmetries is restricted to symmetry operations\nwhose (3x3) matrices <a href=\"varbas.html#symrel\">symrel</a> are\ndiagonal.\n<br>\nIf the geo builder is used, <b>iatfix</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).\n",
    "vartype": "integer arrays of length <a href=\"varrlx.html#natfix\">natfix</a>, <a href=\"varrlx.html#natfixx\">natfixx</a>, <a href=\"varrlx.html#natfixy\">natfixy</a> or <a href=\"varrlx.html#natfixz\">natfixz</a> "
  },
  "iatsph": {
    "category": " ",
    "default": "1, 2, ... <a href=\"vargs.html#natsph\">natsph</a> ",
    "definition": "Index for the ATomic SPHeres of the atom-projected density-of-states",
    "section": "vargs",
    "text": "<p>\nThis input variable is active only in the\n<a href=\"varfil.html#prtdos\">prtdos</a>=3 case or if\n<a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2.\n<br>It gives the number of the <a href=\"vargs.html#natsph\">natsph</a> atoms around which the sphere\nfor atom-projected density-of-states will be build,\nin the <a href=\"varfil.html#prtdos\">prtdos</a>=3 case.\nThe radius of these spheres is given by <a href=\"vargs.html#ratsph\">ratsph</a>.\n<br> If <a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2, it gives the number of the <a href=\"vargs.html#natsph\">natsph</a> atoms around which atom-projected band structure will be built.\n",
    "vartype": "integer array iatsph(1:<a href=\"vargs.html#natsph\">natsph</a>)  "
  },
  "iboxcut": {
    "category": " ",
    "default": "0 ",
    "definition": "",
    "section": "varpaw",
    "text": "<p>\nConcern all summations in the reciprocal space and is\nallowed in PAW and norm-conserving.\n<ul>\n<li>if set to 0 all reciprocal space summations are done in a sphere\ncontained in the FFT box.</li>\n<li>if set to 1 all reciprocal space summations are done in the whole\nFFT box (useful for tests).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "icoulomb": {
    "category": " ",
    "default": "0",
    "definition": "Coulomb TReaTMenT",
    "section": "vargs",
    "text": "<p>\nDefines the type of computation used for Hartree potential, local part of pseudo-potential and ion-ion interaction:</p>\n<ul>\n<li><b>icoulomb</b>=0 : usual reciprocal space computation, using 1 / g^2 for the Hartree potential and using Ewald correction. </li>\n<li><b>icoulomb</b>=1 : free boundary conditions are used when the Hartree potential is computed, real space expressions of pseudo-potentials are involved (restricted to GTH pseudo-potentials) and simple coulombian interaction gives the ion-ion energy. </li>\n</ul>\n",
    "vartype": "integer "
  },
  "icutcoul": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "3",
    "definition": "Integer that governs the CUT-off for COULomb interaction ",
    "section": "vargw",
    "text": "<p>\n(This documentation is still very primitive, and should be checked)\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, a screening or self-energy calculation.\n<p>\nMany-body calculations for isolated systems present a slow convergence with respect to the size of\nthe supercell due to the long ranged Coulomb interaction and the high degree of non-locality of the\noperators involved. A similar issue occur also in fully periodic systems due to the presence\nof the integrable Coulomb singularity at G=0 that hinders the convergence with respect to the number\nof q-points used to sample the Brillouin zone.\nThe convergence can be accelerated by replacing the true bare Coulomb interaction with other\nexpressions\n<b>icutcoul</b> defines the particular expression to be used for the Coulomb term in reciprocal\nspace. The choice of <b>icutcoul</b>  depends on the dimensionality of the system.\nPossible values of <b>icutcoul</b> are 0 to 6. To be complemented by values of <a href=\"vargw.html#vcutgeo\">vcutgeo</a>\nand <a href=\"vargw.html#rcut\">rcut</a>\n<ul>\n<li>0 => sphere (molecules but also 3D-crystals) </li>\n<li>1 => cylinder (nanowires, nanotubes)</li>\n<li>2 => surface </li>\n<li>3 => 3D crystal (no cut-off, G=0 excluded, default value)</li>\n<li>4 => ERF, long-range only Coulomb interaction </li>\n<li>5 => ERFC, short-range only Coulomb interaction (e.g. as used in the HSE functional) </li>\n<li>6 => auxiliary function integration for 3D systems from P. Carrier <i>et al.</i>, PRB <b>75</b>, 205126 (2007).</li>\n</ul>\nNote that Spencer and Alavi PRB <b>77</b>, 193110 (2008) showed that the spherical cutoff can efficiently be used also for 3D systems.\nIn the latter case, use a negative value for the cutoff radius of the sphere (<a href=\"vargw.html#rcut\">rcut</a>&lt0),\nwhich is automatically calculated so that the volume enclosed in the sphere is equal to the volume of the solid.\n",
    "vartype": "integer parameter "
  },
  "idyson": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1.",
    "definition": "Integer giving the choice of method for the DYSON equation",
    "section": "vardev",
    "text": "<p>\nChoice for the method used to solve the Dyson equation in the calculation\nof the interacting susceptibility matrix or/and in the calculation of the ACFD exchange-correlation energy:\n<ul>\n<li><b>idyson</b>=1 : Solve the Dyson equation by direct matrix inversion</li>\n<li><b>idyson</b>=2 : Solve the Dyson equation as a first-order differential equation\nwith respect to the coupling constant lambda - only implemented for the RPA at the\npresent stage (see header of dyson_de.f for details)</li>\n<li><b>idyson</b>=3 : Calculate only the diagonal of the interacting susceptibility matrix\nby self-consistently computing the linear density change in response to a set\nof perturbations. Only implemented for the RPA at the present stage,\nand entirely experimental (see dyson_sc.f for details).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "ieig2rf": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "Integer for second-order EIGenvalues from Response-Function ",
    "section": "varrf",
    "text": "<p>\nIf <b>ieig2rf</b> is greater then 0, the code will produce a file, named with the trailing suffix _EIGR2D, containing the second-order electronic eigenvalues for the perturbation. These files are used in the calculation of the thermal correction to the electronic eigenvalues.\n<br><br>\nIf <b>ieig2rf</b> is set to 1, the second-order electronic eigenvalues will be calculated from the DFPT method. <br>\nIf <b>ieig2rf</b> is set to 2, the second-order electronic eigenvalues will be calculated from the Allen-Cardona method.\n<br>Related variables : <a href=\"varrf.html#bdeigrf\">bdeigrf</a>,<a href=\"varrf.html#elph2_imagden\">elph2_imagden</a>,<a href=\"vardev.html#getgam_eig2nkq\">getgam_eig2nkq</a>,<a href=\"varrf.html#smdelta\">smdelta</a>\n",
    "vartype": "integer parameters  "
  },
  "ikhxc": {
    "category": "",
    "default": "1.",
    "definition": "Integer option for KHXC = Hartree XC kernel ",
    "section": "vardev",
    "text": "<p>\nDefine the HXC kernel, in the cases for which it can be\ndissociated with the choice of the HXC functional given by\n<a href=\"varbas.html#ixc\">ixc</a>, namely the TD-DFT computation of excited\nstates (<a href=\"varbas.html#iscf\">iscf</a>=-1), and the computation of the\nsusceptibility matrix (for ACFD purposes). Options 2 to 6 are for the\nACFD only.\n<ul>\n<li>0 =&gt; RPA for the TDDFT but no kernel for the ACFD (testing purposes).</li>\n<li>1 =&gt; RPA for the TDDFT and ACFD.</li>\n<li>2 =&gt; ALDA (PW92) for the ACFD</li>\n<li>3 =&gt; PGG for the ACFD [M. Petersilka, U.J. Gossmann and E.K.U. Gross, PRL 76,1212 (1996)]</li>\n<li>4 =&gt; BPG for the ACFD. This amounts to half the PGG kernel plus half\nthe ALDA kernel for spin-compensated systems [K. Burke, M. Petersilka and E.K.U. Gross,\nin \"Recent Advances in Density Functional Methods\", Vol. III, edited by P. Fantucci and A. Bencini\n(World Scientific, Singapore, 2002)]</li>\n<li>5 =&gt; Linear energy optimized kernel [J. Dobson and J. Wang, PRB 62, 10038 (2000)]</li>\n<li>6 =&gt; Non-linear energy optimized kernel [J. Dobson and J. Wang, PRB 62, 10038 (2000)]</li>\n</ul>\n<br>\nFor ACFD-ALDA, BPG and energy optimized kernels are highly experimental and not tested yet !!!\nFor ACFD calculations, a cut-off density has been defined for the ALDA, BPG and\nenergy optimized kernels : let rhomin = userre*rhomax (where rhomax is the maximum density\nin space) ; then the actual density used to calculate the local part of these kernels\nat point r is max(rho(r),rhomin.\n",
    "vartype": "integer parameter "
  },
  "imgmov": {
    "category": "",
    "default": "0.",
    "definition": "IMaGe MOVEs ",
    "section": "varrlx",
    "text": "<p>\nControl the collective changes of images (see <a href=\"varrlx.html#nimage\">nimage</a>,\n<a href=\"varpar.html#npimage\">npimage</a>, <a href=\"varrlx.html#dynimage\">dynimage</a>,\n<a href=\"varrlx.html#ntimimage\">ntimimage</a>, <a href=\"varrlx.html#tolimg\">tolimg</a>,\n<a href=\"varrlx.html#istatimg\">istatimg</a>, <a href=\"varfil.html#prtvolimg\">prtvolimg</a>).\n<br> Similar to <a href=\"varrlx.html#ionmov\">ionmov</a>\nin spirit, although here, a population of self-consistent calculations for different geometries is managed,\nwhile with <a href=\"varrlx.html#ionmov\">ionmov</a>,\nonly one geo for self-consistent calculation is managed.\n<br>\nIn this respect the maximal number of time step for image propagation is\n<a href=\"varrlx.html#ntimimage\">ntimimage</a>, corresponding to the input variable <a href=\"varrlx.html#ntime\">ntime</a> of the single\ngeo case.\nAlso, the stopping criterion is governed by\n<a href=\"varrlx.html#tolimg\">tolimg</a>, corresponding to the input variable <a href=\"varbas.html#toldfe\">toldfe</a> of the single\ngeo case. The stopping condition is crude: the image propagation is stopped\nwhen the mean value (over dynamic images) of the absolute difference of total energy\n(previous and current time step) is less than <a href=\"varrlx.html#tolimg\">tolimg</a>.\n\n<p>\nActually, there might be combinations of <a href=\"varrlx.html#ionmov\">ionmov</a>\nand <b>imgmov</b> in which the two mechanisms are at work. Usually, however, only one mechanim\nwill be activated (so, usually, either <a href=\"varrlx.html#ntimimage\">ntimimage</a> is bigger than one OR <a href=\"varrlx.html#ntime\">ntime</a>\nis bigger than one).\nIn order for the user to acquire a mental representation of the\ninterplay between <a href=\"varrlx.html#ionmov\">ionmov</a> and <b>imgmov</b>, here is a F90 pseudo-code presenting\nthe interplay between the different above-mentioned input variables, as well as with the parallelism (see input variable <a href=\"varpar.html#npimage\">npimage</a>).\n<pre>\ndo itimimage=1,ntimimage\ndo iimage=1,nimage\n(possibly, parallelisation over images)\ndo itime=1,ntime\nCompute the forces and stresses for image(iimage)\nExamine whether the stopping criteron defined by tolmxf is fulfilled\nPredict the next geo for image(iimage) using ionmov\nenddo\nenddo\nExamine whether the stopping criteron defined by tolimg is fulfilled\nPredict the next geometries for all images using imgmov\nenddo\n</pre>\n<br>\n<ul>\n<li>0=&gt; simply <b>copy</b> images from previous timimage step.</li>\n</li><br>\n<li>1=&gt; move images according to <b>Steepest Descent</b> following the (scaled) forces,\nthe scaling factor being <a href=\"varrlx.html#fxcartfactor\">fxcartfactor</a>\n</li><br>\n<li>2=&gt; <b>String Method</b> for finding Minimal Energy Path (MEP) connecting to minima\n(see <i> PRB 66, 052301 (2002)</i>); the algorithm variant can be selected with\nthe <a href=\"varrlx.html#string_algo\">string_algo</a> keyword (\"Simplified\nString Method\" by default). The solver for the Ordinary Differential Equation (ODE)\ncan be selected with <a href=\"varrlx.html#mep_solver\">mep_solver</a>\n(steepest-descent by default). See also <a href=\"varrlx.html#mep_mxstep\">mep_mxstep</a> keyword.\n</li><br>\n<li>3=&gt; (tentatively, not yet coded) <b>Metadynamics</b>.\n</li><br>\n<li>4=&gt; (tentatively, not yet coded) <b>Genetic Algorithm</b>.\n</li><br>\n<li>5=&gt; <b>Nudged Elastic Band (NEB)</b> for finding Minimal Energy Path (MEP) connecting to minima;\nthe algorithm variant can be selected with the <a href=\"varrlx.html#neb_algo\">neb_algo</a>\nkeyword (NEB+improved tangent by default). The solver for the Ordinary Differential Equation (ODE)\ncan be selected with <a href=\"varrlx.html#mep_solver\">mep_solver</a> (steepest-descent by default). The spring constant connecting images along the path is defined by <a href=\"varrlx.html#neb_spring\">neb_spring</a>. See also <a href=\"varrlx.html#mep_mxstep\">mep_mxstep</a> keyword.\n</li><br>\n<li>9 or 13 =&gt; <b>Path-Integral Molecular Dynamics</b>\n(see e.g. <i>D. Marx and M. Parrinello, J. Chem. Phys. 104, 4077 (1996)</i>).\nWill use 9 for <b>Langevin</b> and 13 for <b>chain of thermostats</b> (see <a href=\"varrlx.html#ionmov\">ionmov</a>=9 or 13\nfor the definition of associated parameters governing the dynamics).\n<a href=\"varrlx.html#nimage\">nimage</a> is the Trotter number (no use of <a href=\"varrlx.html#dynimage\">dynimage</a>);\npossible transformations of the dynamics of the PI chains are defined by <a href=\"varrlx.html#pitransform\">pitransform</a>;\nInertial masses of the atoms (possibly different from the true masses given by\n<a href=\"varrlx.html#amu\">amu</a>) can be specified by <a href=\"varrlx.html#pimass\">pimass</a>.\nAt present, it is possible to perform calculations in (N,V,T) ensemble (<a href=\"varrlx.html#optcell\">optcell</a>=0)\nor in (N,P,T) ensemble (EXPERIMENTAL - NOT YET USEABLE) (<a href=\"varrlx.html#optcell\">optcell</a>=2). For the latter,\nstarting velocities of the cell parameters can be specified with <a href=\"varrlx.html#vel_cell\">vel_cell</a>.\n</li>\n</font>\n</ul>\n<ul>\n</ul>\n<font id=\"text\"><br>\nNo meaning for RF calculations.\n",
    "vartype": "integer parameter "
  },
  "inclvkb": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "1 <b>TODO: should be changed to 0 or 2</b>",
    "definition": "INCLude VKB ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,99 that is, a screening or BS calculations.\n<p>\nPossible values of <b>inclvkb</b> are 0,1,2.\nIf <b>inclvkb</b> is 1 or 2, the commutator of the non-local part of the pseudopotential\nwith the position operator is correctly included in the q =&gt; 0 contribution. This is\nunfortunately time-consuming. When <b>inclvkb</b> is 0, this contribution is incorrectly\nomitted, but the computation is much faster.\n<p>\nThe importance of this contribution depends on the number of k points. Turning off\n<b>inclvkb</b> should be made by experienced users only.\n<p>\nThe use of <b>inclvkb</b>=2 is strongy recommended for the calculation of optical properties.\n",
    "vartype": "integer parameter "
  },
  "intexact": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "INTegration using an EXACT scheme ",
    "section": "vardev",
    "text": "<p>\nRelates to the ACFD xc functionals only.\nIf <b>intexact</b> &gt; 0, the integration over the coupling constant\nwill be performed analytically in the RPA and in the two-electron PGG\napproximation for the ACFD exchange-correlation energy.\nOtherwise, the integration over the coupling constant will be performed\nnumerically (also see\n<a href=\"vardev.html#ndyson\">ndyson</a> and\n<a href=\"vardev.html#idyson\">idyson</a>.\nNote that the program will stop in <b>intexact</b> &gt; 0 and\n<a href=\"vardev.html#ikhxc\">ikhxc</a>/=1 (RPA) or\n<a href=\"vardev.html#ikhxc\">ikhxc</a>/=3 (PGG, with two electrons)\n",
    "vartype": "integer parameter "
  },
  "intxc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "INTerpolation for eXchange-Correlation ",
    "section": "vardev",
    "text": "<p>\n<ul>\n<li>0=&gt; do \"usual\" xc quadrature on fft grid</li>\n<li>1=&gt; do higher accuracy xc quadrature using fft grid\nand additional points at the centers of each cube\n(doubles number of grid points)--the high accuracy version\nis only valid for boxcut&gt;=2.  If boxcut &lt; 2, the code stops.</li>\n</ul>\n<br>For RF calculations only <b>intxc</b>=0 is allowed yet. Moreover,\nthe GS preparation runs (giving the density file and zero-order\nwavefunctions) must be done with <b>intxc</b>=0\n<p> Prior to ABINITv2.3, the choice <b>intxc</b>=1 was favoured (it was the default),\nbut the continuation of the development of the code lead to prefer\nthe default <b>intxc</b>=0 . Indeed, the benefit of <b>intxc</b>=1 is\nrather small, while making it available for all cases is a\nnon-negligible development effort. Other targets are prioritary...\nYou will notice that many automatice tests use <b>intxc</b>=1. Please,\ndo not follow this historical choice for your production runs.\n",
    "vartype": "integer parameter "
  },
  "ionmov": {
    "category": "",
    "default": "0.",
    "definition": "IONic MOVEs ",
    "section": "varrlx",
    "text": "<p>\nControl the displacements of\nions, and eventually (see <a href=\"varrlx.html#optcell\">optcell</a>)\nchanges of cell shape\nand size.\n</font>\n<ul>\n<font id=\"text\">\n<li>0=&gt; do not move ions; </li>\n<li>1=&gt; move atoms using molecular dynamics with\noptional viscous damping (friction linearly proportional\nto velocity). The viscous damping is controlled by the\nparameter \"<a href=\"varrlx.html#vis\">vis</a>\".\nIf actual undamped molecular dynamics is desired,\nset <a href=\"varrlx.html#vis\">vis</a> to 0. The implemented algorithm\nis the generalisation\nof the Numerov technique (6th order), but is NOT invariant\nupon time-reversal, so that the energy is not conserved.\nThe value <b>ionmov</b>=6 will usually be preferred, although the\nalgorithm that is implemented is lower-order.\nThe time step is governed by\n<a href=\"varrlx.html#dtion\">dtion</a>.<br>\n<b>Purpose:</b> Molecular dynamics (if <a href=\"varrlx.html#vis\">vis</a>=0),\nStructural optimization (if <a href=\"varrlx.html#vis\">vis</a>&gt;0)<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> Viscous parameter <a href=\"varrlx.html#vis\">vis</a>,\ntime step <a href=\"varrlx.html#dtion\">dtion</a>,\nindex of atoms fixed <a href=\"varrlx.html#iatfix\">iatfix</a><br><br>\n</li>\n\n<li>2=&gt; conduct structural optimization using the\nBroyden-Fletcher-Goldfarb-Shanno minimization (BFGS).\nThis is much more efficient for structural optimization\nthan viscous damping, when there are less than\nlet's say 10 degrees of freedom to optimize.<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> Yes (if <a href=\"varrlx.html#optcell\">optcell</a>/=0)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>3=&gt; conduct structural optimization using the\nBroyden-Fletcher-Goldfarb-Shanno minimization (BFGS),\nmodified to take into account the total energy as well as\nthe gradients (as in usual BFGS). <br>\nSee the paper by\nSchlegel, J. Comp. Chem. 3, 214 (1982).\nMight be better than <b>ionmov</b>=2 for few degrees of freedom\n(less than 3 or 4).<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> Yes (if <a href=\"varrlx.html#optcell\">optcell</a>/=0)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>4=&gt; conjugate gradient algorithm for simultaneous\noptimization of potential and ionic degrees of freedom.\nIt can be used with <a href=\"varbas.html#iscf\">iscf</a>=2 and <a\nhref=\"varbas.html#iscf\">iscf</a>=5 or 6\n(WARNING : this is under development, and does not work very well in\nmany\ncases).<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>5=&gt; Simple relaxation of ionic positions according\nto (converged) forces. Equivalent to <b>ionmov</b>=1 with\nzero masses, albeit the relaxation coefficient is not <a\nhref=\"varrlx.html#vis\">vis</a>,\nbut <a href=\"vardev.html#iprcfc\">iprcfc</a>. <br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>6=&gt; Molecular dynamics using the Verlet algorithm, see\nAllen &amp; Tildesley \"Computer simulation of liquids\" 1987, p 81.\nThe only related parameter is the time step\n(<a href=\"varrlx.html#dtion\">dtion</a>).<br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b>   time step <a href=\"varrlx.html#dtion\">dtion</a>,\nindex of atoms fixed <a href=\"varrlx.html#iatfix\">iatfix</a><br><br>\n</li>\n\n<li>7=&gt; Quenched Molecular dynamics using the Verlet\nalgorithm, and stopping each atom for which the scalar product\nof velocity and force is negative.\nThe only related parameter is the time step\n(<a href=\"varrlx.html#dtion\">dtion</a>).\nThe goal is not\nto produce a realistic dynamics, but to go as fast as possible\nto the minimum. For this purpose, it is advised to set\nall the masses to the same value (for example, use the Carbon mass,\ni.e. set <a href=\"varrlx.html#amu\">amu</a> to 12 for all type of\natoms).<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b>   time step <a href=\"varrlx.html#dtion\">dtion</a>,\nindex of atoms fixed <a href=\"varrlx.html#iatfix\">iatfix</a><br><br>\n</li>\n\n<li>8=&gt; Molecular dynamics with Nose-Hoover thermostat,\nusing the Verlet algorithm.<br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> time step (<a href=\"varrlx.html#dtion\">dtion</a>),\nTemperatures (<a href=\"varrlx.html#mdtemp\">mdtemp</a>),\nand thermostat mass (<a href=\"varrlx.html#noseinert\">noseinert</a>).<br>\n<br><br>\n</li>\n\n<li>9=&gt; Langevin molecular dynamics.\n<br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> time step (<a href=\"varrlx.html#dtion\">dtion</a>),\ntemperatures (<a href=\"varrlx.html#mdtemp\">mdtemp</a>),\nand friction coefficient (<a href=\"varrlx.html#friction\">friction</a>).\n<br><br>\n</li>\n\n<li>10=&gt; Delocalized internal coordinates. with BFGS simple\n<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>11=&gt; Delocalized internal coordinates. with BFGS using total energy\n<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>12=&gt; Isokinetic ensemble molecular dynamics.\nThe equation of motion of the ions in contact with a thermostat\nare solved with the algorithm proposed by Zhang [J. Chem. Phys. 106,\n6102 (1997)],\nas worked out by Minary et al [J. Chem. Phys. 188, 2510 (2003)].\nThe conservation of the kinetic energy is obtained within machine\nprecision,\nat each step. <br>\n<s>Related parameters : the time step (<a href=\"varrlx.html#dtion\">dtion</a>),\nthe temperatures (<a href=\"varrlx.html#mdtemp\">mdtemp</a>),\nand the friction coefficient (<a href=\"varrlx.html#friction\">friction</a>).</s><br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>13=&gt; Isothermal/isenthalpic ensemble.\nThe equation of motion of the ions in contact with a thermostat\nand a barostat are solved with the algorithm proposed by Martyna,\nTuckermann Tobias and Klein [Mol. Phys., 1996, p. 1117].<br>\nIf optcell=1 or 2, the mass of the barostat (<a href=\"varrlx.html#bmass\">bmass</a>)\nmust be given in addition. <br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> Yes (if <a href=\"varrlx.html#optcell\">optcell</a>/=0)<br>\n<b>Variables related:</b> The time step (<a href=\"varrlx.html#dtion\">dtion</a>),\nthe temperatures (<a href=\"varrlx.html#mdtemp\">mdtemp</a>),\nthe number of thermostats (<a href=\"varrlx.html#nnos\">nnos</a>),\nand the masses of thermostats (<a href=\"varrlx.html#qmass\">qmass</a>).<br><br>\n</li>\n\n<li>14=&gt; simple molecular dynamics with a symplectic algorithm proposed\nby S.Blanes and P.C.Moans [called SRKNa14 in Practical symplectic partitioned\nRunge--Kutta and Runge--Kutta--Nystrom methods, Journal of Computational\nand Applied Mathematics archive, volume 142,  issue 2  (May 2002), pages 313 - 330]\nof the kind first published by H. Yoshida [Construction of higher order symplectic\nintegrators, Physics Letters A, volume 150, number 5 to 7, pages 262 - 268].\nThis algorithm requires at least 14 evaluation of the forces (actually 15 are done\nwithin Abinit) per time step. At this cost it usually gives much better\nenergy conservation than the verlet algorithm (ionmov 6) for a 30 times bigger\nvalue of <a href=\"varrlx.html#dtion\">dtion</a>. Notice that the potential\nenergy of the initial atomic configuration is never evaluated using this\nalgorithm.\n<br>\n<b>Purpose:</b> Molecular dynamics<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n<li>20=&gt; Direct inversion of the iterative subspace.\nGiven a starting point xred that is a vector of length 3*natom\n(reduced nuclei coordinates), and unit cell parameters (rprimd)\nthis routine uses the DIIS (direct inversion of the iterative\nsubspace) to minize the gradient (forces) on atoms. The preconditioning\nused to compute errors from gradients is using an inversed hessian\nmatrix obtained by a BFGS algorithm.\nThis method is known to converge to the nearest point where gradients\nvanish. This is efficient to refine positions around a saddle point\nfor instance.\n<br>\n<b>Purpose:</b> Structural optimization<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> DIIS memory <a href=\"varrlx.html#diismemory\">diismemory</a><br><br>\n</li>\n\n<li>30=&gt; Using a supercell, calculate a self consistent phonon structure\nas in PRL 100 095901 (2008). The initial phonon eigenvectors and\neigenvalues are read in, and then atoms are displaced according\nto the normal modes populated at a given temperature until\nconvergence of the vibrational free energy (or so I hope)\n<br>\n<b>Purpose:</b> Phonon structure<br>\n<b>Cell optimization:</b> No (Use <a href=\"varrlx.html#optcell\">optcell</a>=0 only)<br>\n<b>Variables related:</b> <br><br>\n</li>\n\n</font>\n</ul>\n<ul>\n</ul>\n<font id=\"text\"><br>\nNo meaning for RF calculations.\n",
    "vartype": "integer parameter "
  },
  "iprcch": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "2.If <a href=\"varrlx.html#ionmov\">ionmov</a>=4 and <a href=\"varbas.html#iscf\">iscf</a>=5,<b>iprcch</b> is automatically put to 3. If <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1, <b>iprcch</b> is automatically put to 6.",
    "definition": "Integer for PReConditioning of CHarge response ",
    "section": "vardev",
    "text": "<p>\nUsed when <a href=\"varbas.html#iscf\">iscf</a>>0, to define:<br>\n- the way a change of density is derived from a change of atomic position,<br>\n- the way forces are corrected when the SCF cycle is not converged.<br>\n<br>Supported values :\n<ul>\n<li>0 =&gt; density not changed (fixed charge), forces not corrected </li>\n<li>1 =&gt; density not changed, forces corrected with rigid ion hypothesis (atomic charge moved with atom)</li>\n<li>2 =&gt; density changed and forces corrected with rigid ion hypothesis (atomic charge moves with atom)</li>\n<li>3 =&gt; density changed and forces corrected with a different implementation of the rigid ion hypothesis</li>\n<li>4 =&gt; density not changed, forces corrected with the use of Harris functional formula (*)</li>\n<li>5 =&gt; density changed using D. Alfe 2nd-order algorithm (**), forces not corrected</li>\n<li>6 =&gt; density changed using D. Alfe 2nd-order algorithm (**) and forces corrected with the use of Harris functional formula (*)</li>\n</ul>\nNo meaning for RF calculations.<br>\n\n<br>For the time being,<br>\n- the choice 3 must be used with <a href=\"varrlx.html#ionmov\">ionmov</a>=4\nand <a href=\"varbas.html#iscf\">iscf</a>=5.<br>\n- the choices 4, 5 or 6 must be used when band-FFT parallelism is selected.<br>\nOtherwise, use the choice 2.<br>\n\n<br><b>(*)</b><U>Note concerning the use of <b>iprcch</b>=4 or 6 (correction of forces)</U>:<br>\nThe force on the atom located at R is corrected by the addition of the following term:<br>\n<i>F_residual=Int[dr.V_residual.dRho_atomic/dR]</i>,  where Rho_atomic is an atomic (spherical) density.<br>\n- When such an atomic density (Rho_atomic) is found in the pseudopotential or PAW file, it is used. If not, a gaussian density\n(defined by <a href=\"vardev.html#densty\">densty</a> parameter) is used.<br>\n- When SCF mixing is done on the density (<a href=\"varbas.html#iscf\">iscf</a>>=10), the potential residual (V_residual)\nis obtained from the density residual with the first order formula <i>V_residual=dV/drho.Rho_residual</i>\nand uses the exchange-correlation kernel <i>dVxc/drho=Kxc</i> which computation is time-consuming for GGA functionals.\nBy default the LDA exchange-correlation kernel is used (even for GGA, for which it seems to give a reasonable accuracy).\nUsing the exact GGA exchange correlation kernel is always possible by giving a negative value to <b>iprcch</b>.\n\n<br><br><b>(**)</b><U>Note concerning the use of <b>iprcch</b>=5 or 6 (density prediction)</U>:<br>\nThe algorithm is described in <i>Computer Physics Communications <b>118</b> (1999) 31-33</i>.\nIt uses an atomic (spherical) density. When such an atomic density is found in the pseudopotential or PAW file, it is used. If not, a gaussian density\n(defined by <a href=\"vardev.html#densty\">densty</a> parameter) is used.<br>\nAlso note that, to be efficient, this algorithm requires a minimum convergency of the SCF cycle;\nTypically, vres2 (or nres2) has to be small enough (10<sup>-4</sup>...10<sup>-5</sup>).",
    "vartype": "integer parameter "
  },
  "iprcel": {
    "category": " ",
    "default": "0.",
    "definition": "Integer for PReConditioning of ELectron response ",
    "section": "vargs",
    "text": "<p>\nUsed when <a href=\"varbas.html#iscf\">iscf</a>>0, to define the SCF preconditioning scheme.\nPotential-based preconditioning schemes for the SCF loop\n(electronic part) are still a subject of active research.\nThe present parameter (electronic part) describes the way the\nchange of potential is derived from the residual.\n<br>The possible values of <b>iprcel</b> correspond to :\n<ul>\n<li>0 => model dielectric function described by <a href=\"vargs.html#diemac\">diemac</a>,\n<a href=\"vargs.html#dielng\">dielng</a>\nand <a href=\"vargs.html#diemix\">diemix</a>.</li>\n<li>larger or equal to 21 => will compute the dielectric matrix\naccording to <a href=\"vargs.html#diecut\">diecut</a>, <a href=\"vargs.html#dielam\">dielam</a>,\n<a href=\"vargs.html#diegap\">diegap</a>. This methodology is described in\nP.-M. Anglade, X. Gonze, Phys. Rev. B 78, 045126 (2008).</li>\n<li>Between 21 and 29 => for the first few steps\nuses the same as option 0 then compute RPA dielectric function,\nand use it as such.</li>\n<li>Between 31 and 39 => for the first few steps\nuses the same as option 0 then compute RPA dielectric function,\nand use it, with the mixing factor <a href=\"vargs.html#diemix\">diemix</a>.</li>\n<li>Between 41 and 49 => compute the RPA dielectric matrix\nat the first step, and recompute it at a later step,\nand take into account the mixing factor <a href=\"vargs.html#diemix\">diemix</a>.</li>\n<li>Between 51 and 59 => same as between 41 and 49, but compute\nthe RPA dielectric matrix by another mean</li>\n<li>Between 61 and 69 => same as between 41 and 49, but compute\nthe electronic dielectric matrix instead of the RPA one.</li>\n<li>Between 71 and 78 => STILL UNDER DEVELOPMENT -- NOT USABLE ; Use the modified Kerker preconditioner with a real-space formulation (basic formulation is shown at <a href=\"vargs.html#dielng\">dielng</a>). The dielectric matrix is approximated thanks to  <a href=\"vargs.html#diemac\">diemac</a> and <a href=\"vargs.html#dielng\">dielng</a>.  Note that <a href=\"vargs.html#diemix\">diemix</a> is also used.  </li>\n<li> 79 => STILL UNDER DEVELOPMENT -- NOT USABLE ; same as previous but with an alternate algorithm. </li>\n<li> 141 to 169 => same as Between 41 and 69 (but, the dielectric matrix is also recomputed every iprcel modulo 10 step). </li>\n</ul>\n<br>\n\nThe computation of the dielectric matrix (for 0 [100]< <b>iprcel</b> < 70 [100]) is based on the  <b>extrapolar</b> approximation. This approximation can be tuned with <a href=\"vargs.html#diecut\">diecut</a>, <a href=\"vargs.html#dielam\">dielam</a>,\nand <a href=\"vargs.html#diegap\">diegap</a>. Yet its accuracy mainly depends on the number of conduction bands included in the system. Having 2 to 10 empty bands in the calculation is\nusually enough (use <a href=\"varbas.html#nband\">nband</a>).\n<br>\n<br>\nNOTES:\n<ul>\n\n<li>The step at which the dielectric matrix is computed or\nrecomputed is determined by modulo(<b>iprcel</b>,10). The recomputation happens\njust once in the calculation for <b>iprcel</b> < 100.\n<li>For non-homogeneous relatively large cells <b>iprcel</b>=45\nwill likely give a large improvement over <b>iprcel</b>=0.\n<li>In case of PAW and <b>iprcel</b>>0, see <a href=\"varpaw.html#pawsushat\">pawsushat</a> input variable. By default,\nan approximation (which can be suppressed) is done for the computation of susceptibility matrix.\n<li> For extremely large inhomogeneous cells where computation of the full dielectric matrix takes too many weeks, 70 < <b>iprcel</b> < 80 is advised.\n<li>For <a href=\"varbas.html#nsppol\">nsppol</a>=2 or\n<a href=\"vargs.html#nspinor\">nspinor</a>=2 with metallic <a href=\"varbas.html#occopt\">occopt</a>,\nonly <b>mod(iprcel,100)</b><50 is allowed.\n<li>No meaning for RF calculations yet.\n<li> The exchange term in the full dielectric matrix diverges for vanishing densities.\nTherefore the values of <b>iprcel</b> beyond 60 must not be used for cells containing vacuum,\nunless ones computes this matrix for every step (<b>iprcel</b>=161).\n</ul>\n",
    "vartype": "integer parameter "
  },
  "iprcfc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "Integer for PReConditioner of Force Constants ",
    "section": "vardev",
    "text": "<p>\nUsed when <a href=\"varbas.html#iscf\">iscf</a>>0, to define the SCF preconditioning scheme.\nPotential-based preconditioning schemes for the SCF loop\nare still under development.\n<br>The present parameter (force constant part)\ndescribes the way a change of force\nis derived from a change of atomic position.\n<br>Supported values :\n<ul>\n<li>0 =&gt; hessian is the identity matrix</li>\n<li>1 =&gt; hessian is 0.5 times the identity matrix</li>\n<li>2 =&gt; hessian is 0.25 times the identity matrix</li>\n<li>-1=&gt; hessian is twice the identity matrix</li>\n<li>... (simply corresponding power of 2 times the identity matrix)</li>\n</ul>\nNo meaning for RF calculations.",
    "vartype": "integer parameter "
  },
  "iprctfvw": {
    "category": " ",
    "default": "0.",
    "definition": "Integer for PReConditioning (of electron response) based on Thomas - Fermi - von Weizs&auml;cker approximations of the kinetic energy ",
    "section": "vargs",
    "text": "<p>\nUsed when <a href=\"varbas.html#iscf\">iscf</a>>0, to use the TFvW preconditioner. This is still in an early DEVELOPMENT stage and is not usable as is.\n\n<ul>\n<li>0 => not TFvW preconditioning applied ; </li>\n<li>1 => TFvW prc. is applied on the residuals left by other preconditioners ;</li>\n<li>2 => Same as previously but with a linear response formulation of TFvW ; </li>\n<li>3 => (starting at abinit 5.3.?) TFvW prc. is applied before any other preconditioner.</li>\n</ul>\n\n<br>For <a href=\"varbas.html#nsppol\">nsppol</a> >=  2 only <b>iprcel</b>=0 is allowed.\n<br>No meaning for RF calculations yet.\n<br>Compatible only with potential mixing : <a href=\"varbas.html#iscf\">iscf</a><10.\n\n<p>\n<br>References:\n<ul>\n<li> D. Raczkowski, A Canning and L.W. Wang PRB 64 121101 (2001)</li>\n</ul>\n</p>\n",
    "vartype": "integer parameter "
  },
  "iqpt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 .",
    "definition": "Index for QPoinT generation ",
    "section": "vargs",
    "text": "<p>\nOnly used if <a href=\"vargs.html#nqpt\">nqpt</a>=1, and\n<a href=\"vargs.html#qptopt\">qptopt</a>=1 to 4.\n<p>Defines the index of the Q point to be selected in the list of q points generated by\n<a href=\"vargs.html#ngqpt\">ngqpt</a>,\n<a href=\"vargs.html#qptrlatt\">qptrlatt</a>,\n<a href=\"vargs.html#nshiftq\">nshiftq</a>,\nand\n<a href=\"vargs.html#shiftq\">shiftq</a>.\n<p>If <b>iqpt</b>=0, then the q point is Gamma (0 0 0).\n<p>The usual working mode is to define a series of values for <b>iqpt</b>,\nstarting with <b>iqpt</b>=0 or 1 (so through the definition of <b>iqpt:</b>),\nand increasing it by one for each dataset (thanks to <b>iqpt+</b>).\n</p>\n",
    "vartype": "integer parameter "
  },
  "irandom": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "3.",
    "definition": "Integer for the choice of the RANDOM number generator",
    "section": "vardev",
    "text": "<p>\nFor the time being, only used when <a href=\"varrlx.html#imgmov\">imgmov</a>=9\n(Langevin Path-Integral Molecular Dynamics).<br>\n<b>irandom</b> defines the random number generator.<br>\n<br>Supported values :\n<ul>\n<li>1 =&gt; \"uniformrandom\", delivered with ABINIT package (initially comes from numerical receipies).</li>\n<li>2 =&gt; intrinsic Fortran 90 random number generator.</li>\n<li>3 =&gt; \"ZBQ\" non-deterministic random number generator by R. Chandler and P. Northrop.\n(This was delivered for free at http://www.ucl.ac.uk/~ucakarc/work/index.html#code\", but\nthe latter address does not seem to work anymore. In any case, the initial copyright is not violated\nby the files/documentation present in the ABINIT package).\n</li>\n</ul>\n<b>irandom</b>=3 is strongly adviced when performing Molecular Dynamics restarts (avoids bias).\n",
    "vartype": "integer parameter "
  },
  "ird1den": {
    "category": " ",
    "default": "0 when iscf &#62 0, 1 when iscf &#60 0.",
    "definition": "Integer that governs the ReaDing of 1st-order DEN file ",
    "section": "varfil",
    "text": "<p>\nGround state calculation:\nStart the ground-state calculation from the density file of a previous run.\nWhen iscf &#60 0, the reading of a DEN file is always enforced.\n<p>A non-zero value of <b>irdden</b> is treated in the same way\nas other \"ird\" variables,\nsee the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n<br>\n<br>Response function calculation:\nIf first order density is needed in single dataset mode\n(for example in nonlinear optical response),\nuse <b>ird1den</b> to read first-order densities from _DENx files produced in\nother calculations. In multi-dataset mode use <a href=\"varfil.html#getden\">get1den</a>.\n",
    "vartype": "integer parameter "
  },
  "ird1wf": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of _1WF files ",
    "section": "varfil",
    "text": "<p>\nIndicates eventual starting\nwavefunctions. As alternative, one can use the\ninput variables <a href=\"varfil.html#getwfk\">getwfk</a>,\n<a href=\"varfil.html#getwfq\">getwfq</a>, <a href=\"varfil.html#get1wf\">get1wf</a>\nor <a href=\"varfil.html#getddk\">getddk</a>.\n<br>\n<br>Ground-state calculation :\n<ul>\n<li>only <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> have a meaning</li>\n<li>at most one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> can be non-zero</li>\n<li>if <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> are both zero,\ninitialize wavefunctions with\nrandom numbers for ground state calculation. </li>\n<li>if <b>irdwfk</b> = 1 : read ground state wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> MUST be non-zero</li>\n<li>if <b>irdwfk</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>only one of <b>irdwfq</b> or <a href=\"varfil.html#getwfq\">getwfq</a> can be non-zero,\nif both of them are non-zero,\nuse as k + q file the one defined by\n<b>irdwfk</b> and/or <a href=\"varfil.html#getwfk\">getwfk</a></li>\n<li>if <b>irdwfq</b> = 1 : read ground state k+q -wavefunctions\nfrom a disk file appended with _WFQ , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>ird1wf</b> or <a href=\"varfil.html#get1wf\">get1wf</a> can be non-zero</li>\n<li>if both are zero, initialize first order wavefunctions\nto 0's.</li>\n<li>if <b>ird1wf</b> = 1 : read first-order wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>irdddk</b> or <a href=\"varfil.html#getddk\">getddk</a> can be non-zero</li>\n<li>one of them must be non-zero if an homogeneous\nelectric field calculation is done\n(presently, a ddk calculation in the same dataset\nis not allowed)</li>\n<li>if <b>irdddk</b> = 1 : read first-order ddk wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "irdbscoup": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of COUPling block ",
    "section": "varfil",
    "text": "<p>\nStart the Bethe-Salpeter calculation from the BSC file containing the coupling block produced in a previous run.\n",
    "vartype": "integer "
  },
  "irdbseig": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of BS_EIG file ",
    "section": "varfil",
    "text": "<p>\nStart the Bethe-Salpeter calculation from the BS_EIG contining the exciton eigenvectors produced in a previous run.\n",
    "vartype": "integer "
  },
  "irdbsreso": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of RESOnant block ",
    "section": "varfil",
    "text": "<p>\nStart the Bethe-Salpeter calculation from the BSR file containing the resonat block produced in a previous run.\n",
    "vartype": "integer "
  },
  "irdddk": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of DDK wavefunctions, in _1WF files ",
    "section": "varfil",
    "text": "<p>\nIndicates eventual starting\nwavefunctions. As alternative, one can use the\ninput variables <a href=\"varfil.html#getwfk\">getwfk</a>,\n<a href=\"varfil.html#getwfq\">getwfq</a>, <a href=\"varfil.html#get1wf\">get1wf</a>\nor <a href=\"varfil.html#getddk\">getddk</a>.\n<br>\n<br>Ground-state calculation :\n<ul>\n<li>only <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> have a meaning</li>\n<li>at most one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> can be non-zero</li>\n<li>if <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> are both zero,\ninitialize wavefunctions with\nrandom numbers for ground state calculation. </li>\n<li>if <b>irdwfk</b> = 1 : read ground state wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> MUST be non-zero</li>\n<li>if <b>irdwfk</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>only one of <b>irdwfq</b> or <a href=\"varfil.html#getwfq\">getwfq</a> can be non-zero,\nif both of them are non-zero,\nuse as k + q file the one defined by\n<b>irdwfk</b> and/or <a href=\"varfil.html#getwfk\">getwfk</a></li>\n<li>if <b>irdwfq</b> = 1 : read ground state k+q -wavefunctions\nfrom a disk file appended with _WFQ , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>ird1wf</b> or <a href=\"varfil.html#get1wf\">get1wf</a> can be non-zero</li>\n<li>if both are zero, initialize first order wavefunctions\nto 0's.</li>\n<li>if <b>ird1wf</b> = 1 : read first-order wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>irdddk</b> or <a href=\"varfil.html#getddk\">getddk</a> can be non-zero</li>\n<li>one of them must be non-zero if an homogeneous\nelectric field calculation is done\n(presently, a ddk calculation in the same dataset\nis not allowed)</li>\n<li>if <b>irdddk</b> = 1 : read first-order ddk wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "irdden": {
    "category": " ",
    "default": "0 when iscf &#62 0, 1 when iscf &#60 0.",
    "definition": "Integer that governs the ReaDing of DEN file ",
    "section": "varfil",
    "text": "<p>\nGround state calculation:\nStart the ground-state calculation from the density file of a previous run.\nWhen iscf &#60 0, the reading of a DEN file is always enforced.\n<p>A non-zero value of <b>irdden</b> is treated in the same way\nas other \"ird\" variables,\nsee the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n<br>\n<br>Response function calculation:\nIf first order density is needed in single dataset mode\n(for example in nonlinear optical response),\nuse <b>ird1den</b> to read first-order densities from _DENx files produced in\nother calculations. In multi-dataset mode use <a href=\"varfil.html#getden\">get1den</a>.\n",
    "vartype": "integer parameter "
  },
  "irdhaydock": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of the HAYDOCK restart file ",
    "section": "varfil",
    "text": "<p>\nUsed to re-start the Haydock iterative technique from the HAYDR_SAVE file produced in a previous run.\n",
    "vartype": "integer "
  },
  "irdkss": {
    "category": "GW  ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of KSS file ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4.\nIndicate the file from which the dielectric matrix must be obtained.\nAs alternative, one can use the input variable\n<a href=\"varfil.html#getkss\">getkss</a>.\n<br>When <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, at least one of\n<b>irdkss</b> or <a href=\"varfil.html#getkss\">getscr</a> must be non-zero.\n<p>A non-zero value of <b>irdkss</b> is treated in the same way\nas other \"ird\" variables,\nsee the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n",
    "vartype": "integer parameter "
  },
  "irdqps": {
    "category": "GW  ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of QuasiParticle Structure ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4.\nIndicate the file from which the eigenvalues and possibly the wavefunctions must be obtained,\nin order to achieve a self-consistent quasiparticle calculations.\nSee also <a href=\"varfil.html#getqps\">getqps</a>\n",
    "vartype": "integer parameter "
  },
  "irdscr": {
    "category": "GW  ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of the SCReening ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#optdriver\">optdriver</a>=4.\nIndicate the file from which the dielectric matrix must be obtained.\nAs alternative, one can use the input variable\n<a href=\"varfil.html#getscr\">getscr</a>.\n<br>When <a href=\"vargs.html#optdriver\">optdriver</a>=4, at least one of\n<b>irdscr</b> or <a href=\"varfil.html#getscr\">getscr</a>\n(alternatively, <a href=\"varfil.html#irdsuscep\">irdsuscep</a> or <a href=\"varfil.html#getsuscep\">getsuscep</a>)\nmust be non-zero.\n<p>A non-zero value of <b>irdscr</b> is treated in the same way as other \"ird\" variables,\nsee the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n",
    "vartype": "integer parameter "
  },
  "irdsuscep": {
    "category": "GW  ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of the SUSCEPtibility ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#optdriver\">optdriver</a>=4.\nIndicate the file from which the irreducible polarizability must be obtained.\nAs alternative, one can use the input variable\n<a href=\"varfil.html#getsuscep\">getsuscep</a>.\n<br>When <a href=\"vargs.html#optdriver\">optdriver</a>=4, at least one of\n<b>irdsuscep</b> or <a href=\"varfil.html#getsuscep\">getsuscep</a>\n(alternatively, <a href=\"varfil.html#irdscr\">irdscr</a> or <a href=\"varfil.html#getscr\">getscr</a>)\nmust be non-zero.\n<p>A non-zero value of <b>irdsuscep</b> is treated in the same way as other \"ird\" variables,\nsee the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n",
    "vartype": "integer parameter "
  },
  "irdvdw": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of _VDW files",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto read previously calculated vdW-DF variables.<br/>\nSupported values:\n<ul>\n<li>0 =&gt; do not read vdW-DF variables</li>\n<li>1 =&gt; read vdW-DF variables</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "irdwfk": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of _WFK files ",
    "section": "varfil",
    "text": "<p>\nIndicates eventual starting\nwavefunctions. As alternative, one can use the\ninput variables <a href=\"varfil.html#getwfk\">getwfk</a>,\n<a href=\"varfil.html#getwfq\">getwfq</a>, <a href=\"varfil.html#get1wf\">get1wf</a>\nor <a href=\"varfil.html#getddk\">getddk</a>.\n<br>\n<br>Ground-state calculation :\n<ul>\n<li>only <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> have a meaning</li>\n<li>at most one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> can be non-zero</li>\n<li>if <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> are both zero,\ninitialize wavefunctions with\nrandom numbers for ground state calculation. </li>\n<li>if <b>irdwfk</b> = 1 : read ground state wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> MUST be non-zero</li>\n<li>if <b>irdwfk</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>only one of <b>irdwfq</b> or <a href=\"varfil.html#getwfq\">getwfq</a> can be non-zero,\nif both of them are non-zero,\nuse as k + q file the one defined by\n<b>irdwfk</b> and/or <a href=\"varfil.html#getwfk\">getwfk</a></li>\n<li>if <b>irdwfq</b> = 1 : read ground state k+q -wavefunctions\nfrom a disk file appended with _WFQ , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>ird1wf</b> or <a href=\"varfil.html#get1wf\">get1wf</a> can be non-zero</li>\n<li>if both are zero, initialize first order wavefunctions\nto 0's.</li>\n<li>if <b>ird1wf</b> = 1 : read first-order wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>irdddk</b> or <a href=\"varfil.html#getddk\">getddk</a> can be non-zero</li>\n<li>one of them must be non-zero if an homogeneous\nelectric field calculation is done\n(presently, a ddk calculation in the same dataset\nis not allowed)</li>\n<li>if <b>irdddk</b> = 1 : read first-order ddk wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "irdwfkfine": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of the fine grid _WFK files ",
    "section": "vardev",
    "text": "Indicates eventual starting\nwavefunctions. As alternative, one can use the\ninput variables <a href=\"vardev.html#getwfkfine\">getwfkfine</a>.\n<br>\n<br>Ground-state calculation :\n<ul>\n<li>only <b>irdwfkfine</b> and <a href=\"vardev.html#getwfkfine\">getwfkfine</a> have a meaning</li>\n<li>at most one of <b>irdwfkfine</b> or <a href=\"vardev.html#getwfkfine\">getwfkfine</a> can be non-zero</li>\n<li>if <b>irdwfkfine</b> = 1 : read ground state wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state fine grid calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>irdwfkfine</b> or <a href=\"vardev.html#getwfkfine\">getwfkfine</a> MUST be non-zero</li>\n<li>if <b>irdwfkfine</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>Reading the fine grid wavefunction will trigger the k-points interpolation technique of the temperature dependent\ncalculations. </li>\n</ul>\n\nBethe-Salpeter calculation :\n<ul>\n<li>one and only one of <b>irdwfkfine</b> or <a href=\"vardev.html#getwfkfine\">getwfkfine</a> MUST be non-zero</li>\n<li>if <b>irdwfkfine</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>This variable or <a href=\"vardev.html#getwfkfine\">getwfkfine</a> is mandatory when bs_interp_mode = 1</li>\n</ul>\n\n<b>This variable is experimental. In development.</b>\n",
    "vartype": "integer parameter "
  },
  "irdwfq": {
    "category": " ",
    "default": "0.",
    "definition": "Integer that governs the ReaDing of _WFQ files ",
    "section": "varfil",
    "text": "<p>\nIndicates eventual starting\nwavefunctions. As alternative, one can use the\ninput variables <a href=\"varfil.html#getwfk\">getwfk</a>,\n<a href=\"varfil.html#getwfq\">getwfq</a>, <a href=\"varfil.html#get1wf\">get1wf</a>\nor <a href=\"varfil.html#getddk\">getddk</a>.\n<br>\n<br>Ground-state calculation :\n<ul>\n<li>only <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> have a meaning</li>\n<li>at most one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> can be non-zero</li>\n<li>if <b>irdwfk</b> and <a href=\"varfil.html#getwfk\">getwfk</a> are both zero,\ninitialize wavefunctions with\nrandom numbers for ground state calculation. </li>\n<li>if <b>irdwfk</b> = 1 : read ground state wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\nResponse-function calculation :\n<ul>\n<li>one and only one of <b>irdwfk</b> or <a href=\"varfil.html#getwfk\">getwfk</a> MUST be non-zero</li>\n<li>if <b>irdwfk</b> = 1 : read ground state k -wavefunctions\nfrom a disk file appended with _WFK , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>only one of <b>irdwfq</b> or <a href=\"varfil.html#getwfq\">getwfq</a> can be non-zero,\nif both of them are non-zero,\nuse as k + q file the one defined by\n<b>irdwfk</b> and/or <a href=\"varfil.html#getwfk\">getwfk</a></li>\n<li>if <b>irdwfq</b> = 1 : read ground state k+q -wavefunctions\nfrom a disk file appended with _WFQ , produced in a\nprevious ground state calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>ird1wf</b> or <a href=\"varfil.html#get1wf\">get1wf</a> can be non-zero</li>\n<li>if both are zero, initialize first order wavefunctions\nto 0's.</li>\n<li>if <b>ird1wf</b> = 1 : read first-order wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n<li>at most one of <b>irdddk</b> or <a href=\"varfil.html#getddk\">getddk</a> can be non-zero</li>\n<li>one of them must be non-zero if an homogeneous\nelectric field calculation is done\n(presently, a ddk calculation in the same dataset\nis not allowed)</li>\n<li>if <b>irdddk</b> = 1 : read first-order ddk wavefunctions\nfrom a disk file appended with _1WFx , produced in a\nprevious response function calculation (see the\n<a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help).</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "iscf": {
    "category": " ",
    "default": "7 (norm-conserving), 17 (PAW) or 0 (WVL). (prior to v5.3 : 5 and 14) ",
    "definition": "Integer for Self-Consistent-Field cycles ",
    "section": "varbas",
    "text": "<p>\nControls the self-consistency.\n<br>Positive values =>\nthis is the usual choice for doing the usual ground state (GS)\ncalculations or for structural relaxation, where\nthe potential has to be determined self-consistently.\nThe choice between different algorithms for SCF is possible :\n<ul>\n<li>=0 => SCF cycle, direct minimization scheme on the gradient of the wavefunctions. This algorithm is faster than diagonalisation and mixing but is working only for systems with a gap. It is implemented only on the wavelet basis set, when <a href=\"varbas.html#usewvl\">usewvl</a>=1.</li>\n<li>=1 => get the largest eigenvalue of the SCF cycle\n<br>(DEVELOP option, used with\n<a href=\"varfil.html#irdwfk\">irdwfk</a>=1 or\n<a href=\"varfil.html#irdwfk\">irdwfq</a>=1)</li>\n<li>=2 => SCF cycle, simple mixing of the potential</li>\n<li>=3 => SCF cycle, Anderson mixing of the potential</li>\n<li>=4 => SCF cycle, Anderson mixing of the potential based on the two previous iterations</li>\n<li>=5 => SCF cycle, CG based on the minim. of the energy with respect to the potential</li>\n<li>=7 => SCF cycle, Pulay mixing of the potential based on the <a href=\"vardev.html#npulayit\">npulayit</a> previous iterations</li>\n<li>=12 => SCF cycle, simple mixing of the density</li>\n<li>=13 => SCF cycle, Anderson mixing of the density</li>\n<li>=14 => SCF cycle, Anderson mixing of the density based on the two previous iterations</li>\n<li>=15 => SCF cycle, CG based on the minim. of the energy with respect to the density</li>\n<li>=17 => SCF cycle, Pulay mixing of the density based on the <a href=\"vardev.html#npulayit\">npulayit</a> previous iterations</li>\n<li>Other positive values, including zero ones, are not allowed. </li>\n</ul>\n<p>\nSuch algorithms for treating the \"SCF iteration history\" should be coupled with accompanying algorithms\nfor the SCF \"preconditioning\". See the input variable <a href=\"vargs.html#iprcel\">iprcel</a>.\nThe default value <a href=\"vargs.html#iprcel\">iprcel</a>=0 is often a good choice, but\nfor inhomogeneous systems, you might gain a lot with <a href=\"vargs.html#iprcel\">iprcel</a>=45.\n<p>\n(Warning : if <b>iscf</b>&gt;10, at present (v4.6), the energy printed at each SCF cycle is not variational -\nthis should not affect the other properties, and at convergence, all values are OK)\n<p>\n- In the norm-conserving case,\nthe default option is <b>iscf</b>=7, which is a compromise between speed and reliability.\nThe value <b>iscf</b>= 2 is safer but slower.\n<br>\n- In the PAW case, default option is <b>iscf</b>=17.\nIn PAW you have the possibility to mix density/potential on the fine or coarse FFT grid (see <a href=\"varpaw.html#pawmixdg\">pawmixdg</a>).\n<br>- Note that a Pulay mixing (<b>iscf</b>=7 or 17) with <a href=\"vardev.html#npulayit\">npulayit</a>\n=1 (resp. 2) is equivalent to an Anderson mixing with <b>iscf</b>=3 or 13 (resp. 4 or 14).\n<br>- Also note that: <br>* when mixing is done on potential (iscf</b><10), total energy is computed by \"direct\" decomposition.\n<br>* when mixing is done on density (iscf</b>>=10), total energy is computed by \"double counting\" decomposition.\n<br>\"Direct\" and \"double counting\" decomposition of energy are equal when SCF cycle is converged. Note that,\nwhen using GGA XC functionals, these decompositions of energy can be slighty different due\nto imprecise computation of density gradients on FFT grid (difference decreases as size of FFT grid increases -\nsee <a href=\"varbas.html#ecut\">ecut</a> for NC pseudopotentials, <a href=\"varpaw.html#pawecutdg\">pawecutdg</a> for PAW).\n<br>\n<br>Other (negative) options:\n<ul>\n<li>= -2 =>\na non-self-consistent calculation is to be done;\nin this case an electron density rho(r) on a real space grid\n(produced in a previous calculation) will be read from a\ndisk file (automatically if <a href=\"varbas.html#ndtset\">ndtset</a>=0, or\naccording to the value of <a href=\"varfil.html#getden\">getden</a>\nif <a href=\"varbas.html#ndtset\">ndtset</a>/=0).\n<br>The name of the density file must be given as indicated\nin the <a href=\"../users/abinit_help.html#4\">section 4</a> of abinit_help.\n<b>iscf</b>=-2 would be used for\nband structure calculations, to permit computation of\nthe eigenvalues of occupied and unoccupied states at\narbitrary k points in the fixed self consistent potential\nproduced by some integration grid of k points.\nDue to this typical use, ABINIT insist that either\n<a href=\"varfil.html#prtvol\">prtvol</a>&gt;2 or\n<a href=\"varfil.html#prteig\">prteig</a> does not vanish\nwhen there are more than 50 k points.\n<br>To compute the eigenvalues\n(and wavefunctions) of unoccupied states in a separate\n(non-selfconsistent) run, the user should\nsave the self-consistent rho(r)\nand then run <b>iscf</b>=-2 for the intended set of k-points and bands.\n<br>To prepare a run with <b>iscf</b>=-2, a density file\ncan be produced using the\nparameter <a href=\"varfil.html#prtden\">prtden</a> (see its description).\nWhen a self-consistent set of wavefunctions is already available,\nabinit can be used with\n<a href=\"varbas.html#nstep\">nstep</a>=0 (see Test_v2/t47.in),\nand the adequate value of <a href=\"varfil.html#prtden\">prtden</a>.\n</li>\n<li>= -3 =>\nlike -2, but initialize <a href=\"vargs.html#occ\">occ</a> and <a href=\"varbas.html#wtk\">wtk</a>,\ndirectly or indirectly (using <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>)\ndepending on the value of <a href=\"varbas.html#occopt\">occopt</a>.\n<br>For GS, this option\nmight be used to generate Density-of-states\n(thanks to <a href=\"varfil.html#prtdos\">prtdos</a>),\nor to produce STM charge density map (thanks to <a href=\"varfil.html#prtstm\">prtstm</a>).\n<br>For RF, this option is needed to compute the response to ddk perturbation.</li>\n\n<li>= -1 => like -2, but the non-self-consistent calculation\nis followed by the determination of excited states\nwithin TDDFT. This is only possible for <a href=\"varbas.html#nkpt\">nkpt</a>=1,\nwith <a href=\"varbas.html#kpt\">kpt</a>=0 0 0.\nNote that the oscillator strength needs to be defined with respect to\nan origin of coordinate, thanks to the input variable\n<a href=\"vargs.html#boxcenter\">boxcenter</a>. The maximal\nnumber of Kohn-Sham excitations to be used to build the\nexcited state TDDFT matrix can be defined by <a href=\"varrf.html#td_mexcit\">td_mexcit</a>,\nor indirectly by the maximum Kohn-Sham excitation energy\n<a href=\"varrf.html#td_maxene\">td_maxene</a>.\n</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "isecur": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0. ",
    "definition": "Integer for level of SECURity choice ",
    "section": "vardev",
    "text": "<p>\nIn the presently used algorithms, there is a compromise\nbetween speed and robustness, that can be tuned by\nusing <b>isecur</b>.\n<br>If <b>isecur</b> =0, an extrapolation of out-of-line\ndata is allowed, and might save one non-SCF calculation every\ntwo line minimisation when some stability conditions\nare fulfilled (since there are 2 non-SCF calculations\nper line minimisation, 1 out of 4 is saved)\n<br>Using <b>isecur</b>=1 or higher integers will raise gradually\nthe threshold to make extrapolation.\n<br>Using <b>isecur</b>=-2 will allow to save 2 non-SCF calculations\nevery three line minimisation, but this can make the\nalgorithm unstable. Lower values of <b>isecur</b> allows\nfor more (tentative) savings. In any case, there must\nbe one non-SCF computation per line minimisation.\n<br>No meaning for RF calculations yet.  ",
    "vartype": "integer "
  },
  "istatimg": {
    "category": "",
    "default": "<b>istatimg</b>= 1",
    "definition": "Integer governing the computation of STATic IMaGes ",
    "section": "varrlx",
    "text": "<p>\nThis input variable is relevant when sets of images are activated (see\n<a href=\"varrlx.html#imgmov\">imgmov</a>).<br>\nNot all images might be required to evolve from one time step to the other\n(see<a href=\"varrlx.html#dynimage\">dynimage</a>): these are static images.<br>\nIf <b>istatimg</b>=0, the total energy of static images is not computed (but static images are\nused to make the dynamic images evolve). This can be useful to save CPU time.<br>\nIf <b>istatimg</b>=1, the total energy of static images is computed.\n",
    "vartype": "integer parameter"
  },
  "istatr": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, <a href=\"../users/abinit_help.html#no_multi\">NO_MULTI</a> ",
    "default": "49, and 149 for Cray T3E (slow I/Os).Values lower than 10 may not work on some machines. Default <b>istatshft</b> is 1.",
    "definition": "Integer for STATus file repetition Rate ",
    "section": "vardev",
    "text": "<p>\nGovern the rate of output of the status file.\nThis status file is written when the number of the\ncall to the status\nsubroutine is equal to '<b>istatshft</b>' modulo '<b>istatr</b>', so that\nit is written once every '<b>istatr</b>' call.\nThere is also a writing for each of the 5 first calls,\nand the 10th call.",
    "vartype": "integer parameter "
  },
  "istatshft": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, <a href=\"../users/abinit_help.html#no_multi\">NO_MULTI</a> ",
    "default": "49, and 149 for Cray T3E (slow I/Os).Values lower than 10 may not work on some machines. Default <b>istatshft</b> is 1.",
    "definition": "Integer for STATus file SHiFT",
    "section": "vardev",
    "text": "<p>\nGovern the rate of output of the status file.\nThis status file is written when the number of the\ncall to the status\nsubroutine is equal to '<b>istatshft</b>' modulo '<b>istatr</b>', so that\nit is written once every '<b>istatr</b>' call.\nThere is also a writing for each of the 5 first calls,\nand the 10th call.",
    "vartype": "integer parameter "
  },
  "istwfk": {
    "category": " ",
    "default": "0 for all k points for GS calculations. For RF calculations, the Default is not used : <b>istwfk</b> is forced to be 1 deep inside the code, for all k points. For spin-orbit calculations (<a href=\"vargs.html#nspinor\">nspinor</a>=2), <b>istwfk</b> is also forced to be 1, for all k points.",
    "definition": "Integer for choice of STorage of WaveFunction at each k point ",
    "section": "vardev",
    "text": "<p>\nControl the way the\nwavefunction for each k-point is stored inside ABINIT,\nin reciprocal space.\n<br>For the GS calculations, in the \"cg\" array containing the\nwavefunction coefficients, there is for each k-point\nand each band, a segment cg(1:2,1:npw). The 'full' number\nof plane wave is determined by <a href=\"varbas.html#ecut\">ecut</a>.\nHowever, if the k-point coordinates are build\nonly from zeroes and halves (see list below),\nthe use of time-reversal symmetry (that connects coefficients)\nhas been implemented, in order to use real-to-complex\nFFTs (see <a href=\"vardev.html#fftalg\">fftalg</a>), and to treat explicitly only half\nof the number of plane waves (this being used as 'npw').\n<br>For the RF calculations, there is not only the \"cg\"\narray, but also the \"cgq\" and \"cg1\" arrays. For the\ntime-reversal symmetry to decrease the number of\nplane waves of these arrays, the q vector MUST be (0 0 0).\nThen, for each k point, the same rule as for the\nRF can be applied.\n<br>WARNING (991018) : for the time being, the time-reversal\nsymmetry cannot be used in the RF calculations.\n<ul>\n<li>1=&gt; do NOT take advantage of the time-reversal symmetry</li>\n<li>2=&gt; use time-reversal symmetry for k=( 0   0   0 )</li>\n<li>3=&gt; use time-reversal symmetry for k=(1/2  0   0 )</li>\n<li>4=&gt; use time-reversal symmetry for k=( 0   0  1/2)</li>\n<li>5=&gt; use time-reversal symmetry for k=(1/2  0  1/2)</li>\n<li>6=&gt; use time-reversal symmetry for k=( 0  1/2  0 )</li>\n<li>7=&gt; use time-reversal symmetry for k=(1/2 1/2  0 )</li>\n<li>8=&gt; use time-reversal symmetry for k=( 0  1/2 1/2)</li>\n<li>9=&gt; use time-reversal symmetry for k=(1/2 1/2 1/2)</li>\n<li>0=&gt; (preprocessed) for each k point, choose automatically\nthe appropriate time-reversal option when it is allowed,\nand chose <b>istwfk</b>=1 for all the other k points.</li>\n</ul>\nNote that the input variable \"<a href=\"varfil.html#mkmem\">mkmem</a>\" also controls\nthe wavefunction storage, but at the\nlevel of core memory versus disk space.",
    "vartype": "integer array istwfk(<a href=\"varbas.html#nkpt\">nkpt</a>)  "
  },
  "ixc": {
    "category": " ",
    "default": "<b>ixc</b>=1 (Teter parameterization). However, if all the pseudopotentials have the same value of pspxc, the initial value of <b>ixc</b> will be that common value.",
    "definition": "Integer for eXchange-Correlation choice ",
    "section": "varbas",
    "text": "<p>\nControls the choice of exchange and correlation (xc). The list of XC functionals is given\nbelow. Positive values are for ABINIT native library of XC functionals, while negative values are for calling\nthe much wider set of functionals from the ETSF LibXC library (by M. Marques), also available at the\n<a href=\"http://www.etsf.eu/resources/software/libraries_and_tools\"> ETSF library Web page </a>\n\n<br>Note that the choice made here should agree with the choice\nmade in generating the original pseudopotential, except\nfor <b>ixc</b>=0 (usually only used for debugging).\nA warning is issued if this is not the case.\nHowever, the choices <b>ixc</b>=1, 2, 3 and 7 are fits to the same data, from\nCeperley-Alder, and are rather similar, at least for spin-unpolarized systems.\n<br>The choice between the non-spin-polarized and spin-polarized case\nis governed by the value of <a href=\"varbas.html#nsppol\">nsppol</a> (see below).\n<p>\n\n<p><b> Native ABINIT XC functionals</b><p>\n\n<br>NOTE : in the implementation of the spin-dependence of these\nfunctionals, and in order to avoid divergences in their\nderivatives, the interpolating function between spin-unpolarized\nand fully-spin-polarized function has been slightly modified,\nby including a zeta rescaled by 1.d0-1.d-6. This should affect\ntotal energy at the level of 1.d-6Ha, and should\nhave an even smaller effect on differences of energies, or derivatives.\n<br>The value <b>ixc</b>=10 is used internally : gives the difference between <b>ixc</b>=7 and\n<b>ixc</b>=9, for use with an accurate RPA correlation energy.\n\n<p>\n\n<ul>\n<li>0=> NO xc; </li>\n</ul>\n<ul>\n<li>1=> LDA or LSD, Teter Pade parametrization (4/93, published in S. Goedecker, M. Teter, J. Huetter, Phys.Rev.B54, 1703 (1996)), which\nreproduces Perdew-Wang (which reproduces Ceperley-Alder!).</li>\n<li>2=> LDA, Perdew-Zunger-Ceperley-Alder (no spin-polarization)</li>\n<li>3=> LDA, old Teter rational polynomial parametrization (4/91)\nfit to Ceperley-Alder data (no spin-polarization)</li>\n<li>4=> LDA, Wigner functional (no spin-polarization)</li>\n<li>5=> LDA, Hedin-Lundqvist functional (no spin-polarization)</li>\n<li>6=> LDA, \"X-alpha\" functional (no spin-polarization)</li>\n<li>7=> LDA or LSD, Perdew-Wang 92 functional</li>\n<li>8=> LDA or LSD, x-only part of the Perdew-Wang 92 functional</li>\n<li>9=> LDA or LSD, x- and RPA correlation part of the Perdew-Wang 92 functional</li>\n</ul>\n<ul>\n<li>11=> GGA, Perdew-Burke-Ernzerhof GGA functional</li>\n<li>12=> GGA, x-only part of Perdew-Burke-Ernzerhof GGA functional</li>\n<li>13=> GGA potential of van Leeuwen-Baerends, while for energy, Perdew-Wang 92 functional</li>\n<li>14=> GGA, revPBE of Y. Zhang and W. Yang, Phys. Rev. Lett. 80, 890 (1998)</li>\n<li>15=> GGA, RPBE of B. Hammer, L.B. Hansen and J.K. Norskov, Phys. Rev. B 59, 7413 (1999)</li>\n<li>16=> GGA, HTCH93 of F.A. Hamprecht, A.J. Cohen, D.J. Tozer, N.C. Handy, J. Chem. Phys. 109, 6264 (1998)</li>\n<li>17=> GGA, HTCH120 of A.D. Boese, N.L. Doltsinis, N.C. Handy, and M. Sprik, J. Chem. Phys 112, 1670 (1998) - The usual HCTH functional.</li>\n<li>18=> (NOT AVAILABLE : used internally for GGA BLYP pseudopotentials from\nM. Krack, see Theor. Chem. Acc. 114, 145 (2005),\navailable from the <a href=\"http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/blyp/\">CP2K repository</a>\n- use the LibXC instead, with <b>ixc</b>=-106131.</li>\n<li>19=> (NOT AVAILABLE : used internally for GGA BP86 pseudopotentials from\nM. Krack, see Theor. Chem. Acc. 114, 145 (2005),\navailable from the <a href=\"http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/bp/\">CP2K repository</a>\n- use the LibXC instead, with <b>ixc</b>=-106132.</li>\n</ul>\n<ul>\n<li>20=> Fermi-Amaldi xc ( -1/N Hartree energy, where N is the\nnumber of electrons per cell ; G=0 is not taken\ninto account however), for TDDFT tests.\nNo spin-pol. Does not work for RF.</li>\n<li>21=> same as 20, except that the xc-kernel is the LDA (<b>ixc</b>=1) one,\nfor TDDFT tests.</li>\n<li>22=> same as 20, except that the xc-kernel is the Burke-Petersilka-Gross\nhybrid, for TDDFT tests.</li>\n<li>23=> GGA of Z. Wu and R.E. Cohen, Phys. Rev. 73, 235116 (2006).</li>\n<li>24=> GGA, C09x exchange of V. R. Cooper, PRB 81, 161104(R) (2010).</li>\n<li>26=> GGA, HTCH147 of A.D. Boese, N.L. Doltsinis, N.C. Handy, and M. Sprik, J. Chem. Phys 112, 1670 (1998).</li>\n<li>27=> GGA, HTCH407 of A.D. Boese, and N.C. Handy, J. Chem. Phys 114, 5497 (2001).</li>\n<li>28=> (NOT AVAILABLE : used internally for GGA OLYP pseudopotentials from\nM. Krack, see Theor. Chem. Acc. 114, 145 (2005),\navailable from the <a href=\"http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/blyp/\">CP2K repository</a>\n- use the LibXC instead, with <b>ixc</b>=-110131.</li>\n</ul>\n\n<p><b> ETSF Lib XC functionals</b><p>\nNote that you must compile ABINIT with the LibXC plug-in in order to be able to access these functionals.\n<br>\nThe LibXC functionals are accessed by <b>negative values</b> of <b>ixc</b>.\nThe LibXC contains functional forms for either exchange-only functionals, correlation-only functionals,\nor combined exchange and correlation functionals. Each of them is to be specified by a three-digit number.\nIn case of a combined exchange and correlation functional, only one such three-digit number has to be specified as value of <b>ixc</b>,\nwith a minus sign (to indicate that it comes from the LibXC).\nIn the case of separate exchange functional (let us represent its identifier by XXX) and\ncorrelation functional (let us represent its identified by CCC),\na six-digit number will have to be specified for <b>ixc</b>, by concatenation, be it XXXCCC or CCCXXX.\nAs an example, <b>ixc</b>=-020 gives access to the Teter93 LDA, while\n<b>ixc</b>=-101130 gives access to the PBE GGA.\nIn version 0.9 of LibXC (December 2008), there are 16 three-dimensional (S)LDA functionals (1 for X, 14 for C, 1 for combined XC),\nand there are 41 three-dimensional GGA (23 for X, 8 for C, 10 for combined XC).\nNote that for a meta-GGA, the kinetic energy density is needed. This means having <a href=\"vargs.html#usekden\">usekden</a>=1 .\n<p>\n<p> (S)LDA functionals (do not forget to add a minus sign, as discussed above)<p>\n<ul>\n\n<li>001=> XC_LDA_X\n[PAM Dirac, Proceedings of the Cambridge Philosophical Society 26, 376 (1930);\nF Bloch, Zeitschrift fuer Physik 57, 545 (1929)\n]</li>\n\n<li>002=> XC_LDA_C_WIGNER Wigner parametrization\n[EP Wigner, Trans. Faraday Soc. 34, 678 (1938)\n]</li>\n\n<li>003=> XC_LDA_C_RPA Random Phase Approximation\n[M Gell-Mann and KA Brueckner, Phys. Rev. 106, 364 (1957)\n]</li>\n\n<li>004=> XC_LDA_C_HL Hedin & Lundqvist\n[L Hedin and BI Lundqvist, J. Phys. C 4, 2064 (1971)\n]</li>\n\n<li>005=> XC_LDA_C_GL !  Gunnarson & Lundqvist\n[O Gunnarsson and BI Lundqvist, PRB 13, 4274 (1976)\n]</li>\n\n<li>006=> XC_LDA_C_XALPHA  !  Slater's Xalpha\n]</li>\n\n<li>007=> XC_LDA_C_VWN !  Vosko, Wilk, & Nussair\n[SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980)\n]</li>\n\n<li>008=> XC_LDA_C_VWN_RPA !  Vosko, Wilk, & Nussair (RPA)\n[SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980)\n]</li>\n\n<li>009=> XC_LDA_C_PZ !  Perdew & Zunger\n[Perdew and Zunger, Phys. Rev. B 23, 5048 (1981)\n]</li>\n\n<li>010=> XC_LDA_C_PZ_MOD !  Perdew & Zunger (Modified)\n[Perdew and Zunger, Phys. Rev. B 23, 5048 (1981)\nModified to improve the matching between the low and high rs part\n]</li>\n\n<li>011=> XC_LDA_C_OB_PZ !  Ortiz & Ballone (PZ)\n[G Ortiz and P Ballone, Phys. Rev. B 50, 1391 (1994) ;\nG Ortiz and P Ballone, Phys. Rev. B 56, 9970(E) (1997) ;\nPerdew and Zunger, Phys. Rev. B 23, 5048 (1981)\n]</li>\n\n<li>012=> XC_LDA_C_PW !  Perdew & Wang\n[JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992)\n]</li>\n\n<li>013=> XC_LDA_C_PW_MOD !  Perdew & Wang (Modified)\n[JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992) ;\nAdded extra digits to some constants as in the PBE routine\nsee <a href=\"http://www.chem.uci.edu/~kieron/dftold2/pbe.php\">http://www.chem.uci.edu/~kieron/dftold2/pbe.php</a>\n(at some point it was available at http://dft.uci.edu/pbe.php)\n]</li>\n\n<li>014=> XC_LDA_C_OB_PW !  Ortiz & Ballone (PW)\n[G Ortiz and P Ballone, Phys. Rev. B 50, 1391 (1994) ;\nG Ortiz and P Ballone, Phys. Rev. B 56, 9970(E) (1997) ;\nJP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992)\n]</li>\n\n<li>017=> XC_LDA_C_vBH !  von Barth & Hedin\n[U von Barth and L Hedin, J. Phys. C: Solid State Phys. 5, 1629 (1972)\n]</li>\n\n<li>020=> XC_LDA_XC_TETER93 !  Teter 93 parametrization\n[S Goedecker, M Teter, J Hutter, PRB 54, 1703 (1996)\n]</li>\n\n<li>022=> XC_LDA_C_ML1 !  Modified LSD (version 1) of Proynov and Salahub\n[EI Proynov and D Salahub, Phys. Rev. B 49, 7874 (1994)\n]</li>\n\n<li>023=> XC_LDA_C_ML2 !  Modified LSD (version 2) of Proynov and Salahub\n[EI Proynov and D Salahub, Phys. Rev. B 49, 7874 (1994)\n]</li>\n\n<li>024=> XC_LDA_C_GOMBAS !  Gombas parametrization\n[P. Gombas, Pseudopotentials (Springer-Verlag, New York, 1967)\n]</li>\n\n\n</ul>\n<p> GGA functionals (do not forget to add a minus sign, as discussed above)<p>\n<ul>\n\n<li>101=> XC_GGA_X_PBE !  Perdew, Burke & Ernzerhof exchange\n[JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996) ;\nJP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 78, 1396(E) (1997)\n]</li>\n\n<li>102=> XC_GGA_X_PBE_R !  Perdew, Burke & Ernzerhof exchange (revised)\n[Y Zhang and W Yang, Phys. Rev. Lett 80, 890 (1998)\n]</li>\n\n<li>103=> XC_GGA_X_B86 !  Becke 86 Xalfa,beta,gamma\n[AD Becke, J. Chem. Phys 84, 4524 (1986)\n]</li>\n\n<li>104=> XC_GGA_X_HERMAN !  Herman Xalphabeta GGA\n[F Herman, JP Van Dyke, and IB Ortenburger, Phys. Rev. Lett. 22, 807 (1969) ;\nF Herman, IB Ortenburger, and JP Van Dyke, Int. J. Quantum Chem. Symp. 3, 827 (1970)\n]</li>\n\n<li>105=> XC_GGA_X_B86_MGC !  Becke 86 Xalfa,beta,gamma (with mod. grad. correction)\n[AD Becke, J. Chem. Phys 84, 4524 (1986) ;\nAD Becke, J. Chem. Phys 85, 7184 (1986)\n]</li>\n\n<li>106=> XC_GGA_X_B88 !  Becke 88\n[AD Becke, Phys. Rev. A 38, 3098 (1988)\n]</li>\n\n<li>107=> XC_GGA_X_G96 !  Gill 96\n[PMW Gill, Mol. Phys. 89, 433 (1996)\n]</li>\n\n<li>108=> XC_GGA_X_PW86 !  Perdew & Wang 86\n[JP Perdew and Y Wang, Phys. Rev. B 33, 8800 (1986)\n]</li>\n\n<li>109=> XC_GGA_X_PW91 !  Perdew & Wang 91\n[JP Perdew, in Proceedings of the 21st Annual International Symposium on the Electronic Structure of Solids, ed. by P Ziesche and H\nEschrig (Akademie Verlag, Berlin, 1991), p. 11. ;\nJP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 46, 6671 (1992) ;\nJP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 48, 4978(E) (1993)\n]</li>\n\n<li>110=> XC_GGA_X_OPTX !  Handy & Cohen OPTX 01\n[NC Handy and AJ Cohen, Mol. Phys. 99, 403 (2001)\n]</li>\n\n<li>111=> XC_GGA_X_DK87_R1 !  dePristo & Kress 87 (version R1)\n[AE DePristo and JD Kress, J. Chem. Phys. 86, 1425 (1987)\n]</li>\n\n<li>112=> XC_GGA_X_DK87_R2 !  dePristo & Kress 87 (version R2)\n[AE DePristo and JD Kress, J. Chem. Phys. 86, 1425 (1987)\n]</li>\n\n<li>113=> XC_GGA_X_LG93 !  Lacks & Gordon 93\n[DJ Lacks and RG Gordon, Phys. Rev. A 47, 4681 (1993)\n]</li>\n\n<li>114=> XC_GGA_X_FT97_A !  Filatov & Thiel 97 (version A)\n[M Filatov and W Thiel, Mol. Phys 91, 847 (1997)\n]</li>\n\n<li>115=> XC_GGA_X_FT97_B !  Filatov & Thiel 97 (version B)\n[M Filatov and W Thiel, Mol. Phys 91, 847 (1997)\n]</li>\n\n<li>116=> XC_GGA_X_PBE_SOL !  Perdew, Burke & Ernzerhof exchange (solids)\n[JP Perdew, et al, Phys. Rev. Lett. 100, 136406 (2008)\n]</li>\n\n<li>117=> XC_GGA_X_RPBE !  Hammer, Hansen & Norskov (PBE-like)\n[B Hammer, LB Hansen and JK Norskov, Phys. Rev. B 59, 7413 (1999)\n]</li>\n\n<li>118=> XC_GGA_X_WC !  Wu & Cohen\n[Z Wu and RE Cohen, Phys. Rev. B 73, 235116 (2006)\n]</li>\n\n<li>119=> XC_GGA_X_mPW91 !  Modified form of PW91 by Adamo & Barone\n[C Adamo and V Barone, J. Chem. Phys. 108, 664 (1998)\n]</li>\n\n<li>120=> XC_GGA_X_AM05 !  Armiento & Mattsson 05 exchange\n[R Armiento and AE Mattsson, Phys. Rev. B 72, 085108 (2005) ;\nAE Mattsson, R Armiento, J Paier, G Kresse, JM Wills, and TR Mattsson, J. Chem. Phys. 128, 084714 (2008)\n]</li>\n\n<li>121=> XC_GGA_X_PBEA !  Madsen (PBE-like)\n[G Madsen, Phys. Rev. B 75, 195108 (2007)\n]</li>\n\n<li>122=> XC_GGA_X_MPBE !  Adamo & Barone modification to PBE\n[C Adamo and V Barone, J. Chem. Phys. 116, 5933 (2002)\n]</li>\n\n<li>123=> XC_GGA_X_XPBE !  xPBE reparametrization by Xu & Goddard\n[X Xu and WA Goddard III, J. Chem. Phys. 121, 4068 (2004)\n]</li>\n\n<li>125=> XC_GGA_X_BAYESIAN !  Bayesian best fit for the enhancement factor\n[JJ Mortensen, K Kaasbjerg, SL Frederiksen, JK Norskov, JP Sethna, and KW Jacobsen, Phys. Rev. Lett. 95, 216401 (2005)\n]</li>\n\n<li>126=> XC_GGA_X_PBE_JSJR !  PBE JSJR reparametrization by Pedroza, Silva & Capelle\n[LS Pedroza, AJR da Silva, and K. Capelle, Phys. Rev. B 79, 201106(R) (2009)\n]</li>\n\n<li>130=> XC_GGA_C_PBE !  Perdew, Burke & Ernzerhof correlation\n[JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996) ;\nJP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 78, 1396(E) (1997)\n]</li>\n\n<li>131=> XC_GGA_C_LYP !  Lee, Yang & Parr\n[C Lee, W Yang and RG Parr, Phys. Rev. B 37, 785 (1988)\nB Miehlich, A Savin, H Stoll and H Preuss, Chem. Phys. Lett. 157, 200 (1989)\n]</li>\n\n<li>132=> XC_GGA_C_P86 !  Perdew 86\n[JP Perdew, Phys. Rev. B 33, 8822 (1986)\n]</li>\n\n<li>133=> XC_GGA_C_PBE_SOL !  Perdew, Burke & Ernzerhof correlation SOL\n[JP Perdew, et al, Phys. Rev. Lett. 100, 136406 (2008)\n]</li>\n\n<li>134=> XC_GGA_C_PW91 !  Perdew & Wang 91\n[JP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 46, 6671 (1992)\n]</li>\n\n<li>135=> XC_GGA_C_AM05 !  Armiento & Mattsson 05 correlation\n[ R Armiento and AE Mattsson, Phys. Rev. B 72, 085108 (2005) ;\nAE Mattsson, R Armiento, J Paier, G Kresse, JM Wills, and TR Mattsson, J. Chem. Phys. 128, 084714 (2008)\n]</li>\n\n<li>136=> XC_GGA_C_XPBE !  xPBE reparametrization by Xu & Goddard\n[X Xu and WA Goddard III, J. Chem. Phys. 121, 4068 (2004)\n]</li>\n\n<li>137=> XC_GGA_C_LM !  Langreth and Mehl correlation\n[DC Langreth and MJ Mehl, Phys. Rev. Lett. 47, 446 (1981)\n]</li>\n\n<li>138=> XC_GGA_C_PBE_JRGX !  JRGX reparametrization by Pedroza, Silva & Capelle\n[LS Pedroza, AJR da Silva, and K. Capelle, Phys. Rev. B 79, 201106(R) (2009)\n]</li>\n\n<li>139=> XC_GGA_X_OPTB88_VDW !  Becke 88 reoptimized to be used with vdW functional of Dion et al\n[J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010)\n]</li>\n\n<li>140=> XC_GGA_X_PBEK1_VDW !  PBE reparametrization for vdW\n[J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010)\n]</li>\n\n<li>141=> XC_GGA_X_OPTPBE_VDW !  PBE reparametrization for vdW\n[J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010)\n]</li>\n\n<li>142=> XC_GGA_X_RGE2 !  Regularized PBE\n[A Ruzsinszky, GI Csonka, and G Scuseria, J. Chem. Theory Comput. 5, 763 (2009)\n]</li>\n\n<li>143=> XC_GGA_C_RGE2 !  Regularized PBE\n[A Ruzsinszky, GI Csonka, and G Scuseria, J. Chem. Theory Comput. 5, 763 (2009)\n]</li>\n\n<li>144=> XC_GGA_X_RPW86 !  refitted Perdew & Wang 86\n[ED Murray, K Lee and DC Langreth, J. Chem. Theory Comput. 5, 2754-2762 (2009)\n]</li>\n\n<li>145=> XC_GGA_X_KT1 !  Keal and Tozer version 1\n[TW Keal and DJ Tozer, J. Chem. Phys. 119, 3015 (2003)\n]</li>\n\n<li>146=> XC_GGA_XC_KT2 !  Keal and Tozer version 2\n[TW Keal and DJ Tozer, J. Chem. Phys. 119, 3015 (2003)\n]</li>\n\n<li>147=> XC_GGA_C_WL !  Wilson & Levy\n[LC Wilson and M Levy, Phys. Rev. B 41, 12930 (1990)\n]</li>\n\n<li>148=> XC_GGA_C_WI !  Wilson & Ivanov\n[LC Wilson & S Ivanov, Int. J. Quantum Chem. 69, 523-532 (1998)\n]</li>\n\n<li>149=> XC_GGA_X_MB88 !  Modified Becke 88 for proton transfer\n[V Tognetti and C Adamo, J. Phys. Chem. A 113, 14415-14419 (2009)\n]</li>\n\n<!-- The following functional is untested in ABINIT\n<li>160=> XC_GGA_XC_LB !  van Leeuwen & Baerends\n[R van Leeuwen and EJ Baerends, Phys. Rev. A. 49, 2421 (1994)\n]</li>\n-->\n\n<li>161=> XC_GGA_XC_HCTH_93 !  HCTH functional fitted to  93 molecules\n[FA Hamprecht, AJ Cohen, DJ Tozer, and NC Handy, J. Chem. Phys. 109, 6264 (1998)\n]</li>\n\n<li>162=> XC_GGA_XC_HCTH_120 !  HCTH functional fitted to 120 molecules\n[AD Boese, NL Doltsinis, NC Handy, and M Sprik, J. Chem. Phys. 112, 1670 (2000)\n]</li>\n\n<li>163=> XC_GGA_XC_HCTH_147 !  HCTH functional fitted to 147 molecules\n[AD Boese, NL Doltsinis, NC Handy, and M Sprik, J. Chem. Phys. 112, 1670 (2000)\n]</li>\n\n<li>164=> XC_GGA_XC_HCTH_407 !  HCTH functional fitted to 407 molecules\n[AD Boese, and NC Handy, J. Chem. Phys. 114, 5497 (2001)\n]</li>\n\n<li>165=> XC_GGA_XC_EDF1 !  Empirical functionals from Adamson, Gill, and Pople\n[RD Adamson, PMW Gill, and JA Pople, Chem. Phys. Lett. 284 6 (1998)\n]</li>\n\n<li>166=> XC_GGA_XC_XLYP !  XLYP functional\n[X Xu and WA Goddard, III, PNAS 101, 2673 (2004)\n]</li>\n\n<li>167=> XC_GGA_XC_B97 !  Becke 97\n[AD Becke, J. Chem. Phys. 107, 8554-8560 (1997)\n]</li>\n\n<li>168=> XC_GGA_XC_B97_1 !  Becke 97-1\n[FA Hamprecht, AJ Cohen, DJ Tozer, and NC Handy, J. Chem. Phys. 109, 6264 (1998);\nAD Becke, J. Chem. Phys. 107, 8554-8560 (1997)\n]</li>\n\n<li>169=> XC_GGA_XC_B97_2 !  Becke 97-2\n[AD Becke, J. Chem. Phys. 107, 8554-8560 (1997)\n]</li>\n\n<li>170=> XC_GGA_XC_B97_D !  Grimme functional to be used with C6 vdW term\n[S Grimme, J. Comput. Chem. 27, 1787 (2006)\n]</li>\n\n<li>171=> XC_GGA_XC_B97_K !  Boese-Martin for Kinetics\n[AD Boese and JML Martin, J. Chem. Phys., Vol. 121, 3405 (2004)\n]</li>\n\n<li>172=> XC_GGA_XC_B97_3 !  Becke 97-3\n[TW Keal and DJ Tozer, J. Chem. Phys. 123, 121103 (2005)\n]</li>\n\n<li>173=> XC_GGA_XC_PBE1W !  Functionals fitted for water\n[EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005)\n]</li>\n\n<li>174=> XC_GGA_XC_MPWLYP1W !  Functionals fitted for water\n[EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005)\n]</li>\n\n<li>175=> XC_GGA_XC_PBELYP1W !  Functionals fitted for water\n[EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005)\n]</li>\n\n<li>176=> XC_GGA_XC_SB98_1a !  Schmider-Becke 98 parameterization 1a\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>177=> XC_GGA_XC_SB98_1b !  Schmider-Becke 98 parameterization 1b\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>178=> XC_GGA_XC_SB98_1c !  Schmider-Becke 98 parameterization 1c\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>179=> XC_GGA_XC_SB98_2a !  Schmider-Becke 98 parameterization 2a\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>180=> XC_GGA_XC_SB98_2b !  Schmider-Becke 98 parameterization 2b\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>181=> XC_GGA_XC_SB98_2c !  Schmider-Becke 98 parameterization 2c\n[HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998)\n]</li>\n\n<li>183=> XC_GGA_X_OL2 !  Exchange form based on Ou-Yang and Levy v.2\n[P Fuentealba and O Reyes, Chem. Phys. Lett. 232, 31-34 (1995) ; H Ou-Yang, M Levy, Int. J. of Quant. Chem. 40, 379-388 (1991)\n]</li>\n\n<li>184=> XC_GGA_X_APBE !  mu fixed from the semiclassical neutral atom\n[LA Constantin, E Fabiano, S Laricchia, and F Della Sala, Phys. Rev. Lett. 106, 186406 (2011)\n]</li>\n\n<li>186=> XC_GGA_C_APBE !  mu fixed from the semiclassical neutral atom\n[LA Constantin, E Fabiano, S Laricchia, and F Della Sala, Phys. Rev. Lett. 106, 186406 (2011)\n]</li>\n\n<li>202=> XC_MGGA_X_TPSS !  Tao, Perdew, Staroverov & Scuseria\n[J Tao, JP Perdew, VN Staroverov, and G Scuseria, Phys. Rev. Lett. 91, 146401 (2003) ;\nJP Perdew, J Tao, VN Staroverov, and G Scuseria, J. Chem. Phys. 120, 6898 (2004)\n]</li>\n\n<li>203=> XC_MGGA_X_M06L !  Zhao, Truhlar exchange\n[Y Zhao and DG Truhlar, JCP 125, 194101 (2006);\nY Zhao and DG Truhlar, Theor. Chem. Account 120, 215 (2008)\n]</li>\n\n<li>204=> XC_MGGA_X_GVT4 !  GVT4 (X part of VSXC) from van Voorhis and Scuseria\n[T Van Voorhis and GE Scuseria, JCP 109, 400 (1998)\n]</li>\n\n<li>205=> XC_MGGA_X_TAU_HCTH ! tau-HCTH from Boese and Handy\n[AD Boese and NC Handy, JCP 116, 9559 (2002)\n]</li>\n\n<li>207=> XC_MGGA_X_BJ06 !  Becke & Johnson correction to Becke-Roussel 89\n[AD Becke and ER Johnson, J. Chem. Phys. 124, 221101 (2006)\n] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92.</li>\n\n<li>208=> XC_MGGA_X_TB09 !  Tran-blaha - correction to Becke & Johnson correction to Becke-Roussel 89\n[F Tran and P Blaha, Phys. Rev. Lett. 102, 226401 (2009)\n] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92.</li>\n\n<li>209=> XC_MGGA_X_RPP09 !  Rasanen, Pittalis, and Proetto correction to Becke & Johnson\n[E Rasanen, S Pittalis & C Proetto, arXiv:0909.1477 (2009)\n] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92.</li>\n\n<li>232=> XC_MGGA_C_VSXC !  VSxc from Van Voorhis and Scuseria (correlation part)\n[T Van Voorhis and GE Scuseria, JCP 109, 400 (1998)\n]</li>\n\n</ul>\n\n\n",
    "vartype": "integer parameter "
  },
  "ixcpositron": {
    "category": " ",
    "default": "0",
    "definition": "Integer for the eXchange-Correlation applied to the electron-POSITRON interaction",
    "section": "vargs",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#positron\">positron</a>/=0.<br>\nDefine the type of electron-positron correlation that is used in case\nof a electron-positron two-component DFT calculation.<br>\nDefine also the analytical formula of the enhancement factor used to compute the electron-positron annhilation rate:<br><br>\nElectron-positron correlation functional:<br>\n<ul>\n<b>ixcpositron=1</b>:\nLDA zero positron density limit parametrized by Arponen & Pajanne and provided by Boronski & Nieminen [1,2]<br>\n<b>ixcpositron=11</b>:\nLDA zero positron density limit parametrized by Arponen & Pajanne and fitted by Sterne & Kaiser [1,3]<br>\n<b>ixcpositron=2</b>:\nLDA electron-positron correlation provided by Puska, Seitsonen, and Nieminen [1,4]<br>\n<b>ixcpositron=3</b>:\nGGA zero positron density limit parametrized by Arponen & Pajanne and provided by Boronski & Nieminen [1,2,5]<br>\n<b>ixcpositron=31</b>:\nGGA zero positron density limit parametrized by Arponen & Pajanne and fitted by Sterne & Kaiser [1,3,5]\n</ul>\nAnnihilation rate enhancement factor:<br>\n<ul>\n<b>ixcpositron=1</b>:\nBoronski and Nieminen full modelisation and RPA limit [1]<br>\n<b>ixcpositron=11</b>:\nSterne and Kaiser [2]<br>\n<b>ixcpositron=2</b>:\nPuska, Seitsonen and Nieminen [3]<br>\n<b>ixcpositron=3</b>:\nBoronski and Nieminen full modelisation and RPA limit [1], with GGA corrections<br>\n<b>ixcpositron=31</b>:\nSterne and Kaiser [2], with GGA corrections<br>\n</ul>\nReferences:\n<ul>\n<b>[1]</b> J. Arponen and E. Pajanne, Ann. Phys. (N.Y.) 121, 343 (1979).<br>\n<b>[2]</b> Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986).<br>\n<b>[3]</b> P.A. Sterne and J.H. Kaiser, Phys. Rev. B 43, 13892 (1991).<br>\n<b>[4]</b> M.J. Puska, A.P. Seitsonen and R.M. Nieminen, Phys. Rev. B 52, 10947 (1994).<br>\n<b>[5]</b> B. Barbiellini, M.J. Puska, T. Torsti and R.M.Nieminen, Phys. Rev. B 51, 7341 (1994)<br>\n</ul>\n",
    "vartype": "integer parameter"
  },
  "jdtset": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "the series 1, 2, 3 ... <a href=\"varbas.html#ndtset\">ndtset</a> .",
    "definition": "index -J- for DaTaSETs ",
    "section": "varbas",
    "text": "<p>\nGives the dataset index\nof each of the datasets. This index will be used :\n<ul>\n<li>to determine which input variables are specific to each\ndataset, since the variable names for this\ndataset will be made from the bare variable\nname concatenated with this index, and only if\nsuch a composite variable name does not exist,\nthe code will consider the bare variable name,\nor even, the Default;</li>\n<li>to characterize output variable names, if their\ncontent differs from dataset to dataset;</li>\n<li>to characterize output files ( root names appended with _DSx\nwhere 'x' is the dataset index ).</li>\n</ul>\nThe allowed index values are between 1 and 9999.\n<br>An input variable name appended with 0 is not allowed.\n<br>When <a href=\"varbas.html#ndtset\">ndtset</a>==0, this array is not used, and moreover,\nno input variable name appended with a digit is allowed.\nThis array might be initialized thanks to the use of\nthe input variable <a href=\"varbas.html#udtset\">udtset</a>. In this case, <b>jdtset</b> cannot\nbe used.",
    "vartype": "integer array <b>jdtset</b>(<a href=\"varbas.html#ndtset\">ndtset</a>)"
  },
  "jellslab": {
    "category": " ",
    "default": "0 (no jellium slab).",
    "definition": "include a JELLium SLAB in the cell",
    "section": "vargs",
    "text": "<p>\nIf set to 1, a slab of uniform positive background charge density,\nthat is, a jellium slab, is included in the calculation cell.\nA portion of the unit cell is filled with such positive charge density distribution\nwhich is equal to a bulk-mean value n<sub>bulk</sub> between two edges\nand zero in the vacuum region if present.\n<br>\nFor the sake of convenience the unit cell is supposed\nto have the third crystal primitive lattice vector orthogonal\nto the other ones so that the portion of the cell filled by the jellium slab can be defined through its edges along z.\n<br>\nThe bulk-mean positive charge density is fixed by the input variable <a href=\"vargs.html#slabwsrad\">slabwsrad</a>,\nwhile the position of the slab edges along z is defined through\nthe input variables <a href=\"vargs.html#slabzbeg\">slabzbeg</a> and <a href=\"vargs.html#slabzend\">slabzend</a>.",
    "vartype": "integer parameter   "
  },
  "jfielddir": {
    "category": " ",
    "default": "3*0 .",
    "definition": "electric/displacement FIELD DIRection ",
    "section": "varff",
    "text": "<p>\nWhen specifying mixed electric field boundary conditions ( <a href=\"varff.html#berryopt\">berryopt</a>=17),\njfielddir controls whether reduced electric field (<b>jfielddir</b>=1)\nor reduced electric displacement field (<b>jfielddir</b>=2) is chosen to be fixed,\nin each of the three lattice directions (i.e., in the reduced, not the Cartesian, frame).\nFor example, <b>jfielddir</b>=(1 1 2) tells the code to use fixed ebar_1 and ebar_2\nalong the first two lattice directions and fixed d_3 along the third.\n<br>\nFor the case of mixed electric field boundary conditions,\n<a href=\"varff.html#red_efieldbar\">red_efieldbar</a> and <a href=\"varff.html#red_dfield\">red_dfield</a>\nare used to control ebar and d, respectively.\nFor example, for electric boundary conditions corresponding to a material\nin a parallel-plate capacitor, if you want to control d_3=d0,\nwhile fixing ebar_1=ebar_2=0, then the input files should have\n<a href=\"varff.html#berryopt\">berryopt</a>=17, <b>jfielddir</b>=(1 1 2), <a href=\"varff.html#red_efieldbar\">red_efieldbar</a>=(0.0 0.0 a),\nand <a href=\"varff.html#red_dfield\">red_dfield</a>=(b c d0).\nHere a, b, and c are the starting values.\nThey can be chosen in this way: do a single run for fixed d calculation (<a href=\"varff.html#red_dfield\">red_dfield</a>=0,0,d0),\nfrom the final results you will have ebar_3, which is a good guess for a.\nThen do another single run for fixed ebar calculation (<a href=\"varff.html#red_efieldbar\">red_efieldbar</a>=(0 0 0)),\nfrom the final results you will have d_1,d_2, these are good guesses for b, c.\n",
    "vartype": "integer array jfielddir(3)   "
  },
  "jpawu": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0",
    "definition": "value of J for PAW+U ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#usepawu\">usepawu</a>=1.<br>\n<br>\nGives the value of the screened exchange interaction between correlated\nelectrons corresponding to <a href=\"varpaw.html#lpawu\">lpawu</a>\nfor each species.<br>\nIn the case where <a href=\"varpaw.html#lpawu\">lpawu</a> =-1,\nthe value is not used.",
    "vartype": "real array jpawu(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "kberry": {
    "category": " ",
    "default": "an array of 0",
    "definition": "K wavevectors for BERRY phase computation ",
    "section": "varff",
    "text": "<p>Used for non-zero values of <a href=\"varff.html#berryopt\">berryopt</a>.\n<p>This array defines, for each Berry phase calculation\n(the number of such calculations is defined by\n<a href=\"varff.html#nberry\">nberry</a>), the\ndifference of wavevector between k points for which\nthe overlap matrix must be computed.\nThe polarisation vector will be projected\non the direction of that wavevector,\nand the result of the computation will be the magnitude of this\nprojection.\nDoing more than one wavevector, with different independent\ndirection, allows to find the full polarisation vector.\nHowever, note that converged results need oriented grids,\ndenser along the difference wavevector than usual Monkhorst-Pack\ngrids.\n<p> The difference of wavevector is computed in the coordinate\nsystem defined by the k-points grid\n(see <a href=\"varbas.html#ngkpt\">ngkpt</a>\nand <a href=\"vargs.html#kptrlatt\">kptrlatt</a>), so that\nthe values of <b>kberry</b> are integers.\nOf course, such a k point grid must exist, and all the\ncorresponding wavefunctions must be available, so that the\ncomputation is allowed only when <a href=\"varbas.html#kptopt\">kptopt</a>\nis equal to 3. In order to save computing time, it is suggested\nto make a preliminary calculation of the wavefunctions on the\nirreducible part of the grid, with <a href=\"varbas.html#kptopt\">kptopt</a>\nequal to 1, and then use these converged wavefunctions\nin the entire Brillouin zone, by reading them to initialize\nthe <a href=\"varbas.html#kptopt\">kptopt</a>=3 computation.\n",
    "vartype": "integer array kberry(3,<a href=\"varff.html#nberry\">nberry</a>)  "
  },
  "kpt": {
    "category": " ",
    "default": "0. 0. 0. (for just one k-point, adequate for one molecule in a supercell)",
    "definition": "K - PoinTs ",
    "section": "varbas",
    "text": "<p>\nContains the k points in terms\nof reciprocal space primitive translations (NOT in\ncartesian coordinates!).\n<br> Needed ONLY\nif <a href=\"varbas.html#kptopt\">kptopt</a>=0, otherwise\ndeduced from other input variables.\n\n<p>It contains dimensionless numbers in terms of which\nthe cartesian coordinates would be:\n<br><tele>k_cartesian = k1*G1+k2*G2+k3*G3 </tele>\n<br>where <tele>(k1,k2,k3)</tele> represent the dimensionless \"reduced\ncoordinates\" and <tele>G1, G2, G3</tele> are the cartesian coordinates\nof the primitive translation vectors.  G1,G2,G3 are related\nto the choice of direct space primitive translation vectors\nmade in <a href=\"varbas.html#rprim\">rprim</a>.\nNote that an overall norm for the k\npoints is supplied by <a href=\"varbas.html#kptnrm\">kptnrm</a>.  This allows\none to avoid supplying many digits for the k points to\nrepresent such points as (1,1,1)/3.\n<br>Note: one of the algorithms used to set up the sphere\nof G vectors for the basis needs components of k-points\nin the range [-1,1], so the\nremapping is easily done by adding or subtracting 1 from\neach component until it is in the range [-1,1].  That is,\ngiven the k point normalization <a href=\"varbas.html#kptnrm\">kptnrm</a> described below,\neach component must lie in [-<a href=\"varbas.html#kptnrm\">kptnrm</a>,<a href=\"varbas.html#kptnrm\">kptnrm</a>].\n<br>Note: a global shift can be provided by <a href=\"varint.html#qptn\">qptn</a>\n<br>Not read if <a href=\"varbas.html#kptopt\">kptopt</a>/=0 .\n",
    "vartype": "real array kpt(3,<a href=\"varbas.html#nkpt\">nkpt</a>)  "
  },
  "kptbounds": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default",
    "definition": "K PoinTs BOUNDarieS ",
    "section": "vargs",
    "text": "<p>\nIt is used to generate the circuit to be followed by the band structure,\nwhen <a href=\"varbas.html#kptopt\">kptopt</a> is negative (it is\nnot read if <a href=\"varbas.html#kptopt\">kptopt</a> is zero or positive).\n\n<p>There are abs(<a href=\"varbas.html#kptopt\">kptopt</a>)\nsegments to be defined, each of which starting from\nthe end point of the preceeding one. Thus,\nthe number of points to be input is\nabs(<a href=\"varbas.html#kptopt\">kptopt</a>)+1.\nThey form a circuit starting\nat <b>kptbounds</b>(1:3,1)/<a href=\"varbas.html#kptnrm\">kptnrm</a>\nand ending at\n<b>kptbounds</b>(1:3,abs(<a href=\"varbas.html#kptopt\">kptopt</a>)+1)/<a href=\"varbas.html#kptnrm\">kptnrm</a>.\nThe number of divisions of each segment can be defined either using the array <a href=\"vargs.html#ndivk\">ndivk</a>\nor the variable <a href=\"vargs.html#ndivsm\">ndivsm</a> that just defines the number of divisions for the smallest segment\n<p>As for <a href=\"varbas.html#kpt\">kpt</a>, <b>kptbounds</b> is specified\nusing the primitive vectors in reciprocal space. If your Bravais lattice is simple,\nthen it should be quite easy to find the coordinates of the end points.\nOn the other hand, for centered, body-centered, face-centered, hexagonal, and rhombohedral\nBravais lattice,\nthe conversion might be more difficult. See the description of <a href=\"varbas.html#kpt\">kpt</a>\nfor an explanation of how to convert data from the \"conventional\" cartesian coordinates to\nthe primitive vectors in the reciprocal space. In order to help a bit, we list below a series\nof typical values, for the FCC, BCC, hexagonal and rhombohedral Bravais lattices. Note : all the data below\nare given in dimensionless units ; they have to be rescaled by the actual lengths defined by the\n<a href=\"varbas.html#acell\">acell</a> values. However, <b>kptbounds</b> values can be used as such,\nif the values of <a href=\"varbas.html#rprim\">rprim</a> given below are adopted.\n\n<p>A. <b>FCC lattice</b>\n<p>Suppose the primitive vectors in real space are given by\n<br><pre>\nrprim   0 1 1    1 0 1    1 1 0\n</pre>\nor\n<pre>\nrprim   0 1/2 1/2    1/2 0 1/2    1/2 1/2 0\n</pre>\n(these two possibilities only differ by a scaling factor, irrelevant for the definition\nof the k points in the primitive vectors in reciprocal space).\n\nThen, the reciprocal primitive vectors (in conventional cartesian coordinates) are\n<pre>\n(-1/2 1/2 1/2), (1/2 -1/2 1/2), (1/2 1/2 -1/2)\n</pre>\nor\n<pre>\n(-1 1 1), (1 -1 1), (1 1 -1)\n</pre>\nand, in both cases, the coordinates of several special points with respect to primitive vectors in reciprocal space are\n<pre>\nX (0   1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)\nX'(1/2 1/2 1  )   (conventional cartesian coordinate 1/2 1/2 0)  (an other instance of X, in another Brillouin zone)\nL (1/2 1/2 1/2)   (conventional cartesian coordinate  1/4 1/4 1/4)\nL'(1/2 0   0  )   (conventional cartesian coordinate -1/4 1/4 1/4) (an other instance of L, on another face of the BZ)\nW (1/4 1/2 3/4)   (conventional cartesian coordinate 1/2 1/4 0)\nU (1/4 5/8 5/8)   (conventional cartesian coordinate 1/2 1/8 1/8)\nK (3/8 3/8 3/4)   (conventional cartesian coordinate 3/8 3/8 0)\n</pre>\nNote that K is actually equivalent to U, by spatial and translational symmetry.\nSo, if you want to specify a typical circuit, the following might do the work :\nL-Gamma-X-W-K,U-L-W-X-K,U-Gamma with\n<br>\n<pre>kptbounds  1/2 0 0  0 0 0  0 1/2 1/2  1/4 1/2 3/4  3/8 3/8 3/4  1/2 1/2 1/2  1/4 1/2 3/4  1/2 1/2 1  3/8 3/8 3/4  0 0 0</pre>\n<p>\nThe lengths of segments (this information is useful to draw the band structure, with the correct relative\nscale between special points)\ncan be found using\nthe conventional cartesian coordinates :\nl(L-Gamma)=sqrt(3)/4=0.433... ;\nl(Gamma-X)=1/2=0.5 ;\nl(X-W)=1/4=0.25 ;\nl(W-K)=sqrt(2)/8=0.177... ;\nl(K-L)=sqrt(6)/8=0.306... ;\nl(L-W)=sqrt(2)/4=0.354... ;\nl(W-X)=1/4=0.25 ;\nl(X-K)=sqrt(2)/8=0.177... ;\nl(K-Gamma)=sqrt(2).3/8=0.530...\n<p>\n\n<p>B. <b>BCC lattice</b>\n<p>Suppose the primitive vectors in real space are given by\n<br><pre>\nrprim  -1 1 1    1 -1 1    1 1 -1\n</pre>\n(as for the FCC lattice, there is a scale invariance).\nThen, the reciprocal primitive vectors (in conventional cartesian coordinates) are\n(0 1/2 1/2), (1/2 0 1/2), and (1/2 1/2 0)\nand the coordinates of several special points with respect to primitive vectors in reciprocal space are\n<pre>\nH (-1/2 1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)\nN ( 0   0   1/2)   (conventional cartesian coordinate 1/4 1/4 0)\nP ( 1/4 1/4 1/4)   (conventional cartesian coordinate 1/4 1/4 1/4)\n</pre>\nSo, if you want to specify a typical circuit, the following might do the work :\nGamma-H-N-Gamma-P-N-P-H\n<br>\n<pre>kptbounds  0 0 0  -1/2 1/2 1/2  0 0 1/2  0 0 0   1/4 1/4 1/4  0 0 1/2  1/4 1/4 1/4  -1/2 1/2 1/2 </pre>\n<p>\nThe lengths of segments (this information is useful to draw the band structure, with the correct relative scale between special points)\ncan be found using the conventional cartesian coordinates :\nl(Gamma-H)=1/2=0.5 ;\nl(H-N)=sqrt(2)/4=0.354... ;\nl(N-Gamma)=sqrt(2)/4=0.354... ;\nl(Gamma-P)=sqrt(3)/4=0.433... ;\nl(P-N)=1/4=0.25 ;\nl(N-P)=1/4=0.25 ;\nl(P-H)=sqrt(3)/4=0.433...\n<p>\n\n<p>C. <b>Hexagonal lattices</b>\n<p>Suppose the primitive vectors in real space are given by\n<br><pre>\nrprim  1 0 0    -1/2 sqrt(0.75) 0    0 0 1\n</pre>\nThe coordinates of several special points with respect to primitive vectors in reciprocal space are\n<pre>\nM (1/2 0 0) or (0 1/2 0) or (-1/2 1/2 0)\nL (1/2 0 1/2) or (0 1/2 1/2) or (-1/2 1/2 1/2)\nK (1/3 1/3 0) or (2/3 -1/3 0) or (-1/3 2/3 0)\nH (1/3 1/3 1/2) or (2/3 -1/3 1/2) or (-1/3 2/3 1/2)\nA (0 0 1/2)\n</pre>\nSo, if you want to specify a typical circuit, the following might do the work :\nK-Gamma-M-K-H-A-L-H-L-M-Gamma-A\n<br>\n<pre>kptbounds  1/3 1/3 0  0 0 0  1/2 0 0  1/3 1/3 0  1/3 1/3 1/2  0 0 1/2  1/2 0 1/2  1/3 1/3 1/2  1/2 0 1/2  1/2 0 0  0 0 0  0 0 1/2 </pre>\n<p>\nIn order to find the lengths of segments\n(this information is useful to draw the band structure,\nwith the correct relative scale between special points)\none needs to know the a and c lattice parameters. Also, in what follows, we omit the 2*pi factor sometimes\npresent in the definition of the reciprocal space vectors.\nThe reciprocal vectors are (1/a 1/(sqrt(3)*a) 0) , (0 2/(sqrt(3)*a) 0), (0 0 1/c). The lengths of\nthe above-mentioned segments can be computed as :\nl(K-Gamma)=2/(3*a)=0.666.../a ;\nl(Gamma-M)=1/(sqrt(3)*a)=0.577.../a ;\nl(M-K)=1/(3*a)=0.333.../a ;\nl(K-H)=1/(2*c)=0.5.../c ;\nl(H-A)=2/(3*a)=0.666.../a ;\nl(A-L)=1/(sqrt(3)*a)=0.577.../a ;\nl(L-H)=1/(3*a)=0.333.../a ;\nl(H-L)=1/(3*a)=0.333.../a ;\nl(L-M)=1/(2*c)=0.5.../c ;\nl(M-Gamma)=-1/(sqrt(3)*a)=0.577.../a ;\nl(Gamma-A)=1/(2*c)=0.5.../c\n<p>\n\n<p>D. <b>Rhombohedral lattices</b>\n<p>Rhombohedral lattices are characterised by two parameters, the length of the primitive\nvectors, that we will denote a0, and the angle they form, alpha.\nThese can be directly input of ABINIT, as\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#angdeg\">angdeg</a>\n<p>This will generate the primitive vectors in real space , with\n<pre>\n<a href=\"varbas.html#acell\">acell</a> a0 a0 a0    and      <a href=\"varbas.html#rprim\">rprim</a>  a 0 c    -a/2 a*sqrt(0.75) c    -a/2 -a*sqrt(0.75) c\n</pre>\nwith a^2+c^2=1, a^2=(1-cos(alpha))*2/3, c^2=(1+2*cos(alpha))*1/3, (a/c)^2=2*(1-cos(alpha))/(1+2*cos(alpha))\nand also cos(alpha)=(1-(a/c)^2/2)/(1+(a/c)^2).\nAlternatively, these values of rprim might directly be the input of ABINIT (then, the balance\nof the scaling factor might be adjusted between\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#rprim\">rprim</a>).\n<p>\nUnlike for the simple cubic, FCC, BCC, hexagonal (and some other) Bravais lattice,\nthe topology of the Brillouin zone will depend on the alpha (or a/c) value. We give below\ninformation concerning the case when cos(alpha) is positive, that is, (a/c)^2 lower than 2.\n<p>\nThe coordinates of several special points with respect to primitive vectors in reciprocal space will\nnot depend on the a/c ratio, but some others will depend on it. So, some care has to be exercised.\nNotations for the Brillouin Zone special points are the same as in Phys. Rev. B 41, 11827 (1990).\n<pre>\nL (1/2 0 0) or (0 1/2 0) or (0 0 1/2) (or with negative signs)\nT (1/2 1/2 1/2)\nX (1/2 1/2 0) or (1/2 0 1/2) or (0 1/2 1/2) (or with separate negative signs)\nW (5/6 - (a/c)^2/6 , 1/2 , 1/6 + (a/c)^2/6 ) = (1 0 -1)*(1-(a/c)^2/2)/3 + (1 1 1)/2\nU ( (1+(a/c)^2)/6 , (8-(a/c)^2)/12 , (8-(a/c)^2)/12 ) = (-1 1/2 1/2)*(1-(a/c)^2/2)/3 + (1 1 1)/2\nK (1 0 -1)*(1+(a/c)^2/4)/3\n</pre>\nSo, if you want to specify a typical circuit, the following might do the work (the representative points on lines of symmetry are indicated - there are sometimes more than one way to go from one point to another) :\nX-V-K-Sigma-Gamma-Lambda-T-Q-W-Y-L-sigma-Gamma-sigma-X . The suggestion is to sample this path\nwith the following coordinates\nfor the special points X, Gamma, T, L, Gamma, X :\n<br>\n<pre>kptbounds  1/2 0 -1/2   0 0 0    1/2 1/2 1/2  1 1/2 0   1 0 0  1 1/2 1/2\n</pre>\n<p>\nIn order to find the lengths of segments\n(this information is useful to draw the band structure,\nwith the correct relative scale between special points)\none needs to know the a and c lattice parameters. Also, in what follows, we omit the 2*pi factor sometimes\npresent in the definition of the reciprocal space vectors.\nThe reciprocal vectors are (2/(3*a) 0 1/(3*c)) , -(1/(3*a) 1/(sqrt(3)*a) 1/(3*c), -(1/(3*a) -1/(sqrt(3)*a) 1/(3*c) ). The lengths of\nthe above-mentioned segments can be computed as :\nl(X-Gamma)=2/(sqrt(3)*a)=1.155.../a , with l(K-Gamma)=(1+(a/c)^2/4)*4/(3*sqrt(3)*a);\nl(Gamma-T)=1/(2*c) ;\nl(T-L)=2/(sqrt(3)*a)=1.155.../a , with l(T-W)=(1-(a/c)^2/2)*4/(3*sqrt(3)*a);\nl(L-Gamma)=sqrt(4/(a^2)+1/(c^2))/3\nl(Gamma-X)=sqrt(1/(a^2)+1/(c^2))*2/3\n<p>\n\n",
    "vartype": "real array kptbounds(3,abs(<a href=\"varbas.html#kptopt\">kptopt</a>)+1)  "
  },
  "kptgw": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "all 0.0's ",
    "definition": "K-PoinTs for GW calculations ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nFor each k-point with number igwpt in the range (1:<a href=\"vargw.html#nkptgw\">nkptgw</a>),\n<b>kptgw(1,igwpt)</b> is the reduced coordinate of the k-point where GW corrections are required.\nwhile <a href=vargw.html#bdgw\">bdgw</a>(1:2,igwpt) specifies the range of bands to be considered.\n<p>\nAt present, not all k-points are possible. Only those corresponding to the k-point\ngrid defined with the same repetition parameters (<a href=\"vargs.html#kptrlatt\" target=\"kwimg\">kptrlatt</a>,\nor <a href=\"varbas.html#ngkpt\" target=\"kwimg\">ngkpt</a>) than the GS one, but WITHOUT any shift, are allowed.\n",
    "vartype": "real array kptgw(3,<a href=\"vargw.html#nkptgw\">nkptgw</a>)"
  },
  "kptnrm": {
    "category": " ",
    "default": "1.",
    "definition": "K - PoinTs NoRMalization ",
    "section": "varbas",
    "text": "<p>\nEstablishes a normalizing denominator\nfor each k point.\nNeeded only\nif <a href=\"varbas.html#kptopt\">kptopt</a>&lt;=0, otherwise\ndeduced from other input variables.\n<br>The k point coordinates as fractions\nof reciprocal lattice translations are therefore\n<a href=\"varbas.html#kpt\">kpt</a>(mu,ikpt)/<b>kptnrm</b>.  <b>kptnrm</b> defaults to 1 and can\nbe ignored by the user.  It is introduced to avoid\nthe need for many digits in representing numbers such as 1/3.\n<br>It cannot be smaller than 1.0d0\n",
    "vartype": "real parameter  "
  },
  "kptns": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "K-PoinTs re-Normalized and Shifted",
    "section": "varint",
    "text": "<p>\nIf <a href=\"vargs.html#nqpt\">nqpt</a>=0, or if one is\ndoing a reponse calculation,\nthis internal variable is derived from\n<a href=\"varbas.html#kpt\">kpt</a> and <a href=\"varbas.html#kptnrm\">kptnrm</a>:\n<b>kptns</b>(1:3,:)=\n<a href=\"varbas.html#kpt\">kpt</a>(1:3,:)/\n<a href=\"varbas.html#kptnrm\">kptnrm</a>, so that\nit is <a href=\"varbas.html#kpt\">kpt</a> renormalized by\n<a href=\"varbas.html#kptnrm\">kptnrm</a>.\n<br>\nIf <a href=\"vargs.html#nqpt\">nqpt</a>=1 and one is\nnot doing a ground-state calculation,\nthis internal variable is derived from\n<a href=\"varbas.html#kpt\">kpt</a>,<a href=\"varbas.html#kptnrm\">kptnrm</a>\nand <a href=\"varint.html#qptn\">qptn</a>\n<b>kptns</b>(1:3,:)=\n<a href=\"varbas.html#kpt\">kpt</a>(1:3,:)/\n<a href=\"varbas.html#kptnrm\">kptnrm</a>+\n<a href=\"varint.html#qptn\">qptn</a>(1:3), so that\nit is <a href=\"varbas.html#kpt\">kpt</a> renormalized by\n<a href=\"varbas.html#kptnrm\">kptnrm</a>, then shifted\nby <a href=\"varint.html#qptn\">qptn</a>(1:3).\n",
    "vartype": "real array <b>kptns</b>(3,<a href=\"vargs.html#qpt\">nkpt</a>) "
  },
  "kptopt": {
    "category": " ",
    "default": "1 (WARNING : was 0 prior to 5.8).",
    "definition": "KPoinTs OPTion ",
    "section": "varbas",
    "text": "<p>\nControls the set up of the k-points list.\nThe aim will be to initialize, by straight reading\nor by a preprocessing approach based on other input variables,\nthe following input variables, giving the k points, their number,\nand their weight:\n<a href=\"varbas.html#kpt\">kpt</a>,\n<a href=\"varbas.html#kptnrm\">kptnrm</a>,\n<a href=\"varbas.html#nkpt\">nkpt</a>,\nand, for <a href=\"varbas.html#iscf\">iscf</a>/=-2,\n<a href=\"varbas.html#wtk\">wtk</a>.\n\n<p>\nOften, the k points will form a lattice in reciprocal space. In this case,\none will also aim at initializing input variables that give\nthe reciprocal of this k-point lattice, as well as its shift with respect\nto the origin:\n<a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>,\nas well as on <a href=\"varbas.html#nshiftk\">nshiftk</a> and\n<a href=\"varbas.html#shiftk\">shiftk</a>.\n\n<p>A global additional shift can be provided by <a href=\"varint.html#qptn\">qptn</a>\n\n<ul>\n<li>0=> read directly <a href=\"varbas.html#nkpt\">nkpt</a>, <a href=\"varbas.html#kpt\">kpt</a>,\n<a href=\"varbas.html#kptnrm\">kptnrm</a> and <a href=\"varbas.html#wtk\">wtk</a>.\n<li>1=> rely on <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>, as well as on\n<a href=\"varbas.html#nshiftk\">nshiftk</a> and\n<a href=\"varbas.html#shiftk\">shiftk</a> to set up the k points.\nTake fully into account the symmetry to generate the\nk points in the Irreducible Brillouin Zone only, with the appropriate weights.<br>\n(This is the usual mode for GS calculations)</li>\n<li>2=> rely on\n<a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>, as well as on\n<a href=\"varbas.html#nshiftk\">nshiftk</a> and\n<a href=\"varbas.html#shiftk\">shiftk</a> to set up the k points.\nTake into account only the time-reversal symmetry :\nk points will be generated in half the Brillouin zone, with the appropriate weights.<br>\n(This is to be used when preparing or executing a\nRF calculation at q=(0 0 0) ) </li>\n<li>3=> rely on <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>, as well as on\n<a href=\"varbas.html#nshiftk\">nshiftk</a> and\n<a href=\"varbas.html#shiftk\">shiftk</a> to set up the k points.\nDo not take into account any symmetry :\nk points will be generated in the full Brillouin zone, with the appropriate weights.<br>\n(This is to be used when preparing or executing a\nRF calculation at non-zero q )</li>\n<li>4=> rely on <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>, as well as on\n<a href=\"varbas.html#nshiftk\">nshiftk</a> and\n<a href=\"varbas.html#shiftk\">shiftk</a> to set up the k points.\nTake into account all the symmetries EXCEPT the time-reversal symmetry\nto generate the k points in the Irreducible Brillouin Zone, with the appropriate weights.<br>\nThis has to be used when performing PAW calculations including\nspin-orbit coupling (<a href=\"varpaw.html#pawspnorb\">pawspnorb</a>/=0)</li>\n<li>A negative value =>\nrely on <a href=\"vargs.html#kptbounds\">kptbounds</a>,\nand <a href=\"vargs.html#ndivk\">ndivk</a>\nto set up a band structure calculation along different lines\n(allowed only for <a href=\"varbas.html#iscf\">iscf</a>==-2).\nThe absolute value of <b>kptopt</b> gives the number of segments\nof the band structure. Weights are usually irrelevant with this option, and will be left to their default value.\n</li>\n</ul>\nIn the case of a grid of k points, the auxiliary variables\n<a href=\"vargs.html#kptrlen\">kptrlen</a>,\n<a href=\"varbas.html#ngkpt\">ngkpt</a>  and\n<a href=\"varfil.html#prtkpt\">prtkpt</a> might help\nyou to select the optimal grid.\n",
    "vartype": "integer parameter "
  },
  "kptrlatt": {
    "category": " ",
    "default": "No default.",
    "definition": "K - PoinTs grid : Real space LATTice ",
    "section": "vargs",
    "text": "<p>\nThis input variable is used only when <a href=\"varbas.html#kptopt\">kptopt</a>\nis positive. It partially defines the k point grid.\nThe other piece of information is contained in\n<a href=\"varbas.html#shiftk\">shiftk</a>.\n<b>kptrlatt</b> cannot be used together with <a href=\"varbas.html#ngkpt\">ngkpt</a>.\n\n<p>The values kptrlatt(1:3,1), kptrlatt(1:3,2), kptrlatt(1:3,3)\nare the coordinates of three vectors in real space, expressed\nin the <a href=\"varbas.html#rprimd\">rprimd</a> coordinate system (reduced coordinates).\nThey defines a super-lattice in real space.\nThe k point lattice is the reciprocal of this super-lattice,\npossibly shifted (see <a href=\"varbas.html#shiftk\">shiftk</a>).\n\n<p>If neither <a href=\"varbas.html#ngkpt\">ngkpt</a> nor <b>kptrlatt</b>\nare defined, ABINIT will automatically generate a set\nof k point grids, and select the best combination\nof <b>kptrlatt</b> and <a href=\"varbas.html#shiftk\">shiftk</a>\nthat allows to reach a sufficient value of <a href=\"vargs.html#kptrlen\">kptrlen</a>.\nSee this latter variable for a complete description of this\nprocedure.\n",
    "vartype": "integer array kptrlatt(3,3)"
  },
  "kptrlen": {
    "category": " ",
    "default": "30.0d0 (WARNING : was 20 prior to v5.8).",
    "definition": "K - PoinTs grid : Real space LENgth ",
    "section": "vargs",
    "text": "<p>\nThis input variable is used only when <a href=\"varbas.html#kptopt\">kptopt</a>\nis positive and non-zero.\n\n<p>Preliminary explanation :\n<br>\nThe k point lattice defined by <a href=\"varbas.html#ngkpt\">ngkpt</a>\nor <a href=\"vargs.html#kptrlatt\">kptrlatt</a> is used to perform integrations\nof periodic quantities in the Brillouin Zone, like\nthe density or the kinetic energy. One can relate the\nerror made by replacing the continuous integral by a sum\nover k point lattice to the Fourier transform of the\nperiodic quantity. Erroneous contributions will appear\nonly for the vectors in real space that belong to the reciprocal\nof the k point lattice, except the origin.\nMoreover, the expected size of these\ncontributions usually decreases exponentially with the distance.\nSo, the length of the smallest of these real space vectors\nis a measure of the accuracy of the k point grid.\n\n<p>When either <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a> is defined, <b>kptrlen</b> is not\nused as an input variable, but the length of the\nsmallest vector will be placed in this variable, and echoed\nin the output file.\n\n<p>On the other hand, when neither <a href=\"varbas.html#ngkpt\">ngkpt</a> nor\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a> are defined, ABINIT will\nautomatically generate a large set of possible k point grids,\nand select among this set, the grids that give\na length of smallest vector LARGER than <b>kptrlen</b>,\nand among these grids, the one that, when used with\n<a href=\"varbas.html#kptopt\">kptopt</a>=1, reduces to the smallest number\nof k points. Note that this procedure can be time-consuming.\nIt is worth doing it once for a given unit cell\nand set of symmetries, but not use this procedure by default.\nThe best is then to set <a href=\"varfil.html#prtkpt\">prtkpt</a>=1, in order\nto get a detailed analysis of the set of grids.\n\n<p>If some layer of vacuum is detected in the unit cell\n(see the input variable <a href=\"vargs.html#vacuum\">vacuum</a>), the\ncomputation of <b>kptrlen</b> will ignore the\ndimension related to the direction perpendicular\nto the vacuum layer, and generate a bi-dimensional k point grid.\nIf the system is confined in a tube,\na one-dimensional k point grid will be generated.\nFor a execution, this procedure will only generate the Gamma point.\n",
    "vartype": "real parameter "
  },
  "kssform": {
    "category": " ",
    "default": "1, i.e. the KSS format",
    "definition": "Kohn Sham Structure file FORMat ",
    "section": "varfil",
    "text": "<p>\nGoverns the choice of the format for the file that\ncontains the Kohn-Sham electronic structure information,\nfor use in GW calculations, see the input variables\n<a href=\"vargs.html#optdriver\">optdriver</a> and\n<a href=\"vargw.html#nbandkss\">nbandkss</a>.\n<ul>\n<li><b>(obsolete and, starting v5.6, not supported anymore) kssform</b>=0,\nthe _STA file is generated together with a _VKB\nfile containing information on the pseudopotential </li>\n<li><b>kssform</b>=1, a single file .kss (double precision) containing\ncomplete information on the Kohn Sham Structure (eigenstates and the\npseudopotentials used) will be generated through full diagonalization\nof the complete Hamiltonian matrix.\nThe file has at the beginning the standard abinit header</li>\n<li><b>(obsolete and not supported anymore starting v5.6) kssform</b>=2, the same as 1,\nbut most of the relevant informations are in single precision. </li>\n<li><b>kssform</b>=3, a single file .kss (double precision) containing\ncomplete information on the Kohn Sham Structure (eigenstates and the\npseudopotentials used) will be generated through the usual conjugate gradient\nalgorithm (so, a restricted number of states)\nThe file has at the beginning the standard abinit header</li>\n</ul>\n<p>Very important : for the time being, <a href=\"vardev.html#istwfk\">istwfk</a>\nmust be 1 for all the k-points.</p>\n",
    "vartype": "integer parameter  "
  },
  "ldgapp": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0.",
    "definition": "Lein-Dobson-Gross approximation",
    "section": "vardev",
    "text": "<p>Concern only the ACFD computation of the correlation energy\n(<a href=\"vargs.html#optdriver\">optdriver</a>=3).\n<br>If <b>ldgapp</b> &gt; 0, the Lein, Dobson and Gross first-order\napproximation to the correlation energy is also computed during the ACFD run.\n[See Lein, Dobson and Gross, J. Comput. Chem. 20,12 (1999)]. This\nis only implemented for the RPA, for the PGG kernel and\nfor the linear energy optimized kernel at the present time.\n",
    "vartype": "integer parameter  "
  },
  "lexexch": {
    "category": "",
    "default": "-1",
    "definition": "value of angular momentum L for EXact EXCHange ",
    "section": "varpaw",
    "text": "<p>\nActivated if\n<a href=\"varpaw.html#useexexch\">useexexch</a> is equal to 1.<br>\nGive for each species the value of the angular momentum (only values 2 or 3 are allowed)\non which to apply the exact exchange correction.\n",
    "vartype": "integer array lexexch(<a href=\"varbas.html#ntypat\">ntypat</a>)"
  },
  "localrdwf": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, PARALLEL ",
    "default": "1.",
    "definition": "LOCAL ReaD WaveFunctions",
    "section": "varpar",
    "text": "<p>\nThis input variable is used only when running abinit in parallel.\nIf <b>localrdwf</b>=1, the input wavefunction disk file or the KSS/SCR file in case of GW\ncalculations, is read locally by each processor, while\nif <b>localrdwf</b>=0, only one processor reads it, and\nbroadcast the data to the other processors.\n<p> The option <b>localrdwf</b>=0 is NOT allowed when parallel I/O are activated (MPI-IO access),\ni.e. when <a href=\"vardev.html#accesswff\">accesswff</a>==1.\n<p> The option <b>localrdwf</b>=0 is NOT allowed when\n<a href=\"varfil.html#mkmem\">mkmem</a>==0 (or, for RF, when\n<a href=\"varrf.html#mkqmem\">mkqmem</a>==0, or <a href=\"varrf.html#mk1mem\">mk1mem</a>==0), that\nis, when the wavefunctions are stored on disk.\nThis is still to be coded ...\n<p> In the case of a parallel computer with a unique file system,\nboth options are as convenient for the user. However, if the I/O\nare slow compared to communications between processors,\n(e.g. for CRAY T3E machines), <b>localrdwf</b>=0 should be much more\nefficient;\nif you really need temporary disk storage, switch to localrdwf=1 ).\n<p> In the case of a execution of nodes, with a different file system for\neach machine, the input wavefunction file must be available on all\nnodes if <b>localrdwf</b>=1, while it is needed only for the\nmaster node if <b>localrdwf</b>=0.\n\n",
    "vartype": "integer "
  },
  "lpawu": {
    "category": "",
    "default": "-1 ",
    "definition": "value of angular momentum L for PAW+U",
    "section": "varpaw",
    "text": "<p>\nActivated if <a href=\"varpaw.html#usepawu\">usepawu</a>\nis equal to 1 or 2.<br>\nGive for each species the value of the angular momentum (only\nvalues 2 or 3 are allowed)&nbsp; on which to apply the LDA+U correction.<br>\n<ul>\n<li>If equal to 2 (d-orbitals)&nbsp; or 3 (f-orbitals), values of\n<a href=\"varpaw.html#upawu\">upawu</a> and&nbsp;\n<a href=\"varpaw.html#jpawu\">jpawu</a> are used in the calculation.</li>\n<li>If equal to -1: do not apply LDA+U correction on the species.</li>\n</ul>\n",
    "vartype": "integer array lpawu(<a href=\"varbas.html#ntypat\">ntypat</a>)"
  },
  "macro_uj": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0.",
    "definition": "Macro variable that activates the determination of the U and J parameter (for the PAW+U calculations) ",
    "section": "vardev",
    "text": "<p>Sets proper input values for the determination of U and J i.e.\nfor <a href=\"vardev.html#pawujat\">pawujat</a> (first atom treated with PAW+U),\n<a href=\"varfil.html#irdwfk\">irdwfk</a> (=1),\n<a href=\"varbas.html#tolvrs\">tolvrs</a> (=10^(-8)),\n<a href=\"varbas.html#nstep\">nstep</a> (=255),\n<a href=\"vargs.html#diemix\">diemix</a> (=0.45),\n<a href=\"varff.html#atvshift\">atvshift</a> (<a href=\"vardev.html#pawujat\">pawujat</a>) <a href=\"vardev.html#pawujv\">pawujv</a>). Do not overwrite these variables manually unless you know what you do.\n\n<ul>\n<li> <b>macro_uj</b>=1 (and <a href=\"varbas.html#nsppol\">nsppol</a>=2) Standard procedure to determine U on atom pawujat through a shift of the potential on both spin channels.</li>\n<li> <b>macro_uj</b>=1 (and <a href=\"varbas.html#nsppol\">nsppol</a>=1) Non standand procedure to determine U from potential shift on atom pawujat (experimental).</li>\n<li> <b>macro_uj</b>=2 (and <a href=\"varbas.html#nsppol\">nsppol</a>=2) Non standand procedure to determine U from potential shift on atom pawujat through a shift on spin channel 1 on this atom and the response on this channel (experimental).</li>\n<li> <b>macro_uj</b>=3 (and <a href=\"varbas.html#nsppol\">nsppol</a>=2) Standand procedure to determine J from potential shift on spin channel 1 on atom pawujat and response on spin channel 2 (experimental).</li>\n</ul>\n\nDetermination of U and J can be done only if the symmetry of the atomic arrangement is reduced and the atom pawujat is not connected to any other atom by symmetry relations (either input reduced symmetries manually, define concerned atom as a separate atomic species or shift concerned atom from ideal postion).\n\n",
    "vartype": "integer parameter  "
  },
  "maxestep": {
    "category": "",
    "default": "0.005",
    "definition": "MAXimum Electric field STEP",
    "section": "varff",
    "text": "<p>\nThis variable controls the maximum change of electric field when updating the electric field after each SCF iteration.\nWhen the calculation is difficult to converge, try reducing this value or reducing <a href=\"varff.html#ddamp\">ddamp</a>.\nThis variable is used in finite electric displacement field calculations (<a href=\"varff.html#berryopt\">berryopt</a>=6,16,17).\n",
    "vartype": "real parameter"
  },
  "maxnsym": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "384.",
    "definition": "MAXimum Number of SYMetries",
    "section": "vardev",
    "text": "<p>Gives the maximum number of spatial symetries allowed in the memory.<br>\nThe default value is sufficient for most applications; it has to be increase in the case of the use of a supercell (unit cell identically repeated).\n",
    "vartype": "integer parameter  "
  },
  "mband": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Maximum number of BANDs ",
    "section": "varint",
    "text": "<p>\nThis internal variable derives\nthe maximum number of bands\nover all k-points and spin-polarisation from\n<a href=\"varbas.html#nband\">nband</a>(1:nkpt*nsppol).\n",
    "vartype": "integer "
  },
  "mdf_epsinf": {
    "category": " ",
    "default": "0.0",
    "definition": "Model dielectric function, epsilon infinity ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if\n<a href=\"vargs.html#optdriver\">optdriver</a>=99,\n<a href=\"vargw.html#bs_coulomb_term\">bs_coulomb_term</a>=2x,\nthat is, bethe-salpeter calculations with a model dielectric function.\n<p>\n<b>mdf_epsinf</b> specifies the value of the macroscopic dielectric function used\nto model the screening function (see Solid State Commun. 84, 765 (1992)).\nThe proper spatial symmetry of the screening W(r,r') is enforced using Eq. (7) of Phys. Rev. B 37, (1988)\n<br>\n",
    "vartype": "real parameter  "
  },
  "mdtemp": {
    "category": "",
    "default": "<b>mdtemp</b>= (300, 300)",
    "definition": "Molecular Dynamics Temperatures ",
    "section": "varrlx",
    "text": "<p>\nGive the initial and final temperature\nof the Nose-Hoover thermostat (<a href=\"varrlx.html#ionmov\">ionmov</a>=8)\nand Langevin dynamics (<a href=\"varrlx.html#ionmov\">ionmov</a>=9), in\nKelvin.\nThis temperature will change linearly from the initial temperature\n<b>mdtemp(1)</b> at itime=1 to\nthe final temperature <b>mdtemp(2)</b> at the end of the\n<a href=\"varrlx.html#ntime\">ntime</a> timesteps.\n",
    "vartype": "real array mdtemp(2)"
  },
  "mdwall": {
    "category": "",
    "default": "10000.0 Bohr (the walls are extremely far away).",
    "definition": "Molecular Dynamics WALL location ",
    "section": "varrlx",
    "text": "<p>\nGives the location (atomic units) of walls\non which the atoms will bounce back.\nwhen <a href=\"varrlx.html#ionmov\">ionmov</a>=6, 7, 8 or 9. For each\ncartesian direction idir=1, 2 or 3, there is a pair of walls with\ncoordinates xcart(idir)=-wall and xcart(idir)=rprimd(idir,idir)+wall .\nSupposing the particle will cross the wall, its velocity normal to the\nwall is reversed, so that it bounces back.\n<br>\nBy default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since <b>mdwall</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>'\ncharacteristics.\n",
    "vartype": "real parameter "
  },
  "mep_mxstep": {
    "category": "<a href=\"../users/abinit_help.html#length\">LENGTH</a>",
    "default": "<b>mep_mxstep</b>=0.4 Bohr if <a href=\"varrlx.html#imgmov\">imgmov</a>=5 (NEB) otherwise <b>mep_mxstep</b>=100. Bohr",
    "definition": "Minimal Energy Path search: MaXimum allowed STEP size",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=1 (Steepest-Descent), 2 (String Method) or 5 (Nudged Elastic Band).<br>\nThe optimizer used to solve the Ordinary Differential Equation (ODE) can be constrained with a maximum allowed step size for each image. By default this feature is only activated for Nudged Elastic Band (NEB) and the value is inspired by <i>J. Chem. Phys. 128, 134106 (2008)</i>.<br>\nNote that the step size is defined for each image as\n<i>step = SQRT[SUM(R_i dot R_i)]</i> where the <i>R_i</i> are the positions of\nthe atoms in the cell.\n",
    "vartype": "real parameter"
  },
  "mep_solver": {
    "category": "",
    "default": "<b>mep_solver</b>=0",
    "definition": "Minimal Energy Path ordinary differential equation SOLVER ",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=2 (String Method) or 5 (Nudged Elastic Band).<br>\nGives the algorithm used to solve the Ordinary Differential Equation (ODE) when searching for\na Minimal Energy Path (MEP).<br>\nPossible values can be:<br>\n<ul>\n<li>0=&gt; <b>Steepest-Descent algorithm</b> following the (scaled) forces,\nthe scaling factor being <a href=\"varrlx.html#fxcartfactor\">fxcartfactor</a>\n(forward Euler method).<br>\nCompatible with all MEP search methods.\n</li>\n<br>\n<li>1=&gt; <b>Quick-min optimizer</b> following the (scaled) forces,\nthe scaling factor being <a href=\"varrlx.html#fxcartfactor\">fxcartfactor</a>.\nThe \"quick minimizer\" improves upon the steepest-descent method by\naccelerating the system in the direction of the forces. The velocity (of the image) is\nprojected long the force and cancelled if antiparallel to it.<br>\nCompatible only with Nudged Elastic Band (<a href=\"varrlx.html#imgmov\">imgmov</a>=5).<br>\n<i>See, for instance: J. Chem. Phys. 128, 134106 (2008).</i><br>\n</li>\n<br>\n<li>2=&gt; <b>Local Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) algorithm</b>; each image along the\nband is minimized with a different instance of the BFGS optimizer.<br>\nCompatible only with Nudged Elastic Band (<a href=\"varrlx.html#imgmov\">imgmov</a>=5).<br>\n<i>See, for instance: J. Chem. Phys. 128, 134106 (2008).</i><br>\nIN DEVELOPPMENT - NOT RELIABLE\n</li>\n<br>\n<li>3=&gt; <b>Global Broyden-Fletcher-Goldfarb-Shanno (GL-BFGS) algorithm</b>; all images along the\nband are minimized with a single instance of the BFGS optimizer.<br>\nCompatible only with Nudged Elastic Band (<a href=\"varrlx.html#imgmov\">imgmov</a>=5).<br>\n<i>See, for instance: J. Chem. Phys. 128, 134106 (2008).</i><br>\nIN DEVELOPPMENT - NOT RELIABLE\n</li>\n<br>\n<li>4=&gt; <b>Fourth-order Runge-Kutta method</b>; the images along the band are moved\nevery four steps (1&lt=istep&lt=<a href=\"varrlx.html#ntimimage\">ntimimage</a>)\nfollowing the Runge-Kutta algorithm,\nthe time step being <a href=\"varrlx.html#fxcartfactor\">fxcartfactor</a>.<br>\nCompatible only with Simplified String Method (<a href=\"varrlx.html#imgmov\">imgmov</a>=2\nand <a href=\"varrlx.html#string_algo\">string_algo</a>=1 or 2).<br>\n<i>See: J. Chem. Phys. 126, 164103 (2007).</i>\n</li>\n</ul>\nAll of the optimizers can be constrained with a maximum allowed step size for each image; see <a href=\"varrlx.html#mep_mxstep\">mep_mxstep</a>. This is by default the case of the Nudged Elastic Band (<a href=\"varrlx.html#imgmov\">imgmov</a>=5).\n",
    "vartype": "integer parameter"
  },
  "mffmem": {
    "category": " ",
    "default": "1, i.e. an in-core solution.",
    "definition": "Maximum number of FFt grids in MEMory ",
    "section": "varfil",
    "text": "<p>\nGoverns the choice of number of\nFFT arrays that will be kept permanently in core memory.\n<br>The allowed values are 0, in which case maximal use\nis made of disk space, saving core memory at the expense of\nexecution time (not much, usually),\nor 1, in which case everything is kept in core memory.\n<br>More detailed explanations : if <b>mffmem</b>==0, some arrays\nof size <br>double precision :: xx(nfft,<a href=\"varbas.html#nsppol\">nsppol</a>) <br>will be saved\non disk when the wavefunctions are optimized or when\nthe Hartree and xc potential is computed (which can require\nsome sizeable memory space also).\n<br>The number of these arrays is\n<br> 5 if <a href=\"varbas.html#iscf\">iscf</a>==1,\n<br> 3 if <a href=\"varbas.html#iscf\">iscf</a>==2 or 12,\n<br> 4 if <a href=\"varbas.html#iscf\">iscf</a>==3 or 3,\n<br> 6 if <a href=\"varbas.html#iscf\">iscf</a>==4 or 14,\n<br> 10 if <a href=\"varbas.html#iscf\">iscf</a>==5,\n<br> (2+2*<a href=\"vardev.html#npulayit\">npulayit</a>) if <a href=\"varbas.html#iscf\">iscf</a>==7 or 17.\n<br>The saving of memory can be appreciable especially when <a href=\"varbas.html#iscf\">iscf</a>==5, 7 ,17 and <a href=\"varbas.html#nsppol\">\nnsppol</a>=2.",
    "vartype": "integer parameter  "
  },
  "mgfft": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Maximum of nGFFT ",
    "section": "varint",
    "text": "<p>\nThis internal variable contains the maximum of\n<a href=\"vargs.html#ngfft\">ngfft</a>(1:3).\n",
    "vartype": "integer "
  },
  "mgfftdg": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Maximum of nGFFT for the Double Grid",
    "section": "varint",
    "text": "<p>\nThis internal variable contains the maximum of\n<a href=\"varpaw.html#ngfftdg\">ngfftdg</a>(1:3).\n",
    "vartype": "integer "
  },
  "mixalch": {
    "category": "EVOLVING ",
    "default": "0.d0 (will not accepted !)",
    "definition": "MIXing coefficients for ALCHemical potentials",
    "section": "vargs",
    "text": "<p>\nUsed for the generation of alchemical pseudoatoms, that is,\nwhen <a href=\"vargs.html#ntypalch\">ntypalch</a> is non-zero.\n<p> This array gives, for each type of alchemical pseudatom (there are\n<a href=\"vargs.html#ntypalch\">ntypalch</a> such pseudoatoms), the mixing coefficients\nof the basic <a href=\"vargs.html#npspalch\">npspalch</a> pseudopotentials for\nalchemical use. For each type of alchemical pseudoatom, the sum of the\nmixing coefficients must equal 1.\n<p> The actual use of the mixing coefficients is defined by the input\nvariable <a href=\"vargs.html#algalch\">algalch</a>. Note that the masses of the atoms,\n<a href=\"varrlx.html#amu\">amu</a>\nare also mixed according to the value of <b>mixalch</b>, by default.\n<p> Example 1. Suppose that we want to describe Ba(0.25) Sr(0.75) Ti O3.\n<br> The input variables related to the construction of the alchemical Ba(0.25) Sr(0.75)\npotential will be :\n<pre>\nnpsp   4                 ! 4 pseudopotentials should be read.\nznucl  8 40 56 38        ! The nuclear charges. Note that the two\n! atoms whose pseudopotentials are to be mixed\n! are mentioned at the end of the series.\nntypat  3                ! There will be three types of atoms.\nntypalch   1             ! One pseudoatom will be alchemical.\n! Hence, there will be ntyppure=2 pure pseudoatoms,\n! with znucl 8 (O) and 40 (Ti), corresponding to\n! the two first pseudopotentials. Out of the\n! four pseudopotentials, npspalch=2 are left\n! for alchemical purposes, with znucl 56 (Ba)\n! and 38 (Sr).\nmixalch    0.25  0.75    ! For that unique pseudoatom to be\n! generated, here are the mixing coeeficients,\n! to be used to combine the Ba and Sr pseudopotentials.\n</pre>\n<p> Example 2. More complicated, and illustrate some minor drawback of the\ndesign of input variables.\nSuppose that one wants to generate Al(0.25)Ga(0.75) As(0.10)Sb(0.90).\n<br> The input variables will be :\n<pre>\nnpsp  4                  ! 4 pseudopotentials should be read\nznucl  13 31 33 51       ! The atomic numbers. All pseudopotentials\n! will be used for some alchemical purpose\nntypat  2                ! There will be two types of atoms.\nntypalch   2             ! None of the atoms will be \"pure\".\n! Hence, there will be npspalch=4 pseudopotentials\n!  to be used for alchemical purposes.\nmixalch    0.25  0.75 0.0  0.0   ! This array is a (4,2) array, arranged in the\n0.0   0.0  0.1  0.9   ! usual Fortran order.\n</pre>\nMinor drawback : one should not forget to fill <b>mixalch</b> with the needed zero's, in this later case.\n<p> In most cases, the use of <b>mixalch</b>\nwill be as a static (non-evolving) variable. However, the possibility to have\ndifferent values of <b>mixalch</b> for different images has been coded. A population of\ncells with different atomic characteristics can thus be considered,\nand can be made to evolve, e.g. with a genetic algorithm (not coded in v7.0.0 though).\nThere is one restriction to this possibility : the value of <a href=\"varint.html#ziontypat\">ziontypat</a> for the atoms that are mixed should be\nidentical.\n",
    "vartype": "integer array mixalch(<a href=\"vargs.html#npspalch\">npspalch</a>,<a href=\"vargs.html#ntypalch\">ntypalch</a>)"
  },
  "mk1mem": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "<a href=\"varbas.html#nkpt\">nkpt</a>, i.e. in-core solution.",
    "definition": "Maximum number of K - points for 1st order wavefunctions, kept in MEMory ",
    "section": "varrf",
    "text": "<p>\nPlays a role similar to <a href=\"varfil.html#mkmem\">mkmem</a>\nbut for different sets of wavefunctions : the\nground state wavefunctions at k+q and the first-order\nwavefunctions. Only needed for response calculations.\n<br>Internal representation as mkmems(2) and mkmems(3).\n<br>Note (991019) that although the effective number of k points\ncan be reduced thanks to symmetry for different\nperturbations, <b>mkqmem</b> and <b>mk1mem</b> are presently\nstill compared with the input <a href=\"varbas.html#nkpt\">nkpt</a>. This should be changed\nlater.",
    "vartype": "integer parameters  "
  },
  "mkmem": {
    "category": " ",
    "default": "<a href=\"varbas.html#nkpt\">nkpt</a>, i.e. in-core solution.",
    "definition": "Maximum number of K - points in MEMory ",
    "section": "varfil",
    "text": "<p>\nSets the maximum number of k\npoints for which the ground state wavefunctions\nare kept in core memory at one time.\n<br>This value should either be 0, in which case an out-of-core\nsolution will be used, or else <a href=\"varbas.html#nkpt\">nkpt</a>,\nin which case an in-core solution will be used.\n<br>\nThis input variable can be used during a GW calculation to reduce the memory allocated\nby each processor (presently only for <a href=\"vargs.html#optdriver\">optdriver</a>=3).\nSee also the related input variable <a href=\"varpar.html#gwpara\">gwpara</a>.\n\n<br>Internal representation as mkmems(1)",
    "vartype": "integer parameter "
  },
  "mkqmem": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "<a href=\"varbas.html#nkpt\">nkpt</a>, i.e. in-core solution.",
    "definition": "Maximum number of K+Q - points in MEMory ",
    "section": "varrf",
    "text": "<p>\nPlays a role similar to <a href=\"varfil.html#mkmem\">mkmem</a>\nbut for different sets of wavefunctions : the\nground state wavefunctions at k+q and the first-order\nwavefunctions. Only needed for response calculations.\n<br>Internal representation as mkmems(2) and mkmems(3).\n<br>Note (991019) that although the effective number of k points\ncan be reduced thanks to symmetry for different\nperturbations, <b>mkqmem</b> and <b>mk1mem</b> are presently\nstill compared with the input <a href=\"varbas.html#nkpt\">nkpt</a>. This should be changed\nlater.",
    "vartype": "integer parameters  "
  },
  "mpw": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Maximum number of Plane Waves ",
    "section": "varint",
    "text": "<p>\nThis internal variable gives the maximum of the number of\nplane waves over all k-points. It is computed\nfrom <a href=\"varbas.html#ecut\">ecut</a> and the description\nof the cell, provided by\n<a href=\"varbas.html#acell\">acell</a>,\n<a href=\"varbas.html#rprim\">rprim</a>, and/or\n<a href=\"varbas.html#angdeg\">angdeg</a>.\n",
    "vartype": "integer "
  },
  "mqgrid": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "3001.",
    "definition": "Maximum number of Q-space GRID points for pseudopotentials",
    "section": "vardev",
    "text": "<p>Govern the size of the one-dimensional information\nrelated to pseudopotentials, in reciprocal space :\npotentials, or projector functions.\n",
    "vartype": "integer parameter  "
  },
  "mqgriddg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "3001 ",
    "definition": "",
    "section": "varpaw",
    "text": "<p>\nMaximum number of wavevectors used to sample the local part of the potential, in PAW.\nActually referred to as mqgrid_vl internally. Should change name to the latter ...\nSee also <a href=\"vardev.html#mqgrid\">mqgrid</a>\n",
    "vartype": "integer parameter "
  },
  "natcon": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 ",
    "definition": "Number of AToms in CONstraint equations",
    "section": "varrlx",
    "text": "<p>\nGives the number of atoms appearing in each of the <a\nhref=\"varrlx.html#nconeq\">nconeq</a>\nindependent equations constraining the motion of\natoms during structural optimization or molecular dynamics (see <a\nhref=\"varrlx.html#nconeq\">nconeq</a>, <a href=\"varrlx.html#iatcon\">iatcon</a>,\nand <a href=\"varrlx.html#wtatcon\">wtatcon</a>).\n",
    "vartype": "integer array of length <a href=\"varrlx.html#nconeq\">nconeq</a>"
  },
  "natfix": {
    "category": "NOT INTERNAL ",
    "default": "0 (no atoms held fixed).",
    "definition": "Number of Atoms that are FIXed ",
    "section": "varrlx",
    "text": "<p>\nGives the number of atoms (not to exceed\n<a href=\"varbas.html#natom\">natom</a>) which are to be held fixed\nduring a structural\noptimization or molecular dynamics. <br>\nWhen <b>natfix</b> &gt; 0,\n<b>natfix</b> entries should be provided in array <a\nhref=\"varrlx.html#iatfix\">iatfix</a>.\n<br>\nWhen <b>natfixx</b> &gt; 0, <b>natfixx</b> entries should be provided\nin array <a href=\"varrlx.html#iatfixx\">iatfixx</a>, and so on ...\n",
    "vartype": "integer parameter "
  },
  "natfixx": {
    "category": "NOT INTERNAL ",
    "default": "0 (no atoms held fixed).",
    "definition": "Number of Atoms that are FIXed along the X direction ",
    "section": "varrlx",
    "text": "<p>\nGives the number of atoms (not to exceed\n<a href=\"varbas.html#natom\">natom</a>) which are to be held fixed\nduring a structural\noptimization or molecular dynamics. <br>\nWhen <b>natfix</b> &gt; 0,\n<b>natfix</b> entries should be provided in array <a\nhref=\"varrlx.html#iatfix\">iatfix</a>.\n<br>\nWhen <b>natfixx</b> &gt; 0, <b>natfixx</b> entries should be provided\nin array <a href=\"varrlx.html#iatfixx\">iatfixx</a>, and so on ...\n",
    "vartype": "integer parameter "
  },
  "natfixy": {
    "category": "NOT INTERNAL ",
    "default": "0 (no atoms held fixed).",
    "definition": "Number of Atoms that are FIXed along the Y direction ",
    "section": "varrlx",
    "text": "<p>\nGives the number of atoms (not to exceed\n<a href=\"varbas.html#natom\">natom</a>) which are to be held fixed\nduring a structural\noptimization or molecular dynamics. <br>\nWhen <b>natfix</b> &gt; 0,\n<b>natfix</b> entries should be provided in array <a\nhref=\"varrlx.html#iatfix\">iatfix</a>.\n<br>\nWhen <b>natfixx</b> &gt; 0, <b>natfixx</b> entries should be provided\nin array <a href=\"varrlx.html#iatfixx\">iatfixx</a>, and so on ...\n",
    "vartype": "integer parameter "
  },
  "natfixz": {
    "category": "NOT INTERNAL ",
    "default": "0 (no atoms held fixed).",
    "definition": "Number of Atoms that are FIXed along the Z direction ",
    "section": "varrlx",
    "text": "<p>\nGives the number of atoms (not to exceed\n<a href=\"varbas.html#natom\">natom</a>) which are to be held fixed\nduring a structural\noptimization or molecular dynamics. <br>\nWhen <b>natfix</b> &gt; 0,\n<b>natfix</b> entries should be provided in array <a\nhref=\"varrlx.html#iatfix\">iatfix</a>.\n<br>\nWhen <b>natfixx</b> &gt; 0, <b>natfixx</b> entries should be provided\nin array <a href=\"varrlx.html#iatfixx\">iatfixx</a>, and so on ...\n",
    "vartype": "integer parameter "
  },
  "natom": {
    "category": " ",
    "default": "1 ",
    "definition": "Number of ATOMs ",
    "section": "varbas",
    "text": "<p>\nGives the total number of atoms in the unit cell.\nDefault is 1 but you will obviously want to input this\nvalue explicitly.\n<br>Note that <b>natom</b> refers to all atoms in the unit cell, not\nonly to the irreducible set of atoms in the unit cell (using symmetry operations,\nthis set allows to recover all atoms). If you want\nto specify only the irreducible set of atoms, use the\nsymmetriser, see the input variable <a href=\"vargeo.html#natrd\">natrd</a>.",
    "vartype": "integer parameter  "
  },
  "natpawu": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Number of AToms on which PAW+U is applied",
    "section": "varint",
    "text": "<p>\nThis internal variable gives the number of atoms on which LDA/GGA+U method\nis applied.\n<br>It is determined by <a href=\"varbas.html#natom\">natom</a>,\n<a href=\"varpaw.html#usepawu\">usepawu</a> and\n<a href=\"varpaw.html#lpawu\">lpawu</a> input keywords.\n",
    "vartype": "integer parameter  "
  },
  "natrd": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>,  SYMMETRISER  ",
    "default": "<a href=\"varbas.html#natom\">natom</a>.",
    "definition": "Number of AToms ReaD ",
    "section": "vargeo",
    "text": "<p>\nGives the number of atoms to be\nread from the input file, in the case the geo builder\nor the symmetriser is used. In this case,\n<b>natrd</b> is also used to dimension\nthe array <a href=\"varbas.html#typat\">typat</a>,\nand the arrays <a href=\"varbas.html#xred\">xred</a>,\n<a href=\"varbas.html#xangst\">xangst</a> and <a href=\"varbas.html#xcart\">xcart</a>.\n<br>Must take into account the vacancies (see <a href=\"vargeo.html#vacnum\">vacnum</a> and\n<a href=\"vargeo.html#vaclst\">vaclst</a>).\n<br>Despite possible vacancies, cannot be bigger than <a href=\"varbas.html#natom\">natom</a>.\n",
    "vartype": "integer parameter  "
  },
  "natsph": {
    "category": " ",
    "default": "<a href=\"varbas.html#natom\">natom</a> ",
    "definition": "Number of ATomic SPHeres for the atom-projected density-of-states",
    "section": "vargs",
    "text": "<p>\nThis input variable is active only in the\n<a href=\"varfil.html#prtdos\">prtdos</a>=3 case or if\n<a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2.\n<br>It gives the number of atoms around which the sphere\nfor atom-projected density-of-states will be built,\nin the <a href=\"varfil.html#prtdos\">prtdos</a>=3 case.\nThe indices of these atoms are given by <a href=\"vargs.html#iatsph\">iatsph</a>.\nThe radius of these spheres is given by <a href=\"vargs.html#ratsph\">ratsph</a>.\n<br> If <a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2, it gives the number of atoms around which atom-projected band structure will be\nbuilt (the indices of these atoms are given by  <a href=\"vargs.html#iatsph\">iatsph</a>).\n",
    "vartype": "integer parameter  "
  },
  "natsph_extra": {
    "category": " ",
    "default": "0",
    "definition": "Number of ATomic SPHeres for the l-projected density-of-states in EXTRA set",
    "section": "vargs",
    "text": "<p>\nThis input variable is active only in the\n<a href=\"varfil.html#prtdos\">prtdos</a>=3 case or if\n<a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2.\n<br>It gives the number of extra spheres\nfor which the angular-momentum-projected density-of-states will be built,\nin the <a href=\"varfil.html#prtdos\">prtdos</a>=3 case.\nThe radius of these spheres is given by <a href=\"vargs.html#ratsph_extra\">ratsph_extra</a>.\nThis simulates the STS signal for an STM tip atom placed at the sphere position, according to the chemical nature of the tip (s- p- d- wave etc...).\n<br> If <a href=\"varpaw.html#pawfatbnd\">pawfatbnd</a>=1 or 2, it gives the number of spheres in which l-projected band structure will be\nbuilt.\n<br> The position of the spheres is given by the <a href=#xredsph_extra>xredsph_extra</a> variable.\n",
    "vartype": "integer parameter  "
  },
  "natvshift": {
    "category": "",
    "default": "0.",
    "definition": "Number of ATomic potential (V) energy SHIFTs (per atom) ",
    "section": "varff",
    "text": "<p>\nNumber of atomic potential energy shifts (per atom), to be used to define the\narray <a href=\"varff.html#atvshift\">atvshift</a>.\nIf non-zero, only two possibilities exist : 5 for d states\n(with <a href=\"varpaw.html#lpawu\">lpawu</a>=2),\nand 7 for f states (with <a href=\"varpaw.html#lpawu\">lpawu</a>=3).\nIf non-zero, one should define\n<a href=\"varpaw.html#usepawu\">usepawu</a>,\n<a href=\"varpaw.html#lpawu\">lpawu</a> and\n<a href=\"varff.html#atvshift\">atvshift</a>.\n",
    "vartype": "integer parameter "
  },
  "nband": {
    "category": " ",
    "default": "1.",
    "definition": "Number of BANDs ",
    "section": "varbas",
    "text": "<p>\nGives number of bands, occupied plus\npossibly unoccupied, for which wavefunctions are being computed\nalong with eigenvalues.\n<br>Note : if the parameter\n<a href=\"varbas.html#occopt\">occopt</a> (see below) is not set to 2,\n<b>nband</b> is a scalar integer, but\nif the parameter <a href=\"varbas.html#occopt\">occopt</a> is set to 2,\nthen <b>nband</b> must be an array <b>nband</b>(<a href=\"varbas.html#nkpt\">nkpt</a>*\n<a href=\"varbas.html#nsppol\">nsppol</a>) giving the\nnumber of bands explicitly for each k point.  This\noption is provided in order to allow the number of\nbands treated to vary from k point to k point.\n<br>For the values of <a href=\"varbas.html#occopt\">occopt</a> not equal to 0 or 2, <b>nband</b>\ncan be omitted. The number of bands will be set up\nthanks to the use of the variable <a href=\"vargs.html#fband\">fband</a>. The present Default\nwill not be used.\n<p>If <a href=\"vargs.html#nspinor\">nspinor</a> is 2, nband must be even for\neach k point.\n<p>In the case of a GW calculation (<a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4),\n<b>nband</b> gives the number of bands to be treated to generate the screening (susceptibility\nand dielectric matrix), as well as the self-energy. However, to generate the _KSS\nfile (see <a href=\"varfil.html#kssform\">kssform</a>)\nthe relevant number of bands is given by <a href=\"vargw.html#nbandkss\">nbandkss</a>.\n\n",
    "vartype": "integer parameter  "
  },
  "nbandkss": {
    "category": " ",
    "default": "0",
    "definition": "Number of BaNDs in the KSS file ",
    "section": "vargw",
    "text": "<p>\nThis input variable is used for the preparation of a GW calculation :\nit is used in a GS run (where <a href=\"vargs.html#optdriver\">optdriver</a>=0) to generate a _KSS file.\nIn this run, <b>nbandkss</b> should be non-zero.\nThe generated _KSS file can be subsequently used to calculate the irreducible polarizabilty\n$\\chi^{(0)}_{KS}$ using <a href=\"vargs.html#optdriver\">optdriver</a>=3\nor to calculate GW corrections setting <a href=\"vargs.html#optdriver\">optdriver</a>=4.\n<p>\n\n<ul>\n<li>If <b>nbandkss</b>=0, no _KSS file is created</li>\n<li>If <b>nbandkss</b>=-1, all the available eigenstates (energies and eigenfunctions) are stored in the\nabo_KSS file at the end of the ground state calculation. The number of states is forced to be\nthe same for all k-points : it will be the minimum of the number of plane waves over all k-points.</li>\n<li>If <b>nbandkss</b> is greater than 0, abinit stores (about) <b>nbandkss</b> eigenstates in the abo_KSS file.\nThis number of states is forced to be the same for all k-points.</li>\n</ul>\n\n<p>\nSee <a href=\"vargw.html#npwkss\">npwkss</a> for the selection of the number of the planewave components of\nthe eigenstates to be stored.\n<br>\nThe input variable <a href=\"vardev.html#accesswff\">accesswff</a> can be used\nto read and write KSS files according to different fileformat\n(presently only <a href=\"vardev.html#accesswff\">accesswff</a>=0 and 3 are available in the GW part).\n<br>\nThe precision of the KSS file can be tuned through the input variable <a href=\"varfil.html#kssform\">kssform</a>.\n<br>\nFor more details about the format of the abo_KSS file, see the routine outkss.F90.\n<p>\nVery important : for the time being, <a href=\"vardev.html#istwfk\">istwfk</a> must be 1 for all the k-points\nin order to generate a _KSS file.\n",
    "vartype": "integer parameter  "
  },
  "nbandsus": {
    "category": "",
    "default": "<a href=\"varbas.html#nband\">nband</a>.",
    "definition": "Number of BANDs to compute the SUSceptibility ",
    "section": "vardev",
    "text": "<p>\nNumber of bands to be used in the calculation of the susceptibility matrix (ACFD only).\n",
    "vartype": "integer parameter "
  },
  "nbdblock": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1",
    "definition": "Number of BanDs in a BLOCK ",
    "section": "vardev",
    "text": "<p>In case of non-standard, blocked algorithms for the\noptimization of the wavefunctions (that is, if\n<a href=\"vardev.html#wfoptalg\">wfoptalg</a>=4):\n<ul>\n<li>if <a href=\"vardev.html#wfoptalg\">wfoptalg</a>=4,\n<b>nbdblock</b> defines the number of blocks (the number of bands in the block is\nthen <a href=\"varbas.html#nband\">nband</a>/nbdblock ).</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "nbdbuf": {
    "category": "",
    "default": "0. However, the default is changed to 2 in some cases, see later.",
    "definition": "Number of BanDs for the BUFfer",
    "section": "vargs",
    "text": "<p>\n<b>nbdbuf</b> gives the number of bands, the highest in energy, that,\namong the\n<a href=\"varbas.html#nband\">nband</a> bands, are to be considered\nas part of a buffer. This concept is useful in three situations:\nin non-self-consistent\ncalculations, for the determination of the convergence tolerance ;\nfor response functions of metals, to avoid instabilities,\nand also when finite electric fields or non-linear responses (with electric field\nperturbations) are considered.\nFor the two first, the need of a buffer is a natural requirement\nof the problem, so that the default value is changed to 2 automatically,\nas explained in the following.\nThe third case is only for implementation convenience.\n\n<p> In non-self-consistent GS calculations (<a href=\"varbas.html#iscf\">iscf</a>&lt;0),\nthe highest levels might be\ndifficult to converge, if they are degenerate with another level,\nthat does not belong to the set of bands treated. Then, it might\ntake extremely long to reach <a href=\"varbas.html#tolwfr\">tolwfr</a>, although\nthe other bands are already extremely well-converged, and the energy\nof the highest bands (whose residual are not yet good enough), is\nalso rather well converged.\n<br> In response to this problem, for non-zero <b>nbdbuf</b>, the\nlargest residual (residm), to be later compared with <a href=\"varbas.html#tolwfr\">tolwfr</a>,\nwill be computed only in the set of non-buffer bands (this modification\napplies for non-self-consistent as well as self-consistent calculation,\nfor GS as well as RF calculations).\n<br> For a GS calculation, with <a href=\"varbas.html#iscf\">iscf</a>&lt;0, supposing\n<b>nbdbuf</b> is not initialized in the input file,\nthen ABINIT will overcome the default <b>nbdbuf</b> value,\nand automatically set <b>nbdbuf</b> to 2.\n<p> In metallic RF calculations, in the conjugate gradient optimisation\nof first-order wavefunctions, there is an instability situation\nwhen the q wavevector of the perturbation brings the eigenenergy of the\nhighest treated band at some k point higher than the lowest\nuntreated eigenenergy at some k+q point.\nIf one accepts a buffer of frozen states, this instability can be made to\ndisappear. Frozen states receive automatically a residual value of -0.1d0.\n<br> For a RF calculation, with 3&lt;=<a href=\"varbas.html#occopt\">occopt</a>&lt;=7,\nsupposing\n<b>nbdbuf</b> is not initialized in the input file, then\nABINIT will overcome the default <b>nbdbuf</b> value,\nand automatically set <b>nbdbuf</b> to 2. This value might be too low\nin some cases.\n\n<p>Also, the number of active bands, in all cases, is imposed\nto be at least 1, irrespective of the value of <b>nbdbuf</b>.\n",
    "vartype": "integer parameter "
  },
  "nberry": {
    "category": "",
    "default": "1",
    "definition": "Number of BERRY phase computations",
    "section": "varff",
    "text": "<p> Used for non-zero values of <a href=\"varff.html#berryopt\">berryopt</a>.\n<p> Gives the number of Berry phase computations of polarisation,\nor finite-difference estimations of the derivative of wavefunctions\nwith respect to the wavevector,\neach of which might be characterized by a different change of\nwavevector <a href=\"varff.html#kberry\">kberry</a>.\n<p> When equal to 0, no Berry phase calculation of polarisation\nis performed. The maximal value of <b>nberry</b> is 20.\n<p> Note that the computation of the polarisation for a set of bands\nhaving different occupation numbers is meaningless (although\nin the case of spin-polarized calculations, the spin up bands\nmight have an identical occupation number, that might differ\nfrom the identical occupation number of spin down bands).\nAlthough meaningless, ABINIT will perform such computation,\nif required by the user. The input variable\n<a href=\"varff.html#bdberry\">bdberry</a> governs the set of bands\nfor which a Berry phase is computed.\n<p> The computation of the Berry phase is not yet implemented\nfor spinor wavefunctions (<a href=\"vargs.html#nspinor\">nspinor</a>=2).\nMoreover, it is not yet implemented in the parallel version of ABINIT.\n",
    "vartype": "integer nberry"
  },
  "nconeq": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "0 ",
    "definition": "Number of CONstraint EQuations",
    "section": "varrlx",
    "text": "<p>\nGives the number of independent equations constraining\nthe motion of\natoms during structural optimization or molecular dynamics (see <a\nhref=\"varrlx.html#natcon\">natcon</a>, <a href=\"varrlx.html#iatcon\">iatcon</a>,\nand <a href=\"varrlx.html#wtatcon\">wtatcon</a>).\n",
    "vartype": "integer parameter"
  },
  "nctime": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "NetCdf TIME between output of molecular dynamics informations ",
    "section": "vardev",
    "text": "<p>When <b>nctime</b> is non-zero, the molecular dynamics information\nis output in NetCDF format, every <b>nctime</b> time step. Here is the content of an example file :\n<pre>\nnetcdf md32.outH_moldyn1 {\ndimensions:\ntime = UNLIMITED ; // (11 currently)\nDimTensor = 6 ;\nDimCoord = 3 ;\nNbAtoms = 32 ;\nDimVector = 3 ;\nDimScalar = 1 ;\nvariables:\ndouble E_pot(time) ;\nE_pot:units = \"hartree\" ;\ndouble E_kin(time) ;\nE_kin:units = \"hartree\" ;\ndouble Stress(time, DimTensor) ;\nStress:units = \"hartree/Bohr^3\" ;\ndouble Position(time, DimCoord, NbAtoms) ;\nPosition:units = \"Bohr\" ;\ndouble Celerity(time, DimCoord, NbAtoms) ;\nCelerity:units = \"Bohr/(atomic time unit)\" ;\ndouble PrimitiveVector1(DimVector) ;\ndouble PrimitiveVector2(DimVector) ;\ndouble PrimitiveVector3(DimVector) ;\ndouble Cell_Volume(DimScalar) ;\nCell_Volume:units = \"Bohr^3\" ;\n}\n</pre>\n\n",
    "vartype": "integer parameter  "
  },
  "ndivk": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No default.",
    "definition": "Number of DIVisions of K lines",
    "section": "vargs",
    "text": "<p>\nGives the number of divisions of each of the segments\nof the band structure, whose path is determined by\n<a href=\"varbas.html#kptopt\">kptopt</a>\nand\n<a href=\"vargs.html#kptbounds\">kptbounds</a>.\nThis is only needed when <a href=\"varbas.html#kptopt\">kptopt</a>\nis negative. In this case, the absolute value of\n<a href=\"varbas.html#kptopt\">kptopt</a> is the number of such segments.\n<p>For example, suppose that the number of segment is just one\n(<a href=\"varbas.html#kptopt\">kptopt</a>=-1),\na value <b>ndivk</b>=4 will lead to the computation\nof points with relative coordinates 0.0, 0.25, 0.5, 0.75 and 1.0 , along\nthe segment in consideration.\n<p>Now, suppose that there are two segments\n(<a href=\"varbas.html#kptopt\">kptopt</a>=-2), with\n<b>ndivk</b>(1)=4 and <b>ndivk</b>(2)=2, the computation of the\neigenvalues will be done at 7 points, 5 belonging to the\nfirst segment, with relative coordinates 0.0, 0.25, 0.5, 0.75 and 1.0,\nthe last one being also the starting point of the next segment,\nfor which two other points must be computed, with relative coordinates\n0.5 and 1.0 .\n<p>It is easy to compute disconnected circuits (non-chained segments),\nby separating\nthe circuits with the value <b>ndivk</b>=1 for the intermediate\nsegment connecting the end of one circuit with the\nbeginning of the next one (in which case no intermediate\npoint is computed along this segment).\n<p>Alternatively it is possible to generate automatically the array <b>ndivk</b>\nby just specifying the number of divisions for the smallest segment.\nSee the related input variable <a href=\"vargs.html#ndivsm\">ndivsm</a>.\n",
    "vartype": "integer array ndivk(abs(<a href=\"varbas.html#kptopt\">kptopt</a>))  "
  },
  "ndivsm": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No default.",
    "definition": "Number of DIVisions for the SMallest segment",
    "section": "vargs",
    "text": "<p>\nGives the number of divisions used to sample the smallest segment\nof the circuit employed during a band structure calculation\n(see related input variables\n<a href=\"varbas.html#kptopt\">kptopt</a>\nand\n<a href=\"vargs.html#kptbounds\">kptbounds</a>).\nIf <b>ndivsm</b> is given in the input file, there is no need to specify the number of divisions\nto be used for the other segments.\nIndeed <a href=\"vargs.html#ndivk\">ndivk</a> is automatically calculated inside the\ncode in order to generate a path where the number of divisions in each segment is proportial\nto the length of the segment itself.\nThis option is activated only when <a href=\"varbas.html#kptopt\">kptopt</a> is negative.\nIn this case, the absolute value of\n<a href=\"varbas.html#kptopt\">kptopt</a> is the number of such segments.\n",
    "vartype": "integer "
  },
  "ndtset": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a>  ",
    "default": "0 (no multi-data set).",
    "definition": "Number of DaTaSETs ",
    "section": "varbas",
    "text": "<p>\nGives the number of data sets to be\ntreated.\n<br>If 0, means that the multi-data set treatment is not used,\nso that the root filenames will not be appended with _DSx,\nwhere 'x' is the dataset index defined\nby the input variable <a href=\"varbas.html#jdtset\">jdtset</a>,\nand also that input names with a dataset index are not allowed.\nOtherwise, <b>ndtset</b>=0 is equivalent to <b>ndtset</b>=1.",
    "vartype": "integer parameter  "
  },
  "ndynimage": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Number of DYNamical IMAGEs ",
    "section": "varint",
    "text": "<p>\nThis internal variable gives the number of dynamical images,\nimmediately deduced from the number of non-zero values present in\n<a href=\"varrlx.html#dynimage\">dynimage</a>.\nIt is used to dimension many memory-consuming arrays (one copy for each image),\nin case they are not stored on disk (see <a href=\"varfil.html#mkmem\">mkmem</a>),\ne.g. the wavefunction array (cg), the density array (rho), etc .\n",
    "vartype": "integer "
  },
  "ndyson": {
    "category": "",
    "default": "-1.",
    "definition": "Number of points to be added for the solution of the DYSON equation ",
    "section": "vardev",
    "text": "<p>\nNumber of points to be added to lambda=0 and lambda=1 (that are always calculated\nfor the integration ober the coupling constant lambda in the ACFD calculation of the\nexchange-correlation energy.\n<ul>\n<li>ndyson=-1 : let the code decide how many points to use (presently, 3 points\nfor <a href=\"vardev.html#idyson\">idyson</a>=1 or 3, and 9 points for\n<a href=\"vardev.html#idyson\">idyson</a>=2)</li>\n<li>ndyson=0 : only compute the non-interacting and fully-interacting\nsusceptibility matrices.</li>\n<li>ndyson&gt;0 : use <b>ndyson</b> more points in ]0,1[</li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "neb_algo": {
    "category": "",
    "default": "<b>neb_algo</b>=1",
    "definition": "Nudged Elastic Band ALGOrithm ",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=5 (Nudged Elastic Band).<br>\nGives the variant of the NEB method used.<br>\nPossible values can be:<br>\n<ul>\n<li>0=&gt; <b>Original NEB method</b>.<br>\n<i>See: Classical and Quantum Dynamics in Condensed Phase Simulations, edited by\nBerne, Ciccotti, Coker (World Scientific, Singapore, 1998), pp. 385-404</i>\n</li>\n<br>\n<li>1=&gt; <b>NEB + improved tangent</b>.<br>\nThe Improved Tangent Method builds on the NEB with an improved estimate of the\ntangent direction and a resulting change of the component of the spring force acting\non the images.<br>\n<i>See: J. Chem. Phys. 113, 9978 (2000).</i>\n</li>\n<br>\n<li>2=&gt; <b>Climbing-Image NEB (CI-NEB)</b>.<br>\nThe CI-NEB method constitutes a small modification to the NEB method.\nInformation about the shape of the MEP is retained, but a rigorous\nconvergence to a saddle point is also obtained.\nBy defaut the spring constants are variable (see <a href=\"varrlx.html#neb_spring\">neb_spring</a>).\nAs the image with the highest energy has to be identified,\nthe calculation begins with several iterations of the standard NEB\nalgorithm. The effective CI-NEB begins at the <a href=\"varrlx.html#cineb_start\">cineb_start</a> iteration.<br>\n<i>See: J. Chem. Phys. 113, 9901 (2000).</i>\n</li>\n</ul>\nNote that, in all cases, it is possible to define the value of the spring constant connecting images with\n<a href=\"varrlx.html#neb_spring\">neb_spring</a>, keeping it constant or allowing it\nto vary between 2 values (to have higher resolution close to the saddle point).\n",
    "vartype": "integer parameter"
  },
  "neb_spring": {
    "category": "",
    "default": "<b>neb_spring</b>=2*0.05 Ha/bohr^2 when <a href=\"varrlx.html#neb_algo\">neb_algo</a>/=2, <b>neb_spring</b>=(0.02, 0.15) Ha/bohr^2 when <a href=\"varrlx.html#neb_algo\">neb_algo</a>/=2 (CI-NEB)",
    "definition": "Nudged Elastic Band: SPRING constant",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=5 (Nudged Elastic Band).<br>\nGives the minimal and maximal values of the spring constant connecting images for the NEB method.<br>\nIn the standard \"Nudged Elastic Band\" method, the spring constant is constant along the path,\nbut, in order to have higher resolution close to the saddle point, it can be better\nto have stronger springs close to it.<br>\nUnits: Hartree/Bohr^2.<br>\n<i>See: J. Chem. Phys. 113, 9901 (2000).</i>\n",
    "vartype": "real array neb_spring(2)"
  },
  "nelect": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Number of ELECTrons ",
    "section": "varint",
    "text": "<p>\nThis internal variable gives the number of electrons per unit\ncell, as computed from the sum of the valence electrons\nrelated to each atom (given in the pseudopotential, where it is called\n\"zion\"), and the input variable\n<a href=\"vargs.html#charge\">charge</a>:\n<br>\n<b>nelect</b>=zion-<a href=\"vargs.html#charge\">charge</a>.\n",
    "vartype": "real number "
  },
  "nfft": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Number of FFT points ",
    "section": "varint",
    "text": "<p>\nIf space parallelisation is not used,\nthis internal variable gives the number of Fast Fourier Transform\npoints in the grid generated by\n<a href=\"vargs.html#ngfft\">ngfft</a>(1:3). It is simply the\nproduct of the three components of <a href=\"vargs.html#ngfft\">ngfft</a>.\n<br> If space parallelisation is used, then it becomes the\nnumber of Fast Fourier Transform points attributed to the\nparticular processor. It is no longer the above-mentioned simple product,\nbut a number usually close to this product divided by the\nnumber of processors on which the space is shared.\n",
    "vartype": "integer "
  },
  "nfftdg": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Number of FFT points for the Double Grid",
    "section": "varint",
    "text": "<p>\nIf space parallelisation is not used,\nthis internal variable gives the number of Fast Fourier Transform\npoints in the (double) grid generated by\n<a href=\"varpaw.html#ngfftdg\">ngfftdg</a>(1:3). It is simply the\nproduct of the three components of <a href=\"varpaw.html#ngfftdg\">ngfftdg</a>.\n<br> If space parallelisation is used, then it becomes the\nnumber of Fast Fourier Transform points attributed to the\nparticular processor. It is no longer the above-mentioned simple product,\nbut a number usually close to this product divided by the\nnumber of processors on which the space is shared.\n",
    "vartype": "integer "
  },
  "nfreqim": {
    "category": " ",
    "default": "0",
    "definition": "Number of FREQuencies along the IMaginary axis ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>nfreqim</b> is used only for numerical integration of the GW self-energy\n(<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).\n<br>\n<b>nfreqim</b> sets the number of pure imaginary frequencies used to calculate\nthe dielectric matrix in order to perform the numerical integration of the GW self-energy.\n",
    "vartype": "integer parameter  "
  },
  "nfreqmidm": {
    "category": " ",
    "default": "No default ",
    "definition": "Nth FREQuencey moment of the IMaginary part of DM ",
    "section": "vargw",
    "text": "<p>\nat the moment only relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4,\nthat is, a screening calculation.\n<p>\ndepending on the value of <b>>nfreqmidm</b> will calculate the frequency moment of the Dielectric matrix or its inverse,\n\nif <b>>nfreqmidm</b> positive : calculate (nth=nfreqmidm) frequency moment of the Dielectric matrix\nif <b>>nfreqmidm</b> negative : calculate (nth=nfreqmidm) frequency moment of the inverse Dielectric matrix\nif <b>>nfreqmidm</b> = 0 : calculate first frequency moment of the full polarizability\n\nsee M. Taut, J. Phys. C: Solid State Phys. 18 (1985) 2677-2690.\n\n",
    "vartype": "integer parameter  "
  },
  "nfreqre": {
    "category": " ",
    "default": "0",
    "definition": "Number of FREQuencies along the Real axis ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>nfreqre</b> is used only for numerical integration of the GW self-energy\n(<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).\n<br>\n<b>nfreqre</b> sets the number of real frequencies used to calculate\nthe dielectric matrix in order to perform the numerical integration of the GW self-energy.\n<p>\nIt can be used also in case of GW calculations with plasmon-pole models,\n<i>i.e</i> <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>&lt;10,\nto reduce the number of frequencies used to evaluate the dielectric matrix from the (default) two to\none frequency (omega=0) by setting <b>nfreqre</b>=1.\nThis might be a good idea in case one is planning to use ppmodel&gt;1.\nThis will force the calculation of the screening on a single frequency (omega=0) and hence\nreduce memory and disk space requirement.\nThe only draw back is that the user will not be able to perform self energy calculation using\n<a href=\"vargw.html#ppmodel\">ppmodel</a>=1,\nsince in the last case the dielectric matrix calculated on two frequencies is required.\nIf the user is not sure which ppmodel to use, then s/he is not advised\nto use this input variable.\nUsing the default values, one must be able to get a screening file that can be used with any ppmodel.\n",
    "vartype": "integer parameter  "
  },
  "nfreqsp": {
    "category": " ",
    "default": "0",
    "definition": "Number of FREQuencies for the SPectral function ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>nfreqsp</b> defines the number of real frequencies used to calculate the spectral function\nof the GW Green's function.\n",
    "vartype": "integer parameter  "
  },
  "nfreqsus": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "Number of FREQuencies for the SUSceptibility matrix",
    "section": "vardev",
    "text": "<p>\nIf 0, no computation of frequency-dependent susceptibility matrix.\nIf 1 or larger, will read <a href=\"vardev.html#freqsuslo\">freqsuslo</a> and\n<a href=\"vardev.html#freqsusin\">freqsusin</a>\nto define the frequencies\n(1 is currently the only value allowed)\n",
    "vartype": "integer parameter  "
  },
  "ngfft": {
    "category": " ",
    "default": "0 0 0 (so, automatic selection of optimal values)",
    "definition": "Number of Grid points for Fast Fourier Transform ",
    "section": "vargs",
    "text": "<p>\ngives the size of fast Fourier transform\n(fft) grid in three dimensions.  Each number must be\ncomposed of the factors 2, 3, and 5 to be consistent with\nthe radices available in our fft.  If no <b>ngfft</b> is provided or\nif <b>ngfft</b> is set to 0 0 0, the code will automatically provide\nan optimal set of <b>ngfft</b> values, based on <a href=\"varbas.html#acell\">acell</a>,\n<a href=\"varbas.html#rprim\">rprim</a> and <a href=\"varbas.html#ecut\">ecut</a>\n(see also <a href=\"vargs.html#boxcutmin\">boxcutmin</a> for speed/accuracy concerns).\nThis is the recommended procedure, of course.\n<br>The total number of FFT points\nis the product:<br> <tele><b>ngfft</b>(1)*<b>ngfft</b>(2)*<b>ngfft</b>(3)=nfft </tele>. <br>\nWhen <b>ngfft</b> is made smaller\nthan recommended values (e.g. by setting <a href=\"vargs.html#boxcutmin\">boxcutmin</a>\nto a value smaller than 2.0 or by setting <b>ngfft</b> manually), the code runs faster and the\nequations in effect are approximated by a low pass Fourier\nfilter.  The code reports to standard output (unit 06) a\nparameter \"boxcut\" which is the smallest ratio of the fft\nbox side to the G vector basis sphere diameter.  When\nboxcut is less than 2 the Fourier filter approximation is being\nused.  When boxcut gets less than about 1.5 the\napproximation may be too severe for realistic results\nand should be tested against larger values of <b>ngfft</b>.\nWhen boxcut is larger than 2, <b>ngfft</b> could be reduced without\nloss of accuracy. In this case, the small variations\nthat are observed are solely due to the\nxc quadrature, that may be handled with <a href=\"vardev.html#intxc\">intxc</a>=1\nto even reduce this effect.\n<p>\nInternally, <b>ngfft</b> is an array of size 18. The present\ncomponents are stored in <b>ngfft</b>(1:3), while\n<ul>\n<li> <b>ngfft</b>(4:6) contains slightly different (larger) values,\nmodified for efficiency of the FFT </li>\n<li> <b>ngfft</b>(7) is <a href=\"vardev.html#fftalg\">fftalg</a> </li>\n<li> <b>ngfft</b>(8) is <a href=\"vardev.html#fftcache\">fftcache</a> </li>\n<li> <b>ngfft</b>(9) is set to 0 if the parallelization of the FFT is not activated,\nwhile it is set to 1 if it is activated.</li>\n<li> <b>ngfft</b>(10) is the number of processors of the FFT group </li>\n<li> <b>ngfft</b>(11) is the index of the processor in the group of processors </li>\n<li> <b>ngfft</b>(12) is n2proc, the number of x-z planes, in reciprocal space, treated by the processor </li>\n<li> <b>ngfft</b>(13) is n3proc, the number of x-y planes, in real space, treated by the processor </li>\n<li> <b>ngfft</b>(14) is mpi_comm_fft, the handle on the MPI communicator in charge of the FFT parallelisation </li>\n<li> <b>ngfft</b>(15:18) are not yet used </li>\n</ul>\n<br>\nThe number of points stored by this processor in real space is n1*n2*n3proc, while in reciprocal\nspace, it is n1*n2proc*n3.\n",
    "vartype": "integer array ngfft(3)"
  },
  "ngfftdg": {
    "category": "",
    "default": "0 0 0 (so, automatic selection of optimal values)",
    "definition": "Number of Grid points for Fast Fourier Transform : Double Grid ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br> This variable has the same meaning as ngfft (gives the size of fast Fourier\ntransform (fft) grid in three dimensions) but concerns the \"double\ngrid\" only used for PAW calculations.\n",
    "vartype": "integer array ngfftdg(3) "
  },
  "ngkpt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default",
    "definition": "Number of Grid points for K PoinTs generation ",
    "section": "varbas",
    "text": "<p>\nUsed when <a href=\"varbas.html#kptopt\">kptopt</a>>=0,\nif <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nhas not been defined (<a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nand <b>ngkpt</b> are exclusive of each other).\n<br> Its three positive components\ngive the number of k points of Monkhorst-Pack grids\n(defined with respect to primitive axis in reciprocal space)\nin each of the three dimensions.\n<b>ngkpt</b> will be used to generate the\ncorresponding <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\ninput variable.\nThe use of <a href=\"varbas.html#nshiftk\">nshiftk</a>\nand <a href=\"varbas.html#shiftk\">shiftk</a>, allows to generate\nshifted grids, or Monkhorst-Pack grids defined\nwith respect to conventional unit cells.\n<p>When <a href=\"varbas.html#nshiftk\">nshiftk</a>=1,\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a> is initialized\nas a diagonal (3x3) matrix, whose diagonal elements\nare the three values <b>ngkpt</b>(1:3). When\n<a href=\"varbas.html#nshiftk\">nshiftk</a> is greater than 1,\nABINIT will try to generate <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\non the basis of the primitive vectors of the k-lattice:\nthe number of shifts might be reduced, in which case\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a> will not be diagonal\nanymore.\n<p>Monkhorst-Pack grids are usually the most efficient when\ntheir defining integer numbers are even.\nFor a measure of the efficiency, see the input variable\n<a href=\"vargs.html#kptrlen\">kptrlen</a>.\n",
    "vartype": "integer array ngkpt(3)"
  },
  "ngqpt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "(0 0 0)",
    "definition": "Number of Grid pointsfor Q PoinTs generation ",
    "section": "vargs",
    "text": "<p>\nUsed when <a href=\"vargs.html#nqpt\">nqpt</a>=1, with <a href=\"vargs.html#qptopt\">kptopt</a>>=0,\nif <a href=\"vargs.html#qptrlatt\">qptrlatt</a>\nhas not been defined (<a href=\"vargs.html#qptrlatt\">qptrlatt</a>\nand <b>ngqpt</b> are exclusive of each other).\n<br>At variance with <a href=\"varbas.html#ngkpt\">ngkpt</a>, note that only one q point\nis selected per dataset (see <a href=\"vargs.html#iqpt\">iqpt</a>).\n<br> Its three positive components\ngive the number of q points of Monkhorst-Pack grids\n(defined with respect to primitive axis in reciprocal space)\nin each of the three dimensions.\nThe use of <a href=\"vargs.html#nshiftq\">nshiftq</a>\nand <a href=\"vargs.html#shiftq\">shiftq</a>, allows to generate\nshifted grids, or Monkhorst-Pack grids defined\nwith respect to conventional unit cells.\n<p>For more information on Monkhorst-Pack grids, see <a href=\"varbas.html#ngkpt\">ngkpt</a>.\n",
    "vartype": "integer array ngqpt(3)"
  },
  "nimage": {
    "category": "",
    "default": "1",
    "definition": "Number of IMAGEs",
    "section": "varrlx",
    "text": "<p>\nGive the number of images (or replicas) of the system,\nfor which the forces and stresses might be computed independantly,\nin the context of the string method, the genetic algorithm, hyperdynamics or Path-Integral Molecular Dynamics\ndepending on the value of <a href=\"varrlx.html#imgmov\">imgmov</a>).\nRelated input variables : <a href=\"varrlx.html#dynimage\">dynimage</a>,\n<a href=\"varpar.html#npimage\">npimage</a>, <a href=\"varrlx.html#ntimimage\">ntimimage</a>\nand <a href=\"varfil.html#prtvolimg\">prtvolimg</a>.\n<br>\nImages might differ by the position of atoms in the unit cell, their\nvelocity, as well as by their cell geo. The following input variables might be used to define\nthe images :\n<ul>\n<li><a href=\"varbas.html#acell\">acell</a>\n<li><a href=\"varbas.html#angdeg\">angdeg</a>\n<li><a href=\"varbas.html#rprim\">rprim</a>\n<li><a href=\"varrlx.html#vel\">vel</a>\n<li><a href=\"varbas.html#xangst\">xangst</a>\n<li><a href=\"varbas.html#xcart\">xcart</a>\n<li><a href=\"varbas.html#xred\">xred</a>\n</ul>\nThese input variables, non-modified, will be used to define the image with index 1.\nFor the image with the last index, the input file might specify the values\nof such input variables, appended with \"_lastimg\", e.g. one of these :\n<ul>\n<li><a href=\"varbas.html#acell\">acell_lastimg</a>\n<li><a href=\"varbas.html#angdeg\">angdeg_lastimg</a>\n<li><a href=\"varbas.html#rprim\">rprim_lastimg</a>\n<li><a href=\"varrlx.html#vel\">vel_lastimg</a>\n<li><a href=\"varbas.html#xangst\">xangst_lastimg</a>\n<li><a href=\"varbas.html#xcart\">xcart_lastimg</a>\n<li><a href=\"varbas.html#xred\">xred_lastimg</a>\n</ul>\n\nBy default, these values will be interpolated linearly to define values for the other images, unless\nthere exist specific values for some images, for which the string \"last\" has to be replaced by the\nindex of the image, e.g. for the image number 4 :\n<ul>\n<li><a href=\"varbas.html#acell\">acell_4img</a>\n<li><a href=\"varbas.html#angdeg\">angdeg_4img</a>\n<li><a href=\"varbas.html#rprim\">rprim_4img</a>\n<li><a href=\"varrlx.html#vel\">vel_4img</a>\n<li><a href=\"varbas.html#xangst\">xangst_4img</a>\n<li><a href=\"varbas.html#xcart\">xcart_4img</a>\n<li><a href=\"varbas.html#xred\">xred_4img</a>\n</ul>\n\nIt is notably possible to specify the starting point and the end point of the path (of images), while specifying intermediate points.<br>\n<br>\nIt usually happen that the images do not have the same symmetries and space group.\nABINIT has not been designed to use different set of symmetries for different images.\nABINIT will use the symmetry and space group of the image number 2, that\nis expected to have a low number of symmetries.\nThis might lead to erroneous calculations, in case some image has even less\nsymmetry. By contrast, there is no problem if some other image has more symmetries\nthan those of the second image.\n",
    "vartype": "integer parameter"
  },
  "nkpt": {
    "category": " ",
    "default": "0 if <a href=\"varbas.html#kptopt\">kptopt</a>/=0, and 1 if <a href=\"varbas.html#kptopt\">kptopt</a>==0.",
    "definition": "Number of K - Points ",
    "section": "varbas",
    "text": "<p>\nIf non-zero,\n<b>nkpt</b>\ngives the number of k points in the k point array\n<a href=\"varbas.html#kpt\">kpt</a>. These points\nare used either to sample the Brillouin zone, or to\nbuild a band structure along specified lines.\n<p>\nIf <b>nkpt</b> is zero, the code deduces from other input variables\n(see the list in the description of <a href=\"varbas.html#kptopt\">kptopt</a>)\nthe number of k points, which is possible only\nwhen <a href=\"varbas.html#kptopt\">kptopt</a>/=0.\nIf <a href=\"varbas.html#kptopt\">kptopt</a>/=0 and\nthe input value of <a href=\"varbas.html#nkpt\">nkpt</a>/=0,\nthen ABINIT will check that the number of k points\ngenerated from the other input variables\nis exactly the same than <b>nkpt</b>.\n\n<p>If <a href=\"varbas.html#kptopt\">kptopt</a> is positive,\n<b>nkpt</b> must be coherent with the values\nof <a href=\"vargs.html#kptrlatt\">kptrlatt</a>,\n<a href=\"varbas.html#nshiftk\">nshiftk</a>\nand <a href=\"varbas.html#shiftk\">shiftk</a>.\n<br>\nFor ground state calculations, one should select the\nk point in the irreducible Brillouin Zone (obtained\nby taking into account point symmetries and the time-reversal\nsymmetry).\n<br>For response function calculations, one should\nselect k points in the full Brillouin zone, if the wavevector\nof the perturbation does not vanish, or in a half of\nthe Brillouin Zone if q=0. The code will automatically decrease\nthe number of k points to the minimal set needed for\neach particular perturbation.\n<p>If <a href=\"varbas.html#kptopt\">kptopt</a> is negative,\n<b>nkpt</b> will be the sum of the number of points on\nthe different lines of the band structure.\nFor example,\nif <a href=\"varbas.html#kptopt\">kptopt</a>=-3, one\nwill have three segments; supposing\n<a href=\"vargs.html#ndivk\">ndivk</a> is 10 12 17,\nthe total number of k points of the circuit will be\n10+12+17+1(for the final point)=40.\n",
    "vartype": "integer parameter  "
  },
  "nkptgw": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of K-Points for GW corrections ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\nThis input variable was called \"ngwpt\" in versions before v4.3.\n<p>\n<b>nkptgw</b> gives the number of k-points for which the GW calculation must be done.\nIt is used to dimension <a href=\"vargw.html#kptgw\">kptgw</a>\n",
    "vartype": "integer parameter"
  },
  "nline": {
    "category": " ",
    "default": "4.",
    "definition": "Number of LINE minimisations ",
    "section": "vargs",
    "text": "<p>\nGives maximum number of line minimizations\nallowed in preconditioned conjugate gradient minimization\nfor each band. The Default, 4, is fine.\n<br>Special cases, with degeneracies or near-degeneracies\nof levels at the Fermi energy may require a larger value of\n<b>nline</b> (5 or 6 ?)\nLine minimizations will be stopped anyway when improvement\ngets small. With the input variable <a href=\"vardev.html#nnsclo\">nnsclo</a>,\ngoverns the convergence of the wavefunctions\nfor fixed potential.\n<br>Note that <b>nline</b>=0 can be used to diagonalize the Hamiltonian\nmatrix in the subspace spanned by the input wavefunctions.",
    "vartype": "integer parameter  "
  },
  "nloalg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "4 (norm-conserving psps) or 14 (PAW), except for the NEC where it is 2 (or 12).",
    "definition": "Non Local ALGorithm ",
    "section": "vardev",
    "text": "<p>\nAllows to choose the algorithm\nfor non-local operator application.\nOn super-scalar architectures, the Default <b>nloalg</b>=4/14 is the best,\nbut you can save memory by using <b>nloalg</b>=-4.<br>\nMore detailed explanations:<br><br>\n<div style=\"margin-left: 10px;\">Units figure of <b>nloalg</b>:</div>\n<div style=\"margin-left: 40px;\">\n- <b>nloalg</b>=?2 : Should be efficient on vector machines. It is\nindeed the fastest algorithm for the NEC, but\nactual tests on Fujitsu machine did not gave better\nperformances than the other options.<br>\n- <b>nloalg</b>=?3 : same as <b>nloalg</b>==2, but the loop order is inverted.<br>\n- <b>nloalg</b>=?4 : same as <b>nloalg</b>==3, but maximal use of registers\nhas been coded. This should be especially efficient on\nscalar and super-scalar machines. This has been\nconfirmed by tests.<br>\n</div><br>\n<div style=\"margin-left: 10px;\">Tens figure of <b>nloalg</b>:</div>\n<div style=\"margin-left: 40px;\">\n- <b>nloalg</b><10 : (k+G) vectors are not precomputed, in order to save memory space.<br>\n- <b>nloalg</b>>=10 : (k+G) vectors are precomputed, once per k-point.<br>\n</div><br>\n<div style=\"margin-left: 10px;\">Sign of <b>nloalg</b>:</div>\n<div style=\"margin-left: 40px;\">\nNegative values of <b>nloalg</b> correspond positive ones,\nwhere the phase precomputation has been suppressed,\nin order to save memory space: an array <i>double precision :: ph3d(2,npw,<a href=\"varbas.html#natom\">natom</a>)</i>\nis saved (typically half the space needed\nfor the wavefunctions at 1 k point - this corresponds\nto the silicon case). However, the computation of phases\ninside nonlop is somehow time-consuming.<br>\n</div>\n<br>\nNote: internally, <b>nloalg</b> is an array <i>nloalg(1:5)</i>,\nthat also allows to initialize several internal variables (not documented):\n<div style=\"margin-left: 40px;\">\n- <i>nloalg(1)</i>=mod(<b>nloalg</b>,10)<br>\n- <i>jump</i>=nloalg(2)<br>\n- <i>mblkpw</i>=nloalg(3)<br>\n- <i>mincat</i>=nloalg(4)<br>\n- <i>nloalg(5)</i>=<b>nloalg</b>/10<br>\n</div>\nHowever, only <i>nloalg(1)+10*nloalg(5)</i> is read as an input variable.",
    "vartype": "integer variable  "
  },
  "nnos": {
    "category": "",
    "default": "0",
    "definition": "Number of nose masses",
    "section": "varrlx",
    "text": "<p>\nGive the number of oscillators in the Martyna et al.\nchain of oscillators thermostats (when <a href=\"varrlx.html#ionmov\">ionmov</a>=13).\nThe mass of these oscillators is given by qmass (similar to <a\nhref=\"varrlx.html#noseinert\">noseinert</a>)&nbsp;\n",
    "vartype": "integer parameter"
  },
  "nnsclo": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0.",
    "definition": "Number of Non-Self Consistent LOops ",
    "section": "vardev",
    "text": "<p>\nGives the maximum number of\nnon-self-consistent loops of <a href=\"vargs.html#nline\">nline</a> line minimisations,\nin the SCF case (when <a href=\"varbas.html#iscf\">iscf</a> &gt;0).  In the case <a href=\"varbas.html#iscf\">iscf</a> &lt;=0 ,\nthe number of non-self-consistent loops is determined\nby <a href=\"varbas.html#nstep\">nstep</a>.\n<br>The Default value of 0 correspond to make\nthe two first fixed potential determinations\nof wavefunctions have 2 non-self consistent loops,\nand the next ones to have only 1 non-self consistent loop. ",
    "vartype": "integer parameter "
  },
  "nobj": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 (no use of the geo builder).",
    "definition": "Number of OBJects ",
    "section": "vargeo",
    "text": "<p>\nGives the number of 'objects'\nto be used by the geo builder in order to find the full\nset of atoms. At present, only one or two objects\ncan be defined, identified as objects 'a' and 'b'.\n<br>Related variables for object 'a' are : <a href=\"vargeo.html#objan\">objan</a>,\n<a href=\"vargeo.html#objaat\">objaat</a>,\n<a href=\"vargeo.html#objarf\">objarf</a>, <a href=\"vargeo.html#objatr\">objatr</a>,\n<a href=\"vargeo.html#objaro\">objaro</a>, <a href=\"vargeo.html#objaax\">objaax</a>. Related variables\nfor object 'b' are : <a href=\"vargeo.html#objan\">objbn</a>, <a href=\"vargeo.html#objaat\">objbat</a>,\n<a href=\"vargeo.html#objarf\">objbrf</a>, <a href=\"vargeo.html#objatr\">objbtr</a>,\n<a href=\"vargeo.html#objaro\">objbro</a>, <a href=\"vargeo.html#objaax\">objbax</a>.\n<br>More detailed explanation : when the geo builder\nis used (i.e. when <b>nobj</b>==1 or <b>nobj</b>==2), the code\nwill be given a primitive set of atoms, from which it\nwill have to deduce the full set of atoms.\n<br>An object will be specified by the number of\natoms it includes (<a href=\"vargeo.html#objan\">objan</a> or <a href=\"vargeo.html#objan\">objbn</a>),\nand the list of these atoms (<a href=\"vargeo.html#objaat\">objaat</a> or <a href=\"vargeo.html#objaat\">objbat</a>).\n<br>Examples of physical realisation of an object can be a molecule,\nor a group of atom to be repeated, or a part of a molecule\nto be rotated.\nThe geo builder can indeed repeat these objects (<a href=\"vargeo.html#objarf\">objarf</a>\nor <a href=\"vargeo.html#objarf\">objbrf</a>), rotate them (<a href=\"vargeo.html#objaro\">objaro</a> or\n<a href=\"vargeo.html#objaro\">objbro</a>) with respect\nto an axis (<a href=\"vargeo.html#objaax\">objaax</a> or <a href=\"vargeo.html#objaax\">objbax</a>), and translate them\n(<a href=\"vargeo.html#objatr\">objatr</a> or <a href=\"vargeo.html#objatr\">objbtr</a>).\nAfter having generated a geo\nthanks to rotation, translation and repetition of objects,\nit is possible to remove some atoms, in order to create\nvacancies (<a href=\"vargeo.html#vacnum\">vacnum</a> and <a href=\"vargeo.html#vaclst\">vaclst</a>).\nThe number of atoms in the primitive\nset, those that will be read from the input file, is\nspecified by the variable <a href=\"vargeo.html#natrd\">natrd</a>. It will be always smaller\nthan the final number of atoms, given by the variable <a href=\"varbas.html#natom\">natom</a>.\nThe code checks whether the primitive number of atoms\nplus those obtained by the repetition operation is\ncoherent with the variable <a href=\"varbas.html#natom\">natom</a>, taking into\naccount possible vacancies. <br>You should look\nat the other variables for more information.\nGo to <a href=\"vargeo.html#objan\">objan</a>, for example.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "integer parameter "
  },
  "nomegasf": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0 ",
    "definition": "Number of OMEGA to evaluate the Spectral Function ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 and\n<a href=\"vargw.html#spmeth\">spmeth</a>/=0, that is, screening calculations\nbased on the spectral reprentation of the irreducible polarizability.\n<p>\n<b>nomegasf</b> defines the number of real frequencies used to describe the spectral function\nassociated to the irreducible polarizability $\\chi^{(0)}_{KS}$.\nThe frequency mesh will cover the interval between 0 and the maximum (positive) transition\nenergy between occupied and empty states.\nThe delta function entering the expression defining the spectral function is approximated using two\ndifferent methods according to the value of the <a href=\"vargw.html#spmeth\">spmeth</a> input variable.\n<p> It is important to notice that an accurate description of the imaginary part of $\\chi^{(0)}_{KS}$\nrequires an extremely dense frequency mesh. It should be kept in mind, however, that the memory required\ngrows fast with the value of <b>nomegasf</b>.\n",
    "vartype": "integer parameter "
  },
  "nomegasi": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "12 ",
    "definition": "Number of OMEGA(S) along the Imaginary axis ",
    "section": "vargw",
    "text": "<p>\n\nOnly relevant for sigma calculations in which the self-energy along the real axis is obtained\nby performing the analytic continuation from the imaginary axis to the full complex plane\nvia the Pade approximant\n(<a href=\"vargs.html#optdriver\">optdriver</a>=4 and <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=x1).\n<p>\n<b>nomegasi</b> defines the number of frequency points used to sample the self-energy along the\nimaginary axis. The frequency mesh is linear and covers the interval between OMEGASIMIN=0.01 Hartree and\n<a href=\"vargw.html#omegasimax\">omegasimax</a>.\n",
    "vartype": "integer "
  },
  "nomegasrd": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "9 ",
    "definition": "Number of OMEGA to evaluate the Sigma Real axis Derivative ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nThe number of real frequencies around the KS energy where the self-energy Sigma is evaluated.\nFrom these values, the derivative of Sigma at the KS energy is numerically estimated through linear interpolation.\n",
    "vartype": "integer parameter "
  },
  "normpawu": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "0 ",
    "definition": "NORMalize atomic PAW+U projector ",
    "section": "vardev",
    "text": "<p>\nDefines whether the atomic wave function (used as projectors in PAW+U) should be renormalized to 1\nwithin PAW sphere.\n<ul>\n<li><b>normpawu</b>=0 : leave projector</li>\n<li><b>normpawu</b>=1 : renormalize </li>\n</ul>\n",
    "vartype": "integer normpawu(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "noseft": {
    "category": " ",
    "default": "",
    "definition": "",
    "section": "vardev",
    "text": "<p>\nTO BE DOCUMENTED\n",
    "vartype": ""
  },
  "noseinert": {
    "category": "",
    "default": "1.0d5 ",
    "definition": "NOSE INERTia factor ",
    "section": "varrlx",
    "text": "<p>\nGive the inertia factor W<sub>T</sub> of the\nNose-Hoover thermostat\n(when <a href=\"varrlx.html#ionmov\">ionmov</a>=8), in atomic\nunits of weight*length<sup>2</sup>, that is (electron mass)*(Bohr)<sup>2</sup>.\nThe equations of motion are :<br>\nM<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>\n- dX/dt M<sub>I</sub> dR<sub>I</sub>/dt\n<br>\nand\n<br>\nW<sub>T</sub> d<sup>2</sup>X/dt<sup>2</sup>=\nSum(I) M<sub>I</sub> (dR<sub>I</sub>/dt)<sup>2</sup>\n- 3Nk<sub>B</sub>T\n<br>\nwhere I represent each nucleus, M<sub>I</sub> is the mass of each\nnucleus\n(see <a href=\"varrlx.html#amu\">amu</a>),\nR<sub>I</sub> is the coordinate of each nucleus (see <a\nhref=\"varbas.html#xcart\">xcart</a>),\ndX/dt is a dynamical friction coefficient, and T is the temperature\nof the thermostat (see <a href=\"varrlx.html#mdtemp\">mdtemp</a>.\n",
    "vartype": "real noseinert"
  },
  "np_slk": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1000000",
    "definition": "Number of mpi Processors used for ScaLapacK calls",
    "section": "varpar",
    "text": "<p>\nOnly relevant (for Ground-State calculations) when <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1\nand LOBPCG algorithm is used.<br>\nWhen using Scalapack (or any similar Matrix Algebra library), it is well known that\nthe efficiency of the eigenproblem resolution saturates as the number of CPU cores\nincreases. It is better to use a smaller number of CPU cores for the LINALG calls.<br>\nThis maximum number of cores can be set with <b>np_slk</b>.<br>\nA large number for <b>np_slk</b> (i.e. 1000000) means that all cores are used for the\nLinear Algebra calls.\n",
    "vartype": "integer parameter"
  },
  "npband": {
    "category": "",
    "default": "1.",
    "definition": "Number of Processors at the BAND level ",
    "section": "varpar",
    "text": "<p>\nRelevant only for the band/FFT parallelisation\n(see the <a href=\"varpar.html#paral_kgb\">paral_kgb</a> input variable).\n<br> <b>npband</b> gives the number of processors among which the work load over the band level is shared.\n<b>npband</b>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npkpt\">npkpt</a> and <a href=\"varpar.html#npspinor\">npspinor</a>\nare combined to give the total number\nof processors (nproc) working on the band/FFT/k-point parallelisation.<br>\nSee <a href=\"varpar.html#npfft\">npfft</a>, <a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npspinor\">npspinor</a> and\n<a href=\"varpar.html#paral_kgb\">paral_kgb</a> for the additional information on the use of\nband/FFT/k-point parallelisation.\n<p>\nNote : at present, <b>npband</b> has to be a divisor or equal to <a href=\"varbas.html#nband\">nband</a>\n",
    "vartype": "integer "
  },
  "npfft": {
    "category": "",
    "default": "nproc.",
    "definition": "Number of Processors at the FFT level ",
    "section": "varpar",
    "text": "<p>\nRelevant only for the band/FFT/k-point parallelisation\n(see the <a href=\"varpar.html#paral_kgb\">paral_kgb</a> input variable).\n<br> <b>npfft</b> gives the number of processors among\nwhich the work load over the FFT level is shared.\n<b>npfft</b>, <a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npband\">npband</a> and <a href=\"varpar.html#npspinor\">npspinor</a>\nare combined to give the total number\nof processors (nproc) working on the band/FFT/k-point parallelisation.<br>\nSee <a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npspinor\">npspinor</a>, and\n<a href=\"varpar.html#paral_kgb\">paral_kgb</a> for the additional information on the use of\nband/FFT/k-point parallelisation.\n<p>\n\nNote : <a href=\"vargs.html#ngfft\">ngfft</a> is automatically adjusted to <b>npfft</b>.\nIf the number of processor is changed from a calculation to another one,\n<b>npfft</b> may change, and then <a href=\"vargs.html#ngfft\">ngfft</a> also.\n\n",
    "vartype": "integer "
  },
  "npimage": {
    "category": "",
    "default": "min(nproc,<a href=\"varint.html#ndynimage\">ndynimage</a>) (see below).",
    "definition": "Number of Processors at the IMAGE level ",
    "section": "varpar",
    "text": "<p>\nRelevant only\nwhen sets of images are activated (see <a href=\"varrlx.html#imgmov\">imgmov</a>\nand <a href=\"varrlx.html#nimage\">nimage</a>.\n<br> <b>npimage</b> gives the number of processors among\nwhich the work load over the image level is shared. It is compatible with all other parallelization\nlevels available for ground-state calculations.<br>\nNote on the <b>npimage</b> default value: this default value is crude.\nIt is set to the number of dynamic images (<a href=\"varint.html#ndynimage\">ndynimage</a>)\nif the number of available processors allows this choice.\nIf <a href=\"varrlx.html#ntimimage\">ntimimage</a>=1, <b>npimage</b> is set to\nmin(nproc,<a href=\"varrlx.html#nimage\">nimage</a>).<br>\n\n<br><br>\n\n<i>See <a href=\"varpar.html#paral_kgb\">paral_kgb</a>,\n<a href=\"varpar.html#npkpt\">npkpt</a>,\n<a href=\"varpar.html#npband\">npband</a>,\n<a href=\"varpar.html#npfft\">npfft</a>\nand <a href=\"varpar.html#npspinor\">npspinor</a>\nfor the additional information on the use of k-point/band/FFT parallelisation.</i>\n<p>\n",
    "vartype": "integer "
  },
  "npkpt": {
    "category": "",
    "default": "1.",
    "definition": "Number of Processors at the K-Point Level ",
    "section": "varpar",
    "text": "<p>\nRelevant only for the band/FFT/k-point parallelisation\n(see the <a href=\"varpar.html#paral_kgb\">paral_kgb</a> input variable).\n<br> <b>npkpt</b> gives the number of processors among\nwhich the work load over the k-point/spin-component level is shared.\n<b>npkpt</b>, <a href=\"varpar.html#npfft\">npfft</a>, <a href=\"varpar.html#npband\">npband</a> and\n<a href=\"varpar.html#npspinor\">npspinor</a> are combined to give the total number\nof processors (nproc) working on the band/FFT/k-point parallelisation.<br>\nSee <a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npspinor\">npspinor</a> and\n<a href=\"varpar.html#paral_kgb\">paral_kgb</a> for the additional information on the use of\nband/FFT/k-point parallelisation.\n<p>\n\nNote : <b>npkpt</b> should be a divisor or equal to with the number of k-point/spin-components\n(<a href=\"varbas.html#nkpt\">nkpt</a>*<a href=\"varbas.html#nsppol\">nsppol</a>)\nin order to have the better load-balancing and efficiency.\n<br>\n",
    "vartype": "integer "
  },
  "nppert": {
    "category": "can even be specified separately for each dataset, parameter paral_rf is necessary ",
    "default": "1.",
    "definition": "Number of Processors at the PERTurbation level  ",
    "section": "varpar",
    "text": "<p>\nThis parameter is used in connection to the parallelization over perturbations(see <a href=\"varpar.html#paral_rf\">paral_rf</a> ), for a linear response calculation.\n<b>nppert</b> gives the number of processors among which the work load over the perturbation level is shared.\n<br>\n",
    "vartype": "integer "
  },
  "npsp": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "<a href=\"varbas.html#ntypat\">ntypat</a>",
    "definition": "Number of PSeudoPotentials ",
    "section": "vargs",
    "text": "<p>\nUsually, the number of pseudopotentials to be read is equal\nto the number of type of atoms. However,\nin the case an alchemical mixing of pseudopotential is to be used,\noften the number of pseudopotentials to be read will not equal the number of types of atoms.\n<p> Alchemical pseudopotentials will be present\nwhen <a href=\"vargs.html#ntypalch\">ntypalch</a> is non-zero.\nSee <a href=\"vargs.html#ntypalch\">ntypalch</a>\nto understand how\nto use alchemical potentials in ABINIT.\nThe input variables\n(<a href=\"vargs.html#ntypalch\">ntypalch</a>,\n<a href=\"vargs.html#algalch\">algalch</a>,<a href=\"vargs.html#mixalch\">mixalch</a>)\nare active, and generate alchemical potentials from the available\npseudopotentials. Also, the inner variables\n(<a href=\"vargs.html#ntyppure\">ntyppure</a>,<a href=\"vargs.html#npspalch\">npspalch</a>)\nbecome active. See these input variables, especially\n<a href=\"vargs.html#mixalch\">mixalch</a>, to understand how\nto use alchemical potentials in ABINIT.\n",
    "vartype": "integer parameter "
  },
  "npspalch": {
    "category": "Inner ",
    "default": "",
    "definition": "Number of PSeudoPotentials that are \"ALCHemical\" ",
    "section": "vargs",
    "text": "<p>\nGives the number of pseudopotentials that are used for alchemical mixing (when <a href=\"vargs.html#ntypalch\">ntypalch</a> is non-zero) :\n<p> <b>npspalch</b>=<a href=\"vargs.html#npsp\">npsp</a>-<a href=\"vargs.html#ntyppure\">ntyppure</a>\n",
    "vartype": "integer parameter, non-negative "
  },
  "npspinor": {
    "category": "",
    "default": "1.",
    "definition": "Number of Processors at the SPINOR level ",
    "section": "varpar",
    "text": "<p>\nCan be 1 or 2 (if <a href=\"vargs.html#nspinor\">nspinor</a>=2).<br>\nRelevant only for the band/FFT/k-point parallelisation\n(see the <a href=\"varpar.html#paral_kgb\">paral_kgb</a> input variable).\n<br> <b>npspinor</b> gives the number of processors among\nwhich the work load over the spinorial components of wave-functions is shared.\n<b>npspinor</b>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npband\">npband</a> and <a href=\"varpar.html#npkpt\">npkpt</a>\nare combined to give the total number of processors (nproc)\nworking on the band/FFT/k-point parallelisation.<br>\nSee <a href=\"varpar.html#npkpt\">npkpt</a>, <a href=\"varpar.html#npband\">npband</a>,\n<a href=\"varpar.html#npfft\">npfft</a>, and\n<a href=\"varpar.html#paral_kgb\">paral_kgb</a> for the additional information on the use of\nband/FFT/k-point parallelisation.\n<br>\n",
    "vartype": "integer "
  },
  "npulayit": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "7.",
    "definition": "Number of PULAY ITerations for SC mixing ",
    "section": "vardev",
    "text": "<p>\nNeeded only when\n<a href=\"varbas.html#iscf\">iscf</a>=7 or 17.\n<br><font id=\"text\">\n<p>\nGives the  number of previous iterations involved in Pulay mixing (mixing\nduring electronic SC iterations).\n",
    "vartype": "integer parameter "
  },
  "npweps": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of PlaneWaves for EPSilon (the dielectric matrix) ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>npweps</b> determines the size of the planewave set used to represent the independent-particle\nsusceptibility $\\chi^{(0)}_{KS}$, the dielectric matrix $\\epsilon$ and its inverse.\n<br>See <a href=\"vargw.html#ecuteps\">ecuteps</a> (preferred over <b>npweps</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "npwkss": {
    "category": "",
    "default": "0",
    "definition": "Number of PlaneWaves in the KSS file ",
    "section": "vargw",
    "text": "<p>\nThis input variable is used for the preparation of a GW calculation:\nthe GS run (where <a href=\"vargs.html#optdriver\">optdriver</a>=1 and <b>nbandkss</b>/=0) should be followed\nwith a run where <a href=\"vargs.html#optdriver\">optdriver</a>=3.\nAlso, if <a href=\"vargw.html#nbandkss\">nbandkss</a>=0, no use of <b>npwkss</b>.\n<p>\n<b>npwkss</b> defines the number of planewave components of the Kohn-Sham states\nto build the Hamiltonian, in the routine outkss.F90, and so, the size of the matrix, the size of eigenvectors,\nand the number of available states, to be stored in the abo_KSS file.\nIf it is set to 0, then, the planewave basis set defined by the usual Ground State input variable\n<a href=\"varbas.html#ecut\">ecut</a> is used to generate the superset of all planewaves used for all k-points.\nNote that this (large) planewave basis is the same for all k-points.\n<p>\nVery important : for the time being, <a href=\"vardev.html#istwfk\">istwfk</a> must be 1 for all the k-points.\n",
    "vartype": "integer parameter  "
  },
  "npwsigx": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of PlaneWaves for SIGma eXchange ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>npwsigx</b> determines the cut-off energy of the planewave set used to generate the\nexchange part of the self-energy operator.\n<br>See <a href=\"vargw.html#ecutsigx\">ecutsigx</a> (preferred over <b>npwsigx</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "npwwfn": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of PlaneWaves for WaveFunctioNs ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screeening or sigma calculations.\n<p>\n<b>npwwfn</b> determines the size of the planewave set used to represent the wavefunctions\nin the formula that generates the independent-particle susceptibility $\\chi^{(0)}_{KS}$.\n<br>\nSee <a href=\"vargw.html#ecutwfn\">ecutwfn</a> (preferred over <b>nshwfn</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "nqpt": {
    "category": " ",
    "default": "0.",
    "definition": "Number of Q - POINTs ",
    "section": "vargs",
    "text": "<p>\nDetermines whether one q point\nmust be read (See the variable <a href=\"varint.html#qptn\">qptn</a>).\n<br>Can be either 0 or 1.\n<br>If 1 and used in ground-state calculation,\na global shift of all the k-points is applied, to give\ncalculation at k+q.\nIn this case, the output wavefunction will be appended\nby _WFQ instead of _WFK (see the <a href=\"../users/abinit_help.html\">section 4</a> of abinit_help)\nAlso, if 1 and a RF calculation is done, defines the\nwavevector of the perturbation.",
    "vartype": "integer parameter "
  },
  "nqptdm": {
    "category": " ",
    "default": "0",
    "definition": "Number of Q-PoinTs for the Dielectric Matrix",
    "section": "vargw",
    "text": "<p>\nUsed only in the screening part, that is for <a href=\"vargs.html#optdriver\">optdriver</a>=3.\n<p>\nIf <b>nqptdm</b> is equal to 0, the set of q-points for computing the dielectric matrix is\ndetermined automatically considering all the possible differences between the k-points contained\nin the _KSS file. When <b>nqptdm</b> is non-zero, the list of q points is read from <a href=\"vargw.html#qptdm\">qptdm</a>.\nThis allows one to split the big calculation of all the dielectric matrices into smaller\ncalculations that can be performed independently. The _SCR files generated in different runs\ncan be merged thanks to the <B>Mrgscr</B> utility.\n",
    "vartype": "integer parameter"
  },
  "nscforder": {
    "category": " ",
    "default": "16",
    "definition": "SCaling Function ORDER",
    "section": "vardev",
    "text": "<p>\nThis variable controls the order of used scaling functions when the Hartree potential is computed using the Poisson solver (see <a href=\"vargs.html#icoulomb\">icoulomb</a> imput variable). This variable is of seldom use since the default value is large enough. Nonetheless, possible values are 8, 14, 16, 20, 24, 30, 40, 50, 60, 100. Values greater than 20 are included in ABINIT for test purposes only.\n",
    "vartype": ""
  },
  "nsheps": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of SHells for EPSilon (the dielectric matrix) ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\n<b>nsheps</b> determines the size of the planewave set used to represent the independent-particle\nsusceptibility $\\chi^{(0)}_{KS}$, the dielectric matrix $\\epsilon$ and its inverse.\n<br>\nSee <a href=\"vargw.html#ecuteps\">ecuteps</a> (preferred over <b>nsheps</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "nshiftk": {
    "category": " ",
    "default": "1.",
    "definition": "Number of SHIFTs for K point grids ",
    "section": "varbas",
    "text": "<p>\nThis parameter\ngives the number of shifted grids\nto be used concurrently to generate the full grid of k points.\nIt can be used with primitive grids defined either from\n<a href=\"varbas.html#ngkpt\">ngkpt</a>\nor\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>.\nThe maximum allowed value of <b>nshiftk</b> is 8.\nThe values of the shifts are given by <a href=\"varbas.html#shiftk\">shiftk</a>.\n",
    "vartype": "integer parameter "
  },
  "nshiftq": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "1.",
    "definition": "Number of SHIFTs for Q point grids ",
    "section": "vargs",
    "text": "<p>\nThis parameter\ngives the number of shifted grids\nto be used concurrently to generate the full grid of q points.\nIt can be used with primitive grids defined either from\n<a href=\"vargs.html#ngqpt\">ngqpt</a>\nor\n<a href=\"vargs.html#qptrlatt\">qptrlatt</a>.\nThe maximum allowed value of <b>nshiftq</b> is 8.\nThe values of the shifts are given by <a href=\"vargs.html#shiftq\">shiftq</a>.\n",
    "vartype": "integer parameter "
  },
  "nshsigx": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of SHells for SIGma eXchange ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\n<b>nshsigx</b> determines the cut-off energy of the planewave set used to generate the\nexchange part of the self-energy operator.\n<br>\nSee <a href=\"vargw.html#ecutsigx\">ecutsigx</a> (preferred over <b>nshsigx</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "nshwfn": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0 ",
    "definition": "Number of SHells for WaveFunctioNs ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations.\n<p>\n<b>nshwfn</b> determines the number of shells of the planewave set used to represent the wavefunctions\nin the formula that generates the independent-particle susceptibility $\\chi^{(0)}_{KS}$.\n<br>\nSee <a href=\"vargw.html#ecutwfn\">ecutwfn</a> (preferred over <b>nshwfn</b>) for more information.\n",
    "vartype": "integer parameter"
  },
  "nspden": {
    "category": "",
    "default": "the value of <a href=\"varbas.html#nsppol\">nsppol</a>.",
    "definition": "Number of SPin-DENsity components ",
    "section": "vargs",
    "text": "<p>\nIf <b>nspden</b>=1, no spin-magnetisation : the density matrix is\ndiagonal, with same values spin-up and spin-down\n(compatible with <a href=\"varbas.html#nsppol\">nsppol</a>=1 only,\nfor both <a href=\"vargs.html#nspinor\">nspinor</a>=1 or 2)\n<p>\nIf <b>nspden</b>=2, scalar magnetization (the axis is arbitrarily\nfixed in the z direction) : the density matrix is\ndiagonal, with different values for spin-up and spin-down\n(compatible with <a href=\"vargs.html#nspinor\">nspinor</a>=1,\neither with <a href=\"varbas.html#nsppol\">nsppol</a>=2 -general\ncollinear magnetisation- or\n<a href=\"varbas.html#nsppol\">nsppol</a>=1 -antiferromagnetism)\n<p>\nIf <b>nspden</b>=4, vector magnetization : the density matrix is full,\nwith allowed x, y and z magnetisation\n(useful only with <a href=\"vargs.html#nspinor\">nspinor</a>=2 and\n<a href=\"varbas.html#nsppol\">nsppol</a>=1, either\nbecause there is spin-orbit without time-reversal\nsymmetry - and thus spontaneous magnetization, or\nwith spin-orbit, if one allows for spontaneous\nnon-collinear magnetism). Not yet available for response functions. Also note\nthat, with <b>nspden</b>=4, time-reversal symmetry is not taken into account\n(at present ; this has to be checked) and thus <a href=\"varbas.html#kptopt\">kptopt</a>\nhas to be different from 1 or 2.\n\n<p>\nThe default (<b>nspden</b>=<a href=\"varbas.html#nsppol\">nsppol</a>)\ndoes not suit the case of vector magnetization.\n",
    "vartype": "integer parameter "
  },
  "nspinor": {
    "category": "",
    "default": "1 (2 if <a href=\"varpaw.html#pawspnorb\">pawspnorb</a>=1).",
    "definition": "Number of SPINORial components of the wavefunctions ",
    "section": "vargs",
    "text": "<p>\nIf <b>nspinor</b>=1, usual case : scalar wavefunction\n(compatible with (<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=1) as well\nas (<a href=\"varbas.html#nsppol\">nsppol</a>=2, <a href=\"vargs.html#nspden\">nspden</a>=2) )\n<p>\nIf <b>nspinor</b>=2, the wavefunction is a spinor\n(compatible with <a href=\"varbas.html#nsppol\">nsppol</a>=1, with\n<a href=\"vargs.html#nspden\">nspden</a>=1 or 4,\nbut not with <a href=\"varbas.html#nsppol\">nsppol</a>=2)\n<p>When <b>nspinor</b> is 2, the values of <a href=\"vardev.html#istwfk\">istwfk</a>\nare automatically set to 1. Also, the number of bands, for each k-point,\nshould be even.\n",
    "vartype": "integer parameter "
  },
  "nsppol": {
    "category": " ",
    "default": "1.",
    "definition": "Number of SPin POLarization ",
    "section": "varbas",
    "text": "<p>\nGive the number of INDEPENDENT\nspin polarisations. Can take the values\n1 or 2.\n<p>If <b>nsppol</b>=1, one has an unpolarized calculation\n(<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=1) or\nan antiferromagnetic system\n(<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2), or\na calculation in which spin up and spin down cannot be disantengled\n(<a href=\"vargs.html#nspinor\">nspinor</a>=2), that is, either\nnon-collinear magnetism or presence of spin-orbit coupling,\nfor which one needs spinor wavefunctions.\n<p>If <b>nsppol</b>=2, one has a spin-polarized (collinear) calculation\nwith separate and different wavefunctions for up and\ndown spin electrons for each band and k point.\nCompatible only with <a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2.\n<p>In the present status of development,\nwith <b>nsppol</b>=1,\nall values of <a href=\"varbas.html#ixc\">ixc</a> are allowed, while\nwith <b>nsppol</b>=2,\nsome values of <a href=\"varbas.html#ixc\">ixc</a> might not be allowed (e.g. 2, 3, 4, 5, 6, 20, 21, 22 are not allowed).\n<p>See also the input variable <a href=\"vargs.html#nspden\">nspden</a>\nfor the components of the density matrix with respect to\nthe spin-polarization.\n",
    "vartype": "integer parameter "
  },
  "nstep": {
    "category": " ",
    "default": "30. (was 1 before v5.3)",
    "definition": "Number of (non-)self-consistent field STEPS ",
    "section": "varbas",
    "text": "<p>\nGives the maximum number of cycles (or \"iterations\") in a SCF or non-SCF run.\n<br>Full convergence from random numbers if usually achieved in\n12-20 SCF iterations. Each can take from minutes to hours.\nIn certain difficult cases, usually related to a small or\nzero bandgap or magnetism, convergence performance may be much worse.\nWhen the convergence tolerance <a href=\"varbas.html#tolwfr\">tolwfr</a> on the wavefunctions\nis satisfied, iterations will stop, so for well converged\ncalculations you should set <b>nstep</b> to a value larger than\nyou think will be needed for full convergence, e.g.\nif 20 steps usually converges the system, set <b>nstep</b> to 30.\n<br>\nFor non-self-consistent runs (<a name=\"iscf\">iscf</a> &lt; 0) nstep governs\nthe number of cycles of convergence for the wavefunctions for a fixed density\nand Hamiltonian.\n<p>NOTE that a choice of <b>nstep</b>=0 is permitted; this will\neither read wavefunctions from disk (with <a href=\"varfil.html#irdwfk\">irdwfk</a>=1\nor  <a href=\"varfil.html#irdwfq\">irdwfq</a>=1,\nor non-zero <a href=\"varfil.html#getwfk\">getwfk</a>\nor <a href=\"varfil.html#getwfq\">getwfq</a> in the case\nof multi-dataset) and\ncompute the density, the total energy and stop, or else\n(with all of the above vanishing) will initialize\nrandomly the wavefunctions and\ncompute the resulting density and total energy.\nThis is provided for testing purposes.\n<br>Also NOTE that <b>nstep</b>=0\nwith <a href=\"varfil.html#irdwfk\">irdwfk</a>=1 will exactly give the same result as\nthe previous run only if the latter is done with <a href=\"varbas.html#iscf\">iscf</a><10\n(potential mixing).\n<br>One can output the density by using <a href=\"varfil.html#prtden\">prtden</a>.\n<br>The forces and stress tensor are computed with <b>nstep</b>=0.",
    "vartype": "integer parameter "
  },
  "nsym": {
    "category": "<a href=\"../users/abinit_help.html#symmetry_finder\">SYMMETRY FINDER</a> ",
    "default": "0.",
    "definition": "Number of SYMmetry operations ",
    "section": "varbas",
    "text": "<p>\nGives number of space group symmetries\nto be applied in this problem.  Symmetries will be input in\narray \"<a href=\"varbas.html#symrel\">symrel</a>\" and (nonsymmorphic) translations vectors\nwill be input\nin array \"<a href=\"varbas.html#tnons\">tnons</a>\".  If there is no symmetry in the problem\nthen set <b>nsym</b> to 1, because the identity is still a symmetry.\n\n<br>In case of a RF calculation, the code is able to use\nthe symmetries of the system to decrease the number of\nperturbations to be calculated, and to decrease of the\nnumber of special k points to be used for the sampling of\nthe Brillouin zone.\nAfter the response to the perturbations have been calculated,\nthe symmetries are used to generate as many as\npossible elements of the 2DTE from those already\ncomputed.\n\n<p>SYMMETRY FINDER mode (Default mode).\nIf <b>nsym</b> is 0, all the atomic coordinates must be\nexplicitely given (one cannot use the geo builder\nand the symmetrizer): the code will then find automatically\nthe symmetry operations that leave the lattice and each\natomic sublattice invariant. It also checks whether the\ncell is primitive (see <a href=\"vargs.html#chkprim\">chkprim</a>).\n<br>Note that the tolerance on symmetric atomic positions and\nlattice is rather stringent :\nfor a symmetry operation to be admitted,\nthe lattice and atomic positions must map on themselves\nwithin 1.0e-8 .\n\n<p>The user is allowed to set up systems with non-primitive unit cells (i.e.\nconventional FCC or BCC cells, or supercells without any distortion).\nIn this case, pure translations will be identified as symmetries\nof the system by the symmetry finder.\nThen, the combined \"pure translation + usual rotation and inversion\" symmetry\noperations can be very numerous. For example, a conventional FCC cell\nhas 192 symmetry operations, instead of the 48 ones of the primitive cell.\nA maximum limit of 384 symmetry operations is hard-coded. This\ncorresponds to the maximum number of symmetry operations of a 2x2x2\nundistorted supercell. Going beyond\nthat number will make the code stop very rapidly. If you want\nnevertheless, for testing purposes, to treat a larger number of symmetries,\nchange the initialization of \"msym\" in the abinit.F90 main routine,\nthen recompile the code.\n\n<p>For GW calculation, the user might want to select only the symmetry operations whose\nnon-symmorphic translation vector <a href=\"varbas.html#tnons\">tnons</a>\nis zero. This can be done with the help of the input variable\n<a href=\"vargw.html#symmorphi\">symmorphi</a>\n",
    "vartype": "integer parameter "
  },
  "ntime": {
    "category": "",
    "default": "0.",
    "definition": "Number of TIME steps ",
    "section": "varrlx",
    "text": "<p>\nGives the number of molecular dynamics time steps or\nBroyden\nstructural optimization steps to be done if <a\nhref=\"varrlx.html#ionmov\">ionmov</a>is non-zero.<br>\nNote that at the present\nthe option <a href=\"varrlx.html#ionmov\">ionmov</a>=1 is initialized\nwith four\nRunge-Kutta steps which costs some overhead in the startup.\nBy contrast, the initialisation of\nother <a href=\"varrlx.html#ionmov\">ionmov</a> values is only one\nSCF call. <br>\n<b>ntime</b> is ignored if <a href=\"varrlx.html#ionmov\">ionmov</a>=0.\n",
    "vartype": "integer parameter "
  },
  "ntimimage": {
    "category": "",
    "default": "1.",
    "definition": "Number of TIME steps for IMAGE propagation ",
    "section": "varrlx",
    "text": "<p>\nGives the maximal number of molecular dynamics time steps or\nstructural optimization steps to be done\nfor the set of images, referred to as 'image-timesteps'. At each image-timestep,\nall the images are propagated simulaneously, each according to the algorithm\ndetermined by <a href=\"varrlx.html#imgmov\">imgmov</a> and the usual accompanying\ninput variables, and then the next positions and velocities for each image\nare determined from the set of results obtained for all images.\n",
    "vartype": "integer parameter "
  },
  "ntypalch": {
    "category": "",
    "default": "0",
    "definition": "Number of TYPe of atoms that are \"ALCHemical\" ",
    "section": "vargs",
    "text": "<p>\nUsed for the generation of alchemical pseudopotentials :\nwhen <b>ntypalch</b> is non-zero, alchemical mixing\nwill be used.\n<p> Among the <a href=\"varbas.html#ntypat\">ntypat</a> types of atoms, the\nlast <b>ntypalch</b> will be \"alchemical\" pseudoatoms, while only\nthe first <b>ntyppure</b> will be uniquely associated with a pseudopotential\n(the <b>ntyppure</b> first of these, actually). The\n<a href=\"vargs.html#ntypalch\">ntypalch</a> types of alchemical\npseudoatoms are to be made\nfrom the remaining <a href=\"vargs.html#npspalch\">npspalch</a> pseudopotentials.\n<p> In this case,\nthe input variables\n<a href=\"vargs.html#algalch\">algalch</a>,<a href=\"vargs.html#mixalch\">mixalch</a>\nare active, and generate alchemical potentials from the available\npseudopotentials.  See these input variables, especially\n<a href=\"vargs.html#mixalch\">mixalch</a>, to understand how\nto use alchemical potentials in ABINIT.\n",
    "vartype": "integer parameter "
  },
  "ntypat": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "1.",
    "definition": "Number of TYPEs of atoms ",
    "section": "varrlx",
    "text": "<p>\nGives the number of types of atoms. E.g. for\na homopolar system (e.g. pure Si) <b>ntypat</b> is 1.\n<br>\nThe code tries to read the same number pseudopotential files.\n<br>\nThe first pseudopotential is assigned type number 1, and so\non ...\n",
    "vartype": "integer parameter "
  },
  "ntyppure": {
    "category": "Inner ",
    "default": "",
    "definition": "Number of TYPe of atoms that are \"PURe\" ",
    "section": "vargs",
    "text": "<p>\nGives the number of type of atoms that are \"pure\" when alchemical mixing is used (<a href=\"vargs.html#ntypalch\">ntypalch</a> /= 0) :\n<p> <b>ntyppure</b>=<a href=\"varbas.html#ntypat\">ntypat</a>-<a href=\"vargs.html#ntypalch\">ntypalch</a>\n",
    "vartype": "integer parameter, non-negative "
  },
  "nwfshist": {
    "category": "",
    "default": "0",
    "definition": "Number of WaveFunctionS HISTory ",
    "section": "vargs",
    "text": "<p>\nIn the wavelet basis set, the ground state is found by direct\nminimisation. The algorithm used can be either the steepest\ndescent or the DIIS (Direct Inversion of Iteration\nSpace). When <b>nwfshist</b> = 0, the steepest descent is used\n(<i>i.e.</i> there is no history storage of the previous\niterations). If <b>nwfshist</b> is strictly positive, a DIIS\nis used. A typical value is 6. Using a DIIS increases the\nmemory required by the program since N previous wavefunctions\nare stored during the electronic minimisation.</p>\n",
    "vartype": "integer parameter, non-negative "
  },
  "objaat": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "",
    "definition": "OBJect A : list of AToms, OBJect B : list of AToms ",
    "section": "vargeo",
    "text": "<p>\nGives the list of atoms in either\nobject a or object b. This list is specified\nby giving, for each atom, its index in the list\nof coordinates (<a href=\"varbas.html#xred\">xred</a>, <a href=\"varbas.html#xangst\">xangst</a>\nor <a href=\"varbas.html#xcart\">xcart</a>), that also\ncorresponds to a type of atom (given by the array type).\nThese objects can be thought as molecules, or groups\nof atoms, or parts of molecules, to be repeated,\nrotated and translated to generate the full set\nof atoms. <br>Look at <a href=\"vargeo.html#objarf\">objarf</a> and <a href=\"vargeo.html#objarf\">objbrf</a>\nfor further explanations.\n<b>objaat</b> MUST be provided if <a href=\"vargeo.html#nobj\">nobj</a>==1.\n<b>objaat</b> and <b>objbat</b> MUST be provided if <a href=\"vargeo.html#nobj\">nobj</a>==2.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "integer arrays objaat(<a href=\"vargeo.html#objan\">objan</a>) and objbat(<a href=\"vargeo.html#objan\">objbn</a>) "
  },
  "objaax": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>, <a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "",
    "definition": "OBJect A : AXis, OBJect B : AXis",
    "section": "vargeo",
    "text": "<p>\nGives, for each object, the cartesian coordinates of\ntwo points (first point :  <b>objaax</b>(1:3) or <b>objbax</b>(1:3),\nsecond point : <b>objaax</b>(4:6) or <b>objbax</b>(4:6) ).\n<br>By default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since these variables have the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\n<br>\nThe two points define an axis of rotation\nof the corresponding object. <br>Note that the rotation of\nthe object is done BEFORE the object is translated.\n<br>The sign of the rotation angle is positive if the\nobject is to be rotated clockwise when looking to it\nalong the axis, from point 1 (coordinates 1:3)\ntoward point 2 (coordinates 4:6).\n<br><a href=\"vargeo.html#objaat\">objaat</a> MUST be provided if <a href=\"vargeo.html#nobj\">\nnobj</a>==1 and one component\nof <a href=\"vargeo.html#objaro\">objaro</a> does not vanish.\n<br><a href=\"vargeo.html#objaat\">objaat</a> and <a href=\"vargeo.html#objaat\">objbat</a>\nMUST be provided if <a href=\"vargeo.html#nobj\">nobj</a>==2 and one\ncomponent of <a href=\"vargeo.html#objaro\">objbro</a> does not vanish.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "real arrays objaax(6) and objbax(6) "
  },
  "objan": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>",
    "default": "",
    "definition": "OBJect A : Number of atoms, OBJect B : Number of atoms ",
    "section": "vargeo",
    "text": "<p>\nGives the number of atoms in either\nobject a or object b. The list of atoms is given by the\nvariables <a href=\"vargeo.html#objaat\">objaat</a> and <a href=\"vargeo.html#objaat\">objbat</a>.\n<br><b>objan</b> MUST be provided if <a href=\"vargeo.html#nobj\">nobj</a>==1.\n<br><b>objan</b> and <b>objbn</b> MUST be provided if <a href=\"vargeo.html#nobj\">nobj</a>==2.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "integer parameters "
  },
  "objarf": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>",
    "default": "1 1 1 .",
    "definition": "OBJect A : Repetition Factors, OBJect B : Repetition Factors ",
    "section": "vargeo",
    "text": "<p>\nGives three repetition factors of the objects a or b.\n<br>This gives the opportunity to generate a three-dimensional\nset of repeated objects, although a simple one-dimensional\nrepetition will be easily obtained through the specification of<br>\nnrep 1 1  &lt;r&gt;\nwhere nrep is the 1D repetition factor.\n<br>The initial rotation and translation of the object,\nas well as the increment of rotation or translation\nfrom one object to the next are specified by\nthe variables <a href=\"vargeo.html#objaro\">objaro</a> and <a href=\"vargeo.html#objatr\">objatr</a>, for object a,\nand <a href=\"vargeo.html#objaro\">objbro</a> and <a href=\"vargeo.html#objatr\">objbtr</a>, for object b.\n<br>Note that the geo builder will generate the full set\nof atoms from the primitive set of atoms using the\nfollowing order : it will process each atom in the\nprimitive list one by one, determine whether it belongs\nto either object a or object b, and then repeat it\ntaking into account the proper rotation and translation,\nwith the fastest varying repetition factor being the first,\nthen the second, then the third.\n<br>In the final list of atoms, one will first\nfind the atoms generated from atom 1 in the primitive list,\nthen those generated from atom 2 in the primitive list, and\nso on.\n<br>If the geo builder is only used to rotate\nor translate an object, without repeating it,\nsimply use 1 1 1, which is also the Default value.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "integer arrays objarf(3) and objbrf(3) "
  },
  "objaro": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>",
    "default": "4*0.0d0 (no rotation).",
    "definition": "OBJect A : ROtations, OBJect B : ROtations ",
    "section": "vargeo",
    "text": "<p>\nGive, for each object, the angles of rotation in degrees\nto be applied to the corresponding object.\n<br>The rotation is applied before the translation,\nand the axis is defined by the variables <a href=\"vargeo.html#objaax\">objaax</a> and\n<a href=\"vargeo.html#objaax\">objbax</a>.\nSee the latter variables for the definition of the sign\nof the rotation.\n<br>The first component <b>objaro</b>(1) and <b>objbro</b>(1) gives\nthe angle of rotation to be applied to the first\ninstance of the object. The second, third or fourth\ncomponent (resp.) gives the increment of rotation angle\nfrom one instance to the next instance, defined\nby the first, second or third repetition factor (resp.) .\nThis allows to generate 3D arrays of molecules with\ndifferent rotation angles.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "real arrays objaro(4) and objbro(4) "
  },
  "objatr": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>, <a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "12*0.0d0 (no translation).",
    "definition": "OBJect A : TRanslations, OBJect B : TRanslations ",
    "section": "vargeo",
    "text": "<p>\nGive, for each object, the vectors of translations,\nin cartesian coordinates,\nto be applied to the corresponding object.\nBy default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since these variables have the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\n<br>The translation is applied after the rotation.\n<br>The first vector <b>objatr</b>(3,1) and <a href=\"vargeo.html#objaro\">objbro</a>(3,1) gives\nthe translation to be applied to the first\ninstance of the object. The second, third or fourth\ncomponent (resp.) gives the increment of translation\nfrom one instance to the next instance, defined\nby the first, second or third repetition factor (resp.) .\nThis allows to generate 3D arrays of molecules.\n<br>In general, when the objects are repeated, a translation\nvector must be given, since otherwise, the repeated objects\npack in the same region of space. As an exception, one can\nhave a set of molecules regularly spaced on a circle, in\nwhich case, only rotations are needed.\n<br>Not present in the dtset array (no internal).\n",
    "vartype": "real arrays objatr(3,4) and objbtr(3,4)"
  },
  "occ": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a> ",
    "default": "0's.",
    "definition": "OCCupation numbers ",
    "section": "vargs",
    "text": "<p>\nGives occupation numbers for all\nbands in the problem. Needed if <a href=\"varbas.html#occopt\">occopt</a>==0 or\n<a href=\"varbas.html#occopt\">occopt</a>==2.\nIgnored otherwise. Also ignored when <a href=\"varbas.html#iscf\">iscf</a>=-2.\n<br>Typical band occupancy is either\n2 or 0, but can be 1 for half-occupied band or other\nchoices in special circumstances.  <br>If <a href=\"varbas.html#occopt\">occopt</a> is not 2,\nthen the occupancies must be the same for each k point.\n<br>If <a href=\"varbas.html#occopt\">occopt</a>=2, then the band occupancies must be\nprovided explicitly for each band, EACH k POINT,\nand EACH SPIN-POLARIZATION, in an\narray which runs over all bands, k points,\nand spin-polarizations.\n<br>The order of entries in the array would correspond to\nall bands at the first k point (spin up), then all bands at the\nsecond k point (spin up), etc, then all k-points spin down.\n<br>The total number of array elements\nwhich must be provided is <br>\n( <a href=\"varbas.html#nband\">nband</a>(1)+<a href=\"varbas.html#nband\">nband</a>(2)+...+\n<a href=\"varbas.html#nband\">nband</a>(<a href=\"varbas.html#nkpt\">nkpt</a>) ) *\n<a href=\"varbas.html#nsppol\">nsppol</a> .\n<br>The occupation numbers evolve only for metallic occupations,\nthat is, <a href=\"varbas.html#occopt\">occopt</a> &ge; 3 .",
    "vartype": "real array occ(<a href=\"varbas.html#nband\">nband</a>)  "
  },
  "occopt": {
    "category": " ",
    "default": "<b>occopt</b>=1",
    "definition": "OCCupation OPTion ",
    "section": "varbas",
    "text": "<p>\nControls how input\nparameters <a href=\"varbas.html#nband\">nband</a>, <a href=\"vargs.html#occ\">occ</a>,\nand <a href=\"varbas.html#wtk\">wtk</a> are handled.\n<ul>\n<li>              <b>occopt</b>=0:\n<br>All k points have the same number of bands\nand the same occupancies of bands.  <a href=\"varbas.html#nband\">nband</a> is given as a\nsingle number, and <a href=\"vargs.html#occ\">occ</a>(<a href=\"varbas.html#nband\">nband</a>)\nis an array of <a href=\"varbas.html#nband\">nband</a>\nelements, read in by the code.  <br>\nThe k point weights in array <a href=\"varbas.html#wtk\">wtk</a>(<a href=\"varbas.html#nkpt\">nkpt</a>) are\nautomatically normalized by the code to add to 1.</li>\n<li>              <b>occopt</b>=1:\n<br>Same as <b>occopt</b>=0, except that the array <a href=\"vargs.html#occ\">occ</a> is\nautomatically generated by the code, to give a semiconductor.\n<br>An error occurs when filling cannot be done with\noccupation numbers equal to 2 or 0 in each k-point (non-spin-polarized case),\nor with occupation numbers equal to 1 or 0 in each k-point (spin-polarized case).</li>\n<li>             <b>occopt</b>=2:\n<br>k points may optionally have different numbers of\nbands and different occupancies.  <a href=\"varbas.html#nband\">nband</a>(<a href=\"varbas.html#nkpt\">\nnkpt</a>*<a href=\"varbas.html#nsppol\">nsppol</a>) is given\nexplicitly as an array of <a href=\"varbas.html#nkpt\">nkpt</a>*<a href=\"varbas.html#nsppol\">nsppol</a> elements.\n<a href=\"vargs.html#occ\">occ</a>() is given explicitly for all bands at each k point,\nand eventually for each spin --\nthe total number of elements is the sum of <a href=\"varbas.html#nband\">nband</a>(ikpt)\nover all k points and spins. The k point weights <a href=\"varbas.html#wtk\">wtk</a>\n(<a href=\"varbas.html#nkpt\">nkpt</a>) are\nNOT automatically normalized under this option.</li>\n<li>             <b>occopt</b>=3, 4, 5, 6 and 7\n<br>Metallic occupation of levels, using different occupation\nschemes (see below). The corresponding thermal\nbroadening, or cold smearing, is defined by\nthe input variable <a href=\"vargs.html#tsmear\">tsmear</a> (see below : the variable\nxx is the energy in Ha, divided by <a href=\"vargs.html#tsmear\">tsmear</a>)\n<br>Like for <b>occopt</b>=1, the variable <a href=\"vargs.html#occ\">occ</a> is not read\n<br>All k points have the same number of bands,\n<a href=\"varbas.html#nband\">nband</a> is given as a single number, read by the code.\n<br>The k point weights in array <a href=\"varbas.html#wtk\">wtk</a>(<a href=\"varbas.html#nkpt\">nkpt</a>) are\nautomatically normalized by the code to add to 1.</li>\n<ul>\n<li> <b>occopt</b>=3:\n<br>Fermi-Dirac smearing (finite-temperature metal)\nSmeared delta function : 0.25d0/(cosh(xx/2.0d0)**2)</li>\n<li> <b>occopt</b>=4:\n<br>\"Cold smearing\" of N. Marzari (see his thesis work),\nwith a=-.5634 (minimization of the bump)\n<br>Smeared delta function :\n<br>  exp(-xx<sup>2</sup>)/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx)))</li>\n<li> <b>occopt</b>=5:\n<br>\"Cold smearing\" of N. Marzari (see his thesis work),\nwith a=-.8165 (monotonic function in the tail)\n<br>Same smeared delta function as <b>occopt</b>=4, with different a.</li>\n<li> <b>occopt</b>=6:\n<br>Smearing of Methfessel and Paxton (PRB40,3616(1989))\nwith Hermite polynomial of degree 2, corresponding\nto \"Cold smearing\" of N. Marzari with a=0\n(so, same smeared delta function as <b>occopt</b>=4, with different a).</li>\n<li> <b>occopt</b>=7:\n<br>Gaussian smearing, corresponding to the 0 order\nHermite polynomial of Methfessel and Paxton.\n<br>Smeared delta function : 1.0d0*exp(-xx**2)/sqrt(pi)</li>\n<li> <b>occopt</b>=8:\n<br>Uniform smearing (the delta function is replaced by a constant function of value one\nover ]-1/2,1/2[ (with one-half value at the boundaries). Used for testing purposes only.\n</li>\n</ul>\n</ul>\n\nWARNING : one can use metallic occupation of levels in the\ncase of a molecule, in order to avoid any problem with\ndegenerate levels. However, it is advised NOT to use\n<b>occopt</b>=6 (and to a lesser extent <b>occopt</b>=4 and 5),\nsince the associated number of electron\nversus the Fermi energy is NOT guaranteed to be\na monotonic function. For true metals, AND a sufficiently\ndense sampling of the Brillouin zone, this should not happen,\nbut be cautious ! As an indication of this problem,\na small variation of input parameters might lead to\na jump of total energy, because there might be two or even\nthree possible values of the Fermi energy, and the\nbisection algorithm find one or the other. ",
    "vartype": "integer option parameter  "
  },
  "omegasimax": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "50 eV ",
    "definition": "OMEGA to evaluate Sigma along the Imaginary axis D: MAXimal value ",
    "section": "vargw",
    "text": "<p>\nOnly relevant for sigma calculations in which the self-energy along the real axis is obtained\nby performing the analytic continuation from the imaginary axis to the full complex plane via the Pade approximant\n(<a href=\"vargs.html#optdriver\">optdriver</a>=4 and <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=x1).\n<p>\n<b>omegasimax</b> defines the maximum frequency along the imaginary the axis.\nIn conjunction with <a href=\"vargw.html#nomegasi\">nomegasi</a>,\n<b>omegasimax</b> uniquely defines the linear mesh employed to sample the self-energy along the imaginary axis.\n\n",
    "vartype": "real "
  },
  "omegasrdmax": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "1.0 eV ",
    "definition": "OMEGA to evaluate the Sigma Real axis Derivative : MAXimal value ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nThe maximum distance from the KS energy where to evaluate Sigma. Sigma is evaluated at\n[KS_energy - maxomegasrd, KS_energy + maxomegasrd] sampled <a href=\"vargw.html#nomegasrd\">nomegasrd</a> times.\n",
    "vartype": "real "
  },
  "optcell": {
    "category": "",
    "default": "<b>optcell</b>=0",
    "definition": "OPTimize the CELL shape and dimensions",
    "section": "varrlx",
    "text": "<p>\nAllows to optimize the\nunit cell shape and dimensions, when <a href=\"varrlx.html#ionmov\">ionmov</a>=2\nor 3.\nThe configuration for which the stress almost vanishes\nis iteratively determined, by using the same algorithms\nas for the nuclei positions. Will eventually\nmodify <a href=\"varbas.html#acell\">acell</a> and/or <a\nhref=\"varbas.html#rprim\">rprim</a>.\nThe ionic positions are ALWAYS updated, according to the forces.\nA target stress tensor might be defined, see <a\nhref=\"varrlx.html#strtarget\">strtarget</a>\n</font>\n<ul>\n<font id=\"text\">\n<li><b>optcell</b>=0 : modify nuclear positions, since <a\nhref=\"varrlx.html#ionmov\">ionmov</a>=2, but no cell shape and\ndimension optimisation.</li>\n<li><b>optcell</b>=1 : optimisation of volume only (do not modify <a\nhref=\"varbas.html#rprim\">rprim</a>, and allow an homogeneous\ndilatation of the three components of <a href=\"varbas.html#acell\">acell</a>)</li>\n<li><b>optcell</b>=2 : full optimization of cell geo (modify <a\nhref=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#rprim\">rprim</a>\n- normalize the vectors of <a href=\"varbas.html#rprim\">rprim</a> to\ngenerate the <a href=\"varbas.html#acell\">acell</a>). This is the usual\nmode for cell shape and volume optimization. It takes into account the\nsymmetry of the system, so that only the effectively relevant degrees\nof freedom are optimized.</li>\n<li><b>optcell</b>=3 : constant-volume optimization of cell geo\n(modify <a href=\"varbas.html#acell\">acell</a> and <a\nhref=\"varbas.html#rprim\">rprim</a> under constraint - normalize the\nvectors of <a href=\"varbas.html#rprim\">rprim</a> to generate the <a\nhref=\"varbas.html#acell\">\nacell</a>)</li>\n<li><b>optcell</b>=4,5 or 6 : optimize <a href=\"varbas.html#acell\">acell</a>(1),\n<a href=\"varbas.html#acell\">acell</a>(2) or <a\nhref=\"varbas.html#acell\">acell</a>(3), respectively (only works if the\ntwo other vectors are orthogonal to the optimized one, the latter being\nalong its cartesian axis).</li>\n<li><b>optcell</b>=7,8 or 9 : optimize the cell geo while\nkeeping the first, second or third vector unchanged (only works if the\ntwo other vectors are orthogonal to the one left unchanged, the latter\nbeing along its cartesian axis).</li>\n</font>\n</ul>\n<font id=\"text\">NOTE that a few details require attention when\nperforming\nunit cell optimisation :\n</font>\n<ul>\n<font id=\"text\">\n<li> one has to get rid of the discontinuites due to discrete changes\nof plane wave number with cell size, by using a suitable value of <a\nhref=\"varrlx.html#ecutsm\">ecutsm</a>;</li>\n<li> one has to allow for the possibility of a larger sphere of plane\nwaves, by using <a href=\"varrlx.html#dilatmx\">dilatmx</a>;</li>\n<li> one might have to adjust the scale of stresses to the scale of\nforces, by using <a href=\"varrlx.html#strfact\">strfact</a>.</li>\n<li> if all the reduced coordinates of atoms are fixed by symmetry,\none cannot use <a href=\"varbas.html#toldff\">toldff</a> to stop the SCF\ncycle. (Suggestion : use <a href=\"varbas.html#toldfe\">toldfe</a> with\na small value, like 1.0d-10)</li>\n</font>\n</ul>\n<font id=\"text\">It is STRONGLY suggested first to optimize the ionic\npositions\nwithout cell shape and size optimization (<b>optcell</b>=0),\nthen start the cell shape and size optimization\nfrom the cell with relaxed ionic positions.\n</font>\n<p><font id=\"text\">Presently (v3.1), one cannot restart (<a\nhref=\"varrlx.html#restartxf\">restartxf</a>)\na calculation with a non-zero <b>optcell</b> value from the\n(x,f) history of another run with a different non-zero <b>optcell</b>\nvalue. There\nare still a few problems at that level.\n",
    "vartype": "integer parameter "
  },
  "optdriver": {
    "category": " ",
    "default": "<b>optdriver</b>=0 ",
    "definition": "OPTions for the DRIVER ",
    "section": "vargs",
    "text": "<p>\nFor each dataset, choose\nthe task to be done, at the level of the \"driver\" routine.\n<p>The choice is among :\n<br><b>optdriver</b>=0 : ground-state calculation (GS), routine \"gstate\"\n<br><b>optdriver</b>=1 : response-function calculation (RF), routine \"respfn\"\n<br><b>optdriver</b>=2 : susceptibility calculation (SUS), routine \"suscep\"\n<br><b>optdriver</b>=3 : susceptibility and dielectric matrix calculation (SCR), routine \"screening\"\n<br>\n(see the input variables <a href=\"vargw.html#ecutwfn\">ecutwfn</a>,\n<a href=\"vargw.html#ecuteps\">ecuteps</a>,\n<a href=\"vargw.html#ppmfrq\">ppmfrq</a>,\n<a href=\"varfil.html#getkss\">getkss</a>,\nas well as <a href=\"vargw.html#nbandkss\">nbandkss</a> and <a href=\"varbas.html#nband\">nband</a>)\n<br><b>optdriver</b>=4 : self-energy calculation (SIG), routine \"sigma\"\n<br><b>optdriver</b>=5 : non-linear response functions, using the 2n+1 theorem, routine \"nonlinear\"\n<br><b>optdriver</b>=99 : Bethe-Salpeter calculation, routine \"bethe_salpeter\"\n<p>\nIf one of <a href=\"varrf.html#rfphon\">rfphon</a>, <a href=\"varrf.html#rfddk\">rfddk</a>,\n<a href=\"varrf.html#rfelfd\">rfelfd</a>,\nor <a href=\"varrf.html#rfstrs\">rfstrs</a> is non-zero, while <b>optdriver</b>\nis not defined in the input file, ABINIT will set <b>optdriver</b> to 1\nautomatically. These input variables (<a href=\"varrf.html#rfphon\">rfphon</a>,\n<a href=\"varrf.html#rfddk\">rfddk</a>, <a href=\"varrf.html#rfelfd\">rfelfd</a>,\nand <a href=\"varrf.html#rfstrs\">rfstrs</a>) must be\nzero if <b>optdriver</b> is not set to 1.\n",
    "vartype": "integer parameter  "
  },
  "optforces": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "2. However, <b>optforces</b> is automatically set to 1 when <a href=\"varbas.html#toldff\">toldff</a> or <a href=\"varbas.html#tolrff\">tolrff</a> are non-zero.",
    "definition": "OPTions for the calculation of FORCES ",
    "section": "vardev",
    "text": "<p>\nAllows to choose options for the calculation of forces.\n<ul>\n<li><b>optforces</b>=0 : the forces are set to zero, and many steps of the\ncomputation of forces are skipped </li>\n<li><b>optforces</b>=1 : calculation of forces at each SCF iteration, allowing\nto use forces as criterion to stop the SCF cycles\n</li>\n<li><b>optforces</b>=2 : calculation of forces at the end of the SCF iterations\n(like the stresses)\n</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "optfreqsus": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "2",
    "definition": "OPTion for the generation of FREQuency grids for the SUSceptibility",
    "section": "vardev",
    "text": "<p>\nSelects the type of frequency grid that will be used to compute ACFD energies,\nas follows:\n</p>\n<ul>\n<li>0: use preassigned mesh (see defs_suscep module)\n<ul>\n<li>nfreqsus= 2: pick-up 2 highest frequencies of H_2 mesh</li>\n<li>nfreqsus= 8: pick-up 8 frequencies inside Be_2 mesh, depending on freq1</li>\n<li>nfreqsus= 9: pick-up 9 frequencies inside H_2 mesh, depending on freq1</li>\n<li>nfreqsus=11: pick-up 11 highest frequencies of Be_2 mesh</li>\n<li>nfreqsus=16: use full He mesh</li>\n<li>nfreqsus=18: use full H_2 mesh</li>\n<li>nfreqsus=20: use full He mesh good up to 8 Ha</li>\n<li>nfreqsus=24: use full Be_2 mesh</li>\n</ul>\n</li>\n<li>1: create linear mesh and weights for quadrature by Taylor rule\n<ul>\n<li>freqsusin=starting frequency</li>\n<li>freqsuslo=frequency increment</li>\n</ul>\n</li>\n<li>2: create mesh and weights using Gauss-Legendre quadrature\n<p>A first Gauss-Legendre mesh is built for interval [0,freqsuslo], then\na second one is obtained by transforming the first for the\n[freqsuslo,+\\infty[ interval. freqsusin may be use to compress or expand\nthe mesh on the second interval (a value of 1.0 is adequate for\nmost cases). For practical reasons, nfreqsus must be even.\n</p>\n</li>\n</ul>\n\n<p>\nSee also:\n<a href=\"vardev.html#nfreqsus\">nfreqsus</a>,\n<a href=\"vardev.html#freqsuslo\">freqsuslo</a>,\n<a href=\"vardev.html#freqsusin\">freqsusin</a>.\n</p>\n\n",
    "vartype": "integer parameter"
  },
  "optnlxccc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1.",
    "definition": "OPTion for the calculation of Non-Linear eXchange-Correlation Core Correction",
    "section": "vardev",
    "text": "<p>\nAllows to choose options for the calculation of non-linear XC correction.\nAt present, only relevant for the FHI type of pseudopotentials, with pspcod=6 .\n<ul>\n<li><b>optnlxccc</b>=1 : uses the old psp6cc.f routine, with inconsistent treatment of real-space derivatives of the core function (computed in this routine, while splined in the other parts of the code) </li>\n<li><b>optnlxccc</b>=2 : consistent calculation derivatives, in the psp6cc_dhr.f routine from DHamann.</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "optstress": {
    "category": " ",
    "default": "1",
    "definition": "OPTion for the computation of STRess",
    "section": "vargs",
    "text": "<p>\nIf set to 1, the computation of stresses is done,\nin the SCF case\n(under the conditions <a href=\"varbas.html#iscf\">iscf</a> > 0 , <a href=\"varfil.html#prtstm\">prtstm</a>==0 ,\n<a href=\"vargs.html#positron\">positron</a>==0,\nand either  <a href=\"varbas.html#nstep\">nstep</a> >0 , or\n<a href=\"varint.html#usepaw\">usepaw</a>==0 or <a href=\"varfil.html#irdwfk\">irdwfk</a>==1).\n<br>\nOtherwise, to save CPU time, if no optimization of the cell is required,\none can skip the computation of stresses. The CPU time saving might be interesting\nfor some PAW calculations.\n",
    "vartype": "integer "
  },
  "orbmag": {
    "category": "",
    "default": "0 ",
    "definition": "ORBital MAGnetization ",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 1, calculate the orbital magnetization. THIS CODE\nIS UNDER DEVELOPMENT AND IS NOT READY FOR USE.\n</li>\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "ortalg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "2 when <a href=\"vardev.html#wfoptalg\">wfoptalg</a> &lt; 10,<br> -2 when <a href=\"vardev.html#wfoptalg\">wfoptalg</a> >=10.",
    "definition": "ORThogonalisation ALGorithm ",
    "section": "vardev",
    "text": "<p> Allows to choose the algorithm\nfor orthogonalisation.\n<br>Positive or zero values make two projections per\nline minimisation, one before the preconditioning, one\nafter. This is the clean application of the band-by-band\nCG gradient for finding eigenfunctions.\n<br>Negative values make only one projection per line mininisation.\n<br>The orthogonalisation step is twice faster, but the\nconvergence is less good. This actually calls to\na better understanding of this effect.\n<br><b>ortalg</b>=0, 1 or -1 is the conventional coding, actually\nidentical to the one in versions prior to 1.7\n<br><b>ortalg</b>=2 or -2 try to make better use of existing registers\non the particular machine one is running.\n<br>More demanding use of registers\nis provided by <b>ortalg</b>=3 or -3, and so on.\n<br>The maximal value is presently 4 and -4.\n<br>Tests have shown that <b>ortalg</b>=2 or -2 is suitable for\nuse on the available platforms.",
    "vartype": "integer parameter  "
  },
  "papiopt": {
    "category": " ",
    "default": "0 ",
    "definition": "PAPI OPTion",
    "section": "vardev",
    "text": "<p>\n<a href=\"http://icl.cs.utk.edu/papi/index.html\">PAPI</a> aims to\nprovide the tool designer and application engineer with a\nconsistent interface and methodology for use of the\nperformance counter hardware found in most major\nmicroprocessors. PAPI enables software engineers to see, in\nnear real time, the relation between software performance and\nprocessor events.<br />\n\nThis option can be used only when ABINIT has been compiled with the\n<code>--enable-papi</code> configure option.<br />\n\nIf <b>papiopt</b>=1, then PAPI counters are used instead of\nthe usual time() routine. All the timing output of ABINIT is\nthen done with PAPI values. The measurements are more accurate and\ngive also access to the flops of the calculation.\n",
    "vartype": "integer"
  },
  "paral_atom": {
    "category": "",
    "default": "0.",
    "definition": "activate PARALelization over (paw) ATOMic sites",
    "section": "varpar",
    "text": "<p>\nRelevant only for PAW calculations.<br>\nThis keyword controls the parallel distribution of memory over atomic sites. Calculations are\nalso distributed using the \"kpt-band\" communicator.<br>\nWarning: use of <b>paral_atom</b> is highly experimental.<br>\nOnly compatible (for the moment) with ground-state calculations.\n<br>\n",
    "vartype": "integer "
  },
  "paral_kgb": {
    "category": "",
    "default": "0.",
    "definition": "activate PARALelization over K-point, G-vectors and Bands",
    "section": "varpar",
    "text": "<p>\n<b>If paral_kgb is not explicitely put in the input file</b>,\nABINIT automatically detects if the job has been sent in sequential or in parallel. In this last case, it detects the number of processors on which the job has been sent and calculates values of\n<a href=\"varpar.html#npkpt\">npkpt</a>, <a href=\"varpar.html#npfft\">npfft</a>,\n<a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#bandpp\">bandpp</a> ,<a href=\"varpar.html#npimage\">npimage</a> and <a href=\"varpar.html#npspinor\">npspinor</a> that are compatible with the number of processors. It then set\nparal_kgb to 0 or 1 (see hereunder)and launches the job.\n</p>\n<b>If paral_kgb=0</b>,\nthe parallelization over k-points only is activated. In this case,\n<a href=\"varpar.html#npkpt\">npkpt</a>, <a href=\"varpar.html#npfft\">npfft</a> and\n<a href=\"varpar.html#npband\">npband</a> are ignored. Require compilation option --enable-mpi=\"yes\".\n</p>\n\n\n\n\n<p>\n<b>If paral_kgb=1</b>,\nthe parallelization over bands, FFTs, and k-point/spin-components is activated\n(see <a href=\"varpar.html#npkpt\">npkpt</a>, <a href=\"varpar.html#npfft\">npfft</a> and\n<a href=\"varpar.html#npband\">npband</a>). With this parallelization, the work load is split over\nthree levels of parallelization. The different communications almost occur\nalong one dimension only. Require compilation option --enable-mpi=\"yes\".\n</p>\n\n\n\nHOWTO fix the number of processors along one level of parallelisation:\n<br>\nAt first, try to parallelise over the k point and spin\n(see <a href=\"varpar.html#npkpt\">npkpt</a>).\nOtherwise, for unpolarized calculation at the gamma point, parallelise over the\ntwo other levels: the band and FFT ones. For nproc<=50,\nthe best speed-up is achieved for\n<a href=\"varpar.html#npband\">npband</a>=nproc and\n<a href=\"varpar.html#npfft\">npfft</a>=1 (which is not yet the default).\nFor nproc>=50, the best speed-up is achieved for\n<a href=\"varpar.html#npband\">npband</a> >=4*<a href=\"varpar.html#npfft\">npfft</a>.\n\n<p>\nFor additional information,\ndownload F. Bottin's presentation at the <a href=\"http://www.abinit.org/community/events/program3rd\">ABINIT workshop 2007</a>\n<p>\nSuggested acknowledgments :\n<br>\nF. Bottin, S. Leroux, A. Knyazev and G. Zerah,\n<i>Large scale ab initio calculations based on three levels of parallelization</i>,\nComput. Mat. Science <b>42</b>, 329 (2008),\navailable on arXiv, http://arxiv.org/abs/0707.3405 .\n<p>\nIf the total number of processors used is compatible with the three levels of parallelization, the values for <a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#npfft\">npfft</a>, <a href=\"varpar.html#npband\">npband</a> and <a href=\"varpar.html#bandpp\">bandpp</a> will be filled automatically, although the repartition may not be optimal. To optimize the repartition use:\n<p>\n\n<b>If paral_kgb=-n </b>, ABINIT will test automatically if all the processor numbers between 2 and n are convenient for a parallel calculation and print the possible values in the log file. A weight is attributed to each possible processors repartition. It is adviced to select a processor repartition for which the weight is high (as closed to the number of processors as possible). The code will then stop after the printing. This test can be done as well with a sequential as with a parallel version of the code. The user can then choose the adequate number of processor on which he can run his job. He must put again paral_kgb=1 in the input file and put the corresponding values for <a href=\"varpar.html#npband\">npband</a>, <a href=\"varpar.html#npfft\">npfft</a>, <a href=\"varpar.html#npband\">npband</a> and <a href=\"varpar.html#bandpp\">bandpp</a> in the input file.\n\n\n\n\n\n",
    "vartype": "integer "
  },
  "paral_rf": {
    "category": "can even be specified separately for each dataset ",
    "default": "0.",
    "definition": "activate PARALlelization over Response Function perturbations ",
    "section": "varpar",
    "text": "<p>\nThis parameter activates the parallelization over perturbations which can be used during\nRF-Calculation. It is possible to use this type of parallelization in combination to the\nparallelization over k-points.\n</p>\n<p>\nCurrently total energies calculated by groups, where the master process is not in, are saved\nin .status_LOGxxxx files.\n</p>\n\n\n",
    "vartype": "integer "
  },
  "pawcpxocc": {
    "category": "",
    "default": "1, except for Ground-state static calculations (<a href=\"vargs.html#optdriver\">optdriver</a>=0, <a href=\"varrlx.html#ionmov\">ionmov</a><6) with spin-orbit coupling (<a href=\"varpaw.html#pawspnorb\">pawspnorb</a>=1), density mixing (<a href=\"varbas.html#iscf\">iscf</a>>=10) and time-reversal symmetry desactivated for k-points (<a href=\"varbas.html#kptopt\">kptopt</a>/=1 or 2)",
    "definition": "PAW - use ComPleX rhoij OCCupancies ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>\nWhen <b>pawcpxocc=2</b>, PAW augmentation occupancies are treated as COMPLEX; else they are considered are REAL.<br>\nThis is needed when time-reversal symmetry is broken (typically when spin-orbit coupling is activated).<br><br>\n\nNote for ground-state calculations (<a href=\"vargs.html#optdriver\">optdriver</a>=0):<br>\nThe imaginary part of PAW augmentation occupancies is only used for the computation of the total energy by \"direct scheme\";\nthis only necessary when SCF mixing on potential is chosen (<a href=\"varbas.html#iscf\">iscf</a><10).<br>\nWhen SCF mixing on density is chosen (<a href=\"varbas.html#iscf\">iscf</a>>=10), the \"direct\" decomposition\nof energy is only printed out without being used. It is thus possible to use <b>pawcpxocc</b>=1 is the latter case.<br>\nIn order to save CPU time, when molecular dynamics is selected (<a href=\"varrlx.html#ionmov\">ionmov</a>>=6) and\nSCF mixing done on density (<a href=\"varbas.html#iscf\">iscf</a>>=10), <b>pawcpxocc</b>=2 is (by default) set to <b>1</b>.<br>\nWhen <b>pawcpxocc=1</b>, \"direct\" decomposition of total energy cannot be printed out.\n\n\n",
    "vartype": "integer parameter "
  },
  "pawcross": {
    "category": "",
    "default": "0 ",
    "definition": "PAW - add CROSS term in oscillator strengths ",
    "section": "varpaw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening or sigma calculations, and\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<p>\nWhen <b>pawcross=1</b>, the overlap between the plane-wave part of one band and the on-site part of an other\nis taken into account in the computation of the oscillator strengths. Hence, the completeness of the on-site basis is no longer assumed.\n\n\n",
    "vartype": "integer parameter "
  },
  "pawecutdg": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "-1, so pawecutdg MUST be specified for PAW calculations.",
    "definition": "PAW - Energy CUToff for the Double Grid ",
    "section": "varpaw",
    "text": "<p>\nNeeded only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>Define the energy cut-off for the fine FFT grid\n(the \"double grid\", that allows to transfer data from the normal, coarse, FFT grid to the\nspherical grid around each atom).\n<br><b>pawecutdg</b> must be larger or equal to\n<a href=\"varbas.html#ecut\">ecut</a>. If it is equal to it, then no fine\ngrid is used. The results are not very accurate, but the computations\nproceed quite fast.\n<br>For typical PAW computations, where <a href=\"varbas.html#ecut\">ecut</a>\nis on the order of 15 Ha, <b>pawecutdg</b> should be on the order of 40 Ha.\nChoosing a larger value should not increase the accuracy, but does not slow down the\ncomputation either, only the memory. The choice made for this variable DOES have a bearing\non the numerical accuracy of the results, and, as such, should be the object\nof a convergence study. The convergence test might be made on the total energy\nor derived quantities, like forces, but also on the two values of the\n\"Compensation charge inside spheres\", a quantity written in the log file.\n",
    "vartype": "real parameter "
  },
  "pawfatbnd": {
    "category": "",
    "default": "0",
    "definition": "PAW: print band structure in the FAT-BaND representation ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1\nfor Ground-State calculations and non self-consistent calculations.<br>\nThis option can be used to plot band structure. For each atom (specified by\n<a href=\"vargs.html#natsph\">natsph</a> and <a href=\"vargs.html#iatsph\">iatsph</a>), each angular momentum, and each\nspin polarisation, the band structure is written in files (such as e.g. FATBANDS_at0001_Ni_is2_l2_m-1). Each file\ncontains the eigenvalue, and the contribution of angular momentum L, and projection of angular momentum m,\n(for the corresponding wavefunction) to the PAW density inside the PAW sphere\nas a function of the index of the k-point.\nThe output can be readily plotted with the software <a href=\"http://plasma-gate.weizmann.ac.il/Grace/\">xmgrace</a> (e.g xmgrace FATBANDS_at0001_Ni_is2_l2_m-1).\nRelevant values are:<br>\n<ul>\n<li>0: desactivated.</li>\n<li>1: The fatbands are only resolved in L.</li>\n<li>2: The fatbands are resolved in L and M.</li>\n</ul>\n",
    "vartype": "integer parameter"
  },
  "pawlcutd": {
    "category": "",
    "default": "10 ",
    "definition": "PAW - L angular momentum used to CUT the development in moments of the Densitites ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>The expansion of the densities in angular momenta is\nperformed up to l=<b>pawlcutd</b>.\n<br>Note that, for a given system, the maximum value of <b>pawlcutd</b> is <b>2*l_max</b>,\nwhere l_max is the maximum l of the PAW partial waves basis.\n<br><br>The choice made for this variable DOES have a bearing\non the numerical accuracy of the results, and, as such, should be the object\nof a convergence study. The convergence test might be made on the total energy\nor derived quantities, like forces, but also on the two values of the\n\"Compensation charge inside spheres\", a quantity written in the log file.\n",
    "vartype": "integer parameter "
  },
  "pawlmix": {
    "category": "",
    "default": "10 ",
    "definition": "PAW - maximum L used in the spherical part MIXing ",
    "section": "varpaw",
    "text": "i\n<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>\nThe choice made for this variable determine how the spherical part of the\ndensity is mixed during electronic iterations.\n<br>\n<br>\nOnly parts of (rhoij quantities) associated with\nl angular momenta up to l=pawlmix are mixed.\nOther parts of augmentation occupancies are not included in the mixing process.\n<br>\nThis option is useful to save CPU time but DOES have a bearing on the numerical accuracy of the results.\n",
    "vartype": "integer parameter "
  },
  "pawmixdg": {
    "category": "",
    "default": "0 if <a href=\"varpar.html#npfft\">npfft</a>=1 (else 1)",
    "definition": "PAW - MIXing is done (or not) on the (fine) Double Grid ",
    "section": "varpaw",
    "text": "i\n<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>\nThe choice made for this variable determines the grid on which the density (or potential) is mixed during the SCF cycle.\n<br>\n<br> - If <b>pawmixdg=1</b> the density/potential is mixed in REAL space using the fine FFT grid\n(defined by <a href=\"varpaw.html#\">pawecutdg</a> or <a href=\"varpaw.html#ngfftdg\">ngfftdg</a>).\n<br> - If <b>pawmixdg=0</b> the density/potential is mixed in RECIPROCAL space using the coarse FFT grid\n(defined by <a href=\"varbas.html#ecut\">ecut</a> or <a href=\"vargs.html#ngfft\">ngfft</a>).\nOnly components of the coarse grid are mixed using the scheme defined by <a href=\"varbas.html#iscf\">iscf</a>;\nother components are only precondionned by <a href=\"vargs.html#diemix\">diemix</a> and simply mixed.\n<br>\nThis option is useful to save memory and does not affect numerical accuracy of converged results.\nIf <b>pawmixdg=1</b>, density and corresponding residual are stored for previous iterations and are\nREAL arrays of size <a href=\"varint.html#nfftdg\">nfftdg</a>.\nIf <b>pawmixdg=0</b>, density and corresponding residual are stored\nfor previous iterations and are COMPLEX arrays of size <a href=\"varint.html#nfft\">nfft</a>.\nThe memory saving is particulary efficient when using the Pulay mixing\n(<a href=\"varbas.html#iscf\">iscf</a>=7 or 17).\n<br>\n<br>\nIn <b>wavelet</b> calculations <a href=\"varbas.html#usewvl\">usewvl</a>=1:\n<br> - pawmixdg is set to 1 by default.\n<br> - A value of 0 is not allowed.\n<br> - Density/potential is mixed in REAL space (Here only one grid is used).\n",
    "vartype": "integer parameter "
  },
  "pawnhatxc": {
    "category": "",
    "default": "1 ",
    "definition": "PAW - Flag for exact computation of gradients of NHAT density in eXchange-Correlation. ",
    "section": "varpaw",
    "text": "<p>\nNeeded only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>Relevant only when a GGA exchange-correlation functional is used.\n<br>When this flag is activated, the gradients of compensation charge density (n_hat) are exactly\ncomputed (i.e. analytically); when it is desactivated, they are computed with a numerical scheme in\nreciprocal space (which can produce inaccurate results if the compensation charge density\nis highly localized).\n<br>As analytical treatment of compensation charge density gradients is CPU time demanding,\nit is possible to bypass it with <b>pawnhatxc</b>=0; but the numerical accuracy can be affected\nby this choice. It is recommended to test the validity of this approximation before use.\n",
    "vartype": "integer parameter "
  },
  "pawnphi": {
    "category": "",
    "default": "13 ",
    "definition": "PAW - Number of PHI angles used to discretize the sphere around each atom. ",
    "section": "varpaw",
    "text": "<p>Needed only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>Number of phi angles (longitude) used to discretize the\ndata on the atomic spheres. This discretization is completely\ndefined by <b>pawnphi</b>\nand <a href=\"varpaw.html#pawntheta\">pawntheta</a>.\n",
    "vartype": "integer parameter "
  },
  "pawntheta": {
    "category": "",
    "default": "12 ",
    "definition": "PAW - Number of THETA angles used to discretize the sphere around each atom. ",
    "section": "varpaw",
    "text": "<p>Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>Number of theta angles (latitude) used to discretize the\ndata on the atomic spheres. This discretization is completely\ndefined by <b>pawntheta</b>\nand <a href=\"varpaw.html#pawnphi\">pawnphi</a>.\n",
    "vartype": "integer parameter "
  },
  "pawnzlm": {
    "category": "",
    "default": "1 ",
    "definition": "PAW - only compute Non-Zero LM-moments of the contributions to the density from the spheres",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br> Concerns the computation of the contributions to the density from the spheres (named rho_1 -\nrho_tild_1).\n<br>If set to 0, all lm-moments of the sphere contributions to the density are computed at each\nelectronic iteration.\n<br> If set to 1, only non-zero lm-moments of the sphere contributions to the density are computed\nat each electronic iteration (they are all computed at the first iteration then only\nthose found to be non-zero will be computed ; thus the first iteration is more cpu intensive)\n",
    "vartype": "integer parameter "
  },
  "pawoptmix": {
    "category": " ",
    "default": "0",
    "definition": "PAW - OPTion for the MIXing of the spherical part",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nWhen PAW is activated, the self-consistent requires the mixing of both the total potential (or density)\nand the \"spherical part\" (in fact the augmentation occupancies rho_ij).\n<br>The same mixing scheme is applied to the potential (density) and the spherical part.\nIt is optimized in order to minimize a residual.\n<br>If <b>pawoptmix</b>=0 the residual is the potential (or density) residual.\n<br>If <b>pawoptmix</b>=1 the residual is a sum of the potential (or density) residual\nand the \"spherical part\" residual.\n",
    "vartype": "integer parameter "
  },
  "pawovlp": {
    "category": " ",
    "default": "5.0",
    "definition": "PAW - spheres OVerLap allowed (in percentage)",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nWhen PAW is activated, a localized atomic basis is added to describe wave functions.\nSpheres around atoms are defined and they are IN PRINCIPLE not allowed to overlap. However,\na small overlap can be allowed without compromising the accurary of results. Be aware that\ntoo high overlaps can lead to unphysical results.<br>\nWith the <b>pawovlp</b> variable, the user can control the (voluminal) overlap percentage\nallowed without stopping the execution.<br>\n<b>pawovlp</b> is the value (in percentage: 0...100%) obtained by dividing\nthe volume of the overlap of two spheres by the volume of the smallest sphere.<br>\nThe following values are permitted for <b>pawovlp</b>:<br>\n<div style=\"margin-left: 40px;\">\n- <b>pawovlp</b><0. : overlap is always allowed<br>\n- <b>pawovlp</b>=0. : no overlap is allowed<br>\n- <b>pawovlp</b>>0. and <100. : overlap is allowed only if it is less than <b>pawovlp</b> %\n</div>",
    "vartype": "real parameter "
  },
  "pawprt_b": {
    "category": " DEVELOP ",
    "default": "0 ",
    "definition": "PAW print band",
    "section": "vardev",
    "text": "<p>\nForces the output of the all-electron wavefunction for\nonly a single band. To be used in conjuction with:<b><br />\n<a href=\"varpaw.html#pawprtwf\">pawprtwf</a>=1</b> and\n<a href=\"vardev.html#pawprt_k\">pawprt_k</a>.\nThe indexing of the bands start with one for the lowest occupied band\nand goes up from there.\n",
    "vartype": "integer"
  },
  "pawprt_k": {
    "category": "DEVELOP",
    "default": "0 ",
    "definition": "PAW print k-point",
    "section": "vardev",
    "text": "<p>\nForces the output of the all-electron wavefunction for\nonly a single k-point. To be used in conjuction with:<b><br />\n<a href=\"varpaw.html#pawprtwf\">pawprtwf</a>=1</b> and\n<a href=\"vardev.html#pawprt_b\">pawprt_b</a>.\nThe indexing follows the order in ouptput of the internal\nvariable <b>kpt</b> in the beginning of the run.\n",
    "vartype": "integer"
  },
  "pawprtden": {
    "category": " ",
    "default": "0",
    "definition": "PAW: PRinT total physical electron DENsity",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br><font id=\"text\">\n<b>Deprecated :</b> See the <a href=\"varfil.html#prtden\">prtden</a>.\n<p>\n",
    "vartype": "integer parameter "
  },
  "pawprtdos": {
    "category": " ",
    "default": "0",
    "definition": "PAW: PRinT partial DOS contributions",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and <a href=\"varfil.html#prtdos\">prtdos</a>=3.\n<font id=\"text\">\n<p>\nThis input variable controls the computation and/or printing of contributions to the PAW partial DOS in _DOS file(s):<br>\n<div style=\"margin-left: 40px;\">\n+ Plane-waves contribution<br>\n+ \"on-site\" all-electron contribution (phi)<br>\n- \"on-site\" pseudo contribution (phi_tild).<br>\n</div>\nIf <b>pawprtdos=0:</b><br>\n- The 3 contributions are computed; only the total partial DOS is output in _DOS file.<br>\nIf <b>pawprtdos=1:</b><br>\n- The 3 contributions are computed and output in _DOS file.<br>\n- In that case, integrated DOS is not output.<br>\nIf <b>pawprtdos=2:</b><br>\n- Only \"on-site\" all-electron contribution is computed and output in _DOS file.<br>\n- This a (very) good approximation of total DOS, provided that (1) the PAW local basis is complete, (2) the electronic charge is mostly contained in PAW spheres.<br>\n- In that case, the <a href=\"vargs.html#ratsph\">ratsph</a> variable is automatically set to the PAW radius.\n",
    "vartype": "integer parameter "
  },
  "pawprtvol": {
    "category": " ",
    "default": "0",
    "definition": "PAW: PRinT VOLume",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nControl print volume and debugging output for PAW in log file or standard output.\nIf set to 0, the print volume is at its minimum.<br>\n<b>pawprtvol</b> can have values from -3 to 3:<br>\n- <b>pawprtvol</b>=-1 or 1: matrices rho_ij (atomic occupancies) and D_ij (psp strength)\nare printed at each SCF cycle with details about their contributions. <br>\n- <b>pawprtvol</b>=-2 or 2: like -1 or 1 plus additional printing: moments of \"on-site\" densities,\ndetails about local exact exchange.<br>\n- <b>pawprtvol</b>=-3 or 3: like -2 or 2 plus additional printing: details about\nPAW+U, rotation matrices of sphercal harmonics.<br>\nWhen <b>pawprtvol</b>>=0, up to 12 components of rho_ij and D_ij matrices for the 1st and last atom are printed.<br>\nWhen <b>pawprtvol</b><0, all components of rho_ij and D_ij matrices for all atoms are printed.<br>\n",
    "vartype": "integer parameter "
  },
  "pawprtwf": {
    "category": " ",
    "default": "0",
    "definition": "PAW: PRinT WaveFunctions",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nThis input variable controls the output of the full PAW wave functions including the on-site\ncontribution inside each PAW sphere needed to reconstruct the correct nodal shape in the augmentation region.\n<b>pawprtwf=1</b> causes the generation of a file  _AE_WFK that contains the full\nwavefunctions in real space on the fine FFT grid defined by\n<a href=\"varpaw.html#pawecutdg\">pawecutdg</a> or <a href=\"varpaw.html#ngfftdg\">ngfftdg</a>).\nLimitations: At present (v6.0), <b>pawprtwf=1</b> is not compatible neither with the k-point parallelism\nnor with the parallelism over G-vectors. Therefore the output of the _AE_WFK has to be done in sequential.\nMoreover, in order to use this feature, one has to be enable the support for ETSF-IO at configure-time\nas the _AW_WFK file is written using the NETCDF file format following the ETSF-IO specification for\nwavefunctions in real space. If the code is run in entirely in serial, additional output is made of various\ncontributions to the all-electron avefunction. By default the full available set of bands and k-points are\nouput, but a single band and k-point index can be requested by using the variables\n<a href=\"vardev.html#pawprt_b\">pawprt_b</a> and <a href=\"vardev.html#pawprt_k\">pawprt_k</a>.\n",
    "vartype": "integer parameter "
  },
  "pawspnorb": {
    "category": " ",
    "default": "0",
    "definition": "PAW - option for SPiN-ORBit coupling",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nWhen PAW is activated, the <b>spin-orbit coupling</b> can be added without the use\nof specific PAW datasets (pseudopotentials).<br>\nIf <b>pawspnorb</b>=1, spin-orbit will be added.<br><br>\nNote that only the all-electron \"on-site\" contribution to the Hamiltonian is taken into account;\nthis a very good approximation but requires the\nfollowing conditions to be fullfilled:\n<br> <div style=\"margin-left: 20px;\">1- the<span\nstyle=\"position: relative; top: -8pt; left: 8pt;\"></span><span\nstyle=\"position: relative; top: -5pt; left: 6pt;\">~</span>&#966;<sub>i</sub>\nbasis is complete enough<br> 2- the electronic density is mainly\ncontained in the PAW sphere<br>\n</div><br>\nAlso note that, when spin-orbit coupling is activated, the time-reversal symmetry might be broken.<br>\nThe use of <a href=\"varbas.html#kptopt\">kptopt</a>=1 or <a href=\"varbas.html#kptopt\">kptopt</a>=2 is thus\nforbidden. It is adviced to use <a href=\"varbas.html#kptopt\">kptopt</a>=3 (no symmetry used to generate k-points)\nor <a href=\"varbas.html#kptopt\">kptopt</a>=4 (only spatial symmetries used to generate k-points).<br>\nBe careful if you choose to use <a href=\"varbas.html#kptopt\">kptopt</a>=0 (k-points given by hand); Time-reversal symmetry\nhas to be avoided.\n<br>An artificial scaling of the spin-orbit can be introduced thanks to the <a href=\"varpaw.html#spnorbscl\">spnorbscl</a> input variable.\n",
    "vartype": "integer parameter "
  },
  "pawstgylm": {
    "category": " ",
    "default": "1",
    "definition": "PAW - option for the STorage of G_l(r).YLM(r)",
    "section": "varpaw",
    "text": "Relevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<font id=\"text\">\n<p>\nWhen PAW is activated, the computation of compensation charge density (so called\n\"hat\" density) requires the computation of g_l(r).Y_lm(r) factors (and cartesian derivatives) at each point\nof real space contained in PAW spheres. The number of atoms, of (l,m) quantum numbers\nand the sharpness of the real FFT grid can lead to a very big {g_l.Y_lm} datastructure.\nOne can save memory by putting <b>pawstgylm</b>=0; but, in that case, g_l(r).Y_lm(r) factors\na re-computed each time they are needed and CPU time increases.\n<br><br><div style=\"margin-left: 20px;\">\nPossible choices:<br>\n- <b>pawstgylm</b>=0 : g_l(r).Y_lm(r) are not stored in memory and recomputed.<br>\n- <b>pawstgylm</b>=1 : g_l(r).Y_lm(r) are stored in memory.<br>\n</div>\n<br><div style=\"margin-left: 40px;\">\nNote:<br>\ng_l(r) are shape functions (analytically known)<br>\nY_lm(r) are real spherical harmonics\n</div>\n",
    "vartype": "integer parameter "
  },
  "pawsushat": {
    "category": " ",
    "default": "0",
    "definition": "PAW - SUSceptibility, inclusion of HAT (compensation charge) contribution",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1 and <a href=\"vargs.html#optdriver\">optdriver</a>=0 (Ground-State calculation).\n<br>\nWhen a sophisticated preconditioning scheme is selected for the SCF cycle of a Ground-State calculation\n(<a href=\"vargs.html#iprcel\">iprcel</a>>0), the computation of the susceptibility matrix\nis required several times during the cycle. This computation is computer time consuming, especially\n-- within PAW -- because of the inclusion of additional terms due to the compensation charge density.\nAs only a crude valuation of the susceptibilty matrix is needed (to evaluate a preconditioning matrix),\nthe compensation charge contribution can be neglected to save CPU time (select <b>pawsushat</b>=0).\nThis approximation could be unfavourable in some cases; in the latter, we advice to put <b>pawsushat</b>=1.\n<br><br><div style=\"margin-left: 20px;\">\nPossible choices:<br>\n- <b>pawsushat</b>=0 : only plane-wave contribution to suscep. matrix is computed.<br>\n- <b>pawsushat</b>=1 : the whole suscep. matrix (PW + PAW on-site) is computed.<br>\n</div>\n",
    "vartype": "integer parameter "
  },
  "pawujat": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "1, i.e. the first atom treated with PAW+U. ",
    "definition": "PAW+macro_UJ, ATom number ",
    "section": "vardev",
    "text": "<p>\nDetermines the atom for which U (or J) should be determined. See also <a href=\"vardev.html#macro_uj\">macro_uj</a>.\n",
    "vartype": "integer"
  },
  "pawujrad": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "20 a.u. ",
    "definition": "PAW+macro_UJ, sphere RADius",
    "section": "vardev",
    "text": "<p>\nThe sphere radius serves to extrapolate the U value calculated at r_paw to a larger sphere radius.\nSee also <a href=\"vardev.html#macro_uj\">macro_uj</a>.\nAs most projector functions are localized within r_paw to &asymp;80%,\n20 a.u. contains &asymp;100% of the wavefunction and corresponds to r_paw &rarr; &infin;.\n",
    "vartype": "real "
  },
  "pawujv": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0.1 eV. ",
    "definition": "PAW+macro_UJ, potential shift (V)",
    "section": "vardev",
    "text": "<p>\nAmplitude of the potential shift for the determination of U (or J). See also <a href=\"vardev.html#macro_uj\">macro_uj</a>.\n",
    "vartype": "real,  "
  },
  "pawusecp": {
    "category": " ",
    "default": "1",
    "definition": "PAW - option for the USE of CPrj in memory (cprj=WF projected with NL projector)",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<br>\nWhen PAW is activated, the computation of cprj arrays is memory and time consuming.<br>\nWhen <b>pawusecp</b>=0, then the cprj are never kept in memory, they are recomputed when needed (this is CPU-time consuming).\nWhen <b>pawusecp</b>=1, then the cprj are computed once and then kept in memory.<br>\nChange the value of the keyword only if you are an experienced user (developper).<br>\nRemember: cprj = (WF_n .dot. p_i) (WF_n=wave function, p_i=non-local projector).<br>\n<br>For the time being, only activated for RF calculations.<br>\n",
    "vartype": "integer parameter "
  },
  "pawxcdev": {
    "category": "",
    "default": "1 ",
    "definition": "PAW - choice for eXchange-Correlation DEVelopment (spherical part) ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 0, the exchange-correlation term in the spherical part of energy is\ntotally computed on the angular mesh </li>\n<li> If set to 1, the exchange-correlation term in the spherical part of energy is\ndeveloped onto lm-moments at order 1 </li>\n<li> If set to 2, the exchange-correlation term in the spherical part of energy is\ndeveloped onto lm-moments at order 2 (can be memory/CPU consuming) </li>\n</ul>\n<br>\nBe careful: GGA requires <b>pawxcdev</b> &gt; 0\n",
    "vartype": "integer parameter "
  },
  "pimass": {
    "category": "",
    "default": "<a href=\"varrlx.html#amu\">amu</a>(<a href=\"varbas.html#ntypat\">ntypat</a>).",
    "definition": "Path Integral inertial MASSes",
    "section": "varrlx",
    "text": "<p>\nOnly relevant if <a href=\"varrlx.html#imgmov\">imgmov</a>=9 or 13 (Path-Integral Molecular Dynamics).<br>\nGives the inertial masses (called \"fictitious masses\" in\n<i>D. Marx and M. Parrinello, J. Chem. Phys. 104, 4077 (1996)</i>)\nin atomic mass units for each kind of atom in cell. These masses are used\nin performing molecular dynamical atomic motion.<br>\nSee <a href=\"varrlx.html#amu\">amu</a> for further details.\n",
    "vartype": "real array pimass(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "pitransform": {
    "category": "",
    "default": "0.",
    "definition": "Path Integral TRANSFORMation",
    "section": "varrlx",
    "text": "<p>\nOnly relevant if <a href=\"varrlx.html#imgmov\">imgmov</a>=13 (Path-Integral Molecular Dynamics).\nAllows to change the dynamics of the Path Integral chains, as described by M. Tuckerman et al, J. Chem. Phys. 104, 5579 (1996).\n<p>\nIf equal to 1, staging transformation.\n<br>\nIf equal to 2, normal modes transformation.\n",
    "vartype": "integer parameter "
  },
  "polcen": {
    "category": "",
    "default": "3*0",
    "definition": "POLarization for Centrosymmetric geo",
    "section": "varff",
    "text": "<p>\nWhen doing a finite electric displacement field calculation,\nif the structure is centrosymmetric but the polarization is non-zero (such as for AlAs),\nthis non-zero polarization should be specified as <b>polcen</b> (in REDUCED coordinates, in atomic units) in the input file.\nSee Eq.(24) in the Suppl. of Nat. Phys. (M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009))\n",
    "vartype": "real array polcen(3) "
  },
  "positron": {
    "category": " ",
    "default": "0",
    "definition": "POSITRON calculation ",
    "section": "vargs",
    "text": "<p>\nThis input parameter can be positive or negative.<br>\nNegative <b>positron</b> are only relevant for PAW calculation.<br>\nElectron-positron correlation functional is defined by <a href=\"vargs.html#ixcpositron\">ixcpositron</a>.<br>\n\n<br><U>Positive values for <b>positron</b>:</U><br>\n<i>For <b>positron=1 or 2</b>, will perform the calculation of positron\nlifetime (and annihilation rate).</i><br>\n<ul>\n<li><b>positron=1</b>:<br>\nStarting from a previous electronic GS density (with <b>positron=0</b>),\na positronic ground-state calculation is performed, considering that the electrons are not perturbed\nby the presence of the positron.<br>\nThis is almost correct for a positron in a perfect bulk material.\nBut this approximation fails when defects exist in\nthe material (for instance: the positron might be trapped by a vacancy).<br>\nThe electronic density will be automatically read from a _DEN file (with or without\n<a href=\"varfil.html#getden\">getden</a>/<a href=\"varfil.html#irdden\">irdden</a>\nkeyword).<br>\nAt the end of the SCF cycle, the positron lifetime and annihilation rate\nare printed out.<br><br>\n<i>Additional information for the use of pseudopotentials:<br><ul>\n<li>PAW datasets: nothing to do; simply use usual electronic PAW datasets\n<li>Norm-conserving pseudopotentials: One has to use specifics\npseudopotentials for the positron calculation.\nThey must be of the FHI type (pspcod=6), and must contain at their\nend, the all-electrons core density generated with FHI98PP. They must have\nlmax=lloc=0 (check that this works for the electronic GS !! No ghost, etc ...). Otherwise, their are similar to a usual FHI pseudopotential.<br>\n</i></ul><br>\n\n<li><b>positron=2</b>:<br>\nStarting from a previous positronic GS density (with <b>positron=1</b>),\nan electronic ground-state calculation is performed, keeping the positronic\ndensity constant.<br>\nThe positronic density will be automatically read from a _DEN file (with or without\n<a href=\"varfil.html#getden\">getden</a>/<a href=\"varfil.html#irdden\">irdden</a>\nkeyword).<br>\nAt the end of the SCF cycle, the positron lifetime and annihilation rate\nare printed out.<br><br>\n<i>Additional information for the use of pseudopotentials:<br><ul>\n<li>PAW datasets: nothing to do; simply use usual electronic PAW datasets\n<li>Norm-conserving pseudopotentials: One has to use specifics\npseudopotentials for the positron calculation.\nThey must be of the FHI type (pspcod=6), and must contain at their\nend, the all-electrons core density generated with FHI98PP.<br>\n</i></ul><br>\n\n<li><b>Typical use</b>:<br>\nThe calculation is done in several steps:<br>\nThe first one is a normal GS calculation for the electrons, with <b>positron</b>=0.\nThe only specific thing to do is to set <a href=\"varfil.html#prtden\">prtden</a>=1.\nThis will create the associated _DEN file which will used as input file for the positronic\nGS calculation.<br>\nThe second step is the GS calculation of the positron and subsequently its\nlifetime, with <b>positron</b>=1.\nOne has to define also <a href=\"vargs.html#ixcpositron\">ixcpositron</a>.<br>\nThen, it is possible to perform an additional step, computing\nthe GS electronic density in presence of the positron, with <b>positron</b>=2.<br>\nand so on...<br>\nThis procedure can be automated (for PAW only) by the use of a negative value for <b>positron</b>.<br>\n</ul>\n\n<br><U>Negative values for <b>positron</b>:</U><br>\n<i>For <b>positron&lt;0</b>, will perform an automatic calculation of electrons and positron\ndensities in the two-component DFT context; then will compute positron lifetime (and annihilation rate).</i><br>\n\n<ul><li><b>positron=-1</b>:<br>\nStarting from scratch, will first perform a usual electronic ground-state\ncalculation until convergency (controlled by the use of one of the <i>tolerance</i> keywords).<br>\nThen will perform a positronic ground state calculation in presence of the electrons\nand ions; then an electronic ground state calculation in presence of the positron and the ions...<br>\nand so on... until the total energy is converged.<br>\nThe convergence of the total energy of the ions+electrons+positron system\nis controlled by the use of the <a href=\"vargs.html#postoldfe\">postoldfe</a> input keyword.<br>\nWith <b>positron=-1</b>, at the beginning of each new electronic/positronic step,\nthe wave functions are unknown.</ul>\n\n<ul><li><b>positron=-10</b>:<br>\nSame as <b>positron=-1</b> except that the electronic/positronic wave functions\nare stored in memory.<br>\nConsequently, the total number of iterations to reach the convergency (Etotal<<a href=\"vargs.html#postoldfe\">postoldfe</a>) is smaller.<br>\nBut, this can increase the total amount of memory needed by the code.</ul><br>\n\nReferences:<br>\n<ul>\n<b>[1]</b> J. Arponen and E. Pajanne, Ann. Phys. (N.Y.) 121, 343 (1979).<br>\n<b>[2]</b> Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986).<br>\n<b>[3]</b> P.A. Sterne and J.H. Kaiser, Phys. Rev. B 43, 13892 (1991).<br>\n<b>[4]</b> M.J. Puska, A.P. Seitsonen and R.M. Nieminen, Phys. Rev. B 52, 10947 (1994).<br>\n<b>[5]</b> B. Barbiellini, M.J. Puska, T. Torsti and R.M.Nieminen, Phys. Rev. B 51, 7341 (1994)<br>\n</ul>\n",
    "vartype": "integer "
  },
  "posnstep": {
    "category": "",
    "default": "50",
    "definition": "POSitron calculation: max. Number of STEPs for the two-component DFT",
    "section": "vargs",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#positron\">positron</a>&lt;0.<br>\nSets the maximum number of electronic/positronic iterations that, when reached, will cause the two-component DFT SCF cycle to stop.<br>\nThe code will first compute the electronic ground-state, then the positronic ground state in the electronic density, then the electronic ground-state in the positronic density, ...<br>\n...until diff_Etotal<<a href=\"vargs.html#postoldfe\">postoldfe</a> or diff_Forces<<a href=\"vargs.html#postoldff\">postoldff</a>\nor the number of electronic/positronic steps is <b>posnstep</b>.<br>\n",
    "vartype": "integer parameter"
  },
  "posocc": {
    "category": "",
    "default": "1.",
    "definition": "POSitron calculation: OCCupation number for the positron",
    "section": "vargs",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#positron\">positron</a>/=0.<br>\nSets the occupation number for the positron. Has to be <=1.<br>\nChanging <b>posocc</b> is only usefull for bulk calculation when one wants to perform lifetime computations using a small simulation cell (can avoid the use of a supercell). It simulates the dispersion of the positron in the whole crystal.<br>\n",
    "vartype": "real parameter "
  },
  "postoldfe": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "1.e-6",
    "definition": "POSITRON calculation: TOLerance on the DiFference of total Energy",
    "section": "vargs",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#positron\">positron</a>&lt;0.<br>\nSets a tolerance for absolute difference of total energy (of <i>ions+electrons+positron</i> system)\nthat, when reached, will cause the SCF cycle to stop before the number of\nsteps is <a href=\"varbas.html#nstep\">nstep</a>.<br>\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>toldfe</b> has the '<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n",
    "vartype": "real parameter "
  },
  "postoldff": {
    "category": "",
    "default": "0",
    "definition": "POSitron calculation: TOLerance on the DiFference of Forces",
    "section": "vargs",
    "text": "<p>\nRelevant only when <a href=\"vargs.html#positron\">positron</a>&lt;0.<br>\nSets a tolerance for absolute difference of maximum force acting on ions (due to <i>ions+electrons+positron</i> system)\nthat, when reached, will cause the SCF cycle to stop before the number of SCF\nsteps is <a href=\"varbas.html#nstep\">nstep</a> or the number of electronic/positronic steps is <a href=\"vargs.html#posnstep\">posnstep</a>.<br>\nOnly one and only one of <a href=\"vargs.html#postoldfe\">postoldfe</a> or <a href=\"vargs.html#postoldff\">postoldff</a> can be set.<br>\n",
    "vartype": "real parameter "
  },
  "ppmfrq": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0 Ha ",
    "definition": "Plasmon Pole Model FReQuency ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening\ncalculations or sigma calculations.\nUsually only effective if GW corrections are evaluated using the plasmon-pole model of Godby-Needs\n(<i>i.e</i> <a href=\"vargw.html#ppmodel\">ppmodel</a>=1).\n<br><br>\n<B> In plasmon-pole calculations</B>\n<p>\nIn the present status of the GW code, the convolution in frequency space\ndefining the self-energy operator can be evaluated using two different approaches:\nnumerical integration and plasmon-pole models.\n<br>\nMethods based on the numerical integration (contour deformation, analytic continuation) require\nthe knowledge of the screened interaction for several frequencies. These approaches give\nthe most accurate results but at the price of an increase in the CPU time required.\n<br>\nAlternatively, it is possible to approximate the dynamical behaviour of the screened interaction\nthrough simple analytical expressions, the so-called plasmon-pole models.\nIn the plasmon-pole model proposed by Godby-Needs (<a href=\"vargw.html#ppmodel\">ppmodel</a>=1),\nthe screening must be available at zero frequency, as well as at another imaginary frequency,\nof the order of the plasmon frequency (the peak in the EELS spectrum).\nThis information is used to model the behaviour of the dielectric matrix\nfor all frequencies.\nDuring the calculation of the screening, <b>ppmfrq</b> defines the imaginary frequency where the\ndielectric matrix is evaluated, in addition to the zero frequency.\nDuring the self-energy run, <b>ppmfrq</b> can be used to define the second frequency to be used\nto calculate the plasmon-pole parameters. This is particularly useful when the\nSCR file contains several frequencies along the imaginary axis.\nIn this case the frequency whose value is the closest one to <b>ppmfrq</b> will be selected.\nNote that, if the plasmon-pole approximation is good, then, the\nchoice of <b>ppmfrq</b> should have no influence on the final result.\nOne should check whether this is the case. In general, the plasmon frequencies of bulk solids\nare of the order of 0.5 Hartree.\n<br><br>\n<B> In Contour Deformation calculations</B>\n<p>\n<b>ppmfrq</b> is here used to <b>override</b> the default value calculated from the average electronic\ndensity per unit cell. This can affect the distribution of gridpoints along the imaginary and\nreal frequency axes. See <a href=\"vargw.html#cd_frqim_method\">gw_frqim_method</a>, <a href=\"vargw.html#gw_frqim_inzgrid\">gw_frqim_inzgrid</a> and <a href=\"vargw.html#gw_frqre_inzgrid\">gw_frqre_inzgrid</a> for more details.\n\n",
    "vartype": "real parameter"
  },
  "ppmodel": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "1 ",
    "definition": "Plasmon Pole MODEL ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 or 4, that is, screening calculations and self-energy calculations.\n\n<ul>\n<li> <b>ppmodel</b>=1 : PP model of Godby and Needs,\nSee <B> FIXME>REFERENCE MISSING!</B></li>\n<li> <b>ppmodel</b>=2 : PP model of Hybertsen and Louie,\nSee Phys Rev B 34, 5390 (1986) </li>\n<li> <b>ppmodel</b>=3 : PP model of  W. von der Linden\nand P. Horsh see Phys Rev B 37, 8351 (1988) </li>\n<li> <b>ppmodel</b>=4 : PP model of Farid and Engel.\nSee Phys Rev B47,15931 (1993)\n<li> <b>ppmodel</b>=0 : no PP model, numerical integration\n(contour deformation method, see e.g. S. Lebegue  et al. PRB  67, 155208 (2003).)  </li>\n</ul>\n\nPlease note the difference between <b>ppmodel</b> 1 and <b>ppmodel</b> 2,3,4.\nIn the first case (<b>ppmodel</b>=1), the plasmon-pole parameters are determined in order to reproduce\nthe behaviour of the dielectric matrix at two calculated frequencies: the static limit (omega=0)\nand the imaginary frequency defined by <a href=\"vargw.html#ppmfrq\">ppmfrq</a>.\nIn the last three cases, instead, the plasmon-pole parameters are found\nby using the dielectric matrix calculated only at omega=0 and enforcing the so-called f-sum rule.\nSee also <a href=\"vargw.html#nfreqre\">nfreqre</a>.\n<p>\nPlease note also that in the case of <b>ppmodel</b> 4, the plasmon energies are not simple mathematical parameters,\nbut rather have a physical meaning (at least the lowest ones).\nThus the calculated plasmon band structure (plasmon energy vs q vector) is reported in the output file for the\nlowest 10 bands.\n",
    "vartype": "integer parameter "
  },
  "prepanl": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "PREPAre Non-Linear response calculation ",
    "section": "varrf",
    "text": "<p>\nThe computation of third-order derivatives from the 2n+1 theorem\nrequires the first-order wavefunctions and densities obtained from\na linear response calculation. The standard approach in a linear\nresponse calculation is (i) to compute only the\nirreducible perturbations, and (ii) to use symmetries to\nreduce the number of k-points for the k-point integration.\n<br>This approach cannot be applied, presently (v4.1),\nif the first-order wavefunctions are to be used to compute third-order derivatives.\nFirst, for electric fields, the code needs the derivatives\nalong the three directions. Still, in case of phonons, only the\nirreducible perturbations are required.\nSecond, for both electric fields and phonons, the wavefunctions\nmust be available in half the BZ (kptopt=2), or the full BZ (kptopt=3).\n<br>During the linear response calculation, in order to prepare a non-linear\ncalculation, one should put <b>prepanl</b> to 1 in order\nto force ABINIT (i) to compute the electric field perturbation\nalong the three directions explicitly, and (ii) to keep the full number of k-points.\n",
    "vartype": "integer parameter  "
  },
  "prepgkk": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "PREPAre GKK calculation",
    "section": "varrf",
    "text": "<p>\nThe calculation of electron-phonon coupling quantities requires the presence\nof all the perturbations (all atoms in all directions) for the chosen set\nof (irreducible) q-points. To impose this and prevent ABINIT from using\nsymmetry to reduce the number of perturbations, set <b>prepgkk</b> to 1.\nUse in conjunction with <a href=\"varfil.html#prtgkk\"><b>prtgkk</b></a>.\n",
    "vartype": "integer parameter  "
  },
  "prepscphon": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0 ",
    "definition": "PREPare Self-Consistent PHONon calculation",
    "section": "vardev",
    "text": "<p>\nPrint PCINFO, PHFREQ, and PHVEC files, for use with self-consistent phonon runs, after a perturbation\ncalculation. Only prints out files for the present q-point, and there is presently no tool to symmetrize\nor merge these files, so use anaddb instead (with prtscphon input variable). The abinit input\nvariable is destined to someday bypass the use of anaddb for scphon calculations.\n",
    "vartype": "integer"
  },
  "prt1dm": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT 1-DiMensional potential and density ",
    "section": "varfil",
    "text": "<p>\nIf set >= 1, provide one-dimensional projection of\npotential and density, for each of the three axis.\nThis corresponds to averaging the potential\nor the density on bi-dimensional slices of the FFT grid.",
    "vartype": "integer parameter "
  },
  "prtatlist": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "0.",
    "definition": "PRinT by ATom LIST of ATom",
    "section": "varrlx",
    "text": "<p>\nThis is an array of the numbers associated to the index atoms that\nthe user want to print in the output or log files, this is useful when\nyou have a large number of atoms and you are only interested to\nfollow especific atoms, the numbers associated should be consistent\nwith the list in <a href=\"varbas.html#xcart\">xcart</a> or\n<a href=\"varbas.html#xcart\">xred</a>\n\nThis input varible does not affect the contents of the \"OUT.nc\" or\n\"HIST.nc\", those are NetCDF files containing the information about\nall the atoms.\n",
    "vartype": "integer array "
  },
  "prtbbb": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "PRinT Band-By-Band decomposition ",
    "section": "varrf",
    "text": "<p>\nIf <b>prtbbb</b> is 1, print the band-by-band decomposition of\nBorn effective charges and localization tensor, in case they are computed.\nSee Ph. Ghosez and X. Gonze, J. Phys.: Condens. Matter 12, 9179 (2000).\n",
    "vartype": "integer parameter  "
  },
  "prtbltztrp": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0 ",
    "definition": "PRinT output for BoLTZTRaP code",
    "section": "vardev",
    "text": "<p>\nPrint out geo (_BLZTRP_GEOM) and eigenenergy (_BLZTRP_EIGEN) files for the\n<a href=\"http://www.icams.de/content/departments/ams/madsen/boltztrap.html\">BoltzTraP code</a> by Georg Madsen.\n",
    "vartype": "integer"
  },
  "prtcif": {
    "category": " DEVELOP",
    "default": "0 ",
    "definition": "PRinT Crystallographic Information File",
    "section": "vardev",
    "text": "<p>\nIf set to 1, a CIF file is output with the crystallographic data for the present run (cell size shape and atomic positions).\n",
    "vartype": "integer flag"
  },
  "prtcml": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT CML file ",
    "section": "varfil",
    "text": "<p>\nIf set to 1 or 2, provide output of geometrical\nparameters using CML (the Chemical Markup Language,\nsee papers by P. Murray-Rust and H. Rzepa, especially\nJ. Chem. Inf. Comput. Sci. 39, 928-942 (1998) and the Web site\n<a href=\"http://cml.sourceforge.net\">http://cml.sourceforge.net</a>).\n<br>If prtcml==1, atomic positions are written in fractional coordinates (attributes\n'xFract', 'yFract', and 'zFract').\n<br>If prtcml==2, atomic positions are written in cartesian coordinates (angstrom units,\nattributes 'x3', 'y3', and 'z3').\n<br>Such file can be treated automatically by tools developed\nto handle XML formatted files.\n<br>\n<br>Such a CML file contains :\n<ul>\n<li>The crystallographic information (space group number and the needed\nunit cell parameters and angles)</li>\n<li>The list of symmetry elements</li>\n<li>The list of atoms in the cell (symbols and fractional or cartesian coordinates in angstroms)</li>\n</ul>\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the CML file will be\nthe root output name, followed by _CML.xml .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, the CML file will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name,</li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _CML.xml </li>\n</ul>\n<br>No output is provided by <b>prtcml</b> different from 1 or 2\n",
    "vartype": "integer parameter "
  },
  "prtcs": {
    "category": "",
    "default": "0 ",
    "definition": "PRinT Chemical Shielding ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 1, calculate the chemical shielding at each atomic site in the unit cell. THIS CODE\nIS UNDER DEVELOPMENT AND IS NOT READY FOR USE.\n</li>\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "prtden": {
    "category": " ",
    "default": "1. (was 0 before v5.3), except when <a href=\"varrlx.html#nimage\">nimage</a>>1",
    "definition": "PRinT the DENsity ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value , provide output of electron density\nin real space rho(r), in units of electrons/Bohr^3.\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the density file will be\nthe root output name, followed by _DEN .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, density files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name,</li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _DEN</li>\n</ul>\nThe file structure of the unformatted output file is\ndescribed below, see section 6).\n<br>If  <b>prtden</b> is lower than 0, two files will be printed for restart every <b>prtden</b>  step,\nwith the names being made of\n<ul>\n<li> the root temporary name,</li>\n<li> followed by _DEN_x , where\nx is 0000 or 0001 alternatively.</li>\n<li> The most recent of the two files should be used for restart, and copied to root input name_DS2_DEN</li>\n<li>To perform a restart, in a multidataset mode, use ndtset 2 and jdtset 2 3 (that is 2 datasets, numbered 2 and 3) </li>\n<li>In the dataset 2, get the density you just copied (getden2 -1), perform a non selfconsistent calculation and print the wave function (prtwf2 1)</li>\n<li>In the dataset 3, get  the previous wf(getwfk3 -1), and continue the calculation </li>\n<li>This complicated procedure is due to the fact that reading the density is only allowed for a non sc calculation,\nand also for a dataset different of 0 or the previous one, the option we choose here.</li>\n\n</ul>\n\nPlease note that in the case of PAW (<a href=\"varint.html#usepaw\">usepaw</a>=1) calculations, the _DEN density output\nis not the full physical electron density. If what is wanted is the full physical electron density, say\nfor post-processing with <A href=\"../users/aim_help.html\">AIM</A> or visualization, prtden > 1 will produce physical electron\ndensity or other interesting quantites (see below). Nevertheless, even in the PAW case, when chaining together\ncalculations where the density from one calculation is to be used in a subsequent calculation, it is necessary\nto use the _DEN files and <b>not</b> one of the other files produced with prtden > 1, i.e. _PAWDEN, ATMDEN_xxx or else.\nNote that the usual _DEN file is allways generated as soon as prtden >= 1.\n\nOptions 2 to 6 for prtden are relevant only for <a href=\"varint.html#usepaw\">usepaw</a>=1 and control the output of the\nfull electron density in the PAW case :<br><br>\n<div style=\"margin-left: 10px; \">\n<b> prtden=2</b> causes generation of a file _PAWDEN that contains the bulk <b>valence</b> charge density together with the PAW on-site contributions, and has the same format as the other density files.<br>\n<b> prtden=3</b> causes generation of a file _PAWDEN that contains the bulk <b>full</b> charge density (valence+core)<br>\n<b> prtden=4</b> causes generation of three files _ATMDEN_CORE, _ATMDEN_VAL and _ATMDEN_FULL which respectively contain the core, valence and full atomic protodensity (the density of the individual component atoms in vacuum superposed at the bulk atomic positions). This can be used to generate various visualizations of the bonding density.<br>\n<b> prtden=5</b> options 2 and 4 taken together.<br>\n<b> prtden=6</b> options 3 and 4 taken together.<br>\n<b> prtden=7</b> causes the generation of all the individual contributions to the bulk <b>valence</b> charge density : n_tilde-n_hat (_N_TILDE), n_onsite (_N_ONE) and n_tilde_onsite (_NT_ONE). This is for diagnosis purposes only. <br>\n</div><br>\nOptions 3 to 6 currently require the user to supply the atomic core and valence density in external files in the working directory. The files must be named properly; for example, the files for an atom of type 1 should be named: \"core_density_atom_type1.dat\" and \"valence_density_atom_type1.dat\". The file should be a text file, where the first line is assumed to be a comment, and the subsequent lines contain two values each, where the first one is a radial coordinate and the second the value of the density n(r). Please note that it is n(r) which should be supplied, <b>not</b> n(r)/r^2. The first coordinate point must be the origin, i.e. <b><i>r = 0</i></b>. The atomic densities are spherically averaged, so assumed to be completely spherically symmetric, even for open shells.<br><br>\nNOTE: in the PAW case, <b>DO NOT</b> use _PAWDEN or _ATMDEN_xxx files produced by prtden > 1 to chain the density output from one\ncalculation as the input to another, use the _DEN file for that.\n\n",
    "vartype": "integer parameter "
  },
  "prtdensph": {
    "category": "",
    "default": "0 except when antiferro-magnetism is activated (<a href=\"varbas.html#nsppol\">nsppol</a>=1, <a href=\"vargs.html#nspden\">nspden</a>=2).",
    "definition": "PRinT integral of DENsity inside atomic SPHeres",
    "section": "vargs",
    "text": "<p>\nWhen this flag is activated, values of integral(s) of total density inside sphere(s) around each atom are printed in output file (for each spin component).\nSpheres around atoms are defined by a radius given by <a href=\"vargs.html#ratsph\">ratsph</a> keyword.<br>\nNote: integral of density inside a sphere around an atom\ncan be used to determine a rough approximation of the local magnetic moment;\nthis is particulary useful for antiferromagnetic systems.\n<br>\nThe algorithm to compute this integral is particularly primitive : the points on the FFT grids, belonging\nto the interior of the sphere are determined, and the value of the functions on these points are summed,\ntaking into account a fixed volume attributed to each point.\nIn particular, the integral as a function of the radius will be a constant, except when\na new point enters the sphere, in which case a sudden jump occurs.\nHowever, since the purpose of this output is to get a rough idea of the repartition of the density,\nthis is not a real problem. If you are interested in a more accurate estimation\nof the density within a sphere, you should use the cut3d postprocessor.\n",
    "vartype": "integer parameter"
  },
  "prtdipole": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0 ",
    "definition": "PRinT DIPOLE",
    "section": "vardev",
    "text": "<p>\nPrint out dipole of unit cell, calculated in real space for the primitive cell only. Under development.\n",
    "vartype": "integer"
  },
  "prtdos": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the Density Of States ",
    "section": "varfil",
    "text": "<p>\nProvide output of Density of States if set to 1, 2 or 3.\nCan either use a smearing technique (<b>prtdos</b>=1),\nor the tetrahedron method (<b>prtdos</b>=2).\nIf <b>prtdos</b>=3, provide output of Local Density of States inside a sphere centered on an atom,\nas well as the angular-momentum projected DOS, in the same sphere. The resolution of the linear grid of energies\nfor which the DOS is computed can be tuned thanks to <a href=\"vargs.html#dosdeltae\">dosdeltae</a>.\n<p>\nIf <b>prtdos</b>=1, the smeared density of states is obtained\nfrom the eigenvalues, properly weighted at each k point\nusing <a href=\"varbas.html#wtk\">wtk</a>, and smeared according to <a href=\"varbas.html#occopt\">occopt</a>\nand <a href=\"vargs.html#tsmear\">tsmear</a>. All levels that are present in the calculation\nare taken into account (occupied and unoccupied).\nNote that <a href=\"varbas.html#occopt\">occopt</a> must be between 3 and 7 .\n<br> In order to compute the DOS of an insulator with <b>prtdos</b>=1, compute its density thanks to\na self-consistent calculation (with a non-metallic <a href=\"varbas.html#occopt\">occopt</a>\nvalue, 0, 1 or 2), then use <b>prtdos</b>=1, together\nwith <a href=\"varbas.html#iscf\">iscf</a>=-3, and a metallic <a href=\"varbas.html#occopt\">occopt</a>,\nbetween 3 and 7, providing the needed smearing.\nIf <b>prtdos</b>=1, the name of the DOS file is the root name for the output\nfiles, followed by \"_DOS\" .\n<p>\nIf <b>prtdos</b>=2, the DOS is computed using the tetrahedron method.\nAs in the case of <b>prtdos</b>=1, all levels that are present in the calculation\nare taken into account (occupied and unoccupied). In this case, the\nk-points must have been defined using the input variable <a href=\"varbas.html#ngkpt\">ngkpt</a>\nor the input variable <a href=\"vargs.html#kptrlatt\">kptrlatt</a>. There must be at least\ntwo non-equivalent points in the Irreducible Brillouin Zone to use  <b>prtdos</b>=2.\nIt is strongly advised to use a non-shifted k-point grid\n(<a href=\"varbas.html#shiftk\">shiftk</a> 0 0 0): such grids contain naturally\nmore extremal points (band minima and maxima at Gamma or at the zone-boundaries) than\nshifted grids, and lead to more non-equivalent points than shifted grids, for the same grid spacing.\n\nThere is no need to take care of\nthe <a href=\"varbas.html#occopt\">occopt</a> or <a href=\"vargs.html#tsmear\">tsmear</a> input variables,\nand there is no subtlety to be taken into account for insulators. The computation\ncan be done in the self-consistent case as well as in the non-self-consistent case,\nusing <a href=\"varbas.html#iscf\">iscf</a>=-3. This allows to refine the DOS at fixed\nstarting density.\n<br>In that case, if <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the potential file will be\nthe root output name, followed by _DOS (like in the <b>prtdos</b>=1 case).\n<br>However, if <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, potential files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name, </li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _DOS.</li>\n</ul>\n<p>\nIf <b>prtdos</b>=3, the same tetrahedron method as for <b>prtdos</b>=2 is used, but\nthe DOS inside a sphere centered on some atom is delivered, as well as the angular-momentum\nprojected (l=0,1,2,3,4) DOS in the same sphere. The preparation of this\ncase, the parameters under which the computation is to be done, and the file\ndenomination is similar\nto the <b>prtdos</b>=2 case. However, three additional input variables might be provided,\ndescribing the atoms that are the center of the sphere (input variables\n<a href=\"vargs.html#natsph\">natsph</a> and  <a href=\"vargs.html#iatsph\">iatsph</a>), as well as the radius of this\nsphere (input variable <a href=\"vargs.html#ratsph\">ratsph</a>).\n<br>\nIn case of PAW, <a href=\"vargs.html#ratsph\">ratsph</a> radius has to be greater or equal to\nlargest PAW radius of the atom types considered (which is read from the PAW atomic data file; see rc_sph or r_paw).\nAdditional printing and/or approximations in PAW mode can be controlled with <a href=\"varpaw.html#pawprtdos\">pawprtdos</a> keyword\n(in particular,<a href=\"varpaw.html#pawprtdos\">pawprtdos</a>=2 can be used to compute quickly a very good approximation of the DOS).\n<br><br>Note 1: when <b>prtdos</b>=3, it is possible to ouptut m-decomposed LDOS in _DOS file; simply use <a href=\"varfil.html#prtdosm\">prtdosm</a> keyword.\n<br>Note 2: the integrated total DOS in spheres around atoms can be obtained when\n<a href=\"vargs.html#prtdensph\">prtdensph</a> flag is activated.\nIt can be compared to the integrated DOS provided in _DOS file when <b>prtdos</b>=3.\n<p>\n<b>prtdos</b>=4 is possible for testing purpose.\n",
    "vartype": "integer parameter "
  },
  "prtdosm": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the Density Of States with M decomposition ",
    "section": "varfil",
    "text": "<p>\nRelevant only when <a href=\"varfil.html#prtdos\">prtdos</a>=3.\n<br>If set to 1, the m-decomposed LDOS is delivered in DOS file.\n<br>Note that <b>prtdosm</b> computes the M-resolved partial dos for complex spherical harmonics,giving e.g.\nDOS(L,M) == DOS(L,-M) (without spin-orbit). In the contrary, the LDA+U occupation matrix,\nsee <a href=\"varpaw.html#dmatpawu\">dmatpawu</a> is in the real spherical harmonics basis.\n<br>If set to 2, the m-decomposed LDOS is delivered in DOS file.\n<br>In this case, <b>prtdosm</b> computes the M-resolved partial dos for real spherical harmonics\nin the same basis as the LDA+U occupation matrix.\n",
    "vartype": "integer parameter "
  },
  "prtefg": {
    "category": "",
    "default": "0 ",
    "definition": "PRint Electric Field Gradient ",
    "section": "varpaw",
    "text": "i\n<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 1, calculate the electric field gradient at each atomic site in the unit cell. Using\nthis option requires <a href=\"varpaw.html#quadmom\">quadmom</a> to be set as well.\nValues written to main output file (search for Electric Field Gradient). If prtefg=1,\nonly the quadrupole coupling in MHz and asymmetry are reported. If prtefg=2, the full electric field\ngradient tensors in atomic units are also given, showing separate contributions from the valence\nelectrons, the ion cores, and the PAW reconstruction. If prtefg=3, then in addition to the prtefg=2 output,\nthe EFG's are computed using an ionic point charge model. This is useful for comparing the accurate PAW-based\nresults to those of simple ion-only models. Use of prtefg=3 requires that the variable\n<a href=\"varpaw.html#ptcharge\">ptcharge</a> be set as well.\n<br> The option prtefg is compatible with spin polarized calculations\n(see <a href=\"vargs.html#nspden\">nspden</a>) and also LDA+U (see <a href=\"varpaw.html#usepawu\">usepawu</a>).\n\n</li>\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "prteig": {
    "category": " ",
    "default": "1 (was 0 before v5.3), except when <a href=\"varrlx.html#nimage\">nimage</a>>1",
    "definition": "PRinT EIGenenergies ",
    "section": "varfil",
    "text": "<p>\nIf set to 1, a file *_EIG, containing the\nk-points and one-electron eigenvalues is printed.\n",
    "vartype": "integer parameter "
  },
  "prtelf": {
    "category": " ",
    "default": "0 ",
    "definition": "PRinT Electron Localization Function (ELF) ",
    "section": "varfil",
    "text": "<p>\nIf set to 1 or a larger value, provide output of ELF\nin real space elf(r). This is a dimensionless quantity bounded between 0 and 1.\n<br>The name of the ELF file will be the root output name, followed by _ELF.\n<br>Like a _DEN file, it can be analyzed by cut3d. However unlike densities, in case of spin polarized\ncalculations, the spin down component can not be obtained by substracting the spin up component to\nthe total ELF. Hence when spin polarized calculations are performed the code produces also output files with\n_ELF_UP and _ELF_DOWN extensions. (For technical reasons these files contain also two components but the second is zero.\nSo to perform analysis of _ELF_UP and _ELF_DOWN files with cut3d you have to answer \"ispden= 0 ==> Total density\"\nwhen cut3d ask you which ispden to choose. Also remember that spin down component can not be obtained by using cut3d on the _ELF file.\nSorry for the inconvenience, this will be fixed in the next release.)\n<br>\nELF is not yet implemented in non collinear spin case.\n<br>\nIf prtelf is set to 2, in the case of spin polarized calculation, the total ELF is computed from an alternative approach which should better take into account the existence of spin dependent densities (see the documentation in /doc/theory/ELF of your ABINIT repository)\n<br>\n<br>Please note that ELF is <b>not</b> yet implemented in the case of PAW (<a href=\"varint.html#usepaw\">usepaw</a>=1) calculations.\n",
    "vartype": "integer parameter "
  },
  "prtfc": {
    "category": "",
    "default": "0 ",
    "definition": "PRinT Fermi Contact term ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 1,  print the Fermi contact interaction at each nuclear site, that is,\nthe electron density at each site. The result appears in the main output file (search for FC).\nNote that this calculation is different than what is done by cut3d, because it also computes the\nPAW on-site corrections in addition to the contribution from the valence pseudo-wavefunctions.\n</li>\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "prtfsurf": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT Fermi SURFace file ",
    "section": "varfil",
    "text": "<p>\nIf set to 1, provide Fermi surface file in the BXSF format (Xcrysden)\nIf <b>prtfsurf</b>=1, a _BXSF file readable by <a href=\"http://www.xcrysden.org\">XCrySDen</a> will\nbe produced at the end of the calculation. The file contains information on the band structure\nof the system and can be used to visualize the Fermi surface or any other energy isosurface.\n<b>prtfsurf</b>=1 is compatible only with SCF calculations\n(<a href=\"varbas.html#iscf\">iscf</a> > 1) or NSCF runs in which the\noccupation factors and Fermi level are recalculated once convergence is achieved (<a href=\"varbas.html#iscf\">iscf</a> = -3).\nThe two methods should produce the same Fermi surface provided that the k-meshes are sufficiently dense.\nThe k-mesh used for the sampling of the Fermi surface can be specified using the standard\nvariables <a href=\"varbas.html#ngkpt\">ngkpt</a>, (<a href=\"varbas.html#shiftk\">shiftk</a>, and <a href=\"varbas.html#nshiftk\">nshiftk</a>.\nNote, however, that the mesh must be homogeneous and centered on gamma (multiple shifts are not supported by Xcrysden)\n",
    "vartype": "integer parameter "
  },
  "prtgden": {
    "category": " ",
    "default": "0. ",
    "definition": "PRinT the Gradient of electron DENsity ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of gradient of electron density\nin real space grho(r), in units of Bohr^-(5/2).\n<br>The names of the gradient of electron density files will be the root output name,\nfollowed by _GDEN1, _GDEN2, GDEN3 for each principal direction (indeed it is a vector).\n<br>Like a _DEN file, it can be analyzed by cut3d. The file structure of the unformatted output file is\ndescribed below, see section 6).\n",
    "vartype": "integer parameter "
  },
  "prtgeo": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the GEOmetry analysis  ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of geometrical analysis\n(bond lengths and bond angles). The value\nof <b>prtgeo</b> is taken by the code to be the\nmaximum coordination number of atoms in the system.\n<br>It will deduce a maximum number of \"nearest\" and \"next-nearest\"\nneighbors accordingly , and compute corresponding bond lengths.\n<br>It will compute bond angles for the \"nearest\" neighbours only.\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the file will be\nthe root output name, followed by _GEO .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, one file will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name,</li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _GEO</li>\n</ul>\nThe content of the file should be rather self-explanatory.\n<br>No output is provided by <b>prtgeo</b> is lower than or equal to 0.\n<br>If <b>prtgeo</b>>0, the maximum number of atoms (<a href=\"varbas.html#natom\">natom</a>) is 9999.",
    "vartype": "integer parameter "
  },
  "prtgkk": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the GKK matrix elements file  ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of electron-phonon\n\"gkk\" matrix elements, for further treatment by mrggkk utility or anaddb utility.\nAdditional information on electron-phonon treatment in ABINIT is given in ~abinit/doc/users/elphon_manual.ps .\n",
    "vartype": "integer parameter "
  },
  "prtkden": {
    "category": " ",
    "default": "0. ",
    "definition": "PRinT the Kinetic energy DENsity ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value , provide output of kinetic energy density\nin real space tau(r), in units of Bohr^-5.\n<br>The name of the kinetic energy density file will be the root output name, followed by _KDEN.\n<br>Like a _DEN file, it can be analyzed by cut3d. The file structure of the unformatted output file is\ndescribed below, see section 6).\n<br>Note that the computation of the kinetic energy density must be activate, thanks to the input variable <a href=\"vargs.html#usekden\">usekden</a>.\n<br>Please note that kinetic energy density is <b>not</b> yet implemented in the case of PAW (<a href=\"varint.html#usepaw\">usepaw</a>=1) calculations.\n",
    "vartype": "integer parameter "
  },
  "prtkpt": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the K-PoinTs sets  ",
    "section": "varfil",
    "text": "<p>\nIf set /= 0 , proceeds to a detailed analysis\nof different k point grids. Works only if\n<a href=\"varbas.html#kptopt\">kptopt</a> is positive, and neither\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nnor\n<a href=\"varbas.html#ngkpt\">ngkpt</a> are defined.\nABINIT will stop after this analysis.\n\n<p>Different sets of k point grids are defined,\nwith common values of <a href=\"varbas.html#shiftk\">shiftk</a>.\nIn each set, ABINIT increases the length of vectors of the\nsupercell (see <a href=\"vargs.html#kptrlatt\">kptrlatt</a>) by integer\nsteps. The different sets are labelled by \"iset\".\nFor each k point grid,  <a href=\"vargs.html#kptrlen\">kptrlen</a>\nand  <a href=\"varbas.html#nkpt\">nkpt</a> are computed (the latter always\ninvoking  <a href=\"varbas.html#kptopt\">kptopt</a>=1, that is, full use of\nsymmetries). A series is finished when the computed\n<a href=\"vargs.html#kptrlen\">kptrlen</a> is twice larger than the\ninput variable <a href=\"vargs.html#kptrlen\">kptrlen</a>.\nAfter the examination of the different sets,\nABINIT summarizes, for each <a href=\"varbas.html#nkpt\">nkpt</a>, the\nbest possible grid, that is, the one with the\nlargest computed <a href=\"vargs.html#kptrlen\">kptrlen</a>.\n\n<p>Note that this analysis is also performed when\n<b>prtkpt</b>=0, as soon as neither <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nnor\n<a href=\"varbas.html#ngkpt\">ngkpt</a> are defined. But, in this case,\nno analysis report is given, and the code selects the grid\nwith the smaller <a href=\"varbas.html#ngkpt\">ngkpt</a>\nfor the desired <a href=\"vargs.html#kptrlen\">kptrlen</a>. However,\nthis analysis takes some times (well sometimes,\nit is only a few seconds - it depends on the value of\nthe input <a href=\"vargs.html#kptrlen\">kptrlen</a>), and it is better\nto examine the full analysis for a given cell and set of symmetries,\n<a href=\"varbas.html#shiftk\">shiftk</a> for all the production runs.\n",
    "vartype": "integer parameter "
  },
  "prtlden": {
    "category": " ",
    "default": "0. ",
    "definition": "PRinT the Laplacian of electron DENsity ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of Laplacian of electron density\nin real space grho(r), in units of Bohr^-(7/2).\n<br>The name of the Laplacian of electron density file will be the root output name,\nfollowed by _LDEN.\n<br>Like a _DEN file, it can be analyzed by cut3d. The file structure of the unformatted output file is\ndescribed below, see section 6).\n",
    "vartype": "integer parameter "
  },
  "prtnabla": {
    "category": "",
    "default": "0 ",
    "definition": "PRint NABLA ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1.\n<ul>\n<li> If set to 1, calculate the matrix elements &lt;Psi_n|-inabla|Psi_m&gt; and write it in file _OPT to be read by the code conducti. </li>\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "prtnest": {
    "category": " DEVELOP",
    "default": "0 ",
    "definition": "PRinT NESTing function",
    "section": "vardev",
    "text": "<p>\nIf set to 1, the nesting function for the k-point grid is printed. For the moment the path in q space for the nesting function is fixed, but will become an input as well.\n",
    "vartype": "integer flag"
  },
  "prtposcar": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0 ",
    "definition": "PRinT POSCAR file",
    "section": "vardev",
    "text": "<p>\nPrint out VASP-style POSCAR and FORCES files, for use with PHON or frophon codes for frozen phonon calculations.\nSee the associated script in ~abinit/extras/post_processing/phondisp2abi.py for further details on interfacing\nwith PHON, PHONOPY, etc...\n",
    "vartype": "integer"
  },
  "prtpot": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the iotal (kohn-sham)POTential ",
    "section": "varfil",
    "text": "<p>\nIf set >=1 , provide output of different\npotentials.\n<br>For <b>prtpot</b>, output the total (Kohn-Sham) potential,\nsum of local pseudo-potential, Hartree potential, and xc potential.\n<br>For <b>prtvha</b>, output the Hartree potential.\n<br>For <b>prtvhxc</b>, output the\nsum of Hartree potential and xc potential.\n<br>For <b>prtvxc</b>, output the exchange-correlation potential.\n\n<p>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the potential file will be\nthe root output name, followed by _POT, _VHA, _VHXC, or _VXC .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, potential files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name, </li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _POT, _VHA, _VHXC, or _VXC.</li>\n</ul>\nThe file structure of this unformatted output file is\ndescribed in <a href=\"../users/abinit_help.html#localpotfile\">section 6.6</a> of abinit_help.\nNo output is provided by a negative value of these variables.\n",
    "vartype": "integer parameter "
  },
  "prtspcur": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the SPin CURrent density ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of the current density of\ndifferent direction spins (x,y,z) in the whole unit cell. Should require spinorial wave functions\n<a href=\"vargs.html#nspinor\"><b>nspinor</b></a> = 2. Experimental: this does not work yet.\n",
    "vartype": "integer parameter "
  },
  "prtstm": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT the STM density ",
    "section": "varfil",
    "text": "<p>\nIf set to 1  or a larger value, provide output of the electron density\nin real space rho(r), made only from the electrons\nclose to the Fermi energy, in a range of energy (positive or negative), determined\nby the (positive or negative, but non-zero) value of the STM bias <a href=\"vargs.html#stmbias\">stmbias</a>.\n<br>This is a very approximate way to obtain STM profiles : one can choose an equidensity surface,\nand consider that the STM tip will follow this surface. Such equidensity surface might be determined\nwith the help of Cut3D, and further post-processing of it (to be implemented). The big approximations\nof this technique are : neglect of the finite size of the tip, and\nposition-independent transfer matrix elements\nbetween the tip and the surface.\n<br>The charge density is provided in units of electrons/Bohr^3.\nThe name of the STM density file will be the root output name, followed by _STM .\nLike a _DEN file, it can be analyzed by cut3d.\nThe file structure of this unformatted output file is\ndescribed in <a href=\"../users/abinit_help.html#densoutputfile\">section 6.5</a> of abinit_help.\n<br>For the STM charge density to be generated, one must give, as an input file, the\nconverged wavefunctions obtained from a previous run, at exactly the same k-points and cut-off energy,\nself-consistently determined, using the occupation numbers from <a href=\"varbas.html#occopt\">occopt</a>=7.\n<br>In the run with positive <b>prtstm</b>, one has to use :\n<ul>\n<li>positive <a href=\"varbas.html#iscf\">iscf</a> </li>\n<li> <a href=\"varbas.html#occopt\">occopt</a>=7, with specification of <a href=\"vargs.html#tsmear\">tsmear</a> </li>\n<li> <a href=\"varbas.html#nstep\">nstep</a>=1 </li>\n<li> the <a href=\"varbas.html#tolwfr\">tolwfr</a> convergence criterion</li>\n<li> <a href=\"varrlx.html#ionmov\">ionmov</a>=0 (this is the default value)</li>\n<li> <a href=\"vargs.html#optdriver\">optdriver</a>=0 (this is the default value)</li>\n</ul>\n<br>Note that you might have to adjust the value of <a href=\"varbas.html#nband\">nband</a>\nas well, for the treatment of unoccupied states, because the automatic determination\nof <a href=\"varbas.html#nband\">nband</a> will often not include enough unoccupied\nstates.\n<br>When <b>prtstm</b> is non-zero, the stress tensor is set to zero.\n<br>No output of _STM file is provided by <b>prtstm</b> lower or equal to 0.\n<br>No other printing variables for density or potentials should be activated (e.g. <a href=\"varfil.html#prtden\">prtden</a> has to be set to zero).\n",
    "vartype": "integer parameter "
  },
  "prtsuscep": {
    "category": " ",
    "default": "1.",
    "definition": "PRinT the SUSCEPtibility file (the irreducible polarizability)",
    "section": "varfil",
    "text": "<p>\nIf set to 0, no _SUSC file will be produced after the screening calculation,\nonly the _SCR file will be output.\n",
    "vartype": "integer parameter "
  },
  "prtvdw": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>",
    "default": "0 ",
    "definition": "PRinT Van Der Waals file",
    "section": "vardev",
    "text": "Print out a NetCDF file containing a vdW-DF kernel.\n<!-- See the associated script in\n~abinit/extras/post_processing/vdw_check_kernel for further details. -->\n",
    "vartype": "integer"
  },
  "prtvha": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT V_HArtree ",
    "section": "varfil",
    "text": "<p>\nIf set >=1 , provide output of different\npotentials.\n<br>For <b>prtpot</b>, output the total (Kohn-Sham) potential,\nsum of local pseudo-potential, Hartree potential, and xc potential.\n<br>For <b>prtvha</b>, output the Hartree potential.\n<br>For <b>prtvhxc</b>, output the\nsum of Hartree potential and xc potential.\n<br>For <b>prtvxc</b>, output the exchange-correlation potential.\n\n<p>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the potential file will be\nthe root output name, followed by _POT, _VHA, _VHXC, or _VXC .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, potential files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name, </li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _POT, _VHA, _VHXC, or _VXC.</li>\n</ul>\nThe file structure of this unformatted output file is\ndescribed in <a href=\"../users/abinit_help.html#localpotfile\">section 6.6</a> of abinit_help.\nNo output is provided by a negative value of these variables.\n",
    "vartype": "integer parameter "
  },
  "prtvhxc": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT V_(Hartree+XC) ",
    "section": "varfil",
    "text": "<p>\nIf set >=1 , provide output of different\npotentials.\n<br>For <b>prtpot</b>, output the total (Kohn-Sham) potential,\nsum of local pseudo-potential, Hartree potential, and xc potential.\n<br>For <b>prtvha</b>, output the Hartree potential.\n<br>For <b>prtvhxc</b>, output the\nsum of Hartree potential and xc potential.\n<br>For <b>prtvxc</b>, output the exchange-correlation potential.\n\n<p>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the potential file will be\nthe root output name, followed by _POT, _VHA, _VHXC, or _VXC .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, potential files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name, </li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _POT, _VHA, _VHXC, or _VXC.</li>\n</ul>\nThe file structure of this unformatted output file is\ndescribed in <a href=\"../users/abinit_help.html#localpotfile\">section 6.6</a> of abinit_help.\nNo output is provided by a negative value of these variables.\n",
    "vartype": "integer parameter "
  },
  "prtvol": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT VOLume ",
    "section": "varfil",
    "text": "<p>\nControl the volume of printed output.\n<br>Standard choice is 0. Positive values print more in the\noutput and log files, while negative values are\nfor debugging (or preprocessing only), and cause\nthe code to stop at some point.\n<ul>\n<li>0 => there is a limit on the number of k-points\nfor which related information will be written. This\nlimit is presently 50. Due to some subtlety, if for <b>some</b> dataset\n<b>prtvol</b> is non-zero, the limit for input and output echoes\ncannot be enforced, so it is like if <b>prtvol</b>=1 for\n<b>all</b> the datasets for which <b>prtvol</b> was set to 0.\nAlso, if <a href=\"varbas.html#iscf\">iscf</a>=-2 and\n<a href=\"varbas.html#kptopt\">kptopt</a>&lt;=0,\nthe eigenvalues for all the k points are printed anyway.</li>\n<li>1 => there is no such limit for the input\nand output echoes, in the main output file. Also, if <a href=\"varbas.html#iscf\">iscf</a>=-2 and\n<a href=\"varbas.html#kptopt\">kptopt</a>&lt;=0, the eigenvalues for all the k points are printed anyway.</li>\n<li>2 => there is no such limit in the whole main output file.</li>\n<li>3 => there is no such limit in both output and log files.</li>\n<li>10 => no limit on the number of k points, and moreover,\nthe eigenvalues are printed for every SCF iteration,\nas well as other additions (to be specified in the future...)</li>\n</ul>\nDebugging options :\n<ul>\n<li>= -1 => stop in abinit (main program), before call gstate.\nUseful to see the effect of the preprocessing of\ninput variables (memory needed, effect of symmetries,\nk points ...) without going further. Run very fast,\non the order of the second.\n<li>=-2 => same as -1, except that print only the first dataset.\nAll the non default input variables associated to all datasets\nare printed in the output file, but only for the first dataset.\nAlso all the input variables are written in the NetCDF file\n\"OUT.nc\", even if the value is the default.\n</li>\n<li>= -3 => stop in gstate, before call scfcv, move or brdmin.\nUseful to debug pseudopotentials</li>\n<li>= -4 => stop in move, after completion of all loops</li>\n<li>= -5 => stop in brdmin, after completion of all loops</li>\n<li>= -6 => stop in scfcv, after completion of all loops</li>\n<li>= -7 => stop in vtorho, after the first rho is obtained</li>\n<li>= -8 => stop in vtowfk, after the first k point is treated</li>\n<li>= -9 => stop in cgwf, after the first wf is optimized </li>\n<li>= -10 => stop in getghc, after the Hamiltonian is applied once</li>\n</ul>\nThis debugging feature is not yet activated in the RF routines.\nNote that <a href=\"vardev.html#fftalg\">fftalg</a> offers\nanother option for debugging.",
    "vartype": "integer parameter "
  },
  "prtvolimg": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT VOLume for IMaGes ",
    "section": "varfil",
    "text": "<p>\nControl the volume of printed output\nwhen an algorithm using images of the cell is used (<a href=\"varrlx.html#nimage\">nimage</a>>1).<br>\nWhen such an algorithm is activated, the printing volume (in output file)\ncan be large and difficult to read.<br>\nUsing <b>prtvolimg=1</b>, the printing volume, for each image,\nis reduced to unit cell, atomic positions, total energy, forces, stresses, velocities\nand convergence residuals.<br>\nUsing <b>prtvolimg=2</b>, the printing volume, for each image,\nis reduced to total energy and convergence residuals only.\n",
    "vartype": "integer parameter "
  },
  "prtvxc": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT V_XC ",
    "section": "varfil",
    "text": "<p>\nIf set >=1 , provide output of different\npotentials.\n<br>For <b>prtpot</b>, output the total (Kohn-Sham) potential,\nsum of local pseudo-potential, Hartree potential, and xc potential.\n<br>For <b>prtvha</b>, output the Hartree potential.\n<br>For <b>prtvhxc</b>, output the\nsum of Hartree potential and xc potential.\n<br>For <b>prtvxc</b>, output the exchange-correlation potential.\n\n<p>If <a href=\"varrlx.html#ionmov\">ionmov</a>==0, the name of the potential file will be\nthe root output name, followed by _POT, _VHA, _VHXC, or _VXC .\n<br>If <a href=\"varrlx.html#ionmov\">ionmov</a>==1 or 2, potential files will be output\nat each time step, with the name being made of\n<ul>\n<li> the root output name, </li>\n<li> followed by _TIMx , where\nx is related to the timestep (see later)</li>\n<li> then followed by _POT, _VHA, _VHXC, or _VXC.</li>\n</ul>\nThe file structure of this unformatted output file is\ndescribed in <a href=\"../users/abinit_help.html#localpotfile\">section 6.6</a> of abinit_help.\nNo output is provided by a negative value of these variables.\n",
    "vartype": "integer parameter "
  },
  "prtwant": {
    "category": " ",
    "default": "0.",
    "definition": "PRinT WANT file ",
    "section": "varfil",
    "text": "<p>\nFlag used to indicate that either the Wannier90 or the WanT interfaces\nwill be used.\n<ul>\n<li> =1 => Use the <b>ABINIT- WanT </b> interface.<p>\nProvide an output file that can be used by the WanT postprocessing\nprogram (see http://www.wannier-transport.org).\nThe value of the prtwant indicates the version of the WanT code that\ncan read it. Currently only the value <b>prtwant</b>=1 is implemented,\ncorresponding to WanT version 1.0.1, available since Oct. 22, 2004.\n<p>\nNotes : Several requirements must be\nfulfilled by the wavefunction. Among them, two are mandatory:\n<br>\n<ul>\n<li>1. An uniform grid of k-points, including the GAMMA point must be used.</li>\n<li>2. The use of time reversal symmetry is not allowed (istwfk=1) </li>\n<li>3. The list of k-points must be ordered, such that the coordinates,\nnamely three-components vectors has the third index varying the most\nrapidly, then the second index, then the first index </li>\n</ul>\nIf these requirement are not fulfilled, the program will stop and an error message is returned.\n<p>\nAs an example of k-point grid in case of systems that have some 3D character (1D systems are easy) :\n<pre>\nnkpt 8\nkpt  0   0   0\n0   0   1/2\n0   1/2 0\n0   1/2 1/2\n1/2 0   0\n1/2 0   1/2\n1/2 1/2 0\n1/2 1/2 1/2\nistwfk 8*1\n</pre>\n<p>\nAlso, in order to use WanT as a postprocessing program for ABINIT you might have to\nrecompile it with the appropriate flags (see ABINIT makefile). Up to now only\nthe -convert big-endian was found to be mandatory, for machines with little-endian default choice.\n<p>\nIf set = 2, provide an output file that can be used by the wannier90 postprocessing\nprogram in next versions\n<li>=2 => Use the <b>ABINIT- Wannier90 </b> interface.<p>\nABINIT will produce the input files required by Wannier90  and it will\nrun Wannier90 to produce the Maximally-locallized Wannier functions\n(see <a href=\"http://www.wannier.org\">\nhttp://www.wannier.org </a> ).\n\n<p>Notes:\n\n<ul>\n<li>The files that are created can also be used by Wannier90 in\nstand-alone mode.\n<li>\nIn order to use Wannier90 as a postprocessing program for ABINIT you\nmight have to recompile it with the appropriate flags (see ABINIT\nmakefile). You might use ./configure --enable-wannier90\n<li>\nThere are some other variables related to the interface of Wannier90\nand ABINIT. See, <a href=\"varw90.html\">VARW90</a>.\n</ul>\n<p>\n\n<li>=3 => Use the <b>ABINIT- Wannier90 </b> interface after converting the\ninput wavefunctions to <b>GW quasiparticle</b> wavefunctions.<p>\nABINIT will produce the input files required by Wannier90  and it will\nrun Wannier90 to produce the Maximally-locallized Wannier functions\n(see <a href=\"http://www.wannier.org\">\nhttp://www.wannier.org </a> ).\n\n<p>Additional Notes:\n\n<ul>\n<li>An input file of LDA wave functions is required which is completely\nconsistent with the _KSS file used in the self-consistent GW calculation.\nThis means that <a href=\"varfil.html#kssform\">kssform</a> 3 must be used\nto create the _KSS file and the output _WFK file from the same run must\nbe used as input here.\n<li>Wannier90 requires <a href=\"varbas.html#nshiftk\">nshiftk</a>=1, and\n<a href=\"varbas.html#shiftk\">shiftk</a>= 0 0 0 is recommended.  The k-point\nset used for the GW calculation, typically the irreducible BZ set created\nusing <a href=\"varbas.html#kptopt\">kptopt</a>=1, and that for the Abinit-\nWannier90 interface must be consistent.\n<li>Full-BZ wavefunctions should be generated in the run calling the\ninterface by setting <a href=\"varbas.html#kptopt\">kptopt</a>=3,\n<a href=\"varbas.html#iscf\">iscf</a>=-2, and\n<a href=\"varbas.html#nstep\">nstep</a>=3.  This will simply use symmetry to\ntransform the input IBZ wavefunctions to the full BZ set, still consistent\nwith the GW _KSS input.\n<li>The final _QPS file created by the self-consistent GW run is required\nas input.\n<li>Any value of <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a> between\nbetween 20 and 29 should be suitable, so, for example, Hartree-Fock\nmaximally-localized Wannier functions could be generated setting\n<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>=25.\n\n</ul>\n\n\n</ul>\n\n",
    "vartype": "integer parameter "
  },
  "prtwf": {
    "category": " ",
    "default": "1, except when <a href=\"varrlx.html#nimage\">nimage</a>>1",
    "definition": "PRinT the WaveFunction ",
    "section": "varfil",
    "text": "<p>\nIf <b>prtwf</b>=1 , provide output of wavefunction\nand eigenvalue file, as described in\n<a href=\"../users/abinit_help.html#wavefctfile\">section 6.7</a> of the main abinit help file.\n<br>For a standard ground-state calculation, the name of the wavefunction file will be\nthe root output name, followed by _WFK. If <a href=\"vargs.html#nqpt\">nqpt</a>=1,\nthe root name will be followed by _WFQ. For response-function calculations,\nthe root name will be followed by _1WFx, where x is the number of the perturbation.\nThe dataset information will be added as well, if relevant.\n<br>No wavefunction output is provided by <b>prtwf</b>=0.\n<p>\n<br>If <b>prtwf</b>=2, a file pwfn.data is produced, to be used as input for the\nCASINO QMC code. See more explanation at the end of this section.\n<br>If <b>prtwf</b>=3, the file that is created is nearly the same as with <b>prtwf</b>=1,\nexcept that the records that should contain the wavefunction is empty (so, such records exist, but store nothing).\nThis is useful to generate size-reduced DDK files,\nto perform an optic run. Indeed, in the latter case, only matrix elements are needed [so, no wavefunction], but possibly\na large number of conduction bands, so that the DDK file might be huge if it contains the wavefunctions.\n\n<p>Further explanation for the <b>prtwf</b>=2 case. To produce a wave function suitable for use as a CASINO trial wave\nfunction, certain ABINIT parameters must be set correctly. Primarily,\nCASINO (and QMC methods generally) can only take advantage of\ntime-reversal symmetry, and not the full set of symmetries of the crystal\nstructure. Therefore, ABINIT must be instructed to generate k-points not\njust in the Irreducible Brillouin Zone, but in a full half of the\nBrillouin Zone (using time-reversal symmetry to generate the other half).\nAdditionally, unless instructed otherwise, Abinit avoids the need for\ninternal storage of many of the coefficients of its wave functions for\nk-points that have the property 2k=G_latt, where G_latt is a reciprocal\nlattice vector, by making use of the property that\nc_k(G)=c^*_k(-G-G_latt). Abinit must be instructed not to do this in order\nto output the full set of coefficients for use in CASINO. See the ABINIT\ntheoretical background documents ABINIT/Infos/Theory/geo.pdf and\nABINIT/Infos/Theory/1WF.pdf for more information.\n<br>\nThe first of these requirements is met by setting the ABINIT input\nvariable kptopt to 2 (see ABINIT/Infos/varbas.html#kptopt) and the second\nby setting istwfk to 1 for all the k points (see\nABINIT/Infos/vardev.html#istwfk). Since CASINO is typically run with\nrelatively small numbers of k-points, this is easily done by defining an\narray of 1's in the input file.\n<br>\nFor example, for the 8 k-points generated with ngkpt 2 2 2, we add the\nfollowing lines to the input file:\n<pre>\n# Turn off special storage mode for time-reversal k-points\nistwfk 1 1 1 1 1 1 1 1\n# Use only time reversal symmetry, not full set of symmetries.\nkptopt 2\n</pre>\nOther useful input variables of relevance to the plane waves ABINIT will\nproduce include ecut, nshiftk, shiftk, nband, occopt, occ, spinat and\nnsppol (see relevant input variable documents in ABINIT/Infos/). If ABINIT\nis run in multiple dataset mode, the different wave functions for the\nvarious datasets are exported as pwfn1.data, pwfn2.data, ..., pwfnn.data\nwhere the numbers are the contents of the contents of the input array\njdtset (defaults to 1,2,...,ndtset).\n<br>\nOnce the routine is incorporated into the ABINIT package it is anticipated\nthat there will be an input variable to control whether or not a CASINO\npwfn.data file is written.\n<p>\nOther issues related to <b>prtwf</b>=2.\n<br>\nThe exporter does not currently work when ABINIT is used in parallel mode\non multiple processors if k-point parallelism is\nchosen. ABINIT does not store the full wave function on each processor but\nrather splits the k-points between the processors, so no one processor\ncould write out the whole file. Clearly this could be fixed but we haven't\ndone it yet. The sort of plane wave DFT calculations usually required to\ngenerate QMC trial wave functions execute very rapidly anyway and will\ngenerally not require a parallel machines. The outqmc routine currently\nbails out with an error if this combination of modes is selected - this\nwill hopefully be fixed later.\n<br>\nThere has not been very extensive testing of less common situations such\nas different numbers of bands for different k-points, and more complicated\nspin polarized systems, so care should be taken when using the output in\nthese circumstances.\n<br>\nIf there is any doubt about the output of this routine, the first place to\nlook is the log file produced by ABINIT: if there are any warnings about\nincorrectly normalized orbitals or non-integer occupation numbers there is\nprobably something set wrong in the input file.\n\n\n",
    "vartype": "integer parameter "
  },
  "prtxml": {
    "category": " ",
    "default": "0",
    "definition": "PRinT an XML output",
    "section": "varfil",
    "text": "<p>\nCreate an XML output with common values. The corresponding\nDTD is distributed in sources as extras/post_processing/abinitRun.dtd. All the DTD is not\nyet implemented and this one is currently restricted to ground computations\n(and derivative such as geo optimisation).",
    "vartype": "0 or 1  "
  },
  "ptcharge": {
    "category": "",
    "default": "0",
    "definition": "PoinT CHARGEs ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#prtefg\">prtefg</a> = 3 or greater.<br>\n<ul>\n<li> Array of point charges, in atomic units, of the nuclei. In the normal computation of electric field gradients\n(see <a href=\"varpaw.html#prtefg\">prtefg</a>) the ionic contribution is calculated from the core charges of the atomic\nsites. Thus for example in a PAW data set for oxygen where the core is 1s2, the core charge is +6 (total nuclear charge\nminus core electron charge). In point charge models, which are much less accurate than PAW calculations, all atomic sites\nare treated as ions with charges determined by their valence states. In such a case oxygen almost always would have a\npoint charge of -2. The present variable taken together with <a href=\"varpaw.html#prtefg\">prtefg=3</a> performs a full\nPAW computation of the electric field gradient and also a simple point charge computation. The user inputs whatever\npoint charges he/she wishes for each atom type.\n</li>\n</ul>\n\n",
    "vartype": "real array ptcharge(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "ptgroupma": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>, <a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "0.",
    "definition": "PoinT GROUP number for the MAgnetic space group",
    "section": "vargeo",
    "text": "<p>\nThis internal variable characterizes a Shubnikov type III magnetic space group (anti-ferromagnetic\nspace group). The user is advised to consult\n\"The mathematical theory of symmetry in solids,\nRepresentation theory for point groups and space groups, 1972,\nC.J. Bradley and A.P. Cracknell, Clarendon Press, Oxford.\"\n<br>A Shubnikov type III magnetic space group might be defined by its Fedorov space group\n(set of all spatial symmetries, irrespective of their magnetic action), and\nthe halving space group (only the symmetries that do not change the magnetisation).\n<br>The specification of the halving space group might be done by specifying, for each\npoint symmetry, the magnetic action. See Table 7.1 of the above-mentioned reference.\nMagnetic point groups are numbered from 1 to 58.\n<p> Related input variables :\n<a href=\"vargeo.html#spgroup\">spgroup</a>,\n<a href=\"vargeo.html#spgroupma\">spgroupma</a>,\n<a href=\"vargeo.html#genafm\">genafm</a>\n",
    "vartype": "integer parameter "
  },
  "qmass": {
    "category": "",
    "default": "nnos*10.0 ",
    "definition": "Q thermostat mass ",
    "section": "varrlx",
    "text": "<p>\nThis are the masses of the chains of <a href=\"varrlx.html#nnos\">nnos</a> thermostats to be used when <a href=\"varrlx.html#ionmov\">ionmov</a>=13. </font>\n<p>\nThis temperature control can be used with&nbsp; <a\nhref=\"varrlx.html#optcell\">optcell</a>==0, 1 (homogeneous cell\ndeformation) or 2 (full cell deformation)\n",
    "vartype": "real array qmass(<a href=\"varrlx.html#nnos\">nnos</a>) "
  },
  "qprtrb": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 0 0.",
    "definition": "Q-wavevector of the PERTurbation ",
    "section": "varff",
    "text": "<p>\nGives the wavevector,\nin units of reciprocal lattice primitive translations,\nof a perturbing potential of strength vprtrb.  See vprtrb\nfor more explanation.",
    "vartype": "integer array of three values"
  },
  "qpt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 0 0.",
    "definition": "Q PoinT ",
    "section": "vargs",
    "text": "<p>\nOnly used if <a href=\"vargs.html#nqpt\">nqpt</a>=1.\n<p>\nCombined with <a href=\"vargs.html#qptnrm\">qptnrm</a>,\ndefine the q vector <a href=\"varint.html#qptn\">qptn</a>(1:3)\nin the case <a href=\"vargs.html#qptopt\">qptopt</a>=0.\n<p>This input variable is not internal (<a href=\"varint.html#qptn\">qptn</a>(1:3) is used\ninstead), but is used to echo the value of <a href=\"varint.html#qptn\">qptn</a>(1:3),\nwith renormalisation factor one.\n",
    "vartype": "real array of 3 elements  "
  },
  "qptdm": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0. 0. 0. (for just one q-point)",
    "definition": "Q-PoinTs for the Dielectric Matrix",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations,\nand only if <a href=\"vargw.html#nqptdm\">nqptdm</a>/=0.\n<p>\n<b>qptdm</b> contains the set of q-points used in the screening part of ABINIT,\ninstead of the automatic generation of the q points when <a href=\"vargw.html#nqptdm\">nqptdm</a>=0.\nThese q points are given in terms of reciprocal space primitive translations (NOT in cartesian coordinates!).\nFor further explanation, see the input variable <a href=\"vargw.html#nqptdm\">nqptdm</a>.\n",
    "vartype": "real array qptdm(3,<a href=\"vargw.html#nqptdm\">nqptdm</a>)  "
  },
  "qptn": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "",
    "definition": "Q-PoinT re-Normalized ",
    "section": "varint",
    "text": "<p>\nOnly used if <a href=\"vargs.html#nqpt\">nqpt</a>=1.\n<br>In ground-state calculation,\nthe vector <b>qptn</b>(1:3) is added to\neach renormalized k point (whatever the value of\n<a href=\"varbas.html#kptopt\">kptopt</a> that was used)\nto generate the normalized, shifted, set of k-points\n<a href=\"varint.html#kptns\">kptns</a>(1:3,1:<b>nkpt</b>).\n<br>In response-function calculations,\n<b>qptn</b>(1:3)\nis the wavevector of the phonon-type calculation.\n<br><b>qptn</b>(1:3) can be produced on the basis of\nthe different methods described in <a href=\"vargs.html#qptopt\">qptopt</a>,\nlike using <a href=\"vargs.html#qpt\">qpt</a>(1:3)\nwith renormalisation provided by <a href=\"vargs.html#qptnrm\">qptnrm</a>,\nor using the other possibilities defined by\n<a href=\"vargs.html#iqpt\">iqpt</a>,\n<a href=\"vargs.html#ngqpt\">ngqpt</a>,\n<a href=\"vargs.html#nshiftq\">nshiftq</a>,\n<a href=\"vargs.html#qptrlatt\">qptrlatt</a>,\n<a href=\"vargs.html#shiftq\">shiftq</a>,\n<br>For insulators, there is no restriction on the\nq-points to be used for the perturbations. By contrast,\nfor metals, for the time being, it is advised to take\nq points for which the k and k+q grids are the same\n(when the periodicity in reciprocal space is taken\ninto account). <br>Tests remain to be done to see whether\nother q points might be allowed (perhaps with some\nmodification of the code).",
    "vartype": "real array <b>qptn</b>(3) "
  },
  "qptnrm": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "1.0  ",
    "definition": "Q PoinTs NoRMalization ",
    "section": "vargs",
    "text": "<p>\nOnly used if <a href=\"vargs.html#nqpt\">nqpt</a>=1 and <a href=\"vargs.html#qptopt\">qptopt</a>=0\n<p>\nProvides re-normalization\nof <a href=\"vargs.html#qpt\">qpt</a>.\nMust be positive, non-zero.\nThe actual q vector (renormalized) is\n<a href=\"varint.html#qptn\">qptn</a>(1:3)=\n<a href=\"vargs.html#qpt\">qpt</a>(1:3)/<b>qptnrm</b>.\n",
    "vartype": "real parameter  "
  },
  "qptopt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0 .",
    "definition": "QPoinTs OPTion ",
    "section": "vargs",
    "text": "<p>\nOnly used if <a href=\"vargs.html#nqpt\">nqpt</a>=1.\n<p>\nControls the set up to generate the Q point\n<a href=\"varint.html#qptn\">qptn</a>(1:3)\nto be used for the specific dataset,\neither as a shift of k-point grid in ground-state calculations,\nor as a stand-alone phonon wavevector.\n<p>There are two basic techniques to generate the Q point : either\nby specifying it directly, possibly with a renormalisation factor (<b>qptopt</b>=0),\nor extracting it from a grid a Q points (<b>qptopt</b>=1 to 4), using the\nindex <a href=\"vargs.html#iqpt\">iqpt</a>.\nAt variance with the similar generation of k points, only ONE q point\ncan be used per dataset.\n<p>With <b>qptopt</b>=1 to 4, rely on <a href=\"vargs.html#ngqpt\">ngqpt</a> or\n<a href=\"vargs.html#qptrlatt\">qptrlatt</a>, as well as on\n<a href=\"vargs.html#nshiftq\">nshiftq</a> and\n<a href=\"vargs.html#shiftq\">shiftq</a> to set up a q point\ngrid, from which the q point with number <a href=\"vargs.html#iqpt\">iqpt</a> will be selected.\nThe values <b>qptopt</b>=1 to 4 differ by the treatment of symmetries. Note\nthat the symmetries are\nrecomputed starting from the values of <a href=\"varbas.html#rprimd\">rprimd</a>\n<a href=\"varbas.html#xred\">xred</a> and\n<a href=\"vargs.html#spinat\">spinat</a>. So, the explicit value of\n<a href=\"varbas.html#symrel\">symrel</a> are not used.\nThis is to allow doing calculations with <a href=\"varbas.html#nsym\">nsym</a>=1,\nsometimes needed for T-dependent electronic structure, still decreasing\nthe number of q points in the case <b>qptopt</b>=1 or <b>qptopt</b>=3.\n\n<ul>\n<li>0=> read directly <a href=\"vargs.html#qpt\">qpt</a>,\nand its (eventual) renormalisation factor <a href=\"vargs.html#qptnrm\">qptnrm</a>.\n<li>1=>\nTake fully into account the symmetry to generate the\ngrid of q points in the Irreducible Brillouin Zone only.<br>\n(This is the usual mode for RF calculations)</li>\n<li>2=>\nTake into account only the time-reversal symmetry :\nq points will be generated in half the Brillouin zone.<br>\n</li>\n<li>3=>\nDo not take into account any symmetry :\nq points will be generated in the full Brillouin zone.<br>\n</li>\n<li>4=>\nTake into account all the symmetries EXCEPT the time-reversal symmetry\nto generate the k points in the Irreducible Brillouin Zone.<br>\n</li>\n</ul>\nIn the case of a grid of q points, the auxiliary variables\n<a href=\"vargs.html#kptrlen\">kptrlen</a>,\n<a href=\"varbas.html#ngkpt\">ngkpt</a>  and\n<a href=\"varfil.html#prtkpt\">prtkpt</a> might help\nyou to select the optimal grid, similarly to the case of the K point grid.\n",
    "vartype": "integer parameter "
  },
  "qptrlatt": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No default.",
    "definition": "Q - PoinTs grid : Real space LATTice ",
    "section": "vargs",
    "text": "<p>\nThis input variable is used only when <a href=\"vargs.html#qptopt\">qptopt</a>\nis positive. It partially defines the q point grid.\nThe other piece of information is contained in\n<a href=\"vargs.html#shiftq\">shiftq</a>.\n<b>qptrlatt</b> cannot be used together with <a href=\"vargs.html#ngqpt\">ngqpt</a>.\n\n<p>The values <b>qptrlatt</b>(1:3,1), <b>qptrlatt</b>(1:3,2),  <b>qptrlatt</b>(1:3,3)\nare the coordinates of three vectors in real space, expressed\nin the <a href=\"varbas.html#rprimd\">rprimd</a> coordinate system (reduced coordinates).\nThey defines a super-lattice in real space.\nThe k point lattice is the reciprocal of this super-lattice,\npossibly shifted (see <a href=\"vargs.html#shiftq\">shiftq</a>).\n\n<p>If neither <a href=\"vargs.html#ngqpt\">ngqpt</a> nor <b>qptrlatt</b>\nare defined, ABINIT will automatically generate a set\nof k point grids, and select the best combination\nof <b>qptrlatt</b> and <a href=\"vargs.html#shiftq\">shiftq</a>\nthat allows to reach a sufficient value of <a href=\"vargs.html#kptrlen\">kptrlen</a>.\nSee this latter variable for a complete description of this\nprocedure.\n",
    "vartype": "integer array qptrlatt(3,3)  "
  },
  "quadmom": {
    "category": "",
    "default": "0",
    "definition": "QUADrupole MOMents ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#prtefg\">prtefg</a> = 1 or greater.<br>\n<ul>\n<li> Array of quadrupole moments, in barns, of the nuclei. These values are used in conjunction with the\nelectric field gradients computed with <a href=\"varpaw.html#prtefg\">prtefg</a> to calculate the quadrupole\ncouplings in MHz, as well as the asymmetries. Note that the electric field gradient at a nuclear site is independent of\nthe nuclear quadrupole moment, thus the quadrupole moment of a nucleus can be input as 0, and the\noption <a href=\"varpaw.html#prtefg\">prtefg = 2</a> used to determine the electric field gradient at the site.\n</li>\n</ul>\n\n",
    "vartype": "real array quadmom(<a href=\"varbas.html#ntypat\">ntypat</a>) "
  },
  "random_atpos": {
    "category": "",
    "default": "0.",
    "definition": "RANDOM ATomic POSitions ",
    "section": "varrlx",
    "text": "<p>\nControl the inner coordinates, which can be generated randomly by using 4 different methods depending\nont its value\n<br>\n(0) if zero, no random generation and xred are taken as they have been introduced by the user\n<br>\n(1) if one, particles are generated completly random within the unit cell.\n<br>\n(2) if two, particles are generated randomly but the inner particle distace is always larger than a factor of the\nsum of the covalent bonds between the atoms (note : this is incompatible with the definition of alchemical mixing, in which\n<a href=\"varbas.html#ntypat\">ntypat</a> differs from <a href=\"vargs.html#npsp\">npsp</a>)\n",
    "vartype": "integer parameter "
  },
  "ratsph": {
    "category": " ",
    "default": "2.0 Bohr for norm-conserving psps, PAW radius (found in PAW dataset file) for PAW",
    "definition": "Radii of the ATomic SPHere(s) ",
    "section": "vargs",
    "text": "<p>\nRelevant only when\n<a href=\"varfil.html#prtdos\">prtdos</a>=3 or <a href=\"vargs.html#prtdensph\">prtdensph</a>=1.<br>\n<br>When <a href=\"varfil.html#prtdos\">prtdos</a>=3:<br>\nProvides the radius of the spheres around the <a href=\"vargs.html#natsph\">natsph</a> atoms\nof indices <a href=\"vargs.html#iatsph\">iatsph</a>, in which the local\nDOS and its angular-momentum projections will be analysed.\nThe choice of this radius is quite arbitrary. In a plane-wave basis set,\nthere is no natural definition of an atomic sphere. However, it might be wise\nto use the following well-defined and physically motivated procedure\n(in version 4.2, this procedure is NOT implemented, unfortunately) :\nfrom the Bader analysis, one can define the radius of the sphere\nthat contains the same charge as the Bader volume. This\n\"Equivalent Bader charge atomic radius\" might then be used to perform\nthe present analysis.\nSee the <A href=\"../users/aim_help.html\"><B>AIM (Bader)</B></a> help file for more explanations.\nAnother physically motivated choice would be to rely on another\ncharge partitioning, like the Hirshfeld one (see the cut3d utility).\nThe advantage of using charge partitioning schemes comes from the fact that the\nsum of atomic DOS, for all angular momenta and atoms, integrated on the\nenergy range of the occupied states,\ngives back the total charge.\nIf this is not an issue, one could rely on the half of the nearest-neighbour distances, or\nany scheme that allows to define an atomic radius. Note that the choice of this\nradius is however critical for the balance between the s, p and d components. Indeed,\nthe integrated charge within a given radius, behave as a different power of the\nradius, for the different channels s, p, d. At the limit of very small radii, the s component\ndominates the charge contained in the sphere ...\n<br><br>When <a href=\"vargs.html#prtdensph\">prtdensph</a>=1:<br>\nProvides the radius of the spheres around (all) atoms in which the total charge density will be integrated.\n<br><br>In case of PAW, <a href=\"vargs.html#ratsph\">ratsph</a> radius has to be greater or equal to\nPAW radius of considered atom type (which is read from the PAW dataset file; see rc_sph or r_paw).\n",
    "vartype": "real array ratsph(<a href=\"varbas.html#ntypat\">ntypat</a>)  "
  },
  "ratsph_extra": {
    "category": "<a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "2.0 Bohr",
    "definition": "Radii of the ATomic SPHere(s) in the EXTRA set ",
    "section": "vargs",
    "text": "Radius for extra spheres the DOS is projected into. See <a href=#natsph_extra>natsph_extra</a>\nand <a href=#xredsph_extra>xredsph_extra</a> for the number and positions of the spheres.\n",
    "vartype": "real parameter "
  },
  "rcut": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0.0d0",
    "definition": "Radius of the CUT-off for coulomb interaction ",
    "section": "vargw",
    "text": "<p>\nTruncation of the Coulomb interaction in real space. The meaning of <b>rcut</b> is governed by the cutoff shape option <a href=\"vargw.html#icutcoul\">icutcoul</a>.\n<p>\nIf <b>rcut</b> is negative, the cutoff is automatically calculated so to enclose the same volume inside the cutoff as the volume of the solid.\n",
    "vartype": "real parameter "
  },
  "recefermi": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "RECursion - initial guess  of the FERMI Energy",
    "section": "vardev",
    "text": "<p>\n\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nIn the first  SCF calculation it fixes the initial guess for the Fermi energy.\n",
    "vartype": "real"
  },
  "recgratio": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1",
    "definition": "RECursion - Grid Ratio ",
    "section": "vardev",
    "text": "<p>\n\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nIt represents the ratio of the two grid step: <b>recgratio</b>=fine_step/coarse_step and\nit is bigger or equal than 1.  It introduces a double-grid system which permits\nto compute the electronic density on a coarse grid, using a fine grid\n(defined by <a href=\"vargs.html#ngfft\">ngfft</a>) in the\ndiscretisation of the green kernel (see <ahref=\"vardev.html#recptrott\">recptrott</a>).\nSuccessively the density and the recursion coefficients are interpolated on the fine grid by\nFFT interpolation.  Note that ngfft/recgratio=number of points of the\ncoarse grid has to be compatible with the parallelization parameters.\n",
    "vartype": "integer"
  },
  "recnpath": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "500",
    "definition": "RECursion - Number of point for PATH integral calculations ",
    "section": "vardev",
    "text": "<p>\n\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nDetermine the number of discretisation points to compute some path\nintegral in the recursion method ; those path integrals are used to\ncompute the entropy and the eigenvalues energy. during the latest SFC\ncycles. ",
    "vartype": "integer"
  },
  "recnrec": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "10",
    "definition": "RECursion - Number of RECursions ",
    "section": "vardev",
    "text": "<p>\n\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nDetermine the maximum order of recursion, that is the dimension of the\nkrylov space we use to compute density. If the precision setten by\n<a href=\"vardev.html#rectolden\">rectolden</a> is reached before that order, the recursion method\nautomatically stops.  ",
    "vartype": "integer"
  },
  "recptrott": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "RECursion - TROTTer P parameter ",
    "section": "vardev",
    "text": "<p>\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nDetermine the trotter parameter used to compute the exponential of the hamiltonian in the\nrecursion method: exp(-beta*(-Delta + V)) ~ (exp(-beta/(4*recptrott)\nV) exp(-beta/(4*recptrott) Delta) exp(-beta/(4*recptrott)\nV))^(2*recptrott).\nIf set to 0, we use recptrott = 1/2 in the above formula.\nIncreasing <b>recptrott</b> improve the accuracy of the trotter formula, but\nincrease the dicretisation error: it may be necessary to increase\n<a href=\"vargs.html#ngfft\">ngfft</a>. The discretisation error is essentially the discretisation\nerror of the green kernel exp((recptrott/beta*|r|^2)) on the ngfft\ngrid.\n",
    "vartype": "integer"
  },
  "recrcut": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "RECursion - CUTing Radius  ",
    "section": "vardev",
    "text": "<p>\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nUsed to improve the\ncomputational time in the case of the recursion method in a large\ncell: the density at a point will be computed with taking account only of\na sphere of radius <b>recrcut</b>.\n",
    "vartype": "integer"
  },
  "rectesteg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "RECursion - TEST on Electron Gas  ",
    "section": "vardev",
    "text": "<p>\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nIt is used to test an electron gas by putting the ion potential\nequal to zero.\n",
    "vartype": "integer"
  },
  "rectolden": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0.0E00 (to change)",
    "definition": "RECursion - TOLerance on the difference of electronic DENsity  ",
    "section": "vardev",
    "text": "<p>\nUsed in Recursion method (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=2).\nSets a tolerance for differences of electronic density that, reached TWICE\nsuccessively, will cause one SCF cycle to stop. That electronic\ndensity difference is computed in the infinity norm (that is, it is\ncomputed point-by-point, and then the maximum difference is computed).\n",
    "vartype": "real"
  },
  "red_dfield": {
    "category": " ",
    "default": "3*0.0 .",
    "definition": "REDuced Displacement FIELD ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=16,\na reduced finite electric displacement field calculation is performed. The value\nof this displacement field, and its direction is determined by <b>red_dfield</b>.\nIt must be given in atomic units.\n<p>\n<b>red_dfield</b> is defined via Eq.(26) in the Supplement of M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).\n",
    "vartype": "real array red_dfield(3)  "
  },
  "red_efield": {
    "category": " ",
    "default": "3*0.0 .",
    "definition": "REDuced Electric FIELD ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=16,\na reduced finite electric displacement field calculation is performed.\nIn this case, the parameter red_efield specifies the initial electric field used on the first iteration, in atomic units.\n<p>\n<b>red_efield</b> is defined via Eq.(25) in the Supplement of M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).\n",
    "vartype": "real array red_efield(3)  "
  },
  "red_efieldbar": {
    "category": " ",
    "default": "3*0.0 .",
    "definition": "REDuced Electric FIELD BAR ",
    "section": "varff",
    "text": "<p>\nIn case <a href=\"varff.html#berryopt\">berryopt</a>=14,\na reduced finite electric field calculation is performed.\nThe magnitude and direction of this electric field are determined by red_efieldbar. It must be given in atomic units.\n<p>\n<b>red_efieldbar</b> is defined via Eq.(28) in the Supplement of M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).\n",
    "vartype": "real array red_efieldbar(3)  "
  },
  "restartxf": {
    "category": "",
    "default": "0.",
    "definition": "RESTART from (X,F) history ",
    "section": "varrlx",
    "text": "<p>\nControl the restart of a molecular dynamics or structural\noptimization job.\n<br><br>\n<b>restartxf>0 (Deprecated)</b>:The code reads from the input wf file,\nthe previous history of atomic coordinates and corresponding forces, in order\nto continue the work done by the job that produced this wf file.\nIf <a href=\"varrlx.html#optcell\">optcell</a>/=0, the history of\n<a href=\"varbas.html#acell\">acell</a> and\n<a href=\"varbas.html#rprim\">rprim</a> variables is also taken into account.\n\nThe code will take into consideration the whole history (if <b>restartxf</b>=1),\nor discard the few first (x,f) pairs, and begin only at the\npair whose number corresponds to <b>restartxf</b>.\n<br>\nWorks only for <a href=\"varrlx.html#ionmov\">ionmov</a>=2 (Broyden) and\nwhen an input wavefunction file is specified, thanks to the\nappropriate values of <a href=\"varfil.html#irdwfk\">irdwfk</a> or <a\nhref=\"varfil.html#getwfk\">getwfk</a>.\n<br><br>\nNOTES :<br>\n* The input wf file must have been produced by a run that exited cleanly.\nIt cannot be one of the temporary wf files that exist when a job crashed.\n<br>\n* One cannot restart a calculation with a non-zero <a href=\"varrlx.html#optcell\">optcell</a>\nvalue from the (x,f) history of another run with a different non-zero <a\nhref=\"varrlx.html#optcell\">optcell</a> value. Starting a non-zero <a\nhref=\"varrlx.html#optcell\">optcell</a> run from a zero\n<a href=\"varrlx.html#optcell\">optcell</a> run should work.<br>\n* Deprecated, the use of the new options (-1 and -2) is prefered.\n<br><br>\n<b>restartxf=0 (Default)</b>: No restart procedure is enable\nand will start a Molecular dynamics or structural optimization\nfrom scratch.\n<br><br>\n<b>restartxf=-1 (New)</b>: Use the HIST file to reconstruct the\na partial calculation. It will reconstruct the different configurations\nusing the forces and stress store in the HIST file, instead of calling\nthe SCF procedure.\n<br>\nEnable <b>restartxf=-1</b> from the begining is harmless.\nThe only condition is to keep the input file the same in such a way\nthat the same predictor is used and it will predict the same structure\nrecorded in the HIST file.\n<br>\nThis option will always compute extra <a href=\"varrlx.html#ntime\">ntime</a>\niterations independent of the number of iterations recovered previously.\n<br><br>\n<b>restartxf=-2 (New)</b>:Read the HIST file and select the atomic\npositions and cell parameters with the lowest energy. Forget all the\nhistory and start the calculation using those values. The original\natomic coordinates and cell parameters are irrelevant in that case.\n<br><br>\nNOTES:\n<br>\n* You can use <b>restartxf=-1 or -2</b> for all predictiors that\nmake no use of random numbers.<br>\n* You can use <b>restartxf=-1 or -2</b> to restart a calculation\nthat was not completed. The HIST file is written on each iteration. So\nyou always have something to recover from.<br>\n* You can take advantage of the appropriate values\nof <a href=\"varfil.html#irdwfk\">irdwfk</a> or <a\nhref=\"varfil.html#getwfk\">getwfk</a> to get a good wave function\nto continue your job.\n",
    "vartype": "integer parameter "
  },
  "rf1atpol": {
    "category": "NON-LINEAR  ",
    "default": "1 1",
    "definition": "non-linear Response Function, 1st mixed perturbation : limits of ATomic POLarisations ",
    "section": "varrf",
    "text": "<p>\nControl the range\nof atoms for which displacements will be considered\nin phonon calculations (atomic polarisations), or in non-linear\ncomputations, using the 2n+1 theorem.\n<br>These values are only relevant to phonon response function\ncalculations, or non-linear computations.\n<br>May take values from 1 to <a href=\"varbas.html#natom\">natom</a>, with <b>rfatpol</b>(1)&lt;=<b>rfatpol</b>(2).\n<br>The atoms to be moved will be defined by the\n<br>do-loop variable iatpol :\n<br>do iatpol=<b>rfatpol</b>(1),<b>rfatpol</b>(2)\n<br>For the calculation of a full dynamical matrix, use\n<b>rfatpol</b>(1)=1 and <b>rfatpol</b>(2)=<a href=\"varbas.html#natom\">natom</a>, together with\n<a href=\"varrf.html#rfdir\">rfdir</a> 1 1 1 . For selected elements of the\ndynamical matrix, use different values of <b>rfatpol</b> and/or\n<a href=\"varrf.html#rfdir\">rfdir</a>. The name 'iatpol' is used for the part of the\ninternal variable ipert when it runs from 1 to <a href=\"varbas.html#natom\">natom</a>. The\ninternal variable ipert can also assume values larger\nthan <a href=\"varbas.html#natom\">natom</a>, of electric field or stress type (see respfn.help).",
    "vartype": "integer array of 2 elements  "
  },
  "rf1dir": {
    "category": "NON-LINEAR  ",
    "default": "0 0 0.",
    "definition": "non-linear Response Function, 1st mixed perturbation : DIRections ",
    "section": "varrf",
    "text": "<p>\nGives the directions\nto be considered for response function calculations, or non-linear computations\n(also for the Berry phase computation of the polarization, see\nthe <a href=\"varff.html#berryopt\">berryopt</a> input variable).\n<br>The three elements corresponds to the three primitive\nvectors, either in real space (phonon calculations),\nor in reciprocal space (d/dk, homogeneous electric field, homogeneous magnetic field\ncalculations). So, they generate a basis\nfor the generation of the dynamical matrix or\nthe macroscopic dielectric tensor or magnetic susceptibility and magnetic\nshielding, or the effective\ncharge tensors.\n<br>If equal to 1, response functions, as defined\nby <a href=\"varrf.html#rfddk\">rfddk</a>,\n<a href=\"varrf.html#rfelfd\">rfelfd</a>, <a href=\"varrf.html#rfphon\">rfphon</a>, <b>rfdir</b>\nand <a href=\"varrf.html#rfatpol\">rfatpol</a>, are to be computed\nfor the corresponding direction. If 0, this direction\nshould not be considered (for non-linear computations, the corresponding input\nvariables should be used).",
    "vartype": "integer array of 3 elements  "
  },
  "rf1elfd": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 1st mixed perturbation : ELectric FielD ",
    "section": "varrf",
    "text": "<p>\nTurns on electric field response\nfunction calculations (or non-linear computation, including the electric field\nperturbation). Actually, such calculations\nrequires first the non-self-consistent calculation\nof derivatives with respect to k, independently of the\nelectric field perturbation itself.\n<br>\nOnly <a href=\"varrf.html#rfelfd\">rfelfd</a>\nis compatible with both norm-conserving pseudopotentials as well as PAW. Higher mixed\nperturbations can be used only with norm-conserving pseudopotentials.\n<ul>\n<li>0=>no electric field perturbation</li>\n<li>1=>full calculation, with first the\nderivative of ground-state wavefunction with\nrespect to k (d/dk calculation), by a\nnon-self-consistent calculation, then the generation of\nthe first-order response to an homogeneous\nelectric field</li>\n<li>2=>only the derivative of ground-state wavefunctions with\nrespect to k</li>\n<li>3=>only the generation of the first-order response\nto the electric field,\nassuming that the data on derivative of ground-state\nwavefunction with respect to k is available on disk.</li>\n</ul>\n(Note : because the tolerances to be used for derivatives or\nhomogeneous electric field are different, one often does the\ncalculation of derivatives in a separate dataset, followed by\ncalculation of electric field response as well as phonon.\n<br>The options 2 and 3 proves useful in that context ;\nalso, in case a scissor shift is to be used,\nit is usually not applied for the d/dk response). ",
    "vartype": "integer parameter  "
  },
  "rf1phon": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 1st mixed perturbation : PHONons ",
    "section": "varrf",
    "text": "<p>\nIt must be equal to 1\nto run phonon response function calculations, or to include some phonon perturbation\nin non-linear computations.   ",
    "vartype": "integer parameter "
  },
  "rf2atpol": {
    "category": "NON-LINEAR  ",
    "default": "1 1",
    "definition": "non-linear Response Function, 2nd mixed perturbation : limits of ATomic POLarisations ",
    "section": "varrf",
    "text": "<p>\nControl the range\nof atoms for which displacements will be considered\nin phonon calculations (atomic polarisations), or in non-linear\ncomputations, using the 2n+1 theorem.\n<br>These values are only relevant to phonon response function\ncalculations, or non-linear computations.\n<br>May take values from 1 to <a href=\"varbas.html#natom\">natom</a>, with <b>rfatpol</b>(1)&lt;=<b>rfatpol</b>(2).\n<br>The atoms to be moved will be defined by the\n<br>do-loop variable iatpol :\n<br>do iatpol=<b>rfatpol</b>(1),<b>rfatpol</b>(2)\n<br>For the calculation of a full dynamical matrix, use\n<b>rfatpol</b>(1)=1 and <b>rfatpol</b>(2)=<a href=\"varbas.html#natom\">natom</a>, together with\n<a href=\"varrf.html#rfdir\">rfdir</a> 1 1 1 . For selected elements of the\ndynamical matrix, use different values of <b>rfatpol</b> and/or\n<a href=\"varrf.html#rfdir\">rfdir</a>. The name 'iatpol' is used for the part of the\ninternal variable ipert when it runs from 1 to <a href=\"varbas.html#natom\">natom</a>. The\ninternal variable ipert can also assume values larger\nthan <a href=\"varbas.html#natom\">natom</a>, of electric field or stress type (see respfn.help).",
    "vartype": "integer array of 2 elements  "
  },
  "rf2dir": {
    "category": "NON-LINEAR  ",
    "default": "0 0 0.",
    "definition": "non-linear Response Function, 2nd mixed perturbation : DIRections ",
    "section": "varrf",
    "text": "<p>\nGives the directions\nto be considered for response function calculations, or non-linear computations\n(also for the Berry phase computation of the polarization, see\nthe <a href=\"varff.html#berryopt\">berryopt</a> input variable).\n<br>The three elements corresponds to the three primitive\nvectors, either in real space (phonon calculations),\nor in reciprocal space (d/dk, homogeneous electric field, homogeneous magnetic field\ncalculations). So, they generate a basis\nfor the generation of the dynamical matrix or\nthe macroscopic dielectric tensor or magnetic susceptibility and magnetic\nshielding, or the effective\ncharge tensors.\n<br>If equal to 1, response functions, as defined\nby <a href=\"varrf.html#rfddk\">rfddk</a>,\n<a href=\"varrf.html#rfelfd\">rfelfd</a>, <a href=\"varrf.html#rfphon\">rfphon</a>, <b>rfdir</b>\nand <a href=\"varrf.html#rfatpol\">rfatpol</a>, are to be computed\nfor the corresponding direction. If 0, this direction\nshould not be considered (for non-linear computations, the corresponding input\nvariables should be used).",
    "vartype": "integer array of 3 elements  "
  },
  "rf2elfd": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 2nd mixed perturbation : ELectric FielD ",
    "section": "varrf",
    "text": "<p>\nTurns on electric field response\nfunction calculations (or non-linear computation, including the electric field\nperturbation). Actually, such calculations\nrequires first the non-self-consistent calculation\nof derivatives with respect to k, independently of the\nelectric field perturbation itself.\n<br>\nOnly <a href=\"varrf.html#rfelfd\">rfelfd</a>\nis compatible with both norm-conserving pseudopotentials as well as PAW. Higher mixed\nperturbations can be used only with norm-conserving pseudopotentials.\n<ul>\n<li>0=>no electric field perturbation</li>\n<li>1=>full calculation, with first the\nderivative of ground-state wavefunction with\nrespect to k (d/dk calculation), by a\nnon-self-consistent calculation, then the generation of\nthe first-order response to an homogeneous\nelectric field</li>\n<li>2=>only the derivative of ground-state wavefunctions with\nrespect to k</li>\n<li>3=>only the generation of the first-order response\nto the electric field,\nassuming that the data on derivative of ground-state\nwavefunction with respect to k is available on disk.</li>\n</ul>\n(Note : because the tolerances to be used for derivatives or\nhomogeneous electric field are different, one often does the\ncalculation of derivatives in a separate dataset, followed by\ncalculation of electric field response as well as phonon.\n<br>The options 2 and 3 proves useful in that context ;\nalso, in case a scissor shift is to be used,\nit is usually not applied for the d/dk response). ",
    "vartype": "integer parameter  "
  },
  "rf2phon": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 2nd mixed perturbation : PHONons ",
    "section": "varrf",
    "text": "<p>\nIt must be equal to 1\nto run phonon response function calculations, or to include some phonon perturbation\nin non-linear computations.   ",
    "vartype": "integer parameter "
  },
  "rf3atpol": {
    "category": "NON-LINEAR  ",
    "default": "1 1",
    "definition": "non-linear Response Function, 3rd mixed perturbation : limits of ATomic POLarisations ",
    "section": "varrf",
    "text": "<p>\nControl the range\nof atoms for which displacements will be considered\nin phonon calculations (atomic polarisations), or in non-linear\ncomputations, using the 2n+1 theorem.\n<br>These values are only relevant to phonon response function\ncalculations, or non-linear computations.\n<br>May take values from 1 to <a href=\"varbas.html#natom\">natom</a>, with <b>rfatpol</b>(1)&lt;=<b>rfatpol</b>(2).\n<br>The atoms to be moved will be defined by the\n<br>do-loop variable iatpol :\n<br>do iatpol=<b>rfatpol</b>(1),<b>rfatpol</b>(2)\n<br>For the calculation of a full dynamical matrix, use\n<b>rfatpol</b>(1)=1 and <b>rfatpol</b>(2)=<a href=\"varbas.html#natom\">natom</a>, together with\n<a href=\"varrf.html#rfdir\">rfdir</a> 1 1 1 . For selected elements of the\ndynamical matrix, use different values of <b>rfatpol</b> and/or\n<a href=\"varrf.html#rfdir\">rfdir</a>. The name 'iatpol' is used for the part of the\ninternal variable ipert when it runs from 1 to <a href=\"varbas.html#natom\">natom</a>. The\ninternal variable ipert can also assume values larger\nthan <a href=\"varbas.html#natom\">natom</a>, of electric field or stress type (see respfn.help).",
    "vartype": "integer array of 2 elements  "
  },
  "rf3dir": {
    "category": "NON-LINEAR  ",
    "default": "0 0 0.",
    "definition": "non-linear Response Function, 3rd mixed perturbation : DIRections ",
    "section": "varrf",
    "text": "<p>\nGives the directions\nto be considered for response function calculations, or non-linear computations\n(also for the Berry phase computation of the polarization, see\nthe <a href=\"varff.html#berryopt\">berryopt</a> input variable).\n<br>The three elements corresponds to the three primitive\nvectors, either in real space (phonon calculations),\nor in reciprocal space (d/dk, homogeneous electric field, homogeneous magnetic field\ncalculations). So, they generate a basis\nfor the generation of the dynamical matrix or\nthe macroscopic dielectric tensor or magnetic susceptibility and magnetic\nshielding, or the effective\ncharge tensors.\n<br>If equal to 1, response functions, as defined\nby <a href=\"varrf.html#rfddk\">rfddk</a>,\n<a href=\"varrf.html#rfelfd\">rfelfd</a>, <a href=\"varrf.html#rfphon\">rfphon</a>, <b>rfdir</b>\nand <a href=\"varrf.html#rfatpol\">rfatpol</a>, are to be computed\nfor the corresponding direction. If 0, this direction\nshould not be considered (for non-linear computations, the corresponding input\nvariables should be used).",
    "vartype": "integer array of 3 elements  "
  },
  "rf3elfd": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 3rd mixed perturbation : ELectric FielD ",
    "section": "varrf",
    "text": "<p>\nTurns on electric field response\nfunction calculations (or non-linear computation, including the electric field\nperturbation). Actually, such calculations\nrequires first the non-self-consistent calculation\nof derivatives with respect to k, independently of the\nelectric field perturbation itself.\n<br>\nOnly <a href=\"varrf.html#rfelfd\">rfelfd</a>\nis compatible with both norm-conserving pseudopotentials as well as PAW. Higher mixed\nperturbations can be used only with norm-conserving pseudopotentials.\n<ul>\n<li>0=>no electric field perturbation</li>\n<li>1=>full calculation, with first the\nderivative of ground-state wavefunction with\nrespect to k (d/dk calculation), by a\nnon-self-consistent calculation, then the generation of\nthe first-order response to an homogeneous\nelectric field</li>\n<li>2=>only the derivative of ground-state wavefunctions with\nrespect to k</li>\n<li>3=>only the generation of the first-order response\nto the electric field,\nassuming that the data on derivative of ground-state\nwavefunction with respect to k is available on disk.</li>\n</ul>\n(Note : because the tolerances to be used for derivatives or\nhomogeneous electric field are different, one often does the\ncalculation of derivatives in a separate dataset, followed by\ncalculation of electric field response as well as phonon.\n<br>The options 2 and 3 proves useful in that context ;\nalso, in case a scissor shift is to be used,\nit is usually not applied for the d/dk response). ",
    "vartype": "integer parameter  "
  },
  "rf3phon": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "non-linear Response Function, 3rd mixed perturbation : PHONons ",
    "section": "varrf",
    "text": "<p>\nIt must be equal to 1\nto run phonon response function calculations, or to include some phonon perturbation\nin non-linear computations.   ",
    "vartype": "integer parameter "
  },
  "rfasr": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "Response Function : Acoustic Sum Rule ",
    "section": "varrf",
    "text": "<p>\nControl the evaluation of the\nacoustic sum rule in effective charges and dynamical matrix at Gamma\nwithin a response function calculation (not active at the level of producing the DDB, but\nat the level of the phonon eigenfrequencies output).\n<ul>\n<li>0 => no acoustic sum rule imposed</li>\n<li>1 => acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with\nextra charge evenly distributed among atoms</li>\n<li>2 => acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with\nextra charge given proportionally to those atoms with\nthe largest effective charge.</li>\n</ul>\nThe treatment of the acoustic sum rule and charge neutrality sum rule is finer at the level of the ANADDB utility,\nwith the two independent input variables <a href=\"../users/anaddb_help.html#asr\">asr</a>\nand <a href=\"../users/anaddb_help.html#chneut\">chneut</a>.\n",
    "vartype": "integer parameter  "
  },
  "rfatpol": {
    "category": "NON-LINEAR  ",
    "default": "1 1",
    "definition": "Response Function : limits of ATomic POLarisations ",
    "section": "varrf",
    "text": "<p>\nControl the range\nof atoms for which displacements will be considered\nin phonon calculations (atomic polarisations), or in non-linear\ncomputations, using the 2n+1 theorem.\n<br>These values are only relevant to phonon response function\ncalculations, or non-linear computations.\n<br>May take values from 1 to <a href=\"varbas.html#natom\">natom</a>, with <b>rfatpol</b>(1)&lt;=<b>rfatpol</b>(2).\n<br>The atoms to be moved will be defined by the\n<br>do-loop variable iatpol :\n<br>do iatpol=<b>rfatpol</b>(1),<b>rfatpol</b>(2)\n<br>For the calculation of a full dynamical matrix, use\n<b>rfatpol</b>(1)=1 and <b>rfatpol</b>(2)=<a href=\"varbas.html#natom\">natom</a>, together with\n<a href=\"varrf.html#rfdir\">rfdir</a> 1 1 1 . For selected elements of the\ndynamical matrix, use different values of <b>rfatpol</b> and/or\n<a href=\"varrf.html#rfdir\">rfdir</a>. The name 'iatpol' is used for the part of the\ninternal variable ipert when it runs from 1 to <a href=\"varbas.html#natom\">natom</a>. The\ninternal variable ipert can also assume values larger\nthan <a href=\"varbas.html#natom\">natom</a>, of electric field or stress type (see respfn.help).",
    "vartype": "integer array of 2 elements  "
  },
  "rfddk": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "Response Function with respect to Derivative with respect to K ",
    "section": "varrf",
    "text": "<p>\nActivates computation of derivatives of ground state\nwavefunctions with respect to wavevectors. This is not strictly a response\nfunction but is a needed auxiliary quantity in the electric field\ncalculations (see <a href=\"varrf.html#rfelfd\">rfelfd</a>) The directions for the\nderivatives are determined by <a href=\"varrf.html#rfdir\">rfdir</a>.\n<ul>\n<li>0=>no derivative calculation</li>\n<li>1=>calculation of first derivatives of wavefunctions with respect to k points\n(d/dk calculation). The exact same functionality is provided by\n<a href=\"varrf.html#rfelfd\">rfelfd</a> = 2.\n</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "rfdir": {
    "category": "NON-LINEAR  ",
    "default": "0 0 0.",
    "definition": "Response Function : DIRections ",
    "section": "varrf",
    "text": "<p>\nGives the directions\nto be considered for response function calculations, or non-linear computations\n(also for the Berry phase computation of the polarization, see\nthe <a href=\"varff.html#berryopt\">berryopt</a> input variable).\n<br>The three elements corresponds to the three primitive\nvectors, either in real space (phonon calculations),\nor in reciprocal space (d/dk, homogeneous electric field, homogeneous magnetic field\ncalculations). So, they generate a basis\nfor the generation of the dynamical matrix or\nthe macroscopic dielectric tensor or magnetic susceptibility and magnetic\nshielding, or the effective\ncharge tensors.\n<br>If equal to 1, response functions, as defined\nby <a href=\"varrf.html#rfddk\">rfddk</a>,\n<a href=\"varrf.html#rfelfd\">rfelfd</a>, <a href=\"varrf.html#rfphon\">rfphon</a>, <b>rfdir</b>\nand <a href=\"varrf.html#rfatpol\">rfatpol</a>, are to be computed\nfor the corresponding direction. If 0, this direction\nshould not be considered (for non-linear computations, the corresponding input\nvariables should be used).",
    "vartype": "integer array of 3 elements  "
  },
  "rfelfd": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "Response Function with respect to the ELectric FielD ",
    "section": "varrf",
    "text": "<p>\nTurns on electric field response\nfunction calculations (or non-linear computation, including the electric field\nperturbation). Actually, such calculations\nrequires first the non-self-consistent calculation\nof derivatives with respect to k, independently of the\nelectric field perturbation itself.\n<br>\nOnly <a href=\"varrf.html#rfelfd\">rfelfd</a>\nis compatible with both norm-conserving pseudopotentials as well as PAW. Higher mixed\nperturbations can be used only with norm-conserving pseudopotentials.\n<ul>\n<li>0=>no electric field perturbation</li>\n<li>1=>full calculation, with first the\nderivative of ground-state wavefunction with\nrespect to k (d/dk calculation), by a\nnon-self-consistent calculation, then the generation of\nthe first-order response to an homogeneous\nelectric field</li>\n<li>2=>only the derivative of ground-state wavefunctions with\nrespect to k</li>\n<li>3=>only the generation of the first-order response\nto the electric field,\nassuming that the data on derivative of ground-state\nwavefunction with respect to k is available on disk.</li>\n</ul>\n(Note : because the tolerances to be used for derivatives or\nhomogeneous electric field are different, one often does the\ncalculation of derivatives in a separate dataset, followed by\ncalculation of electric field response as well as phonon.\n<br>The options 2 and 3 proves useful in that context ;\nalso, in case a scissor shift is to be used,\nit is usually not applied for the d/dk response). ",
    "vartype": "integer parameter  "
  },
  "rfmeth": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "1.",
    "definition": "Response Function METHod ",
    "section": "varrf",
    "text": "<p>\nSelects method used in\nresponse function calculations. Presently, only 1\nis allowed. ",
    "vartype": "integer parameter  "
  },
  "rfphon": {
    "category": "NON-LINEAR  ",
    "default": "0.",
    "definition": "Response Function with respect to PHONons ",
    "section": "varrf",
    "text": "<p>\nIt must be equal to 1\nto run phonon response function calculations, or to include some phonon perturbation\nin non-linear computations.   ",
    "vartype": "integer parameter "
  },
  "rfstrs": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0.",
    "definition": "Response Function with respect to STRainS ",
    "section": "varrf",
    "text": "<p>\nUsed to run strain response-function\ncalculations (e.g. needed to get elastic constants). Define, with\n<a href=\"varrf.html#rfdir\">rfdir</a>, the set of perturbations.\n<ul>\n<li>0=>no strain perturbation</li>\n<li>1=>only uniaxial strain(s) (ipert=natom+3 is activated)</li>\n<li>2=>only shear strain(s) (ipert=natom+4 is activated)</li>\n<li>3=>both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated)</li>\n</ul>\nSee the possible restrictions on the use of strain perturbations, in the\n<a href=\"../users/respfn_help.html#1\">respfn_help file</a>.\n",
    "vartype": "integer parameter  "
  },
  "rfuser": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0. ",
    "definition": "Response Function, USER-defined  ",
    "section": "varrf",
    "text": "<p>\nAvailable to the developpers, to activate\nthe use of ipert=natom+5 and ipert=natom+6, two sets of perturbations\nthat the developpers can define.\n<br>\n<ul>\n<li>0=>no computations for ipert=natom+5 or ipert=natom+6</li>\n<li>1=>response with respect to perturbation natom+5 will be computed </li>\n<li>2=>response with respect to perturbation natom+6 will be computed </li>\n<li>3=>responses with respect to perturbations natom+5 and natom+6 will be computed </li>\n</ul>\n<p>In order to define and use correctly the new perturbations,\nthe developper might have to include code lines or additional routines\nat the level of the following routines :\ncgwf3.f, chkph3.f, dyout3.f, d2sym3.f, eneou3.f, eneres3.f, gath3.f, insy3.f,\nloper3.f, mkcor3.f, nstdy3.f, nstwf3.f, respfn.f,\nscfcv3.f, syper3.f, vloca3.f, vtorho3.f, vtowfk3.f, wings3.f, .\nIn these routines, the developper should pay a particular\nattention to the rfpert array, defined in the routine respfn.f ,\nas well as to the ipert local variable.\n",
    "vartype": "integer parameter  "
  },
  "rhoqpmix": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "1.0",
    "definition": "RHO QuasiParticle MIXing",
    "section": "vargw",
    "text": "<p>\nFor self-consistent GW runs, <b>rhoqpmix</b> sets the mixing coefficient between the new and the previous\nelectronic densities.\nThis mixing damps the spurious oscillations in the Hartree potential when achieving self-consistency.\n<b>rhoqpmix</b> is meaningful only when doing self-consistency on the wavefunctions with\n<a href=\"vargw.html#gwcalctyp\">gwcalctyp</a> &#62&#61 20.\n",
    "vartype": "real parameter  "
  },
  "rprim": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a> (if <a href=\"varrlx.html#ionmov\">ionmov</a>==2 and <a href=\"varrlx.html#optcell\">optcell</a>/=0) ",
    "default": "3x3 unity matrix.",
    "definition": "Real space PRIMitive translations ",
    "section": "varbas",
    "text": "<p>\nGive, in columnwise entry,\nthe three dimensionless primitive translations in real space, to be rescaled by\n<a href=\"varbas.html#acell\">acell</a> and <a href=\"varbas.html#scalecart\">scalecart</a>.\n<br>If the Default is used, that is, <b>rprim</b> is the unity matrix,\nthe three dimensionless primitive vectors are three\nunit vectors in cartesian coordinates. Each will be (possibly) multiplied\nby the corresponding <a href=\"varbas.html#acell\">acell</a> value, then (possibly)\nstretched along the cartesian coordinates by the corresponding <a href=\"varbas.html#scalecart\">scalecart</a> value,\nto give the dimensional primitive vectors, called <a href=\"varbas.html#rprimd\">rprimd</a>.\n<br>In the general case, the dimensional cartesian\ncoordinates of the crystal primitive translations R1p, R2p and R3p, see\n<a href=\"varbas.html#rprimd\">rprimd</a>, are\n<ul>\n<li>  R1p(i)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)<b>rprim</b>(i,1)*<a href=\"varbas.html#acell\">acell</a>(1) </li>\n<li>  R2p(i)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)<b>rprim</b>(i,2)*<a href=\"varbas.html#acell\">acell</a>(2) </li>\n<li>  R3p(i)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)<b>rprim</b>(i,3)*<a href=\"varbas.html#acell\">acell</a>(3) </li>\n</ul>\nwhere i=1,2,3 is the component of the primitive translation (i.e. x, y, and z).\n<br>\n<br>\nThe <b>rprim</b> variable, scaled by <a href=\"varbas.html#scalecart\">scalecart</a>, is thus used to define directions\nof the primitive vectors, that will be multiplied (so keeping the direction unchanged) by\nthe appropriate length scale <a href=\"varbas.html#acell\">acell</a>(1), <a href=\"varbas.html#acell\">acell</a>(2),\nor <a href=\"varbas.html#acell\">acell</a>(3),\nrespectively to give the dimensional primitive translations\nin real space in cartesian coordinates.\n<br>\nPresently, it is requested that the mixed product\n(R1xR2).R3 is positive. If this is not the case,\nsimply exchange a pair of vectors.\n<br>\nTo be more specific, keeping the default value of <a href=\"varbas.html#scalecart\">scalecart</a>=1 to simplify the matter,\n<b>rprim</b> 1 2 3 4 5 6 7 8 9 corresponds to input of the\nthree primitive translations R1=(1,2,3) (to be multiplied by <a\nhref=\"varbas.html#acell\">acell</a>(1)), R2=(4,5,6) (to be multiplied by <a\nhref=\"varbas.html#acell\">acell</a>(2)), and R3=(7,8,9) (to be multiplied by <a\nhref=\"varbas.html#acell\">acell</a>(3)).\n<br>\nNote carefully that the first\nthree numbers input are the first column of <b>rprim</b>, the next\nthree are the second, and the final three are the third.\nThis corresponds with the usual Fortran order for arrays.\nThe matrix whose columns are the reciprocal space primitive\ntranslations is the inverse transpose of the matrix whose\ncolumns are the direct space primitive translations.\n<p>Alternatively to <b>rprim</b>, directions of dimensionless primitive\nvectors can be specified by using the input variable <a href=\"varbas.html#angdeg\">angdeg</a>.\nThis is especially useful for hexagonal lattices (with 120 or 60 degrees angles).\nIndeed, in order for symmetries to be recognized, rprim must be symmetric up to\n<a href=\"vargeo.html#tolsym\">tolsym</a> (10 digits by default),\ninducing a specification such as\n<pre>\nrprim  0.86602540378  0.5  0.0\n-0.86602540378  0.5  0.0\n0.0            0.0  1.0\n</pre>\nthat can be avoided thanks to <a href=\"varbas.html#angdeg\">angdeg</a>:\n<pre>\nangdeg 90 90 120\n</pre>\n<br>Although the use of <a href=\"varbas.html#scalecart\">scalecart</a> or <a href=\"varbas.html#acell\">acell</a> is\nrather equivalent when the primitive vectors are aligned with the cartesian directions, it is not the case for\nnon-orthogonal primitive vectors. In particular, beginners often make the error of trying to use <a href=\"varbas.html#acell\">acell</a>\nto define primitive vectors in face-centered tetragonal lattice, or body-centered tetragonal lattice, or similarly\nin face or body-centered orthorhombic lattices. Let's take the example of a body-centered tetragonal lattice, that\nmight be defined using the following (\"a\" and \"c\" have to be replaced by the appropriate conventional cell vector length):\n<pre>\nrprim  \"a\"      0      0\n0      \"a\"     0\n\"a/2\"   \"a/2\"  \"c/2\"\nacell 3*1     scalecart 3*1    !  ( These are default values)\n</pre>\nThe following is a valid, alternative way to define  the same primitive vectors :\n<pre>\nrprim   1       0      0\n0       1      0\n1/2     1/2    1/2\nscalecart  \"a\"  \"a\"  \"c\"\nacell 3*1    !  ( These are default values)\n</pre>\nIndeed, the cell has been stretched along the cartesian coordinates, by \"a\", \"a\" and \"c\" factors.\n<p>\nAt variance, the following is WRONG :\n<pre>\nrprim   1       0      0\n0       1      0\n1/2     1/2    1/2\nacell  \"a\"  \"a\"  \"c\"    !   THIS IS WRONG\nscalecart 3*1    !  ( These are default values)\n</pre>\nIndeed, the latter would correspond to :\n<pre>\nrprim  \"a\"      0      0\n0      \"a\"     0\n\"c/2\"   \"c/2\"  \"c/2\"\nacell 3*1     scalecart 3*1    !  ( These are default values)\n</pre>\nNamely, the third vector has been rescaled by \"c\". It is not at all in the center of the tetragonal cell whose basis vectors\nare defined by the scaling factor \"a\".\n<br> As another difference between <a href=\"varbas.html#scalecart\">scalecart</a> or <a href=\"varbas.html#acell\">acell</a>,\nnote that <a href=\"varbas.html#scalecart\">scalecart</a> is <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> :\nits content will be immediately applied to rprim, at parsing time,\nand then scalecart will be set to the default values (3*1). So, in case <a href=\"varbas.html#scalecart\">scalecart</a> is used,\nthe echo of <b>rprim</b> in the output file is not the value contained in the input file,\nbut the value rescaled by <a href=\"varbas.html#scalecart\">scalecart</a>.\n",
    "vartype": "real array rprim(3,3), represented internally as rprim(3,3,<a href=\"varrlx.html#nimage\">nimage</a>)"
  },
  "rprimd": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a>, <a href=\"../users/abinit_help.html#evolving\">EVOVING</a>(if <a href=\"varrlx.html#ionmov\">ionmov</a>==2 and <a href=\"varrlx.html#optcell\">optcell</a>/=0) ",
    "default": "",
    "definition": "Real space PRIMitive translations, Dimensional ",
    "section": "varbas",
    "text": "<p>\nThis internal variable gives the dimensional real space primitive\nvectors, computed from <a href=\"varbas.html#acell\">acell</a>,\n<a href=\"varbas.html#scalecart\">scalecart</a>,\nand <a href=\"varbas.html#rprim\">rprim</a>.\n<ul>\n<li>  R1p(i)=<b>rprimd</b>(i,1)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)*<a href=\"varbas.html#rprim\">rprim</a>(i,1)*<a href=\"varbas.html#acell\">acell</a>(1) for i=1,2,3 (x,y,and z)</li>\n<li>  R2p(i)=<b>rprimd</b>(i,2)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)*<a href=\"varbas.html#rprim\">rprim</a>(i,2)*<a href=\"varbas.html#acell\">acell</a>(2) for i=1,2,3</li>\n<li>  R3p(i)=<b>rprimd</b>(i,3)=<a href=\"varbas.html#scalecart\">scalecart</a>(i)*<a href=\"varbas.html#rprim\">rprim</a>(i,3)*<a href=\"varbas.html#acell\">acell</a>(3) for i=1,2,3</li>\n</ul>\n",
    "vartype": "real array rprimd(3,3), represented internally as rprimd(3,3,<a href=\"varrlx.html#nimage\">nimage</a>)"
  },
  "scalecart": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>  ",
    "default": "3*1  ",
    "definition": "SCALE CARTesian coordinates",
    "section": "varbas",
    "text": "<p>\nGives the scaling factors of cartesian coordinates by which\ndimensionless primitive translations (in \"<a href=\"varbas.html#rprim\">rprim</a>\") are\nto be multiplied.\n<a href=\"varbas.html#rprim\">rprim</a> input variable,\nthe <a href=\"varbas.html#acell\">acell</a> input variable,\nand the associated internal <a href=\"varbas.html#rprimd\">rprimd</a> internal variable.\n<br> Especially useful for body-centered and face-centered tetragonal lattices, as well as\nbody-centered and face-centered orthorhombic lattices, see <a href=\"varbas.html#rprimd\">rprimd</a>.\n<br> Note that this input variable is NOT INTERNAL : its content will be immediately applied to rprim, at parsing time,\nand then scalecart will be set to the default values. So, it will not be echoed.\n",
    "vartype": "real array scalecart(3)   "
  },
  "sciss": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.",
    "definition": "SCISSor operator ",
    "section": "varrf",
    "text": "<p>\nIt is the value of the \"scissors operator\", the\nshift of conduction band eigenvalues,\nused in response function calculations.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n<br>Typical use is for response to electric field (<a href=\"varrf.html#rfelfd\">rfelfd</a>=3),\nbut NOT for d/dk (<a href=\"varrf.html#rfelfd\">rfelfd</a>=2) and phonon responses.",
    "vartype": "real parameter "
  },
  "scphon_supercell": {
    "category": "",
    "default": "1 1 1 ",
    "definition": "Self Consistent PHONon SUPERCELL",
    "section": "vargs",
    "text": "<p>\nGive extent, in number of primitive unit cells, of the supercell being used for\na self-consistent phonon calculation. Presumes the phonon frequencies and eigenvectors\nhave been calculated in the original primitive unit cell, on a grid of q-points which\ncorresponds to the supercell in the present calculation.\n\nTO BE IMPROVED : should contain a tutorial on how to do self-consistent phonon calculations, David Waroquiers 090831\n",
    "vartype": "integer array of 3 elements"
  },
  "scphon_temp": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0d0 ",
    "definition": "Self Consistent PHONon TEMPerature",
    "section": "vargs",
    "text": "<p>\nTemperature which is imposed on phonon distribution, in the self-consistent scheme of\nSouvatzis et al. PRL <b>100</b>, 095901. Determines the extent of the finite displacements\nused, and consequent anharmonic effects. Experimental.\n",
    "vartype": "real parameter"
  },
  "shiftk": {
    "category": " ",
    "default": "0.5 0.5 0.5 ... 0.5  ",
    "definition": "SHIFT for K points ",
    "section": "varbas",
    "text": "<p>\nIt is used only when <a href=\"varbas.html#kptopt\">kptopt</a>>=0,\nand must be defined if <a href=\"varbas.html#nshiftk\">nshiftk</a> is larger than 1.\n<br><b>shiftk</b>(1:3,1:<a href=\"varbas.html#nshiftk\">nshiftk</a>) defines\n<a href=\"varbas.html#nshiftk\">nshiftk</a> shifts\nof the homogeneous grid of k points\nbased on <a href=\"varbas.html#ngkpt\">ngkpt</a> or\n<a href=\"vargs.html#kptrlatt\">kptrlatt</a>.\n<br>The shifts induced by <b>shiftk</b> corresponds\nto the reduced coordinates in the coordinate system\ndefining the k-point lattice. For example,\nif the k point lattice is defined using <a href=\"varbas.html#ngkpt\">ngkpt</a>,\nthe point whose reciprocal space reduced coordinates are\n( <b>shiftk</b>(1,ii)/<a href=\"varbas.html#ngkpt\">ngkpt</a>(1)\n<b>shiftk</b>(2,ii)/<a href=\"varbas.html#ngkpt\">ngkpt</a>(2)\n<b>shiftk</b>(3,ii)/<a href=\"varbas.html#ngkpt\">ngkpt</a>(3) )\nbelongs to the shifted grid number ii.\n\n<p>The user might rely on ABINIT to suggest suitable and\nefficient combinations of <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nand <a href=\"varbas.html#shiftk\">shiftk</a>.\nThe procedure to be followed is described with the\ninput variables <a href=\"vargs.html#kptrlen\">kptrlen</a>.\nIn what follows, we suggest some interesting values of the shifts,\nto be used with even values of <a href=\"varbas.html#ngkpt\">ngkpt</a>.\nThis list is much less exhaustive than the above-mentioned automatic\nprocedure.\n<p>\n1) When the primitive vectors of the lattice do NOT form\na FCC or a BCC lattice, the usual (shifted) Monkhorst-Pack\ngrids are formed by using\n<a href=\"varbas.html#nshiftk\">nshiftk</a>=1 and <b>shiftk</b> 0.5 0.5 0.5 .\nThis is often the preferred k point sampling.\nFor a non-shifted Monkhorst-Pack grid, use\n<a href=\"varbas.html#nshiftk\">nshiftk</a>=1 and <b>shiftk</b> 0.0 0.0 0.0 ,\nbut there is little reason to do that.\n<p>\n2) When the primitive vectors of the lattice form a FCC lattice,\nwith <a href=\"varbas.html#rprim\">rprim</a>\n<pre>\n0.0 0.5 0.5\n0.5 0.0 0.5\n0.5 0.5 0.0\n</pre>\nthe (very efficient) usual Monkhorst-Pack sampling will be generated by using\n<a href=\"varbas.html#nshiftk\">nshiftk</a>= 4  and <b>shiftk</b>\n<pre>\n0.5 0.5 0.5\n0.5 0.0 0.0\n0.0 0.5 0.0\n0.0 0.0 0.5\n</pre>\n<p>\n3) When the primitive vectors of the lattice form a BCC lattice,\nwith <a href=\"varbas.html#rprim\">rprim</a>\n<pre>\n-0.5  0.5  0.5\n0.5 -0.5  0.5\n0.5  0.5 -0.5\n</pre>\nthe usual Monkhorst-Pack sampling will be generated by using\n<a href=\"varbas.html#nshiftk\">nshiftk</a>= 2  and <b>shiftk</b>\n<pre>\n0.25  0.25  0.25\n-0.25 -0.25 -0.25\n</pre>\nHowever, the simple sampling\n<a href=\"varbas.html#nshiftk\">nshiftk</a>=1 and <b>shiftk</b> 0.5 0.5 0.5\nis excellent.\n<p>\n4) For hexagonal lattices with hexagonal axes, e.g. <a href=\"varbas.html#rprim\">rprim</a>\n<pre>\n1.0  0.0       0.0\n-0.5  sqrt(3)/2 0.0\n0.0  0.0       1.0\n</pre>\none can use\n<a href=\"varbas.html#nshiftk\">nshiftk</a>= 1  and <b>shiftk</b>  0.0 0.0 0.5\n<p>\nIn rhombohedral axes, e.g. using <a href=\"varbas.html#angdeg\">angdeg</a> 3*60.,\nthis corresponds to <b>shiftk</b>  0.5 0.5 0.5, to keep the shift along the\nsymmetry axis.\n",
    "vartype": "real array shift(3,<a href=\"varbas.html#nshiftk\">nshiftk</a>)  "
  },
  "shiftq": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0.5 0.5 0.5 ... 0.5  ",
    "definition": "SHIFT for Q points ",
    "section": "vargs",
    "text": "<p>\nIt is used only when <a href=\"vargs.html#qptopt\">qptopt</a>>=0,\nand must be defined if <a href=\"vargs.html#nshiftq\">nshiftq</a> is larger than 1.\n<br><b>shiftq</b>(1:3,1:<a href=\"vargs.html#nshiftq\">nshiftq</a>) defines\n<a href=\"vargs.html#nshiftq\">nshiftq</a> shifts\nof the homogeneous grid of q points\nbased on <a href=\"vargs.html#ngqpt\">ngqpt</a> or\n<a href=\"vargs.html#qptrlatt\">qptrlatt</a>.\n<p>See <a href=\"varbas.html#shiftk\">shiftk</a> for more information on the definition,\nuse, and suitable values for these shifts.\n",
    "vartype": "real array shift(3,<a href=\"vargs.html#nshiftq\">nshiftq</a>)  "
  },
  "signperm": {
    "category": "",
    "default": "1.",
    "definition": "SIGN of PERMutation potential ",
    "section": "varrlx",
    "text": "<p>\nIn development. See the routine moldyn.F90.\nDecides the bias of permutation operations on atoms.\nSee also <a href=\"varrlx.html#delayperm\">delayperm</a>.\n</font>\n<p><font id=\"text\"> +1 favors alternation of species\n</font></p>\n<p><font id=\"text\"> -1 favors segregation\n",
    "vartype": "integer "
  },
  "slabwsrad": {
    "category": "<a href=\"../users/abinit_help.html#length\">LENGTH</a>",
    "default": "0.0d0. ",
    "definition": "jellium SLAB Wigner-Seitz RADius",
    "section": "vargs",
    "text": "<p>\nFix the bulk-mean positive charge density n<sub>bulk</sub>\nof a jellium slab (if the latter is employed, e.g. <a href=\"vargs.html#jellslab\">jellslab</a> &ne 0).\nOften called \"r<sub>s</sub>\" [see for example N. D. Lang and W. Kohn PRB 1, 4555 (1970)],\n<b>slabwsrad</b> is the radius of a sphere which has the same volume\nas the average volume per particle in a homogeneous electron gas with density n<sub>bulk</sub>, so:\n<pre>\n1/n<sub>bulk</sub> = 4/3 Pi * <a href=\"vargs.html#slabwsrad\">slabwsrad</a><sup>3</sup>\n</pre>\nFor example, the bulk aluminum fcc lattice constant\nis a=4.0495 Angstroms (webelements.com), each cubic centered cell\nincludes 4 Al atoms and each atom has 3 valence electrons,\nso the average volume per electron is a<sup>3</sup>/12=37.34 Bohr<sup>3</sup>\nwhich has to be equal to 4/3 Pi*r<sub>s</sub><sup>3</sup>.\nConsequently Al has approximately r<sub>s</sub>=2.07 Bohr, while for example magnesium has r<sub>s</sub>=2.65 Bohr, sodium 3.99 Bohr.\n<br>\nBy default, given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms).",
    "vartype": "real parameter "
  },
  "slabzbeg": {
    "category": "",
    "default": "0.0d0, 0.0d0.  ",
    "definition": "jellium SLAB BEGinning edge along the Z direction",
    "section": "vargs",
    "text": "<p>\nDefine the edges of the jellium slab (if used, so if <a href=\"vargs.html#jellslab\">jellslab</a> &ne 0)\nalong z, namely the slab starts at a point along z which is expressed in Bohr by <b>slabzbeg</b>\nand it ends at a point expressed in Bohr by <b>slabzend</b>.\nThe z direction is parallel to the third crystal primitive lattice vector\nwhich has to be orthogonal to the other ones,\nso the length of the cell along z is <a href=\"varbas.html#rprimd\">rprimd</a>(3,3).\nIn addition <b>slabzbeg</b> and <b>slabzend</b> have to be such that:\n<pre>\n0 &le <b>slabzbeg</b> &lt <b>slabzend</b> &le <a href=\"varbas.html#rprimd\">rprimd</a>(3,3)\n</pre>\nTogether with <a href=\"vargs.html#slabwsrad\">slabwsrad</a>\nthey define the jellium positive charge density distribution n<sub>+</sub>(x,y,z) in this way:\n<pre>\nn<sub>+</sub>(x,y,z) = n<sub>bulk</sub>   if <b>slabzbeg</b> &le z &le <b>slabzend</b>\n= 0      otherwise,\n</pre>\nso the positive charge density is invariant along the xy plane as well as the electrostatic potential generated by it.",
    "vartype": "real parameter "
  },
  "slabzend": {
    "category": "",
    "default": "0.0d0, 0.0d0.  ",
    "definition": "jellium SLAB ENDing edge along the Z direction",
    "section": "vargs",
    "text": "<p>\nDefine the edges of the jellium slab (if used, so if <a href=\"vargs.html#jellslab\">jellslab</a> &ne 0)\nalong z, namely the slab starts at a point along z which is expressed in Bohr by <b>slabzbeg</b>\nand it ends at a point expressed in Bohr by <b>slabzend</b>.\nThe z direction is parallel to the third crystal primitive lattice vector\nwhich has to be orthogonal to the other ones,\nso the length of the cell along z is <a href=\"varbas.html#rprimd\">rprimd</a>(3,3).\nIn addition <b>slabzbeg</b> and <b>slabzend</b> have to be such that:\n<pre>\n0 &le <b>slabzbeg</b> &lt <b>slabzend</b> &le <a href=\"varbas.html#rprimd\">rprimd</a>(3,3)\n</pre>\nTogether with <a href=\"vargs.html#slabwsrad\">slabwsrad</a>\nthey define the jellium positive charge density distribution n<sub>+</sub>(x,y,z) in this way:\n<pre>\nn<sub>+</sub>(x,y,z) = n<sub>bulk</sub>   if <b>slabzbeg</b> &le z &le <b>slabzend</b>\n= 0      otherwise,\n</pre>\nso the positive charge density is invariant along the xy plane as well as the electrostatic potential generated by it.",
    "vartype": "real parameter "
  },
  "smdelta": {
    "category": "<a href=\"../users/abinit_help.html#respfn\">RESPFN</a>  ",
    "default": "0",
    "definition": "SMeared DELTA function ",
    "section": "varrf",
    "text": "<p>\nWhen <b>smdelta</b> in non-zero, it will trigger the calculation of the imaginary part of the second-order electronic eigenvalues, which can be related to the electronic lifetimes. The delta function is evaluated using:\n<br>\n<ul>\n<li> when <b>smdelta</b> == 1, Fermi-Dirac smearing : 0.25_dp/(cosh(xx/2.0_dp)**2 </li>\n<li> when <b>smdelta</b> == 2, Cold smearing by Marzari using the parameter a=-.5634 (minimization of the bump): exp(-xx2)/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx))) </li>\n<li> when <b>smdelta</b> == 3, Cold smearing by Marzari using the parameter a=-.8165 (monotonic function in the tail): as 2 but different a </li>\n<li> when <b>smdelta</b> == 4, Smearing of Methfessel and Paxton (PRB40,3616(1989)) with Hermite polynomial of degree 2, corresponding to \"Cold smearing\" of N. Marzari with a=0 (so, same smeared delta function as smdelta=2, with different a). </li>\n<li> when <b>smdelta</b> == 5, Gaussian smearing :  1.0d0*exp(-xx**2)/sqrt(pi) </li>\n</ul>\n",
    "vartype": "integer parameter "
  },
  "so_psp": {
    "category": " ",
    "default": "<a href=\"vargs.html#npsp\">npsp</a>*1 ",
    "definition": "Spin-Orbit treatment for each PSeudoPotential ",
    "section": "vargs",
    "text": "<p>\nFor each type of atom (each pseudopotential), specify\nthe treatment of spin-orbit interaction (if <a href=\"vargs.html#nspinor\">nspinor</a>==2).\n<br> If 0 : no spin-orbit interaction, even if <a href=\"vargs.html#nspinor\">nspinor</a>=2\n<br> If 2 : treat spin-orbit in the HGH form\n(not allowed for all pseudopotentials)\n<br> If 3 : treat spin-orbit in the HFN form\n(not allowed for all pseudopotentials)\n<p>Also, <b>so_psp</b>=1 lead automatically to treatments 0, 2, or 3 according\nto the data contained in the pseudopotential file\n(0= there is no spin-orbit information in the psp file;\n2= the spin-orbit information is of the HGH form;\n3= the spin-orbit information is of the HFN form )\nSo, for typical usage, one will need only the values 0 or 1\n<p>Note that if <a href=\"vargs.html#nspinor\">nspinor</a>==1, the spin-orbit cannot be treated\nanyhow, so the value of <b>so_psp</b> is irrelevant.\n<p>Prior to v5.4, the input variable <b>so_typat</b>\nwas used, in place of <b>so_psp</b>. Because the values 0 and 1 have been switched\nbetween <b>so_psp</b> and so_typat, it was dangerous to continue to allow the use of so_typat.\n",
    "vartype": "integer array <b>so_psp</b>(<a href=\"vargs.html#npsp\">npsp</a>) "
  },
  "soenergy": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0 ",
    "definition": "Scissor Operator ENERGY ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,4,99 that is, screening, sigma or Bethe-Salpeter calculations.\n<p>\nThe Scissors operator energy added to the conductions states.\nIn some cases, it mimics a second iteration self-consistent GW calculation.\n",
    "vartype": "real "
  },
  "spbroad": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.0 ",
    "definition": "SPectral BROADening ",
    "section": "vargw",
    "text": "Only relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3 and\n<a href=\"vargw.html#spmeth\">spmeth</a>=2, that is, screening calculations\nbased on the spectral reprentation of the irreducible polarizability in which\nthe delta function is replaced by the gaussian approximant whose standard deviation\nis given by <b>spbroad</b>.\n\n",
    "vartype": "real parameter "
  },
  "spgaxor": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>  ",
    "default": "1.",
    "definition": "SPace Group : AXes ORientation ",
    "section": "vargeo",
    "text": "<p>\nIt is taken into account only when <a href=\"vargeo.html#spgroup\">spgroup</a>/=0; it\nallows one to define the axes orientation\nfor the specific space groups for which this is needed.\nTrigonal groups (number 146,148,155,160,161,166,167):\n<ul>\n<li> 1 represents the hexagonal axes</li>\n<li> 2 represents the rhombohedral axes</li>\n</ul>\nOrthorhombic space groups :\nthere are six possibilities corresponding to the possible\naxes permutations\n<ul>\n<li> 1 abc -> abc</li>\n<li> 2 abc -> cab</li>\n<li> 3 abc -> bca</li>\n<li> 4 abc -> acb</li>\n<li> 5 abc -> bac</li>\n<li> 6 abc -> cba</li>\n</ul>\nMonoclinic : there are 3 or 9 possibilities depending on\nthe space group. See the space group\n<a href=\"../users/spacegrouphelpfile.html\">help file</a> for details.\nIn the log/output file the notation used to describe the\nmonoclinic groups is for example:<br>\n15:c1, A2/a_c = C2/c<br>\nwhere,\n<ul>\n<li>15 represents the space group number,</li>\n<li>c1 the orientation as it appears on the web page, </li>\n<li>A is the real Bravais type lattice, </li>\n<li>2/a the existent symmetry elements, </li>\n<li>_c marks the orientation of the two-fold axis or of the mirror plane, </li>\n<li>C2/c represents the parent space group.</li>\n</ul>\n",
    "vartype": " integer parameter"
  },
  "spgorig": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>  ",
    "default": "1.",
    "definition": "SPace Group : ORIGin  ",
    "section": "vargeo",
    "text": "<p>\nGives the choice of origin for the axes system,\ntaken into account only when <a href=\"vargeo.html#spgroup\">spgroup</a>/=0,\n<br>It is defined according to the origin choice in the\nInternational Tables of Crystallography.\n<br>It applies only to the space groups 48, 50, 59, 70, 85, 86, 88, 125,\n126, 129, 130, 133, 134, 137, 141, 142, 201, 203, 222, 224, 227, 228.\n<br>For details see the space group\n<a href=\"../users/spacegrouphelpfile.html\">help file</a>.",
    "vartype": "integer parameter "
  },
  "spgroup": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>  ",
    "default": "0.",
    "definition": "SPace GROUP number ",
    "section": "vargeo",
    "text": "<p>\nGives the number of the space group.\n<br>If <b>spgroup</b> is 0, the code assumes that all the symmetries\nare input through the <a href=\"varbas.html#symrel\">symrel</a> matrices and the <a href=\"varbas.html#tnons\">tnons</a>\nvectors, or obtained from the symmetry finder (the default when\n<a href=\"varbas.html#nsym\">nsym</a>==0).\n<br>It should be between 1 and 230.  This option can be\nused to obtain all the atoms in the unit cell, starting\nfrom the assymetric unit cell.\n<br>The references for computing the symmetry corresponding to\nthe space groups are :\n<ul>\n<li>International Tables for Crystallography, 1983, Ed. Theo Hahn,\nD. Reidel Publishing Company</li>\n<li>The mathematical theory of symmetry in solids,\nRepresentation theory for point groups and space groups, 1972,\nC.J. Bradley and A.P. Cracknell, Clarendon Press, Oxford.</li></ul>\n<br>For details see the space group\n<a href=\"../users/spacegrouphelpfile.html\">help file</a>.\n",
    "vartype": "integer parameter "
  },
  "spgroupma": {
    "category": "<a href=\"../users/abinit_help.html#symmetriser\">SYMMETRISER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "0.",
    "definition": "SPace GROUP number defining a MAgnetic space group",
    "section": "vargeo",
    "text": "<p>\nThis input variable might be used to define a Shubnikov\nmagnetic space group (anti-ferromagnetic space group). The user is advised to consult\n\"The mathematical theory of symmetry in solids,\nRepresentation theory for point groups and space groups, 1972,\nC.J. Bradley and A.P. Cracknell, Clarendon Press, Oxford.\"\n<br>A Shubnikov type IV magnetic space group might be defined by its Fedorov space group\n(set of spatial symmetries that do not change the magnetisation), and an additional\nmagnetic space group number <b>spgroupma</b>.\n<br>A Shubnikov type III magnetic space group might be defined by its Fedorov space group\n(set of all spatial symmetries, irrespective of their magnetic action), and an additional\nmagnetic space group number <b>spgroupma</b>.\n<br>For the additional number <b>spgroupma</b>, we follow the definition of Table 7.4 of the\nabove-mentioned Bradley and Cracknell textbook.\n<br>Thus, one way to specify a Shubnikov IV magnetic space group, is to define both\n<a href=\"vargeo.html#spgroup\">spgroup</a> and <b>spgroupma</b>.\n<br>For example, the group P2_1/c' has <a href=\"vargeo.html#spgroup\">spgroup</a>=14\nand <b>spgroupma</b>=78.\n<br>Alternatively,\nfor Shubnikov IV magnetic groups, one might\ndefine <a href=\"vargeo.html#spgroup\">spgroup</a> and <a href=\"vargeo.html#genafm\">genafm</a>.\nFor both the type III and IV, one might\ndefine by hand the set of symmetries, using <a href=\"varbas.html#symrel\">symrel</a>,\n<a href=\"varbas.html#tnons\">tnons</a> and <a href=\"vargs.html#symafm\">symafm</a>\n",
    "vartype": "integer parameter "
  },
  "spinat": {
    "category": " ",
    "default": "0.0d0.",
    "definition": "SPIN for AToms ",
    "section": "vargs",
    "text": "<p>\nGives the initial electronic spin-magnetisation\nfor each atom, in unit of h-bar/2.\n<p>Note that if <a href=\"vargs.html#nspden\">nspden</a>=2,\nthe z-component must be given\nfor each atom, in triplets (0 0 z-component).\n<br>For example, the electron of an hydrogen atom\ncan be spin up (0 0 1.0) or spin down (0 0 -1.0).\n<p>This value is only used to create\nthe first exchange and correlation potential,\nand is not used anymore afterwards.\n<br>It is not checked against the initial occupation numbers\n<a href=\"vargs.html#occ\">occ</a> for each spin channel.\n<br>It is meant to give an easy way to break\nthe spin symmetry, and to allow\nto find stable local spin fluctuations, for example :\nantiferromagnetism, or the spontaneous spatial\nspin separation of elongated H2 molecule.\n<br><br><li>If the geo builder is used, <b>spinat</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).</li>\n<br><li>If the geo builder is not used, and the symmetries\nare not specified by the user (<a href=\"varbas.html#nsym\">nsym</a>=0),\nspinat will be used, if present, to determine the anti-ferromagnetic\ncharacteristics of the symmetry operations, see <a href=\"vargs.html#symafm\">symafm</a>.<br>\nIn case of collinear antiferromagnetism\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2),\nthese symmetries are used to symmetrize the density.<br>\nIn case of non-collinear magnetism\n(<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=4),\nthey are also used to symmetrize the density.\nIn the latter case, this strongly constrains the magnetization (imposing its direction).\nIf the user want to let all degrees of freedom of the magnetization evolve, it is\nthen recommended to put <a href=\"varbas.html#nsym\">nsym</a>=1.<br>\n</li>\n<br><li>If the symmetries are specified, and the irreducible set of atoms\nis specified, the anti-ferromagnetic characteristics of the symmetry\noperations <a href=\"vargs.html#symafm\">symafm</a> will be used to generate\n<b>spinat</b> for all the non-irreducible atoms.</li>\n<br><li>In the case of PAW+U calculations using the <a href=\"varpaw.html#dmatpawu\">dmatpawu</a>\ninitial occupation matrix, and if <a href=\"vargs.html#nspden\">nspden</a>=4, <b>spinat</b> is\nalso used to determine the direction of the integrated magnetization matrix.</li>\n",
    "vartype": "real array spinat(3,<a href=\"varbas.html#natom\">natom</a>) or spinat(3,<a href=\"vargeo.html#natrd\">natrd</a>) if the symmetriser is used  "
  },
  "spinmagntarget": {
    "category": " ",
    "default": "-99.99d0",
    "definition": "SPIN-MAGNetization TARGET ",
    "section": "varff",
    "text": "<p>\nThis input variable is active only in the\n<a href=\"varbas.html#nsppol\">nsppol</a>=2 case.\nIf <b>spinmagntarget</b> is not the \"magic\" value of -99.99d0, the\nspin-magnetization of the system will be fixed (or optimized, if it is not possible to impose it)\nto the value of <b>spinmagntarget</b>.\n<br>If <a href=\"varbas.html#occopt\">occopt</a> is a metallic one, the\nFermi energies for spin up and spin down are adjusted to give the target\nspin-polarisation (this is equivalent to an exchange splitting).\nIf <a href=\"varbas.html#occopt\">occopt</a>=1 and <a href=\"varbas.html#nsppol\">nsppol</a>=2,\nthe occupation numbers for spin up and spin down will be adjusted to give the required\nspin-magnetization (occupation numbers are identical for all k-points, with <a href=\"varbas.html#occopt\">occopt</a>=1)\n<br>\nIf <b>spinmagntarget</b> is the default one, the spin-magnetization will not be constrained,\nand will be determined self-consistently, by having the same spin up and spin down\nFermi energy in the metallic case, while for the other cases, there will be no spin-magnetization,\nexcept for an odd number of electrons if <a href=\"varbas.html#occopt\">occopt</a>=1 and <a href=\"varbas.html#nsppol\">nsppol</a>=2.\n<p>\nNote : for the time being, only the spin down Fermi energy\nis written out in the main output file. In the fixed\nmagnetic moment case, it differs from the\nspin up Fermi energy.\n",
    "vartype": "real parameter  "
  },
  "spmeth": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "0  </b>",
    "definition": "SPectral METHod ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4, that is, sigma calculations.\n<p>\nThe <b>spmeth</b> input variable defines the method used to calculate the irreducible\npolarizability $\\chi^{(0)}_{KS}$.\n<p>\nBy default $\\chi^{(0)}_{KS}$ is calculated employing the Adler-Wiser expression (<b>spmeth</b>=0)\nwith a CPU effort that scales linearly with the number of frequencies.\nThis approach is convenient when few frequencies are required, and is usually\nused in conjunction with plasmon-pole models in which only one or two frequencies are calculated,\naccording to the value of <a href=vargw.html#ppmodel\">ppmodel</a>.\n<br>\nUnfortunately a calculation based on the Adler-Wiser expression might be quite CPU demanding\nif the matrix elements of the self-energy operator are evaluated by performing numerically\nthe convolution defining the self-energy.\nThe integrand function, indeed, has poles above and below the real axis, and\nthe screened interaction has to be evaluated on a dense frequency mesh in order to obtain accurate\nresults.\n<p>\nIn the spectral method (<b>spmeth</b>=1 or 2) the irreducible polarizability is expressed as\nthe Hilbert transform of the imaginary part.\nThe advantage in using this approach consists in the fact that, once the spectral function is known,\nthe irreducible polarizability for an arbitrary frequency can be easily obtained through inexpensive\nintegrations. On the other hand an accurate evaluation of the imaginary part requires a dense\nfrequency mesh due to the presence of delta functions.\nTwo different approaches can be used to approximate these delta functions thus allowing the use\nof affordable frequency grids.\n<p>\nSummarizing:\n\n<ul>\n<li> 0 =&gt; use Adler-Wiser expression to calculate $\\chi^{(0)}_{KS}$  </li>\n<li> 1 =&gt; use the spectral method approximating the delta function with a triangular approximant\nas proposed in <B>REF TO BE ADDED</B> </li>\n<li> 2 =&gt; use spectral method but approximating the delta function with a Taylor expansion of the exponential\nas proposed in <B>REF TO BE ADDED</B> </li>\n</ul>\n",
    "vartype": "integer "
  },
  "spnorbscl": {
    "category": "",
    "default": "1.d0",
    "definition": "SPin-ORBit SCaLing",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#pawspnorb\">pawspnorb</a> = 1 (or greater).<br>\nScaling of the spin-orbit interaction. The default values gives the first-principles value, while\nother values are used for the analysis of the effect of the spin-orbit interaction,\nbut are not expected to correspond to any physical situation.\n\n",
    "vartype": "real "
  },
  "stmbias": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.00",
    "definition": "Scanning Tunneling Microscopy BIAS voltage ",
    "section": "vargs",
    "text": "<p>\nGives, in Hartree, the\nbias of the STM tip, with respect to the sample, in order to generate\nthe STM density map.\n<br>Used with positive <a href=\"varbas.html#iscf\">iscf</a>,\n<a href=\"varbas.html#occopt\">occopt</a>=7 (metallic, gaussian),\n<a href=\"varbas.html#nstep\">nstep</a>=1 ,\nand positive <a href=\"varfil.html#prtstm\">prtstm</a>, this\nvalue is used to generate a charge density map from electrons\nclose to the Fermi energy, in a (positive or negative) energy range.\nPositive <b>stmbias</b> will lead to the inclusion of occupied (valence) states only, while\nnegative <b>stmbias</b> will lead to the inclusion of unoccupied (conduction) states only.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>stmbias</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics\n(0.001 Ha = 27.2113845 meV = 315.773 Kelvin).\nWith <a href=\"varbas.html#occopt\">occopt</a>=7,\none has also to specify an independent broadening <a href=\"vargs.html#tsmear\">tsmear</a>.\n",
    "vartype": "real parameter "
  },
  "strfact": {
    "category": "",
    "default": "100.0 (Bohr^2)",
    "definition": "STRess FACTor ",
    "section": "varrlx",
    "text": "<p>\nThe stresses multiplied\nby <b>strfact</b> will be treated like forces in the\nprocess of optimization (<a href=\"varrlx.html#ionmov\">ionmov</a>=2,\nnon-zero\n<a href=\"varrlx.html#optcell\">optcell</a>).\n<br>\nFor example, the stopping criterion defined by\n<a href=\"varrlx.html#tolmxf\">tolmxf</a> relates to these scaled\nstresses.\n",
    "vartype": "real parameter "
  },
  "string_algo": {
    "category": "",
    "default": "<b>string_algo</b>=1",
    "definition": "STRING method ALGOrithm ",
    "section": "varrlx",
    "text": "<p>\nRelevant only when <a href=\"varrlx.html#imgmov\">imgmov</a>=2 (String Method).<br>\nGives the variant of the String Method method used.<br>\nPossible values can be:<br>\n<ul>\n<li>0=&gt; <b>Original String Method</b>.<br>\nNOT YET IMPLEMENTED<br>\n<i>See: Phys. Rev. B 66, 052301 (2002)</i>\n</li>\n<br>\n<li>1=&gt; <b>Simplified String Method</b> with parametrization by <b>equal arc length</b>.<br>\nInstead of using the normal force (wr the band), the full force is used; the\nreparametrization is enforced by keeping the points of the string equally spaced.<br>\n<i>See: J. Chem. Phys. 126, 164103 (2007)</i>\n</li>\n<br>\n<li>2=&gt; <b>Simplified String Method</b> with parametrization by <b>energy-weighted arc length</b>.<br>\nA variant of the Simplified String Method (like 2-); the reparametrization is done by using\nenergy-weight arc-lengths, giving a finer distribution near the saddle point..<br>\n<i>See: J. Chem. Phys. 126, 164103 (2007) and J. Chem. Phys. 130, 244108 (2009)</i>\n</li>\n</ul>\n",
    "vartype": "integer parameter"
  },
  "strprecon": {
    "category": "",
    "default": "1.0 ",
    "definition": "STRess PRECONditioner ",
    "section": "varrlx",
    "text": "<p>\nThis is a scaling factor to initialize the part of\nthe Hessian related to the treatment of the stresses (optimisation\nof the unit cell). In case there is an instability, decrease the\ndefault value, e.g. set it to 0.1 .\n",
    "vartype": "real parameter "
  },
  "strtarget": {
    "category": "",
    "default": "6*0.0 (Ha/Bohr**3)",
    "definition": "STRess TARGET ",
    "section": "varrlx",
    "text": "<p>\nThe optimization of cell size and shape,\nas might be asked through <a href=\"varrlx.html#optcell\">optcell</a>,\nwill target\nthe stress tensor defined by\nby <b>strtarget</b>, or part thereof (if restricted optimizations\nare asked, like fixed shape). Presently, this required target\nstress is not taken into account for the determination of\nthe symmetries. If it breaks the symmetries of the input unit cell,\nso that <a href=\"varbas.html#symrel\">symrel</a> disagrees with <b>strtarget</b>,\nthe result will be unreliable. Also, presently, the thermodynamical\npotential to be used in this situation (the free energy) does not\nreplace the total energy, so that, for exemple,\n<a href=\"varrlx.html#ionmov\">ionmov</a>=3 cannot be used,\nsince this algorithm is taking into account the total energy.\n</font>\n<p><font id=\"text\">The components of the stress tensor must be stored\naccording to :\n(1,1)-&gt;1 ; (2,2)-&gt;2 ; (3,3)-&gt;3 ; (2,3)-&gt;4 ; (3,1)-&gt;5 ;\n(1,2)-&gt;6.\nThe conversion factor\nbetween Ha/Bohr**3 and GPa is : 1 Ha/Bohr**3 = 29421.033d0 GPa.\n<br>\nNot used if <a href=\"varrlx.html#optcell\">optcell</a>==0.\n",
    "vartype": "real array strtarget(6) "
  },
  "suskxcrs": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "SUSceptibility times KXC treated in real space ",
    "section": "vardev",
    "text": "<p>\nOnly relevant for the ACFD calculation of total energies.\nIf <b>suskxcrs</b>=1, the XC kernel is not treated in\nreciprocal space, but combined with the susceptibility (chi_0), to avoid\nKxc divergences where the density goes to zero (G. Onida &amp; M. Gatti !)\n<p>\nNot applicable for RPA (as there should be a Kxc present). Initially tested for ikhxc==2 (ALDA).\n",
    "vartype": "integer"
  },
  "symafm": {
    "category": " ",
    "default": "<a href=\"varbas.html#nsym\">nsym</a>*1.",
    "definition": "SYMmetries, Anti-FerroMagnetic characteristics ",
    "section": "vargs",
    "text": "<p>\nIn case the material is magnetic (well, this is only interesting in the\ncase of antiferromagnetism, collinear or not), additional symmetries might appear, that\nchange the sign of the magnetisation.\nThey have been introduced by Shubnikov (1951). They can be used by ABINIT\nto decrease the CPU time, by using them to decrease the number of k-points.\n<br> <b>symafm</b> should be set to +1 for all the usual symmetry operations,\nthat do not change the sign of the magnetisation, while it should be\nset to -1 for the magnetisation-changing symmetries.\n<br> If the symmetry operations are not specified by the user\nin the input file, that is, if <a href=\"varbas.html#nsym\">nsym</a>=0,\nthen ABINIT will use the values of <a href=\"vargs.html#spinat\">spinat</a>\nto determine the content of <b>symafm</b>.<br>\nThe symmetries found as \"antiferro magnetic\" (<b>symafm</b>=-1) are used to symmetrize density and magnetization in the following cases:<br>\n- antiferromagnetism (<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=2)<br>\n- non-collinear magnetism (<a href=\"varbas.html#nsppol\">nsppol</a>=1,\n<a href=\"vargs.html#nspinor\">nspinor</a>=1,\n<a href=\"vargs.html#nspden\">nspden</a>=4)<br>\nIn other cases they are not used.\n",
    "vartype": "integer array symafm(<a href=\"varbas.html#nsym\">nsym</a>) "
  },
  "symchi": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, GW ",
    "default": "1 ",
    "definition": "SYMmetryze \\chi_o ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3, that is, screening calculations.\n<p>\nThe evaluation of the irreducible polarizability for a given q-point requires an\nintegration over the Brillouin zone (BZ) which is approximated by a discrete sum over k-points.\nIn principle the integrand function should be evaluated for each k-point in the BZ, however it is possible\nto reduce the number of points to be explicitly considered by taking advantage of symmetry properties.\nThe development input variable <b>symchi</b> is used to choose between these two equivalent methods:\n\n<ul>\n<li> 0=&gt; the summation over k-points is performed considering ALL the points in the BZ (useful for testing and debugging).\n<li> 1=&gt; the summation is restricted to the k-points belonging to the irreducible wedge\ndefined by the little group associated to the external vector q.\n</ul>\n\n",
    "vartype": "integer "
  },
  "symmorphi": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, GW ",
    "default": "1",
    "definition": "SYMMORPHIc symmetry operations ",
    "section": "vargw",
    "text": "<p>\nWith <b>symmorphi</b>=1, symmetry operations with a non-symmorphic vector are allowed.\nWith <b>symmorphi</b>=0, they are not allowed.\nIn the latter case, if the symmetry operations are specified in the input file, the code\nwill stop and print an error message if a non-symmorphic vector is encountered.\nBy contrast, if the symmetry operations are to be determined automatically\n(if <a href=\"varbas.html#nsym\">nsym</a>=0), then the set of symmetries will\nnot include the non-symmorphic operations.\n<p>\nNote : this feature exist because in a previous status of the GW calculations, non-symmorphic\nsymmetry operations could not be exploited. Thus, the k points were restricted\nto the IBZ. In order to prepare GW calculations, and to perform GW calculations,\n<b>symmorphi</b>=0 was to be used, together with <a href=\"varbas.html#nsym\">nsym</a>=0.\n",
    "vartype": "integer parameter"
  },
  "symrel": {
    "category": " ",
    "default": "the identity matrix for one symmetry.",
    "definition": "SYMmetry in REaL space  ",
    "section": "varbas",
    "text": "<p>\nGives \"<a href=\"varbas.html#nsym\">nsym</a>\" 3x3 matrices\nexpressing space group symmetries in terms of their action\non the direct (or real) space primitive translations.\n<br>It turns out that these can always be expressed as integers.\n<br>Always give the identity matrix even if no other symmetries\nhold, e.g.\n<b>symrel</b> 1 0 0 0 1 0 0 0 1\n<br>Also note that for this array as for all others the array\nelements are filled in a columnwise order as is usual for\nFortran.\n<br>The relation between the above symmetry matrices <b>symrel</b>,\nexpressed in the basis of primitive translations, and\nthe same symmetry matrices expressed in cartesian coordinates,\nis as follows.  Denote the matrix whose columns are the\nprimitive translations as R, and denote the cartesian\nsymmetry matrix as S.  Then <br>\n<b>symrel</b> = R(inverse) * S * R <br>\nwhere matrix multiplication is implied.\n<br>When the symmetry finder is used (see <a href=\"varbas.html#nsym\">nsym</a>), <b>symrel</b>\nwill be computed automatically.",
    "vartype": "integer array symrel(3,3,<a href=\"varbas.html#nsym\">nsym</a>)  "
  },
  "symsigma": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0",
    "definition": "SYMmetrization of SIGMA matrix elements ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=4 that is sigma calculations.\n<p>\nThis option is used to switch on the symmetrization of the self-energy matrix elements (<a href=\"vargw.html#symsigma\">symsigma</a>=1).\nIn this case the BZ integration defining the self-energy matrix elements is\nreduced to an appropriate irreducible wedge defined by the point group of the wave-vector k\nspecified in the <a href=\"vargw.html#kptgw\">kptgw</a> list.\n<p>\nThe symmetrized expression leads to a considerable speedup of the run but, unfortunately,\nthis option is not yet compatible with self-consistent GW calculations\n(see <a href=\"vargw.html#gwcalctyp\">gwcalctyp</a>).\n<p>\nThe algorithm implemented in <a href=\"vargw.html#symsigma\">symsigma</a>=1\nconstructs a symmetric invariant for the diagonal matrix elements of the self-energy\nby simply averaging the GW results within the degenerate subspace.\n\nTherefore particular care has to be taken in the presence of accidental degeneracies.\nsince GW calculations performed with <a href=\"vargw.html#symsigma\">symsigma</a>=1 won't be able to remove\nthe initial accidental degeneracy.\n\n",
    "vartype": "integer "
  },
  "td_maxene": {
    "category": "TDDFT  ",
    "default": "0.0",
    "definition": "Time-Dependent dft : MAXimal kohn-sham ENErgy difference ",
    "section": "varrf",
    "text": "<p>\nThe Matrix to be diagonalized in the Casida framework\n(see \"Time-Dependent Density Functional Response Theory of Molecular\nsystems: Theory, Computational Methods, and Functionals\", by M.E. Casida,\nin Recent Developments and Applications of Modern Density Functional\nTheory, edited by J.M. Seminario (Elsevier, Amsterdam, 1996).)\nis a NxN matrix, where, by default, N is the product of\nthe number of occupied states by the number of unoccupied states.\n<br>\nThe input variable <b>td_maxene</b> allows to diminish N : it selects\nonly the pairs of occupied and unoccupied states for which the\nKohn-Sham energy difference is less than <b>td_maxene</b>.\nThe default value 0.0 means that all pairs are taken into account.\n<br>See <a href=\"varrf.html#td_mexcit\">td_mexcit</a> for an alternative\nway to decrease N.\n",
    "vartype": "real parameter "
  },
  "td_mexcit": {
    "category": "TDDFT  ",
    "default": "0.",
    "definition": "Time-Dependent dft : Maximal number of EXCITations ",
    "section": "varrf",
    "text": "<p>\nThe Matrix to be diagonalized in the Casida framework\n(see \"Time-Dependent Density Functional Response Theory of Molecular\nsystems: Theory, Computational Methods, and Functionals\", by M.E. Casida,\nin Recent Developments and Applications of Modern Density Functional\nTheory, edited by J.M. Seminario (Elsevier, Amsterdam, 1996).)\nis a NxN matrix, where, by default, N is the product of\nthe number of occupied states by the number of unoccupied states.\n<br>\nThe input variable <b>td_mexcit</b> allows to diminish N : it selects\nthe first <b>td_mexcit</b> pairs of occupied and unoccupied states, ordered\nwith respect to increasing Kohn-Sham energy difference.\nHowever, when <b>td_mexcit</b> is zero, all pairs are allowed.\n<br>See <a href=\"varrf.html#td_mexcit\">td_maxene</a> for an alternative\nway to decrease N.\n",
    "vartype": "real parameter "
  },
  "tfkinfunc": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "Thomas-Fermi KINetic energy FUNCtional ",
    "section": "vardev",
    "text": "<p>\n<ul>\n<li>\n<b>tfkinfunc</b>=1 : Thomas-Fermi\nkinetic functional (explicit functional of the density)\nis used instead of Kohn-Sham kinetic energy functional (implicit functional of the density\nthrough Kohn-Sham wavefunctions).\n<br></li>\n<li> <b>tfkinfunc</b>=2 : the Recursion Method is used in order to compute\nelectronic density, entropy, Fermi energy and eigenvalues energy. This\nmethod computes the density without computing any orbital, is\nefficient at high temperature, with a efficient parallelization\n(almost perfect scalability). When that option is in use, the\n<a href=\"varbas.html#ecut\">ecut</a> input variable is no longer a\nconvergence parameter ;\n<a href=\"vargs.html#ngfft\">ngfft</a> becomes\nthe main convergence parameter: you should adapt ecut for the ngfft\ngrid you need (it is not yet automatically computed). Other\nconvergence parameter are for the energetic values:\n<a href=\"vardev.html#recnrec\">recnrec</a>, <a href=\"vardev.html#recptrott\">recptrott</a>,\n<a href=\"vardev.html#recnpath\">recnpath</a>.\nSince the convergence of the self-consistent cycle\nis determined directly by the convergence of the density:\n<a href=\"varbas.html#toldfe\">toldfe</a>,\n<a href=\"varbas.html#toldff\">toldff</a>\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a>,\n<a href=\"varbas.html#tolwfr\">tolwfr</a> are not used, and are replaced by\n<a href=\"vardev.html#rectolden\">rectolden</a>; the energetic values, except for the fermi energy, are only\ncomputed during the latest SFC cycle : the output file will show a\njump of the total energy at the end, but it is not because of a bad\nconvergence behavior. Computational speed can be improved by the use\nof  <a href=\"vardev.html#recrcut\">recrcut</a> and  <a href=\"vardev.html#recgratio\">recgratio</a>.\nThe recursion method has not be tested in the case of non cubic cell\nor with the use of symmetries.\nIn the recursion method the following variables are set to:\n<br> <a href=\"vardev.html#useylm\">useylm</a>=1,\n<br> <a href=\"varint.html#userec\">userec</a>=1.\n</ul>\n</li>\n",
    "vartype": "integer"
  },
  "timopt": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "1 for sequential code, 0 for parallel code.",
    "definition": "TIMing OPTion ",
    "section": "vargs",
    "text": "<p>\nThis input variable allows to modulate the use of the timing routines.\n<p>\nIf 0 => as soon as possible, suppresses all calls to timing routines\n<br>\nIf 1 => usual timing behaviour, with short analysis, appropriate\nfor sequential execution\n<br>\nIf 2 => close to <b>timopt</b>=1, except that the analysis routine\ndoes not time the timer, appropriate for parallel execution.\n<br>\nIf 3 => close to <b>timopt</b>=1, except that the different parts of the lobpcg routine are timed in detail.\n<br>\nIf 4 => close to <b>timopt</b>=1, except that the different parts of the lobpcg routine are timed in detail.\nA different splitting of lobpcg than for <b>timopt</b>=-3 is provided.\n<br>\nIf -1 => a full analysis of timings is delivered\n<br>\nIf -2 => a full analysis of timings is delivered,\nexcept timing the timer\n<br>\nIf -3 => a full analysis of timings is delivered, including the detailed timing of the different parts of the lobpcg routine.\n(this takes time, and is discouraged for too small runs - the timing would take more time than the run !). The timer is timed.\n\n<br>\nIf -4 => a full analysis of timings is delivered, including the detailed timing of the different parts of the lobpcg routine.\nA different splitting of lobpcg than for <b>timopt</b>=-3 is provided\n(this takes time, and is discouraged for too small runs - the timing would take more time than the run !). The timer is timed.\nThe sum of the independent parts is closer to 100% than for <b>timopt</b>=-3.\n",
    "vartype": "integer parameter "
  },
  "tl_nprccg": {
    "category": " ",
    "default": "30.",
    "definition": "TaiL maximum Number of PReConditionner Conjugate Gradient iterations ",
    "section": "vargs",
    "text": "<p>\nThis variable is the same than <a href=\"#wvl_nprccg\">wvl_nprccg</a>\nbut for the preconditionner iterations during the tail\ncorrections (see <a href=\"#tl_radius\">tl_radius</a>).\n\nTO BE IMPROVED : all tl_* and wvl_* variables should contain a link to a tutorial, David Waroquiers 090831.\n",
    "vartype": "integer parameter "
  },
  "tl_radius": {
    "category": "<a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "0.0d0.",
    "definition": "TaiL expansion RADIUS ",
    "section": "vargs",
    "text": "<p>\nIn the wavelet computation case, the linkage between the grid and the\nfree boundary conditions can be smoothed using an exponential\ndecay. This means a correction on the energy at the end on each\nwavefunction optimisation run. If this parameter is set to zero,\nno tail computation is done. On the contrary, put it to a\npositive value makes the tail correction available. The value\ncorrespond to a length in atomic units being the spacial expansion\nwith the exponential decay around the grid.\n",
    "vartype": "real parameter "
  },
  "tnons": {
    "category": " ",
    "default": "",
    "definition": "Translation NON-Symmorphic vectors ",
    "section": "varbas",
    "text": "<p>\nGives the (nonsymmorphic) translation\nvectors associated with the symmetries expressed\nin \"<a href=\"varbas.html#symrel\">symrel</a>\".\n<br>These may all be 0, or may be fractional (nonprimitive)\ntranslations expressed relative to the real space\nprimitive translations (so, using the \"reduced\" system\nof coordinates, see \"<a href=\"varbas.html#xred\">xred</a>\").\nIf all elements of the space\ngroup leave 0 0 0 invariant, then these are all 0.\n<br>When the symmetry finder is used (see <a href=\"varbas.html#nsym\">nsym</a>), <b>tnons</b>\nis computed automatically.",
    "vartype": "real array tnons(3,<a href=\"varbas.html#nsym\">nsym</a>)  "
  },
  "toldfe": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a>  ",
    "default": "0.0 (stopping condition ignored)",
    "definition": "TOLerance on the DiFference of total Energy ",
    "section": "varbas",
    "text": "<p>\nSets a tolerance for absolute differences\nof total energy that, reached TWICE successively,\nwill cause one SCF cycle to stop (and ions to be moved).\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>toldfe</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n(1 Ha=27.2113845 eV)\n<br>If set to zero, this stopping condition is ignored.\n<br>Effective only when SCF cycles are done (<a href=\"varbas.html#iscf\">iscf</a>>0).\n<br>Because of machine precision, it is not worth to try\nto obtain differences in energy that are smaller\nthan about 1.0d-12 of the total energy.\nTo get accurate stresses may be quite demanding.\n<br>When the geo is optimized (relaxation of atomic positions or primitive vectors), the use of\n<b>toldfe</b> is to be avoided. The use of <a href=\"varbas.html#toldff\">toldff</a> or\n<a href=\"varbas.html#tolrff\">tolrff</a> is by far preferable, in order to have a handle on the\ngeo characteristics. When all forces vanish by symmetry (e.g. optimization of the lattice parameters\nof a high-symmetry crystal), then place <b>toldfe</b> to 1.0d-12, or use (better) <a href=\"varbas.html#tolvrs\">tolvrs</a>.\n<br>Since <b>toldfe</b>, <a href=\"varbas.html#toldff\">toldff</a>,\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a> and <a href=\"varbas.html#tolwfr\">tolwfr</a>\nare aimed at the same goal (causing the SCF cycle to stop),\nthey are seen as a unique input variable at reading. Hence, it is forbidden that two of these input variables\nhave non-zero values for the same dataset, or generically (for all datasets).\nHowever, a non-zero value for one such variable for one dataset will have precedence on the non-zero value for another\ninput variable defined generically.\n\n",
    "vartype": "real parameter  "
  },
  "toldff": {
    "category": " ",
    "default": "0.0 (stopping condition ignored)",
    "definition": "TOLerance on the DiFference of Forces ",
    "section": "varbas",
    "text": "<p>\nSets a tolerance for differences of forces\n(in hartree/Bohr) that, reached TWICE successively,\nwill cause one SCF cycle to stop (and ions to be moved).\n<br>If set to zero, this stopping condition is ignored.\n<br>Effective only when SCF cycles are done (<a href=\"varbas.html#iscf\">iscf</a>>0).\nThis tolerance applies to any particular cartesian\ncomponent of any atom, INCLUDING fixed ones.\nThis is to be used when trying to equilibrate a\nstructure to its lowest energy configuration (<a href=\"varrlx.html#ionmov\">ionmov</a>=2),\nor in case of molecular dynamics (<a href=\"varrlx.html#ionmov\">ionmov</a>=1)\n<br>A value ten times smaller\nthan <a href=\"varrlx.html#tolmxf\">tolmxf</a> is suggested (for example 5.0d-6 hartree/Bohr).\n<br>This stopping criterion is not allowed for RF calculations.\n<br>Since <b>toldfe</b>, <a href=\"varbas.html#toldff\">toldff</a>,\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a> and <a href=\"varbas.html#tolwfr\">tolwfr</a>\nare aimed at the same goal (causing the SCF cycle to stop),\nthey are seen as a unique input variable at reading. Hence, it is forbidden that two of these input variables\nhave non-zero values for the same dataset, or generically (for all datasets).\nHowever, a non-zero value for one such variable for one dataset will have precedence on the non-zero value for another\ninput variable defined generically.\n",
    "vartype": "real parameter  "
  },
  "tolimg": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "5.0d-5 hartree",
    "definition": "TOLerance on the mean total energy for IMaGes ",
    "section": "varrlx",
    "text": "<p>\nSets a maximal absolute energy tolerance (in hartree, averaged over dynamic images)\nbelow which iterations on images (the one governed by the <a\nhref=\"varrlx.html#ntimimage\">ntimimage</a> input variable) will stop.\n<br>\nThis is to be used when trying to optimize a\npopulation of structures to their lowest energy configuration,\ntaking into account the particular algorithm defined by <a href=\"varrlx.html#imgmov\">imgmov</a>\n<br>\nA value of about 5.0d-5 hartree or smaller\nis suggested (this corresponds to about 3.7d-7 eV).\n<br>\nNo meaning for RF calculations.\n",
    "vartype": "real parameter "
  },
  "tolmxf": {
    "category": "",
    "default": "5.0d-5 hartree/Bohr.",
    "definition": "TOLerance on the MaXimal Force ",
    "section": "varrlx",
    "text": "<p>\nSets a maximal absolute force tolerance\n(in hartree/Bohr) below which\nBFGS structural relaxation iterations will stop.\n<br>\nCan also control tolerance on stresses, when <a\nhref=\"varrlx.html#optcell\">optcell</a>/=0,\nusing the conversion factor <a href=\"varrlx.html#strfact\">strfact</a>.\nThis tolerance applies to any particular cartesian\ncomponent of any atom, excluding fixed ones.\nSee the parameter <a href=\"varrlx.html#ionmov\">ionmov</a>.\n<br>\nThis is to be used when trying to equilibrate a\nstructure to its lowest energy configuration (<a\nhref=\"varrlx.html#ionmov\">ionmov</a>=2).\n<br>\nA value of about 5.0d-5 hartree/Bohr or smaller\nis suggested (this corresponds to about 2.5d-3 eV/Angstrom).\n<br>\nNo meaning for RF calculations.\n",
    "vartype": "real parameter "
  },
  "tolrde": {
    "category": " ",
    "default": "0.005",
    "definition": "TOLerance on the Relative Difference of Eigenenergies ",
    "section": "vardev",
    "text": "<p>\nSets a tolerance for the ratio of differences of eigenenergies\nin the line minisation conjugate-gradient algorithm. It compares the\ndecrease of the eigenenergy due to the last line minimisation, with the\none observed for the first line minimisation.\nWhen the ratio is lower than <b>tolrde</b>,\nthe next line minimisations are skipped.\n<br>The number of line minimisations is limited by\n<a href=\"vargs.html#nline\">nline</a> anyhow.\n<br>This stopping criterion is present for both GS and RF calculations.\nIn RF calculations, <b>tolrde</b> is actually doubled before comparing with the above-mentioned\nratio, for historical reasons.",
    "vartype": "real parameter  "
  },
  "tolrff": {
    "category": " ",
    "default": "0.0 (stopping condition ignored)",
    "definition": "TOLerance on the Relative diFference of Forces ",
    "section": "varbas",
    "text": "<p>\nSets a tolerance for the ratio of differences of forces\n(in hartree/Bohr) to maximum force, that, reached TWICE successively,\nwill cause one SCF cycle to stop (and ions to be moved) : diffor < tolrff * maxfor.\n<br>If set to zero, this stopping condition is ignored.\n<br>Effective only when SCF cycles are done (<a href=\"varbas.html#iscf\">iscf</a>>0).\nThis tolerance applies to any particular cartesian\ncomponent of any atom, INCLUDING fixed ones.\nThis is to be used when trying to equilibrate a\nstructure to its lowest energy configuration (<a href=\"varrlx.html#ionmov\">ionmov</a>=2),\nor in case of molecular dynamics (<a href=\"varrlx.html#ionmov\">ionmov</a>=1)\n<br>A value of 0.02 is suggested.\n<br>This stopping criterion is not allowed for RF calculations.\n<br>Since <b>toldfe</b>, <a href=\"varbas.html#toldff\">toldff</a>,\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a> and <a href=\"varbas.html#tolwfr\">tolwfr</a>\nare aimed at the same goal (causing the SCF cycle to stop),\nthey are seen as a unique input variable at reading. Hence, it is forbidden that two of these input variables\nhave non-zero values for the same dataset, or generically (for all datasets).\nHowever, a non-zero value for one such variable for one dataset will have precedence on the non-zero value for another\ninput variable defined generically.\n",
    "vartype": "real parameter  "
  },
  "tolsym": {
    "category": "",
    "default": "1.e-8 ",
    "definition": "TOLERANCE for SYMmetries ",
    "section": "vargeo",
    "text": "<p>\nGives the tolerance on the atomic positions (reduced coordinates), primitive\nvectors, or magnetization, to be considered equivalent, thanks to symmetry operations.\nThis is used in the recognition of the set of symmetries of the system,\nor the application of the symmetry operations to generate from a reduced set of atoms,\nthe full set of atoms. Note that a value larger than 0.01 is considered to be unacceptable.\n<br>\nNote : ABINIT needs the atomic positions to be symmmetric to each others within 1.e-8 .\nIf <b>tolsym</b> is set to a larger value than 1.e-8, then the input atomic coordinates\nwill be automatically symmetrized by the symmetry operations that will have been found.\n",
    "vartype": "real "
  },
  "tolvrs": {
    "category": " ",
    "default": "0.0 (stopping condition ignored)",
    "definition": "TOLerance on the potential V(r) ReSidual ",
    "section": "varbas",
    "text": "<p>\nSets a tolerance for potential\nresidual that, when reached, will cause one SCF cycle\nto stop (and ions to be moved).\n<br>If set to zero, this stopping condition is ignored.\n<br>Effective only when SCF cycles are done (<a href=\"varbas.html#iscf\">iscf</a>>0).\n<br>To get accurate stresses may be quite demanding.\n<p>Additional explanation : the residual of the potential is the difference between the\ninput potential and the output potential, when the latter is obtained from the density\ndetermined from the eigenfunctions of the input potential. When the self-consistency\nloop is achieved, both input and output potentials must be equal, and the residual\nof the potential must be zero. The tolerance on the\npotential residual is imposed by first subtracting the mean of the residual of the potential\n(or the trace of the potential matrix, if the system is spin-polarized),\nthen summing the square of this function over all FFT grid points. The result should be\nlower than <b>tolvrs</b>.\n<br>Since <b>toldfe</b>, <a href=\"varbas.html#toldff\">toldff</a>,\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a> and <a href=\"varbas.html#tolwfr\">tolwfr</a>\nare aimed at the same goal (causing the SCF cycle to stop),\nthey are seen as a unique input variable at reading. Hence, it is forbidden that two of these input variables\nhave non-zero values for the same dataset, or generically (for all datasets).\nHowever, a non-zero value for one such variable for one dataset will have precedence on the non-zero value for another\ninput variable defined generically.\n",
    "vartype": "real parameter  "
  },
  "tolwfr": {
    "category": " ",
    "default": "0.0d0 (stopping criterion ignored)",
    "definition": "TOLerance on WaveFunction squared Residual ",
    "section": "varbas",
    "text": "<p>\nThe signification of this tolerance depends on\nthe basis set. In plane waves, it gives a convergence tolerance for the\nlargest squared \"residual\" (defined below) for any\ngiven band.  The squared residual is:<br>\n<pre>\n&lt; nk|(H-E)<sup>2</sup>|nk &gt;,    E = &lt; nk|H|nk &gt;\n</pre>\n<br>which clearly is nonnegative and goes to 0 as\nthe iterations converge to an eigenstate.\nWith the squared residual expressed in\nHartrees<sup>2</sup> (Hartrees squared), the largest squared\nresidual (called residm) encountered over all bands\nand k points must be less than <b>tolwfr</b> for iterations\nto halt due to successful convergence.\n<br>Note that if <a href=\"varbas.html#iscf\">iscf</a>>0, this criterion should be replaced\nby those based on <a href=\"varbas.html#toldfe\">toldfe</a> (preferred for <a href=\"varrlx.html#ionmov\">ionmov</a>==0),\n<a href=\"varbas.html#toldff\">toldff</a>\n<a href=\"varbas.html#tolrff\">tolrff</a> (preferred for <a href=\"varrlx.html#ionmov\">ionmov</a>/=0), or\n<a href=\"varbas.html#tolvrs\">tolvrs</a> (preferred for theoretical reasons!).\n<br>When <b>tolwfr</b> is 0.0, this criterion is ignored,\nand a finite value of <a href=\"varbas.html#toldfe\">toldfe</a>, <a href=\"varbas.html#toldff\">toldff</a>\nor <a href=\"varbas.html#tolvrs\">tolvrs</a> must be specified.\nThis also imposes a restriction\non taking an ion step; ion steps are not permitted\nunless the largest squared residual is less than\n<b>tolwfr</b>, ensuring accurate forces.\n<br>To get accurate stresses may be quite demanding.\n<br>\nNote that the preparatory GS calculations\nbefore a RF calculations must be highly converged.\n<br>Typical values for these preparatory runs are <b>tolwfr</b>\nbetween 1.0d-16 and 1.0d-22.\n<p> Note that <b>tolwfr</b> is often used in the test cases, but this is\n<em>tolwfr</em> purely for historical reasons :\nexcept when <a href=\"varbas.html#iscf\">iscf</a>&lt;0, other critera\nshould be used.</p>\n<p>In the wavelet case (see <a href=\"varbas.html#usewvl\">usewvl</a> =\n1), this criterion is the favoured one. It is based on the\nnorm 2 of the gradient of the wavefunctions. Typical values\nrange from 5*10<sup>-4</sup> to 5*10<sup>-5</sup>.</p>\n<br>Since <b>toldfe</b>, <a href=\"varbas.html#toldff\">toldff</a>,\n<a href=\"varbas.html#tolrff\">tolrff</a>,\n<a href=\"varbas.html#tolvrs\">tolvrs</a> and <a href=\"varbas.html#tolwfr\">tolwfr</a>\nare aimed at the same goal (causing the SCF cycle to stop),\nthey are seen as a unique input variable at reading. Hence, it is forbidden that two of these input variables\nhave non-zero values for the same dataset, or generically (for all datasets).\nHowever, a non-zero value for one such variable for one dataset will have precedence on the non-zero value for another\ninput variable defined generically.\n",
    "vartype": "real parameter  "
  },
  "tphysel": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.00",
    "definition": "Temperature (PHYSical) of the ELectrons ",
    "section": "vargs",
    "text": "<p>\nGives, in Hartree, the physical temperature of the\nsystem, in case <a href=\"varbas.html#occopt\">occopt</a>=4, 5, 6, or 7.\n<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics\n(0.001 Ha = 27.2113845 meV = 315.773 Kelvin).\nOne has to specify an independent broadening <a href=\"vargs.html#tsmear\">tsmear</a>.\nThe combination of the two parameters\n<b>tphysel</b> and <a href=\"vargs.html#tsmear\">tsmear</a> is described\nin a paper by M. Verstraete and X. Gonze, Phys. Rev. B 65, 035111 (2002).\nNote that the signification of the entropy is modified with respect\nto the usual entropy. The choice has been made to use\n<a href=\"vargs.html#tsmear\">tsmear</a> as a prefactor of the entropy,\nto define the entropy contribution to the free energy.\n",
    "vartype": "real parameter "
  },
  "tsmear": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.04",
    "definition": "Temperature of SMEARing ",
    "section": "vargs",
    "text": "<p>\nGives the broadening of occupation\nnumbers <a href=\"vargs.html#occ\">occ</a>, in the metallic cases\n(<a href=\"varbas.html#occopt\">occopt</a>=3, 4, 5, 6 and 7).\nCan be specified in Ha (the default), eV, Ry, or Kelvin, since\n<b>tsmear</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics\n(0.001 Ha = 27.2113845 meV = 315.773 Kelvin).\n<br>Default is 0.04 Ha. This should be OK for a free-electron\nmetal like Al. For d-band metals, use 0.01 Ha.\n<br>Always check the convergence of the calculation\nwith respect to this parameter, and simultaneously,\nwith respect to the sampling of k-points (see <a href=\"varbas.html#nkpt\">nkpt</a>)\n<br>If <a href=\"varbas.html#occopt\">occopt</a>=3, <b>tsmear</b> is the\nphysical temperature, as the broadening is based on Fermi-Dirac statistics.\nHowever,\nif <a href=\"varbas.html#occopt\">occopt</a>=4, 5, 6, or 7,\nthe broadening is not based on Fermi-Dirac statistics, and\n<b>tsmear</b> is only a convergence parameter. It is still possible\nto define a physical temperature, thanks to the input variable\n<a href=\"vargs.html#tphysel\">tphysel</a>. See the paper\nby M. Verstraete and X. Gonze, Phys. Rev. B (2002).\n",
    "vartype": "real parameter "
  },
  "typat": {
    "category": " ",
    "default": "1 (for <a href=\"varbas.html#natom\">natom</a>=1)",
    "definition": "TYPE of atoms ",
    "section": "varbas",
    "text": "<p>\nArray giving an integer label to every atom in the unit\ncell to denote its type. <br>The different types of atoms\nare constructed from the pseudopotential files.\nThere are at most <a href=\"varbas.html#ntypat\">ntypat</a> types of atoms.\n<br> As an example, for BaTiO3, where the pseudopotential for Ba is number 1,\nthe one of Ti is number 2, and the one of O is number 3, the actual\nvalue of the <b>typat</b> array might be :\n<pre>\ntypat 1 2 3 3 3\n</pre>\n<br>The array <b>typat</b> has to agree with the actual locations\nof atoms given in <a href=\"varbas.html#xred\">xred</a> , <a href=\"varbas.html#xcart\">xcart</a> or\n<a href=\"varbas.html#xangst\">xangst</a>, and the input\nof pseudopotentials has to be ordered to agree with the\natoms identified in <b>typat</b>.\n<br>The nuclear charge of the\nelements, given by the array <a href=\"varbas.html#znucl\">znucl</a>, also must agree with\nthe type of atoms designated in \"<b>typat</b>\".\n<br>The array <b>typat</b> is\nnot constrained to be increasing. An\ninternal representation of the list of atoms,\ndeep in the code (array atindx), groups the atoms of same type\ntogether. This should be transparent to the\nuser, while keeping efficiency.\n",
    "vartype": "integer array typat(<a href=\"varbas.html#natom\">natom</a>) (or : typat(<a href=\"vargeo.html#natrd\">natrd</a>), if the geo builder is used) "
  },
  "ucrpa": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "0",
    "definition": "calculation of the screened interaction U with the Constrained RPA method ",
    "section": "vargw",
    "text": "<p>\nWhen equal to one, this variable allows for the calculation of U with the cRPA method.\nAn explicit test is shown in automatic test v7/t23.\nThe present implementation is non parallelized, do not use symetry over k-points (except inversion),\nand is restricted to the case when correlated bands are isolated (such as in SrVO3).\nThis implementation is thus not yet for production.\nThe constrained calculation of the polarisability can only be done by eliminating\ntransition betweens correlated bands (and not orbitals) with the variable <a href=\"vargw.html#ucrpa_bands\">ucrpa_bands</a>.\n<p>\n",
    "vartype": "integer "
  },
  "ucrpa_bands": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a> ",
    "default": "-1",
    "definition": "For the calculation of U with the Constrained RPA method, gives correlated BANDS ",
    "section": "vargw",
    "text": "<p>\nGives the first and last correlated bands for the cRPA calculation of the polarisability.\n<p>\n",
    "vartype": "integer "
  },
  "udtset": {
    "category": " ",
    "default": "No Default (since it is not used when it is not defined).",
    "definition": "Upper limit on DaTa SETs ",
    "section": "varbas",
    "text": "<p>\nUsed to define the set of indices in the multi-data set\nmode, when a double loop is needed (see later).\n<br>The values of <b>udtset</b>(1) must be between 1 and 999,\nthe values of <b>udtset</b>(2) must be between 1 and 9, and their\nproduct must be equal to <a href=\"varbas.html#ndtset\">ndtset</a>.\n<br>\nThe values of <a href=\"varbas.html#jdtset\">jdtset</a> are obtained by\nlooping on the two indices defined by <b>udtset</b>(1) and  <b>udtset</b>(2) as follows :\n<pre>\ndo i1=1,intarr(1)\ndo i2=1,intarr(2)\nidtset=idtset+1\ndtsets(idtset)%jdtset=i1*10+i2\nend do\nend do\n</pre>\nSo, <b>udtset</b>(2) sets the largest value for the unity digit, that varies between 1 and <b>udtset</b>(2).\n<br>If <b>udtset</b> is used, the input variable <a href=\"varbas.html#jdtset\">jdtset</a> cannot be used.",
    "vartype": "integer array udtset(2)"
  },
  "upawu": {
    "category": "<a href=\"../users/abinit_help.html#energy\">ENERGY</a>",
    "default": "0",
    "definition": "value of U for PAW+U ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#usepawu\">usepawu</a>=1.<br>\nGives the value of the\nscreened coulomb interaction between correlated electrons corresponding\nto <a href=\"varpaw.html#lpawu\">lpawu</a> for each species.<br>\nIn the case where\n<a href=\"varpaw.html#lpawu\">lpawu</a>\n=-1, the value is not used.\n<br>\nIn the case of a GW calculation, the U interaction defined by <b>upawu</b> will be REMOVED from the self energy.\nIn particular, for G0 W0 calculations (perturbative calculations), the energy eigenvalues obtained\nafter an underlying DFT+U calculation will be\n<br>\nE_GW = E_DFT+U + < phi | Self-energy - U | phi>\n<br>\nActually, in order to perform a GW @ DFT+U calculation, one should define the same value of U in the self-energy calculation,\nthan the one defined in the DFT calculation.\nThe easiest is actually to define the value of U for the whole set of calculations (for the different datasets),\nincluding the screening, even if the U value does not play explicitly a role in the computation of the latter (well, the input\nwavefunctions will be different anyhow).\n<br>\nIt is possible to perform calculations of the type GW+U' @ DFT+U , so keeping a U interaction  (usually smaller than the initial U)\nin the GW calculation, by defining a smaller U than the one used in the DFT calculation. This value will be subtracted in the GW correction calculation,\nas outlined above.\n<br> Explicitly, in order to do a calculation of a material with a DFT U value of 7.5 eV, followed by a GW calculation where there is a residual\nU value of 2 eV, one has to define :\n<pre>\nuldau1   7.5 eV   ! This is for the DFT calculation\n...\noptdriver4  4\nuldau4   5.5 eV   ! This is for the screening calculation\n</pre>\n",
    "vartype": "real array upawu(<a href=\"varbas.html#ntypat\">ntypat</a>)"
  },
  "use_gpu_cuda": {
    "category": "",
    "default": "1 for ground-state calculations (<a href=\"vargs.html#optdriver\">optdriver</a>=0) when ABINIT has been compiled using cuda, 0 otherwise",
    "definition": "activate USE of GPU accelerators with CUDA (nvidia)",
    "section": "varpar",
    "text": "<p>\nOnly available if ABINIT executable has been compiled with cuda nvcc compiler.<br>\nThis parameter activates the use of NVidia graphic accelerators (GPU) if present.<br>\nIf <b>use_gp_cuda</b>=1, some parts of the computation are transmitted to the GPUs.<br>\nIf <b>use_gp_cuda</b>=1, no computation is done on GPUs, even if present.<br><br>\nNote that, while running ABINIT on GPUs, it is recommended to use MAGMA external library\n(i.e. Lapack on GPUs). The latter is activated during compilation stage (see \"configure\"\nstep of ABINIT compilation process). If MAGMA is not used, ABINIT performances on GPUs\ncan be poor.\n",
    "vartype": "integer "
  },
  "use_slk": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0",
    "definition": "USE ScaLapacK",
    "section": "varpar",
    "text": "<p>\nIf set to 1, enable the use of ScaLapack within LOBPCG.\n",
    "vartype": "integer parameter  "
  },
  "usedmatpu": {
    "category": "",
    "default": "0",
    "definition": "USE of an initial Density MATrix in Paw+U",
    "section": "varpaw",
    "text": "<p>\nRelevant only when\n<a href=\"varint.html#usepaw\">usepaw</a>=1, and <a\nhref=\"varpaw.html#usepawu\">usepawu</a>=1.<br>\nWhen <b>usedmatpu</b>/=0, an initial density matrix (given by <a href=\"varpaw.html#dmatpawu\">dmatpawu</a>\nkeyword) is used and kept fixed during the first ABS(<b>usedmatpu</b>) SCF steps.<br>\nThis starting value of the density matrix can be useful to find the correct ground state.\nWithin LDA+U formalism, finding the minimal energy of the system is tricky; thus it is advised to test several values\nof the initial density matrix.<br>\nNote also that the density matrix has to respect some symmetry rules determined by the space group.\nIf the symmetry is not respected in the input, the matrix is however automatically symmetrised.<br><br>\nThe sign of <b>usedmatpu</b> has influence only when <a href=\"varrlx.html#ionmov\">ionmov</a>/=0 (dynamics or relaxation):<br>\n- When <b>usedmatpu</b>>0, the density matrix is kept constant only at first ionic step<br>\n- When <b>usedmatpu</b><0, the density matrix is kept constant at each ionic step<br>\n",
    "vartype": "integer parameter "
  },
  "usedmft": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 ",
    "definition": "USE Dynamical Mean Field Theory ",
    "section": "vardev",
    "text": "<p>\nIf set to 1, enable the use of LDA+DMFT, see in particular the important variables\n<a href=\"vardev.html#dmft_solv\">dmft_solv</a>,\n<a href=\"vardev.html#dmftbandi\">dmftbandi</a>,\n<a href=\"vardev.html#dmftbandf\">dmftbandf</a>,\n<a href=\"vardev.html#dmft_nwli\">dmft_nwli</a>,\n<a href=\"vardev.html#dmft_nwlo\">dmft_nwlo</a>,\n<a href=\"vardev.html#dmft_tollc\">dmft_tollc</a>,\nand\t<a href=\"vardev.html#dmft_iter\">dmft_iter</a>.\nDMFT is currently available for collinear (nspinor=1) polarized or unpolarized calculations (nspden=nsppol=2 or nspden=nsppol=1)\nand for non collinear calculations (nspinor=2,nspden=4,nsppol=1). However it is not yet available\nfor collinear antiferromagnetic calculations  (nspden=2,nsppol=1) and non collinear non magnetic calculations (nspden=1, nsppol=1,nspinor=2).\nOnly static calculations without relaxation or dynamics are possible. Relevant quantity from\nconverged DMFT calculations are total energy and spectral function. Total and partail spectral\nfunctions can be obtained with prtdos=1 and can be found in files OUTSpFunc* (where OUT is the root for\noutput files).\n\n(see Amadon, B., Lechermann, F., Georges, A., Jollet, F., Wehling, T. O., and Lichtenstein, A. I. Phys. Rev. B 77(20), (2008)\nand B Amadon 2012 J. Phys.: Condens. Matter 24 075604 )\n\n",
    "vartype": "integer parameter  "
  },
  "useexexch": {
    "category": "",
    "default": "0",
    "definition": "USE of EXact EXCHange ",
    "section": "varpaw",
    "text": "<p>\nWhen <b>useexexch</b>=1, the hybrid functional PBE0 is used\nin PAW, inside PAW spheres only, and only for correlated orbitals given by\n<a href=\"varpaw.html#lexexch\">lexexch</a>. To change the ratio of exact exchange, see also <a href=\"vardev.html#exchmix\">exchmix</a>.\n",
    "vartype": "integer parameter "
  },
  "usekden": {
    "category": " ",
    "default": "0",
    "definition": "USE Kinetic energy DENsity",
    "section": "vargs",
    "text": "<p>\nIf <b>usekden</b>=1 the kinetic energy density will be computed during the self-consistency loop,\nin a way similar to the computation of the density.\nThis is needed if a meta-GGA is to be used as XC functional. Otherwise (<b>usekden</b>=0), the kinetic energy\ndensity is not computed during the self-consistency loop.</p>\n",
    "vartype": "integer "
  },
  "usepaw": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "set by the pseudopotential files : either PAW (1) or norm-conserving (0).",
    "definition": "USE Projector Augmented Waves method ",
    "section": "varint",
    "text": "<p>\nThis variable is determined by the pseudopotentials files.\nPAW calculations (see <a href=\"varpaw.html\">PAW variables</a>) can only\nbe performed with PAW atomic data input files, while\npseudopotential calculations are performed in ABINIT with norm-conserving\npseudopotential input files. Most functionalities in ABINIT are available\nwith either type of calculation.\n",
    "vartype": "integer parameter  "
  },
  "usepawu": {
    "category": "",
    "default": "0",
    "definition": "USE PAW+U (spherical part) ",
    "section": "varpaw",
    "text": "<p>\nMust be non-zero if a DFT+U calculation is done, or if a GW calculation following a DFT+U calculation is done (important !).\n<ul>\n<li> If set to 0, the LDA+U method is not used.<br>\n</li>\n<li> If set to 1 or 2, the LDA+U method (cf [1])  is used. The full rotationally invariant\nformulation is used (see Eq. (3) of Ref [2]) for the interaction term of the energy.\nTwo choices are allowed concerning the double counting term: <br>\n</li>\n<ul>\n<li> If <b>usepawu</b>=1, the Full Localized\nLimit (FLL) (or Atomic limit) double counting is used (cf Eq. (4) of Ref.[2] or\nEq. (8) of Ref[3]).\n<br>\n</li>\n<li> If <b>usepawu</b>=2, the Around Mean Field (AMF) double counting is used\n(cf Eq. (7) of Ref [3]). Not valid if nspinor=2.<br>\n</li>\n</ul>\n</ul>\nIf LDA+U is activated (<b>usepawu</b>=1 or 2), the <a href=\"varpaw.html#lpawu\">lpawu</a>,\n<a href=\"varpaw.html#upawu\">upawu</a> and&nbsp; <a\nhref=\"varpaw.html#jpawu\">jpawu</a>&nbsp; input variables are read. <br>\nThe implementation is done inside PAW augmentation regions only (cf Ref [4]). The initial density matrix can be\ngiven in the input file (see  <a href=\"varpaw.html#usedmatpu\">usedmatpu</a>).\nThe expression of the density matrix is chosen thanks to\n<a href=\"varpaw.html#dmatpuopt\">dmatpuopt</a>. See also <a href=\"../users/How_to_use_LDA_plus_U.txt\">How_to_use_LDA_plus_U.txt</a>.\nfor some informations.\n<br>\nIn the case of a GW calculation on top of a DFT+U, the absence of definition of a U value in the self-energy\nwill LEAVE the underlying U from the DFT calculation.\nThus, the code will actually do a GW+U @ DFT+U calculation.\nNote that the screening calculation will not be affected by the presence/absence of a U value.\n<br>\nActually, in order to perform a GW @ DFT+U calculation, one should define the same value of U in the self-energy calculation,\nthan the one defined in the DFT calculation. The code will know that the interaction corresponding to that value has to be\nSUBTRACTED inside the self-energy. The easiest is actually to define the presence U for the whole set of calculations (for the different datasets),\nincluding the screening, even if the U value does not play explicitly a role in the computation of the latter (well, the input\nwavefunctions will be different anyhow).\n<br>\nIt is possible to perform calculations of the type GW+U' @ DFT+U , so keeping a smaller U interaction in the GW calculation, by subtracting\na smaller U than the one used in the DFT calculation. See the description of the <a href=\"varpaw.html#upawu\">upawu</a> input variable.\n<br>\n\nReferences: <br>\n[1] V. I. Anisimov, J. Zaanen, and O. K. Andersen PRB 44, 943 (1991) <br>\n[2] A.I. Lichtenstein, V.I. Anisimov and J. Zaanen  PRB 52, 5467 (1995) <br>\n[3] M. T. Czyzyk and G.  A. Sawatzky PRB 49, 14211 (1994) <br>\n[4] O. Bengone, M. Alouani, P. Blochl, and J. Hugel PRB 62, 16392 (2000) <br>\n\n<br>\n<br>\nSuggested acknowledgment:<br>\n</span>- B. Amadon, F. Jollet and M. Torrent, Phys. Rev. B 77, 155104 (2008).<br>\n",
    "vartype": "integer parameter "
  },
  "userec": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a> ",
    "default": "Value is 0",
    "definition": "USE RECursion ",
    "section": "varint",
    "text": "<p>\nThis internal variable is set to 1 when the recursion method is\nactivated (see <a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>).\n",
    "vartype": "integer parameter  "
  },
  "useri": {
    "category": " ",
    "default": "0 .",
    "definition": "USER Integer variables A, B, C, D and E ",
    "section": "vardev",
    "text": "<p>\nThese are user-definable integers which the user may\ninput and then utilize in subroutines of his/her own\ndesign.  They are not used in the official versions\nof the ABINIT code, and should ease independent\ndevelopments (hopefully integrated in the official\nversion afterwards).\n<br>Internally, they are available in the dtset structured datatype,\ne.g. dtset%useria .\n",
    "vartype": "integers "
  },
  "userr": {
    "category": " ",
    "default": "0.0 .",
    "definition": "USER Real variables A, B, C, D, and E ",
    "section": "vardev",
    "text": "<p>\nThese are user-definable with the same purpose as <a href=\"vardev.html#useri\">useri</a>. ",
    "vartype": "real numbers"
  },
  "usewvl": {
    "category": " ",
    "default": "0 (use plane-wave basis set).",
    "definition": "Use WaVeLet basis set ",
    "section": "varbas",
    "text": "<p>\nUsed to define if the calculation is done on a\nwavelet basis set or not.\n<br>The values of <b>usewvl</b> must be 0 or 1. Putting <b>usewvl</b>\nto 1, makes <a href=\"vargs.html#icoulomb\">icoulomb</a>\nmandatory to 1. The number of band (<a\nhref=\"varbas.html#nband\">nband</a>) must be set manually to\nthe strict number need for an isolator system (<i>i.e.</i>\nnumber of electron over two). The cut-off is not relevant in the\nwavelet case, use <a href=\"varbas.html#wvl_hgrid\">wvl_hgrid</a>\ninstead.\n<br>In wavelet case, the system must be isolated systems (molecules or\nclusters). All geo optimization are available (see <a\nhref=\"varrlx.html#ionmov\">ionmov</a>, especially the geo\noptimisation and the molecular dynamics.\n<br>The spin computation is not currently possible with wavelets and\nmetalic systems may be slow to converge.\n",
    "vartype": "integer (0 or 1)"
  },
  "usexcnhat": {
    "category": "",
    "default": "-1",
    "definition": "USE eXchange-Correlation with NHAT (compensation charge density) ",
    "section": "varpaw",
    "text": "<p>\nRelevant only when <a href=\"varint.html#usepaw\">usepaw</a>=1.<br>\nThis flag determines how the exchange-correlation terms are computed for the pseudo-density.<br>\nWhen <b>usexcnhat</b>=0, exchange-correlation potential does not include the compensation charge density, i.e.\nVxc=Vxc(tild_Ncore + tild_Nvalence).<br>\nWhen <b>usexcnhat</b>=1, exchange-correlation potential includes the compensation charge density, i.e.\nVxc=Vxc(tild_Ncore + tild_Nvalence + hat_N).<br>\nWhen <b>usexcnhat</b>=-1,the value of <b>usexcnhat</b> is determined from the reading of the PAW dataset file\n(pseudopotential file). When PAW datasets with different treatment of Vxc are used in the same\nrun, the code stops.\n\n",
    "vartype": "integer parameter "
  },
  "useylm": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 for norm-conserving pseudopotential(s), 1 for Projector Augmented-Wave (PAW), 1 when the recursion method is used (<a href=\"vardev.html#tfkinfunc\">tfkinfunc</a>=1).",
    "definition": "USE YLM (the spherical harmonics) ",
    "section": "vardev",
    "text": "<p>\nWhen this flag is activated, the non-local operator is applied using an algorithm based on spherical harmonics. Non-local projectors are used with their usual form:<br>\n<ul>P<sub>lmn</sub>(r)=Y<sub>lm</sub>(r)*p<sub>ln</sub>(r)</ul><br>\n<br>When <b>useylm</b>=0, the sum over Y_lm can be reduced to a Legendre polynomial form.\n",
    "vartype": "integer parameter  "
  },
  "vaclst": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>, <a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>  ",
    "default": "No Default.",
    "definition": "VACancies LiST ",
    "section": "vargeo",
    "text": "<p>\nGives the identification number(s) of atoms\nto be subtracted from the set of atoms that are obtained\nafter having rotated, translated and repeated the objects.\n<br>Useful to created vacancies.",
    "vartype": "integer array vaclst(<a href=\"vargeo.html#vacnum\">vacnum</a>) "
  },
  "vacnum": {
    "category": "<a href=\"../users/abinit_help.html#geometry_builder\">GEOMETRY BUILDER</a>  ",
    "default": "0.",
    "definition": "VACancies NUMber ",
    "section": "vargeo",
    "text": "<p>\nGives the number of atoms to be subtracted\nfrom the list of atoms after the rotations, translations\nand repetitions have been done. The list of these\natoms is contained in <a href=\"vargeo.html#vaclst\">vaclst</a>.",
    "vartype": "integer parameter  "
  },
  "vacuum": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "No Default",
    "definition": "VACUUM identification ",
    "section": "vargs",
    "text": "<p>\nEstablishes the presence (if 1) or absence (if 0) of a vacuum\nlayer, along the three possible directions normal to the\nprimitive axes.\n<p>\nThis information might be used to generate k-point grids,\nif <a href=\"varbas.html#kptopt\">kptopt</a>=0 and neither\n<a href=\"varbas.html#ngkpt\">ngkpt</a> nor <a href=\"vargs.html#kptrlatt\">kptrlatt</a>\nare defined (see explanations with the input variable\n<a href=\"varfil.html#prtkpt\">prtkpt</a>).\n<br> It will allow to select\na zero-, one-, two- or three-dimensional\ngrid of k points. The coordinate of the k points\nalong vacuum directions is automatically set to zero.\n<p>\nIf <b>vacuum</b> is not defined, the input variable\n<a href=\"vargs.html#vacwidth\">vacwidth</a>\nwill be used to determine automatically whether the\ndistance between atoms is sufficient to have the\npresence or absence of vacuum.\n",
    "vartype": "integer array <b>vacuum</b>(3)  "
  },
  "vacwidth": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>, <a href=\"../users/abinit_help.html#length\">LENGTH</a>  ",
    "default": "10.0",
    "definition": "VACuum WIDTH ",
    "section": "vargs",
    "text": "<p>\nGive a minimum \"projected\" distance between\natoms to be found in order to declare that there\nis some <a href=\"vargs.html#vacuum\">vacuum</a> present for each of the three\ndirections.\nBy default, given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since <b>vacwidth</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\n<br>The precise requirement is that a slab\nof width <b>vacwidth</b>, delimited by two\nplanes of constant reduced coordinates in the\ninvestigated direction, must be empty of atoms.\n",
    "vartype": "real parameter  "
  },
  "vcutgeo": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>  ",
    "default": "3*0.0d0",
    "definition": "V (potential) CUT-off GEOmetry ",
    "section": "vargw",
    "text": "<p>\n(No explicit documentation, please see\n<a href=\"https://listes-2.sipr.ucl.ac.be/abinit.org/arc/forum/2008-11/msg00087.html\">\nhttps://listes-2.sipr.ucl.ac.be/abinit.org/arc/forum/2008-11/msg00087.html </a>\nfor the time being)\n<p>\n<b>vcutgeo</b> is used in conjunction with <a href=\"vargw.html#icutcoul\">icutcoul</a>\nto specify the geo used to truncate the Coulomb interaction as well as the\nparticular approach to be used.\nIt has a meaning only for the cylindrical symmetry\n(<a href=\"vargw.html#icutcoul\">icutcoul</a>=1) or in the case of surfaces\n<a href=\"vargw.html#icutcoul\">icutcoul</a>=2.\nFor each geo, two different definition of the cutoff region are available\n(see Phys. Rev. B 73, 233103 and Phys. Rev. B 73, 205119 for a complete description of the methods)\n<p>\nIn Beigi's method (Phys. Rev. B 73, 233103), the cutoff region is given by the Wigner-Seitz cell\ncentered on the axis of the cylinder.\nThe cutoff region is thus automatically defined by the unit cell and there's no need to specify\nWhen <a href=\"vargw.html#rcut\">rcut</a>.\n<p>\nTo define a cylinder along the z-axis use the following two lines.\n\nicutcoul 1\nrprim    1 0 0\n0 1 0\n0 0 1\nvcutgeo  0 0 1\n\n<p>\nPlease note that Beigi's method is implemented only in the case if an orthorombic\nBravais lattic. For hexagonal lattices, one has to use the method of Rozzi (Phys. Rev. B 73, 205119)\nIn this case, the interaction is truncated in a finite cylinder.\nContrarily to the first approach, here one has to specify both the radius of the cylinder\nwith <a href=\"vargw.html#rcut\">rcut</a>\nas well as the length of the cylinder along the periodic dimension that should always be smaller\nthan the extension of the Born von Karman box.\nThe length of the cylinder is given in terms of the primitive vector along the periodic direction.\n<p>\nFor example, in order to define a finite cylinder along z of radius 2.5 Bohr and length 3*R3\n\nicutcoul 1\nrprim    1 0 0\n0 1 0\n0 0 1\nvcutgeo  0 0 -3.0 # note the minus sign\nrcut     2.5\n\n<p>\nFor surface calculations (<a href=\"vargw.html#icutcoul\">icutcoul</a>=2),\n<b>vcutgeo</b> is used to define the two periodic directions defining the surface.\nAlso in this case two different techniques are available.\nIn the method of Beigi, the (positive) non-zero components of vcutgeo define the periodic\ndirections of the infinite surface. The interaction is truncated within a slab\nof width L where L is the length of the primitive vector of the lattice along the non-periodic dimension.\nFor example:\n\nicutcoul 2\nrprim    1 0 0\n0 1 0\n0 0 1\nvcutgeo 1 1 0\n\nIt is also possible to define a finite surface by employing negative values\nFor example:\n\nicutcoul 2\nvcutgeo -3 -2 0\n\ndefines ....\n\n\n",
    "vartype": "real array vcutgeo(3)"
  },
  "vdw_df_acutmin": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "10.",
    "definition": "vdW-DF MINimum Angular CUT-off",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build angular meshes for the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_aratio": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "20.",
    "definition": "vdW-DF RATIO between the high",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build angular meshes for the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_damax": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1.",
    "definition": "vdW-DF MAXimum Angular Delta",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build angular meshes for the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_dcut": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "20.",
    "definition": "vdW-DF D-mesh CUT-off",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_dratio": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "10.",
    "definition": "vdW-DF RATIO between the high",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_dsoft": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1.0.",
    "definition": "vdW-DF SOFTening distance.",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_gcut": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "5.",
    "definition": "vdW-DF K-space CUT-off",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto filter the vdW-DF kernel in reciprocal space.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_ndpts": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "15.",
    "definition": "vdW-DF Number of D-mesh PoinTS",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "integer parameter "
  },
  "vdw_df_nqpts": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "20.",
    "definition": "vdW-DF Number of Q-mesh PoinTS",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "integer parameter "
  },
  "vdw_df_nrpts": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "512.",
    "definition": "vdW-DF Number of R-PoinTS",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto define the sampling of the vdW-DF-kernel in real-space.<br/>\n",
    "vartype": "integer parameter "
  },
  "vdw_df_nsmooth": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "6.",
    "definition": "vdW-DF Number of SMOOTHening iterations",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto exponentially smoothen q near q0.<br/>\n",
    "vartype": "integer parameter "
  },
  "vdw_df_qcut": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "5.",
    "definition": "vdW-DF Q-mesh CUT-off",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto build the vdW-DF kernel.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_qratio": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "15.",
    "definition": "vdW-DF RATIO between high",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\n.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_rcut": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "50.",
    "definition": "vdW-DF Real-space CUT-off",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nto define the vdW-DF kernel cut-off radius.<br/>\n",
    "vartype": "real number "
  },
  "vdw_df_threshold": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "1.0e-2",
    "definition": "vdW-DF energy calculation threshold",
    "section": "vardev",
    "text": "Sets a threshold for the energy gradient that,\nwhen reached, will cause the vdW-DF interactions to be calculated. This\nmakes sense only if <a href=\"vardev.html#vdw_xc\">vdw_xc</a> is non-zero.\n<br>Adjust it to a big value (e.g. 1e12) to enable it all along the SCF\ncalculation. Too small values, as well as negative values, will result\nin the vdW-DF energy contributions never being calculated.\n",
    "vartype": "real parameter  "
  },
  "vdw_df_zab": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a> ",
    "default": "-0.8491.",
    "definition": "vdW-DF Zab parameter ",
    "section": "vardev",
    "text": "Used when <a href=\"vardev.html#vdw_xc\">vdw_xc</a>&gt;0,\nas inctroduced in <a href=\"http://dx.doi.org/10.1103/PhysRevLett.92.246401\">doi:10.1103/PhysRevLett.92.246401</a>.<br/>\n",
    "vartype": "real number "
  },
  "vdw_nfrag": {
    "category": "DEVELOP",
    "default": "1",
    "definition": "van der Waals Number of interacting FRAGments",
    "section": "vardev",
    "text": "<p>\nThe absolute value of vdw_nfrag is the number of vdW interacting\nfragments in the unit cell. As wannierization takes place in reciprocal space, the MLWF\ncenter positions could be translated by some lattice vector from the cell where atoms\nare placed. If vdw_nfrag >= 1 then MLWFs are translated to the original\nunit cell, otherwise the program will keep the positions obtained by Wannier90. The\nlater is usually correct if some atoms are located at the corners or at limiting\nfaces of the unit cell.\n\nUsed only if <b>vdw_xc=</b>10,11.\n",
    "vartype": "integer vdw_nfrag "
  },
  "vdw_supercell": {
    "category": "DEVELOP",
    "default": "0 0 0",
    "definition": "Van Der Waals correction from Wannier functions in SUPERCELL",
    "section": "vardev",
    "text": "<p>\nSet of dimensionless positive numbers which define the maximum multiples\nof the primitive translations (rprimd) in the supercell construction. Each component of vdw_supercell\nindicates the maximum number of cells along both positive or negative directions of the corresponding\nprimitive vector i.e. the components of <a href=\"varbas.html#rprimd\">rprimd</a>. In the case of layered\nsystems for which vdW interactions occur between layers made of tightly bound atoms, the evaluation\nof vdW corrections comming from MLWFs in the same layer (fragment) must be avoided. Both a negative or\nnull value for one component of <b>vdw_supercell</b>  will indicate that the  corresponding direction\nis normal to the layers.\n\n\nUsed only if <b>vdw_xc</b>=10,11.\n",
    "vartype": "integer array vdw_supercell(3) "
  },
  "vdw_tol": {
    "category": "DEVELOP",
    "default": "10^-10",
    "definition": "van der Waals TOLerance",
    "section": "vardev",
    "text": "<p>\nUsed only when Van der Waals DFT-D2 correction is activated (<a href=\"vardev.html#vdw_xc\">vdw_xc</a>=5).<br>\nThe DFT-D2 (S. Grimme approach) dispersion potential is implemented as a pair potential.\nThe number of pairs of atoms contributing to the potential is necessarily limited. To be included\nin the potential a pair of atom must have contribution to the energy larger than <b>vdw_tol</b>.\n",
    "vartype": "real number "
  },
  "vdw_typfrag": {
    "category": "DEVELOP",
    "default": "1*natom",
    "definition": "van der Waals TYPe of FRAGment",
    "section": "vardev",
    "text": "<p>\nThis array defines the interacting fragments by assigning to each atom an\ninteger index from 1 to <b>vdw_nfrag</b>. The ordering of <b>vdw_typfrag</b> is the same as\n<a href=\"varbas.html#typat\">typat</a> or <a href=\"varbas.html#xcart\">xcart</a>. Internally each MLWF is\nassigned to a given fragment by computing the distance to the atoms. MLWFs belong to\nthe same fragment as their nearest atom. The resulting set of MLWFs in each interacting fragment\ncan be found in the output file in xyz format for easy visualization.\n\nUsed only if <b>vdw_xc</b>=10,11.\n",
    "vartype": "integer array vdw_typfrag(natom) "
  },
  "vdw_xc": {
    "category": "DEVELOP",
    "default": "0",
    "definition": "van der Waals eXchange-Correlation functional",
    "section": "vardev",
    "text": "<p>\nSelects a van-der-Waals density functional to\napply the corresponding correction to the exchange-correlation energy.\nIf set to zero, no correction will be applied.\n<br>\nPossible values are:\n<ul>\n<li>0: no correction.</li>\n<li>1: apply vdW-DF1 (DRSLL) from Dion <i>et al.</i><br>\n<i>doi:10.1103/PhysRevLett.92.246401</i></li>\n<li>2: apply vdw-DF2 (LMKLL) from Lee <i>et al.</i><br>\n<i>arXiv:1003.5255v1</i></li>\n<li>5: apply vdw-DFT-D2 as proposed by S. Grimme (adding a semi-empirical dispersion potential)<br>\nAvailable only for ground-state calculations ; see <a href=\"vardev.html#vdw_tol\">vdw_tol</a> variable\nto control convergency<br>\n<i>J. Comp. Chem. 27, 1787 (2006)</i></li>\n<li>10: evaluate the vdW correlation energy from maximally localized Wannier functions, as proposed by\nP. L. Silvestrelli, also known as vdW-WF1 method. <i>doi:10.1103/PhysRevLett.100.053002,\ndoi:10.1016/j.cpc.2011.11.003</i></li>\n<li>11: evaluate the vdW correlation energy from maximally localized Wannier functions, as proposed by\nA. Ambrosetti and P. L. Silvestrelli, also known as vdW-WF2 method. <i>doi:10.1103/PhysRevB.85.073101</i></li>\n</ul>\nFor vdw_xc=1 and vdw_xc=2, the implementation follows the strategy devised\nin the article of Rom&aacute;n-P&eacute;rez and Soler\n(doi:10.1103/PhysRevLett.103.096102).\n",
    "vartype": "integer  "
  },
  "vel": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a> ",
    "default": "3*<a href=\"varbas.html#natom\">natom</a> 0's.",
    "definition": "VELocity ",
    "section": "varrlx",
    "text": "<p>\nGives the starting velocities\nof atoms, in cartesian coordinates, in Bohr/atomic time\nunits (atomic time units given where <a href=\"varrlx.html#dtion\">dtion</a>\nis described).\n<br>\nIrrelevant unless <a href=\"varrlx.html#ionmov\">ionmov</a> &gt; 0.\n<br>\nFor <a href=\"varrlx.html#ionmov\">ionmov</a>=8 (Nose thermostat),\nif <b>vel</b> is not initialized, a random initial\nvelocity giving the right kinetic energy will be generated.\n<br>\nIf the geo builder is used, <b>vel</b> will be related\nto the preprocessed set of atoms, generated by the\ngeo builder. The user must thus foresee the effect\nof this geo builder (see <a href=\"vargeo.html#objarf\">objarf</a>).\n<br>\nVelocities evolve is <a href=\"varrlx.html#ionmov\">ionmov</a>==1.\n",
    "vartype": "real array vel(3,<a href=\"varbas.html#natom\">natom</a>) represented internally as vel(3,<a href=\"varbas.html#natom\">natom</a>,<a href=\"varrlx.html#nimage\">nimage</a>)"
  },
  "vel_cell": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a> ",
    "default": "3*3 0's.",
    "definition": "VELocity of the CELL parameters ",
    "section": "varrlx",
    "text": "<p>\nIrrelevant unless <a href=\"varrlx.html#imgmov\">imgmov</a>=9 or 13\nand <a href=\"varrlx.html#optcell\">optcell</a>>0 (Path-Integral Molecular Dynamics\nwith NPT algorithm).<br>\nGives the starting velocities of the dimensional cell parameters in Bohr/atomic time\nunits (atomic time units given where <a href=\"varrlx.html#dtion\">dtion</a>\nis described).\n",
    "vartype": "real array vel_cell(3,3) represented internally as vel_cell(3,3,<a href=\"varrlx.html#nimage\">nimage</a>)"
  },
  "vis": {
    "category": "",
    "default": "100.",
    "definition": "VIScosity ",
    "section": "varrlx",
    "text": "<p>\nGives the viscosity (atomic units) for linear\nfrictional damping term applied to molecular dynamics\nwhen <a href=\"varrlx.html#ionmov\">ionmov</a>=1. Used for eventual\nrelaxation of structure\n(however, <a href=\"varrlx.html#ionmov\">ionmov</a>=2 is in general more\nefficient).\n</font>\n<p><font id=\"text\">The equation of motion is :<br>\nM<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>\n- <b>vis</b> dR<sub>I</sub>/dt\n<br>\n<br>\nThe atomic unit of viscosity is hartrees*(atomic time units)/Bohr<sup>2</sup>.\nUnits are not\ncritical as this is a fictitious damping used to relax\nstructures. A typical value for silicon is 400 with\n<a href=\"varrlx.html#dtion\">dtion</a> of 350 and atomic mass 28 <a\nhref=\"varrlx.html#amu\">amu</a>. Critical\ndamping is most desirable and is found only by\noptimizing <b>vis</b> for a given situation.\n",
    "vartype": "real parameter "
  },
  "vprtrb": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a>  ",
    "default": "0.d0 0.d0.",
    "definition": "potential -V- for the PeRTuRBation ",
    "section": "varff",
    "text": "<p>\nGives the real and imaginary\nparts of a scalar potential perturbation.\nCan be specified in Ha (the default), Ry, eV or Kelvin, since\n<b>ecut</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">ENERGY</a>' characteristics.\n<br>This is made\navailable for testing responses to such perturbations.\nThe form of the perturbation, which is added to the local\npotential, is:\n<ul>\n<li> (<b>vprtrb</b>(1)+I*<b>vprtrb</b>(2))/2 at G=<a href=\"varff.html#qprtrb\">qprtrb</a>  and</li>\n<li> (<b>vprtrb</b>(1)-I*<b>vprtrb</b>(2))/2 at G=-<a href=\"varff.html#qprtrb\">qprtrb</a>\n(see <a href=\"varff.html#qprtrb\">qprtrb</a> also).</li>\n</ul>",
    "vartype": "real array of 2 elements  "
  },
  "w90iniprj": {
    "category": " ",
    "default": "1 (random projections).",
    "definition": "Wannier90- INItial PROJections ",
    "section": "varw90",
    "text": "<p>\nIn order to find the Maximally Localized Wannier Functions, the user\nhas to provide an initial guess. A set of localized trial orbitals\nis chosen\ncorresponding to some rough initial guess at the\nWannier Functions, and these are projected onto the  Bloch\neigenstates. See Ivo\nSouza, Nicola Marzari, and David Vanderbilt. Phys. Rev. B, 65, 035109 (2001).\n<br>These initial projections are stored in a file .amn and the variable\n<b> w90iniprj</b> is used to construct them:\n<ul>\n<li><b> w90iniprj</b>=1:\nRandom projections.<br>\n<br>\n</li>\n\n<li><b> w90iniprj</b>=2:\nThe initial projections will be a linear combination of hydrogenic\natomic orbitals.\n<br>The user has to define the projections in the secondary input file\nwannier90.win\n<br>Information about how to define them can be found in the manual of\nWannier90. See <span><a href=\"http://www.wannier.org\">www.wannier.org</a>\n</ul>\nNot read if <a href=\"varfil.html#prtwant\">prtwant</a> /= 2 or 3.\n",
    "vartype": "integer "
  },
  "w90prtunk": {
    "category": " ",
    "default": "set to zero.",
    "definition": "Wannier90- PRINT UNKp.s file",
    "section": "varw90",
    "text": "<p>\nDefines whether or not the UNKp.s file will be printed.\n<ul>\n<li> <b>w90prtunk</b>=0: Do not print the UNKp.s files<br>\n<br>\n</li>\n<li> <b>w90prtunk</b>=1: Print the UNKp.s files on a fine grid<br>\n<br>\n</li>\n<li> <b>w90prtunk</b>>1: Print the UNKp.s files on a coarse grid <br>\nInstead of printing every record we will print every w90prtunk records. This is useful to reduce the size of the UNKp.s files, but, the quality is also reduced.</li>\n\n</ul>\nNot read if <a href=\"varfil.html#prtwant\">prtwant</a> /= 2 or 3.<br>\n<br>\nThe default is set to zero because UNKp.s files occupy a lot of\nmemory.\nThese files contain the periodic part of the bloch states represented\non a regular real space grid. They are indexed by k-point <b>p</b> (from 1 to\nnkpt) and spin <b>s</b> ('1' for 'up','2' for 'down').\n<br> <br> The name of the wavefunction file is assumed to have the form:\n<br><br>\nwrite(wfnname,200) <b>p</b>, <b>spin</b>\n<br>200 format ('UNK',i5.5,'.',i1)\n<br><br>\nThese file are unformatted.\nThe first line of each file contains 5 integers: the number of\ngrid points in each direction (<b>n1</b>, <b>n2</b> and <b>n3</b>), the k-point number <b>ikpt</b>\nand the total number of bands mband in the file. The following rows contain the wavefunctions in real space.\n<p>\nThese files are written in the following way for the coarse grid:</p>\n<pre>\nwrite(iun_plot) n1/w90prtunk,n2/w90prtunk,n3/w90prtunk,ikpt,nband\nwrite(iun_plot) (((fofr(1,jj1,jj2,jj3),fofr(2,jj1,jj2,jj3),&\n&      jj1=1,n1,w90prtunk),jj2=1,n2,w90prtunk),jj3=1,n3,w90prtunk)\n</pre>\nWhere <b>fofr</b> is a double precision variable which contains the wavefunctions in real space.\nNote that in order to reduce the size of the UNK files we are just\nincluding records in the wavefunctions for 1/(w90prtunk^3) of the grid points.\nThat is why we divide n1, n2 and n3 by prtunk. The output .xsf files for plotting\nwith XCrysDen will also be on the coarse grid.  When this dosen't produce an\nacceptable plot, prtunk can be set to 1 to output every grid point.\n(You should try spline interpolation in XCrysDen first.)\n\n\n\n</ul>\n",
    "vartype": "integer "
  },
  "wfoptalg": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "0 when <a href=\"varint.html#usepaw\">usepaw</a>=0 (norm-conserving pseudopotentials),<br>10 when <a href=\"varint.html#usepaw\">usepaw</a>=1 (PAW).<br>Default is 14 if <a href=\"varpar.html#paral_kgb\">paral_kgb</a>=1.",
    "definition": "WaveFunction OPTimisation ALGorithm ",
    "section": "vardev",
    "text": "<p>\nAllows to choose the algorithm\nfor the optimisation of the wavefunctions.\n<br>The different possibilities are :\n<ul>\n<li><b>wfoptalg</b>=0 : standard state-by-state conjugate gradient algorithm,\nwith no possibility to parallelize over the states;</li>\n<li><b>wfoptalg</b>=2 : minimisation of the residual with respect\nto different shifts, in order to cover the whole set of occupied\nbands, with possibility to parallelize over blocks of states (or bands).\nThe number of states in a block\nis defined in <a href=\"vardev.html#nbdblock\">nbdblock</a>.\nTHIS IS STILL IN DEVELOPMENT.</li>\n<li><b>wfoptalg</b>=3 : minimisation of the residual with respect\nto a shift. Available only in the non-self-consistent case\n<a href=\"varbas.html#iscf\">iscf</a>=-2,\nin order to find eigenvalues and wavefunctions close to a\nprescribed value.</li>\n<li><b>wfoptalg</b>=4 : (see also <b>wfoptalg</b>=14), a parallel code based on the Locally Optimal\nBlock Preconditioned Conjugate Gradient (LOBPCG) method of Knyazev.\n<a href=\"http://dx.doi.org/10.1137/S1064827500366124\">\nReference : A.V. Knyazev, \"Toward the Optimal Preconditioned Eigensolver\n: Locally Optimal Block Preconditioned Conjugate Gradient Method\". SIAM\nJournal on Scientific Computing 23, pp517-541 (2001)</a>.\nThe implementation rests\non the <a href=\"http://www.mathworks.com/matlabcentral/fileexchange/48-lobpcg-m\">\nmatlab program by Knyazev</a>.\n<a href=\"http://dx.doi.org/10.1137/060661624\">\nReference A. V. Knyazev, I. Lashuk, M. E. Argentati, and E. Ovchinnikov,\nBlock Locally Optimal Preconditioned Eigenvalue Xolvers (BLOPEX) in\nhypre and PETSc (2007). SIAM Journal on Scientific Computing (SISC).\n25(5): 2224-2239</a>.\nFor more\ninformation see\n<a href=\"http://dx.doi.org/10.1016/j.commatsci.2007.07.019\">\nF. Bottin, S. Leroux, A. Knyazev, G. Zerah, Large scale\nab initio calculations based on three levels of parallelization. (2008).\nComputational Material Science, 42(2), 329-336.\n</a>\n<li><b>wfoptalg</b>=10 : (for PAW) standard state-by-state conjugate gradient algorithm,\nwith no possibility to parallelize over the states, but modified\nscheme described in Kresse, Furthmuller, PRB 54, 11169 (1996)\n(modified kinetic energy, modified preconditionning, minimal\northogonalization, ...) ;</li>\n<li><b>wfoptalg</b>=14 :\nthe recommended for massively parallel code, the same as <b>wfoptalg</b>=4 except that the preconditioning of\nthe block vectors does not depend on the kinetic energy of each band,\nand the orthogonalization after the LOBPCG algorithm is no longer\nperformed. The first modification increases the convergence and the\nsecond one the efficiency.\n</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "wtatcon": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a> ",
    "default": "0.",
    "definition": "WeighTs for AToms in CONstraint equations",
    "section": "varrlx",
    "text": "<p>\nGives the weights determining how the motion of atoms\nis constrained\nduring structural optimization or molecular dynamics (see <a\nhref=\"varrlx.html#nconeq\">nconeq</a>, <a href=\"varrlx.html#natcon\">natcon</a>,\nand <a href=\"varrlx.html#iatcon\">iatcon</a>). For each of the <a\nhref=\"varrlx.html#nconeq\">nconeq</a> independent constraint equations,\nwtatcon is a 3*<a href=\"varrlx.html#natcon\">natcon</a> array giving\nweights, W<sub>I</sub>,\nfor the x, y, and z components of each of the atoms (labeled by I) in\nthe list of indices <a href=\"varrlx.html#iatcon\">iatcon</a>.\nPrior to taking an atomic step, the calculated forces, F<sub>I</sub>,\nare\nreplaced by projected forces, F'<sub>I</sub>, which satisfy the set of\nconstraint equations\n<br>\n<br>\nSum<sub>mu=x,y,z; I=1,natcon</sub>: W<sub>mu,I</sub> * F'<sub>mu,I</sub>\n= 0 for each of the <a href=\"varrlx.html#nconeq\">nconeq</a> arrays W<sub>I</sub>.\n<br>\n<br>\nDifferent types of motion constraints can be implemented this way. For\nexample,\n<br>\n<br>\nnconeq 1 natcon 2 iatcon 1 2 wtatcon 0 0 +1 0 0 -1\n<br>\n<br>\ncould be used to constrain the relative height difference of two\nadsorbate atoms on a surface (assuming their\nmasses are equal), since F'<sub>z,1</sub> - F'<sub>z,2</sub> = 0\nimplies z<sub>1</sub> - z<sub>2</sub> = constant.\n",
    "vartype": "real array wtatcon(3,<a href=\"varrlx.html#natcon\">natcon</a>,<a href=\"varrlx.html#nconeq\">nconeq</a>)"
  },
  "wtk": {
    "category": " ",
    "default": "<a href=\"varbas.html#nkpt\">nkpt</a>*1.0d0 except when <a href=\"varbas.html#kptopt\">kptopt</a>/=0.",
    "definition": "WeighTs for K points ",
    "section": "varbas",
    "text": "<p>\nGives the k point weights.  <br>The\nk point weights will have their sum (re)normalized to 1\n(unless <a href=\"varbas.html#occopt\">occopt</a>=2 and <a href=\"varbas.html#kptopt\">kptopt</a>=0;\nsee description of <a href=\"varbas.html#occopt\">occopt</a>)\nwithin the program and therefore may be input with any\narbitrary normalization.  This feature helps avoid the\nneed for many digits in representing fractional weights\nsuch as 1/3.\n<br><b>wtk</b> is ignored if <a href=\"varbas.html#iscf\">iscf</a> is not positive,\nexcept if <a href=\"varbas.html#iscf\">iscf</a>=-3.",
    "vartype": "real array wtk(<a href=\"varbas.html#nkpt\">nkpt</a>)  "
  },
  "wvl_bigdft_comp": {
    "category": "",
    "default": "0",
    "definition": "WaVeLet BigDFT Comparison ",
    "section": "vargs",
    "text": "This variable is used for the wavelets capabilities of ABINIT (see <a\nhref=\"varbas.html#usewvl\">usewvl</a>).\nIt is used to compare the results obtained with ABINIT\nwith those obtained with BigDFT stand-alone.\nWhen it is set to 1, ABINIT will follow the workflow as in BigDFT stand-alone.\nTherefore, the results must be exactly the same with the two codes.\n",
    "vartype": "integer parameter  "
  },
  "wvl_crmult": {
    "category": "",
    "default": "6.0",
    "definition": "WaVeLet Coarse grid Radius MULTiplier ",
    "section": "vargs",
    "text": "<p>\nThis factor is used to defined the expansion of the coarse resolution\ngrid in the case of wavelets (see <a\nhref=\"varbas.html#usewvl\">usewvl</a>). The grid is made of\npoints inside spheres centered on atoms. The radius of these\nspheres are the product between this factor and the covalent\nradius of element (read from the pseudo-potential file).<br />\nThis factor is responsible for the amount of used memory (see also <a href=\"varbas.html#wvl_hgrid\">wvl_hgrid</a>).\n",
    "vartype": "real parameter  "
  },
  "wvl_frmult": {
    "category": "",
    "default": "10.0",
    "definition": "WaVeLet Fine grid Radius MULTiplier ",
    "section": "vargs",
    "text": "<p>\nThis factor is used to defined the expansion of the fine resolution\ngrid in the case of wavelets (see <a\nhref=\"varbas.html#usewvl\">usewvl</a>). This fine resolution\ngrid has the same grid step than the coarse one (see <a\nhref=\"vargs.html#wvl_crmult\">wvl_crmult</a>), but on each\npoint, 8 coefficients are stored instead of one, increasing the\nprecision of the calculation in this area. The grid is made of\npoints inside spheres centered on atoms. The radius of these\nspheres are the product between this factor and a value read from the pseudo-potential file.<br />\nThis factor is responsible for the amount of used memory (see also <a href=\"varbas.html#wvl_hgrid\">wvl_hgrid</a>).\n",
    "vartype": "real parameter  "
  },
  "wvl_hgrid": {
    "category": "<a href=\"../users/abinit_help.html#length\">LENGTH</a>  ",
    "default": "0.5d0 .",
    "definition": "WaVeLet H step GRID ",
    "section": "varbas",
    "text": "<p>\nIt gives the step size in real space for the\ngrid resolution in the wavelet basis set. This value is highly\nresponsible for the memory occupation in the wavelet\ncomputation. The value is a length in atomic units.\n",
    "vartype": "real parameter "
  },
  "wvl_nprccg": {
    "category": "",
    "default": "5",
    "definition": "WaVeLet maximum Number of PReConditionner Conjugate Gradient iterations",
    "section": "vargs",
    "text": "<p>\nIn the wavelet computation case, the wavefunctions are directly\nminimised using a real-space preconditionner. This preconditionner\nhas internally some conjugate gradient iterations. This value\ndefines a boundary for the number of conjugate gradient\niterations on each wavefunction convergence step.\n",
    "vartype": "integer parameter  "
  },
  "xangst": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a> ",
    "default": "",
    "definition": "vectors (X) of atom positions in cartesian coordinates -length in ANGSTrom- ",
    "section": "varbas",
    "text": "<p>\nGives the cartesian coordinates\nof atoms within unit cell, in angstrom.  This information is\nredundant with that supplied by array <a href=\"varbas.html#xred\">xred</a> or <a href=\"varbas.html#xcart\">xcart</a>.\n<br>If <a href=\"varbas.html#xred\">xred</a> and <b>xangst</b> are ABSENT from the input file and\n<a href=\"varbas.html#xcart\">xcart</a> is\nprovided, then the values of <a href=\"varbas.html#xred\">xred</a> will be computed from\nthe provided <a href=\"varbas.html#xcart\">xcart</a> (i.e. the user may use xangst instead\nof <a href=\"varbas.html#xred\">xred</a> or <a href=\"varbas.html#xcart\">xcart</a> to provide starting coordinates).\n<br>One and only one of <a href=\"varbas.html#xred\">xred</a>, <a href=\"varbas.html#xcart\">xcart</a>\nand <b>xangst</b> must be provided.\n<br>The conversion factor between Bohr and Angstrom\nis 1 Bohr=0.5291772108 Angstrom, see the <a href=\"http://physics.nist.gov/cuu/Constants/index.html\">NIST site</a>.\n<br>Atomic positions evolve if <a href=\"varrlx.html#ionmov\">ionmov</a>/=0 .\nIn constrast with <a href=\"varbas.html#xred\">xred</a> and\n<a href=\"varbas.html#xcart\">xcart</a>, <b>xangst</b> is not internal.\n",
    "vartype": "real array xangst(3,<a href=\"varbas.html#natom\">natom</a>) (or xangst(3,<a href=\"vargeo.html#natrd\">natrd</a>) if the geo builder is used)"
  },
  "xc_denpos": {
    "category": "<a href=\"../users/abinit_help.html#develop\">DEVELOP</a>  ",
    "default": "1.0e-14 ",
    "definition": "eXchange-Correlation - DENsity POSitivity value  ",
    "section": "vardev",
    "text": "<p>\nFor the evaluation of the exchange-correlation functionals, the density\ncannot be negative, or even too small (e.g. the LDA exchange kernel\nbehaves like the density at power -(2/3), and the density is used at the denominator\nof different factors in GGAs and metaGGAs.\n<b>xc_denpos</b> is the smallest value that the density can assume at the time of the\nevaluation of a XC functional, in ABINIT. When then computed density drops below <b>xc_denpos</b>\nbefore attacking the evaluation of the XC functional, then it will be (only for that purpose)\nreplaced by <b>xc_denpos</b>. Note that the evaluation of the gradients or other quantities\nthat are density-dependent is performed before this replacement.\n<p>\nIt has been observed that the SCF cycle of the Tran-Blaha mGGA can be quite hard to make converge, for systems\nfor which there is some vacuum. In this case, setting <b>xc_denpos</b> to 1.0e-7 ... 1.0e-6 has been seen\nto allow good convergence. Of course, this will affect the numerical results somehow, and one should play\na bit with this value to avoid incorrect calculations.\n",
    "vartype": "real"
  },
  "xc_tb09_c": {
    "category": "</a> ",
    "default": "all 99.99d0",
    "definition": "Value of the c parameter in the eXchange-Correlation TB09 functional ",
    "section": "vardev",
    "text": "<p>\nThe modified Becke-Johnson exchange-correlation functional by Tran and Blaha (Phys. Rev. Lett. 102, 226401 (2009)) reads :\n<p>V_x(r) = c * V_x^{BR}(r) + (3*c - 2) * 1/pi * sqrt(5/12) * sqrt(2*kden(r)/den(r))\n<p>in which V_x^{BR}(r) is the Becke-Roussel potential.\n<p>In this equation the parameter c can be evaluated at each SCF step according to the following equation :\n<p>c = alpha + beta * sqrt(1/V_{cell} * \\int_{V_{cell}} |grad(den(r))|/den(r) d3r)\n<p>The c parameter is evaluated thanks to the previous equation when xc_tb09_c is equal to the \"magic\" default value 99.99.\nThe c parameter can also be fixed to some (property-optimized or material-optimized) value by using this variable.\n",
    "vartype": "real "
  },
  "xcart": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a>, <a href=\"../users/abinit_help.html#length\">LENGTH</a> ",
    "default": "",
    "definition": "vectors (X) of atom positions in CARTesian coordinates  ",
    "section": "varbas",
    "text": "<p>\nGives the cartesian coordinates\nof atoms within unit cell.  This information is\nredundant with that supplied by array <a href=\"varbas.html#xred\">xred</a> or <a href=\"varbas.html#xangst\">xangst</a>.\nBy default, <b>xcart</b> is given in Bohr atomic units\n(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,\nif preferred, since <b>xcart</b> has the\n'<a href=\"../users/abinit_help.html#dimensions\">LENGTH</a>' characteristics.\n<br>If <a href=\"varbas.html#xred\">xred</a> and <a href=\"varbas.html#xangst\">xangst</a> are\nABSENT from the input file and <b>xcart</b> is\nprovided, then the values of <a href=\"varbas.html#xred\">xred</a> will be computed from\nthe provided <b>xcart</b> (i.e. the user may use <b>xcart</b> instead\nof <a href=\"varbas.html#xred\">xred</a> or <a href=\"varbas.html#xangst\">xangst</a> to provide starting coordinates).\n<br>One and only one of <a href=\"varbas.html#xred\">xred</a>, <a href=\"varbas.html#xcart\">xcart</a>\nand <b>xangst</b> must be provided.\n<br>Atomic positions evolve if <a href=\"varrlx.html#ionmov\">ionmov</a>/=0 .",
    "vartype": "real array xcart(3,<a href=\"varbas.html#natom\">natom</a>) (or xcart(3,<a href=\"vargeo.html#natrd\">natrd</a>) if the geo builder is used) "
  },
  "xclevel": {
    "category": "<a href=\"../users/abinit_help.html#internal\">INTERNAL</a>",
    "default": "0",
    "definition": "eXchange Correlation functional level",
    "section": "vargs",
    "text": "<p>\nAutomatically determined from the value of <a href=\"varbas.html#ixc\">ixc</a>.\n<ul>\n<li>0 => No XC contribution.</li>\n<li>1 => LDA functional.</li>\n<li>2 => GGA functional.</li>\n<li>3 => Functional for TDDFT.</li>\n</ul>\n",
    "vartype": "integer parameter  "
  },
  "xred": {
    "category": "<a href=\"../users/abinit_help.html#evolving\">EVOLVING</a> ",
    "default": "all 0.0d0",
    "definition": "vectors (X) of atom positions in REDuced coordinates  ",
    "section": "varbas",
    "text": "<p>\nGives the atomic locations within\nunit cell in coordinates relative to real space primitive\ntranslations (NOT in cartesian coordinates).  Thus these\nare fractional numbers typically between 0 and 1 and\nare dimensionless.  The cartesian coordinates of atoms (in Bohr)\nare given by:<br>\n<tele>  R_cartesian = xred1*rprimd1+xred2*rprimd2+xred3*rprimd3</tele><br>\nwhere (t1,t2,t3) are the \"reduced coordinates\" given in\ncolumns of \"<b>xred</b>\", (rprimd1,rprimd2,rprimd3) are the columns of\nprimitive vectors array \"<a href=\"varbas.html#rprimd\">rprimd</a>\" in Bohr.\n<br>If you prefer to work only with cartesian coordinates, you\nmay work entirely with \"<a href=\"varbas.html#xcart\">xcart</a>\" or \"<a href=\"varbas.html#xangst\">xangst</a>\" and ignore <b>xred</b>, in\nwhich case <b>xred</b> must be absent from the input file.\n<br>One and only one of <a href=\"varbas.html#xred\">xred</a>, <a href=\"varbas.html#xcart\">xcart</a>\nand <b>xangst</b> must be provided.\n<br>Atomic positions evolve if <a href=\"varrlx.html#ionmov\">ionmov</a>/=0 .",
    "vartype": "real array xred(3,<a href=\"varbas.html#natom\">natom</a>) (or xred(3,<a href=\"vargeo.html#natrd\">natrd</a>) if the geo builder is used), represented internally as xred(3,<a href=\"varbas.html#natom\">natom</a>,<a href=\"varrlx.html#nimage\">nimage</a>) "
  },
  "xredsph_extra": {
    "category": "</a>",
    "default": "unallocated unless <a href=\"vargs.html#natsph_extra\">natsph_extra</a> is greater than 0 ",
    "definition": "X(position) in REDuced coordinates of the SPHeres for dos projection in the EXTRA set",
    "section": "vargs",
    "text": "<p>\nThe positions in reduced coordinates of extra spheres used in the DOS projection, simulating an STS signal.\nSee <a href=\"vargs.html#natsph_extra\">natsph_extra</a> for a more complete description.\n",
    "vartype": "real array xredsph_extra(3,<a href=\"vargs.html#natsph_extra\">natsph_extra</a>)"
  },
  "xyzfile": {
    "category": "<a href=\"../users/abinit_help.html#not_internal\">NOT INTERNAL</a>",
    "default": "No default",
    "definition": "XYZ FILE input for geo ",
    "section": "vargeo",
    "text": "<p>\nGives the name of a xyz format file, to take\n<a href=\"varbas.html#natom\">natom</a>, <a href=\"varbas.html#ntypat\">ntypat</a>, <a href=\"varbas.html#typat\">typat</a>, <a href=\"varbas.html#znucl\">znucl</a>,\nand <a href=\"varbas.html#xangst\">xangst</a> from. This input can not be mixed with normal atom specifications or <a href=\"varfil.html#cmlfile\">cmlfile</a> for other datasets.",
    "vartype": "character file name  "
  },
  "zcut": {
    "category": "<a href=\"../users/abinit_help.html#gw\">GW</a>, <a href=\"../users/abinit_help.html#energy\">ENERGY</a> ",
    "default": "0.1 eV = 3.67493260d-03Ha ",
    "definition": "Z-CUT ",
    "section": "vargw",
    "text": "<p>\nOnly relevant if <a href=\"vargs.html#optdriver\">optdriver</a>=3,4,99 that is, screening, sigma or BS calculations.\n<p>\nIt is meant to avoid some divergencies that might occur during the evaluation of the Adler-Wiser expression of\nthe irreducible polarizability (<a href=\"vargs.html#optdriver\">optdriver</a>=3) or during the numerical treatment\nof the integrals defining the contribution to the self-energy matrix elements\n(<a href=\"vargs.html#optdriver\">optdriver</a>=4).\nIf the denominator becomes smaller than <b>zcut</b>, a small imaginary part (depending on <b>zcut</b>) is added,\nin order to avoid the divergence.\n<p>\nWhen <a href=\"vargs.html#optdriver\">optdriver</a>=99, <b>zcut</b> defines the small complex shift\nused to avoid divergences in the expression for the macroscopic dieletric function.\nIt simulates the experimental uncertainty and the finite lifetime of the quasiparticles\n(although the true lifetime should be k- and band-dependent).\nThe value of <b>zcut</b> affects the number of iteration needed to achieve convergence\nin the Haydock iterative method. In this case, <b>zcut</b> should be\nlarger than the typical distance between the eigenvalues of the exciton Hamiltonian.\n<br>\nIdeally, one should make a convergence study decreasing the value of <b>zcut</b> for increasing number of k-points.\n",
    "vartype": "real parameter "
  },
  "zeemanfield": {
    "category": "MAGNETIC FIELD",
    "default": "0",
    "definition": "ZEEMAN FIELD",
    "section": "varff",
    "text": "<p>\nGive the value of the Zeeman field, H, acting on the spinorial wavefunctions.\nNote that Tesla are admitted. This sets the magnitude of mu_0*H, in Tesla,\nwith H in Amperes/metre.\n",
    "vartype": "real array zeemanfield(3)  "
  },
  "ziontypat": {
    "category": " ",
    "default": "value is set by the pseudopotential files.",
    "definition": "Z (charge) of the IONs for the different TYPes of AToms",
    "section": "varint",
    "text": "<p>\nCharge of the pseudo-ion (=number of valence electrons\nthat are needed to screen exactly the pseudopotential).\n",
    "vartype": "real array ziontypat(ntypat)"
  },
  "znucl": {
    "category": "<a href=\"../users/abinit_help.html#no_multi\">NO MULTI</a>  ",
    "default": "",
    "definition": "charge -Z- of the NUCLeus ",
    "section": "varbas",
    "text": "<p>\nGives nuclear charge for each\ntype of pseudopotential, in order.\n<br>If <b>znucl</b> does not agree with nuclear charge,\nas given in pseudopotential files, the program writes\nan error message and stops.\n<p>N.B. : In the pseudopotential files, <b>znucl</b> is called \"zatom\".\n<p>For a \"dummy\" atom, with znucl=0 , as used in the case of calculations\nwith only a jellium surface, ABINIT sets arbitrarily the covalent radius to one.\n",
    "vartype": "real array znucl(<a href=\"vargs.html#npsp\">npsp</a>)  "
  }
}